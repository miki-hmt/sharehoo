<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=GBK">
<title>15.2.&#160;限制结果集内容</title>
<link rel="stylesheet" href="styles/html.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.71.0">
<link rel="start" href="index.html" title="HIBERNATE - 符合Java习惯的关系数据库持久化">
<link rel="up" href="ch15.html" title="第&#160;15&#160;章&#160; 条件查询(Criteria Queries)">
<link rel="prev" href="ch15.html" title="第&#160;15&#160;章&#160; 条件查询(Criteria Queries)">
<link rel="next" href="ch15s03.html" title="15.3.&#160;结果集排序">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="querycriteria-narrowing"></a>15.2.&#160;限制结果集内容</h2></div></div></div>
<p>
            一个单独的查询条件是<code class="literal">org.hibernate.criterion.Criterion</code>
            接口的一个实例。<code class="literal">org.hibernate.criterion.Restrictions</code>类
            定义了获得某些内置<code class="literal">Criterion</code>类型的工厂方法。
        </p>
<pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .add( Restrictions.between("weight", minWeight, maxWeight) )
    .list();</pre>
<p>
            约束可以按逻辑分组。
        </p>
<pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .add( Restrictions.or(
        Restrictions.eq( "age", new Integer(0) ),
        Restrictions.isNull("age")
    ) )
    .list();</pre>
<pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.in( "name", new String[] { "Fritz", "Izi", "Pk" } ) )
    .add( Restrictions.disjunction()
        .add( Restrictions.isNull("age") )
    	.add( Restrictions.eq("age", new Integer(0) ) )
    	.add( Restrictions.eq("age", new Integer(1) ) )
    	.add( Restrictions.eq("age", new Integer(2) ) )
    ) )
    .list();</pre>
<p>
            Hibernate提供了相当多的内置criterion类型(<code class="literal">Restrictions</code>
            子类), 但是尤其有用的是可以允许你直接使用SQL。
        </p>
<pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.sqlRestriction("lower({alias}.name) like lower(?)", "Fritz%", Hibernate.STRING) )
    .list();</pre>
<p>
            <code class="literal">{alias}</code>占位符应当被替换为被查询实体的列别名。
        </p>
<p>
             
            <code class="literal">Property</code>实例是获得一个条件的另外一种途径。你可以通过调用<code class="literal">Property.forName()</code>
            创建一个<code class="literal">Property</code>。
           
        </p>
<pre class="programlisting">
Property age = Property.forName("age");
List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.disjunction()
        .add( age.isNull() )
    	.add( age.eq( new Integer(0) ) )
    	.add( age.eq( new Integer(1) ) )
    	.add( age.eq( new Integer(2) ) )
    ) )
    .add( Property.forName("name").in( new String[] { "Fritz", "Izi", "Pk" } ) )
    .list();</pre>
</div></body>
</html>
