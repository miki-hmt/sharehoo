<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=GBK">
<title>3.7.&#160; XML配置文件</title>
<link rel="stylesheet" href="styles/html.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.71.0">
<link rel="start" href="index.html" title="HIBERNATE - 符合Java习惯的关系数据库持久化">
<link rel="up" href="ch03.html" title="第&#160;3&#160;章&#160; 配置">
<link rel="prev" href="ch03s06.html" title="3.6.&#160; 实现NamingStrategy">
<link rel="next" href="ch03s08.html" title="3.8.&#160; J2EE应用程序服务器的集成">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="configuration-xmlconfig"></a>3.7.&#160;
            XML配置文件
        </h2></div></div></div>
<p>
            另一个配置方法是在<code class="literal">hibernate.cfg.xml</code>文件中指定一套完整的配置. 
            这个文件可以当成<code class="literal">hibernate.properties</code>的替代。 若两个文件同时存在，它将覆盖前者的属性.
        </p>
<p>
            XML配置文件被默认是放在<code class="literal">CLASSPATH</code>的根目录下. 这是一个例子:
        </p>
<p>
            
        </p>
<pre class="programlisting">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;!-- 以/jndi/name绑定到JNDI的SessionFactory实例 --&gt;
    &lt;session-factory
        name="java:hibernate/SessionFactory"&gt;

        &lt;!-- 属性 --&gt;
        &lt;property name="connection.datasource"&gt;java:/comp/env/jdbc/MyDB&lt;/property&gt;
        &lt;property name="dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
        &lt;property name="show_sql"&gt;false&lt;/property&gt;
        &lt;property name="transaction.factory_class"&gt;
            org.hibernate.transaction.JTATransactionFactory
        &lt;/property&gt;
        &lt;property name="jta.UserTransaction"&gt;java:comp/UserTransaction&lt;/property&gt;

        &lt;!-- 映射定义文件 --&gt;
        &lt;mapping resource="org/hibernate/auction/Item.hbm.xml"/&gt;
        &lt;mapping resource="org/hibernate/auction/Bid.hbm.xml"/&gt;

        &lt;!-- 缓存设置 --&gt;
        &lt;class-cache class="org.hibernate.auction.Item" usage="read-write"/&gt;
        &lt;class-cache class="org.hibernate.auction.Bid" usage="read-only"/&gt;
        &lt;collection-cache collection="org.hibernate.auction.Item.bids" usage="read-write"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</pre>
<p>
            如你所见, 这个方法优势在于，在配置文件中指出了映射定义文件的名字. 一旦你需要调整Hibernate的缓存，
            <code class="literal">hibernate.cfg.xml</code>也是更方便. 注意，使用<code class="literal">hibernate.properties</code>还是
            <code class="literal">hibernate.cfg.xml</code>完全是由你来决定, 除了上面提到的XML语法的优势之外, 两者是等价的.
        </p>
<p>
            使用XML配置，使得启动Hibernate变的异常简单, 如下所示，一行代码就可以搞定：
        </p>
<pre class="programlisting">SessionFactory sf = new Configuration().configure().buildSessionFactory();</pre>
<p>
            你可以使用如下代码来添加一个不同的XML配置文件
        </p>
<pre class="programlisting">SessionFactory sf = new Configuration()
    .configure("catdb.cfg.xml")
    .buildSessionFactory();</pre>
</div></body>
</html>
