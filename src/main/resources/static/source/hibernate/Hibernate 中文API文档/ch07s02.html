<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=GBK">
<title>7.2.&#160;单向关联（Unidirectional associations）</title>
<link rel="stylesheet" href="styles/html.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.71.0">
<link rel="start" href="index.html" title="HIBERNATE - 符合Java习惯的关系数据库持久化">
<link rel="up" href="ch07.html" title="第&#160;7&#160;章&#160;关联关系映射">
<link rel="prev" href="ch07.html" title="第&#160;7&#160;章&#160;关联关系映射">
<link rel="next" href="ch07s03.html" title="7.3.&#160;使用连接表的单向关联（Unidirectional associations with join tables）">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="assoc-unidirectional"></a>7.2.&#160;单向关联（Unidirectional associations）</h2></div></div></div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="assoc-unidirectional-m21"></a>7.2.1.&#160;多对一(many to one)</h3></div></div></div>
<p>
             <span class="emphasis"><em>单向many-to-one关联</em></span>是最常见的单向关联关系。
        </p>
<pre class="programlisting">&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</pre>
<pre class="programlisting">
create table Person ( personId bigint not null primary key, addressId bigint not null )
create table Address ( addressId bigint not null primary key )
        </pre>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="assoc-unidirectional-121"></a>7.2.2.&#160;一对一（one to one）</h3></div></div></div>
<p>
             <span class="emphasis"><em>基于外键关联的单向一对一关联</em></span>和<span class="emphasis"><em>单向多对一关联</em></span>几乎是一样的。唯一的不同就是单向一对一关联中的外键字段具有唯一性约束。
        </p>
<pre class="programlisting">&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId" 
        unique="true"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</pre>
<pre class="programlisting">
create table Person ( personId bigint not null primary key, addressId bigint not null unique )
create table Address ( addressId bigint not null primary key )
        </pre>
<p>
            <span class="emphasis"><em>基于主键关联的单向一对一关联</em></span>通常使用一个特定的id生成器。（请注意，在这个例子中我们掉换了关联的方向。）
        </p>
<pre class="programlisting">&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;person&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    &lt;one-to-one name="person" constrained="true"/&gt;
&lt;/class&gt;</pre>
<pre class="programlisting">
create table Person ( personId bigint not null primary key )
create table Address ( personId bigint not null primary key )
        </pre>
</div>
<div class="sect2" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="assoc-unidirectional-12m"></a>7.2.3.&#160;一对多（one to many）</h3></div></div></div>
<p>
            <span class="emphasis"><em>基于外键关联的单向一对多关联</em></span>是一种很少见的情况，并不推荐使用。
        </p>
<pre class="programlisting">&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses"&gt;
        &lt;key column="personId" 
            not-null="true"/&gt;
        &lt;one-to-many class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</pre>
<pre class="programlisting">
create table Person ( personId bigint not null primary key )
create table Address ( addressId bigint not null primary key, personId bigint not null )
        </pre>
<p>
            我们认为对于这种关联关系最好使用连接表。
        </p>
</div>
</div></body>
</html>
