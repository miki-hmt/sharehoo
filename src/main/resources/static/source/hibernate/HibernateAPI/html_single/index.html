<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;</TITLE>
<META content="text/html; charset=ISO-8859-1" http-equiv=Content-Type><LINK 
rel=stylesheet type=text/css href="../shared/css/html.css">
<META name=GENERATOR content="MSHTML 11.00.9431.193"></HEAD>
<BODY aLink=#0000ff link=#0000ff bgColor=white text=black vLink=#840084>
<DIV lang=zh-cn class=book>
<DIV class=titlepage>
<DIV>
<DIV>
<H1 class=title><A name=d0e1></A>HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;</H1>
<P class=title>&#23398;&#20064;<FONT color=#ff0000>QQ&#32676;&#65306;</FONT><FONT color=#ff0000 
size=5>476133513&nbsp;&nbsp; &#21487;&#20197;&#21152;&#32676;&#19968;&#36215;&#35752;&#35770;&#23398;&#20064;</FONT></P></DIV>
<DIV>
<H2 class=subtitle>Hibernate&#21442;&#32771;&#25991;&#26723;</H2></DIV>
<DIV>
<P class=releaseinfo>3.1.2</P></DIV></DIV>
<DIV></DIV>
<HR>
</DIV>
<DIV class=toc>
<P><B>&#30446;&#24405;</B></P>
<DL>
  <DT><SPAN class=preface><A href="#preface">&#21069;&#35328;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#preface-translate-comments-zh-cn">1. 
    &#32763;&#35793;&#35828;&#26126;</A></SPAN>
    <DT><SPAN class=sect1><A href="#preface-translate-licence-zh-cn">2. 
    &#29256;&#26435;&#22768;&#26126;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#tutorial">1. Hibernate&#20837;&#38376; </A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#tutorial-intro">1.1. &#21069;&#35328; </A></SPAN>
    <DT><SPAN class=sect1><A href="#tutorial-firstapp">1.2. &#31532;&#19968;&#37096;&#20998; &#65293; 
    &#31532;&#19968;&#20010;Hibernate&#24212;&#29992;&#31243;&#24207; </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#tutorial-firstapp-firstclass">1.2.1. 
      &#31532;&#19968;&#20010;class </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-firstapp-mapping">1.2.2. &#26144;&#23556;&#25991;&#20214; 
      </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-firstapp-configuration">1.2.3. 
      Hibernate&#37197;&#32622; </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-firstapp-ant">1.2.4. &#29992;Ant&#26500;&#24314; 
      </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-firstapp-helpers">1.2.5. &#21551;&#21160;&#21644;&#36741;&#21161;&#31867; 
      </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#tutorial-firstapp-workingpersistence">1.2.6. &#21152;&#36733;&#24182;&#23384;&#20648;&#23545;&#35937; 
      </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#tutorial-associations">1.3. &#31532;&#20108;&#37096;&#20998; &#65293; &#20851;&#32852;&#26144;&#23556; 
    </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#tutorial-associations-mappinguser">1.3.1. 
      &#26144;&#23556;Person&#31867; </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-associations-unidirset">1.3.2. 
      &#21333;&#21521;Set-based&#30340;&#20851;&#32852; </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-associations-working">1.3.3. 
      &#20351;&#20851;&#32852;&#24037;&#20316; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#tutorial-associations-valuecollections">1.3.4. &#20540;&#31867;&#22411;&#30340;&#38598;&#21512; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#tutorial-associations-bidirectional">1.3.5. &#21452;&#21521;&#20851;&#32852; </A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-associations-usingbidir">1.3.6. 
      &#20351;&#21452;&#21521;&#36830;&#36215;&#26469; </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#tutorial-webapp">1.4. &#31532;&#19977;&#37096;&#20998; - EventManager 
    web&#24212;&#29992;&#31243;&#24207;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#tutorial-webapp-servlet">1.4.1. 
      &#32534;&#20889;&#22522;&#26412;&#30340;servlet</A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-webapp-processing">1.4.2. 
      &#22788;&#29702;&#19982;&#28210;&#26579;</A></SPAN>
      <DT><SPAN class=sect2><A href="#tutorial-webapp-deploy">1.4.3. 
      &#37096;&#32626;&#19982;&#27979;&#35797;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#tutorial-summary">1.5. &#24635;&#32467; 
</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#architecture">2. 
  &#20307;&#31995;&#32467;&#26500;(Architecture)</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#architecture-overview">2.1. 
    &#27010;&#20917;(Overview)</A></SPAN>
    <DT><SPAN class=sect1><A href="#architecture-states">2.2. &#23454;&#20363;&#29366;&#24577;</A></SPAN>
    <DT><SPAN class=sect1><A href="#architecture-jmx">2.3. JMX&#25972;&#21512;</A></SPAN>
    <DT><SPAN class=sect1><A href="#architecture-jca">2.4. &#23545;JCA&#30340;&#25903;&#25345;</A></SPAN>
    <DT><SPAN class=sect1><A href="#architecture-current-session">2.5. 
    &#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#session-configuration">3. &#37197;&#32622; </A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#configuration-programmatic">3.1. &#21487;&#32534;&#31243;&#30340;&#37197;&#32622;&#26041;&#24335; 
    </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-sessionfactory">3.2. 
    &#33719;&#24471;SessionFactory </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-hibernatejdbc">3.3. JDBC&#36830;&#25509; 
    </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-optional">3.4. &#21487;&#36873;&#30340;&#37197;&#32622;&#23646;&#24615; 
    </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#configuration-optional-dialects">3.4.1. 
      SQL&#26041;&#35328; </A></SPAN>
      <DT><SPAN class=sect2><A href="#configuration-optional-outerjoin">3.4.2. 
      &#22806;&#36830;&#25509;&#25235;&#21462;(Outer Join Fetching) </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#configuration-optional-binarystreams">3.4.3. &#20108;&#36827;&#21046;&#27969; (Binary Streams) 
      </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#configuration-optional-cacheprovider">3.4.4. &#20108;&#32423;&#32531;&#23384;&#19982;&#26597;&#35810;&#32531;&#23384; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#configuration-optional-querysubstitution">3.4.5. &#26597;&#35810;&#35821;&#35328;&#20013;&#30340;&#26367;&#25442; 
      </A></SPAN>
      <DT><SPAN class=sect2><A href="#configuration-optional-statistics">3.4.6. 
      Hibernate&#30340;&#32479;&#35745;(statistics)&#26426;&#21046; </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#configuration-logging">3.5. &#26085;&#24535; </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-namingstrategy">3.6. 
    &#23454;&#29616;NamingStrategy </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-xmlconfig">3.7. XML&#37197;&#32622;&#25991;&#20214; 
    </A></SPAN>
    <DT><SPAN class=sect1><A href="#configuration-j2ee">3.8. J2EE&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#30340;&#38598;&#25104; 
    </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A 
      href="#configuration-optional-transactionstrategy">3.8.1. &#20107;&#21153;&#31574;&#30053;&#37197;&#32622; 
      </A></SPAN>
      <DT><SPAN class=sect2><A href="#configuration-optional-jndi">3.8.2. 
      JNDI&#32465;&#23450;&#30340;SessionFactory </A></SPAN>
      <DT><SPAN class=sect2><A href="#configuration-j2ee-currentsession">3.8.3. 
      &#22312;JTA&#29615;&#22659;&#19979;&#20351;&#29992;Current Session context (&#24403;&#21069;session&#19978;&#19979;&#25991;)&#31649;&#29702;</A></SPAN>
      <DT><SPAN class=sect2><A href="#configuration-j2ee-jmx">3.8.4. JMX&#37096;&#32626; 
      </A></SPAN></DT></DL></DD></DL>
  <DT><SPAN class=chapter><A href="#persistent-classes">4. &#25345;&#20037;&#21270;&#31867;(Persistent 
  Classes)</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#persistent-classes-pojo">4.1. 
    &#19968;&#20010;&#31616;&#21333;&#30340;POJO&#20363;&#23376;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A 
      href="#persistent-classes-pojo-constructor">4.1.1. 
      &#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#65288;&#21363;&#26080;&#21442;&#25968;&#30340;&#65289;&#26500;&#36896;&#26041;&#27861;&#65288;constructor&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#persistent-classes-pojo-identifier">4.1.2. 
      &#25552;&#20379;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;identifier property&#65289;&#65288;&#21487;&#36873;&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#persistent-classes-pojo-final">4.1.3. 
      &#20351;&#29992;&#38750;final&#30340;&#31867; (&#21487;&#36873;)</A></SPAN>
      <DT><SPAN class=sect2><A href="#persistent-classes-pojo-accessors">4.1.4. 
      &#20026;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#35775;&#38382;&#22120;(accessors)&#21644;&#26159;&#21542;&#21487;&#21464;&#30340;&#26631;&#24535;(mutators)(&#21487;&#36873;)</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#persistent-classes-inheritance">4.2. 
    &#23454;&#29616;&#32487;&#25215;&#65288;Inheritance&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#persistent-classes-equalshashcode">4.3. 
    &#23454;&#29616;equals()&#21644;hashCode()</A></SPAN>
    <DT><SPAN class=sect1><A href="#persistent-classes-dynamicmodels">4.4. 
    &#21160;&#24577;&#27169;&#22411;(Dynamic models)</A></SPAN>
    <DT><SPAN class=sect1><A href="#persistent-classes-tuplizers">4.5. 
    &#20803;&#32452;&#29255;&#26029;&#26144;&#23556;(Tuplizers)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#mapping">5. &#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R 
  Mapping)</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#mapping-declaration">5.1. &#26144;&#23556;&#23450;&#20041;&#65288;Mapping 
    declaration&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#mapping-declaration-doctype">5.1.1. 
      Doctype</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-mapping">5.1.2. 
      hibernate-mapping</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-class">5.1.3. 
      class</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-id">5.1.4. 
      id</A></SPAN>
      <DD>
      <DL>
        <DT><SPAN class=sect3><A 
        href="#mapping-declaration-id-generator">5.1.4.1. Generator</A></SPAN>
        <DT><SPAN class=sect3><A href="#mapping-declaration-id-hilo">5.1.4.2. 
        &#39640;/&#20302;&#20301;&#31639;&#27861;&#65288;Hi/Lo Algorithm&#65289;</A></SPAN>
        <DT><SPAN class=sect3><A href="#mapping-declaration-id-uuid">5.1.4.3. 
        UUID&#31639;&#27861;&#65288;UUID Algorithm &#65289;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#mapping-declaration-id-sequences">5.1.4.4. &#26631;&#35782;&#23383;&#27573;&#21644;&#24207;&#21015;&#65288;Identity 
        columns and Sequences&#65289;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#mapping-declaration-id-assigned">5.1.4.5. &#31243;&#24207;&#20998;&#37197;&#30340;&#26631;&#35782;&#31526;&#65288;Assigned 
        Identifiers&#65289;</A></SPAN>
        <DT><SPAN class=sect3><A href="#mapping-declaration-id-select">5.1.4.6. 
        &#35302;&#21457;&#22120;&#23454;&#29616;&#30340;&#20027;&#38190;&#29983;&#25104;&#22120;&#65288;Primary keys assigned by triggers&#65289;</A></SPAN></DT></DL>
      <DT><SPAN class=sect2><A href="#mapping-declaration-compositeid">5.1.5. 
      composite-id</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-discriminator">5.1.6. 
      &#37492;&#21035;&#22120;&#65288;discriminator&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-version">5.1.7. 
      &#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-timestamp">5.1.8. 
      timestamp (&#21487;&#36873;)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-property">5.1.9. 
      property</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-manytoone">5.1.10. 
      &#22810;&#23545;&#19968;&#65288;many-to-one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-onetoone">5.1.11. 
      &#19968;&#23545;&#19968;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-naturalid">5.1.12. 
      &#33258;&#28982;ID(natural-id)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-component">5.1.13. 
      &#32452;&#20214;(component), &#21160;&#24577;&#32452;&#20214;(dynamic-component)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-properties">5.1.14. 
      properties</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-subclass">5.1.15. 
      &#23376;&#31867;(subclass)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#mapping-declaration-joinedsubclass">5.1.16. 
      &#36830;&#25509;&#30340;&#23376;&#31867;(joined-subclass)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-unionsubclass">5.1.17. 
      &#32852;&#21512;&#23376;&#31867;(union-subclass)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-join">5.1.18. 
      &#36830;&#25509;(join)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-key">5.1.19. 
      &#38190;(key)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-column">5.1.20. &#23383;&#27573;&#21644;&#35268;&#21017;&#20803;&#32032;&#65288;column and 
      formula elements&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-declaration-import">5.1.21. 
      &#24341;&#29992;(import)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-types-anymapping">5.1.22. 
      any</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#mapping-types">5.2. Hibernate &#30340;&#31867;&#22411;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#mapping-types-entitiesvalues">5.2.1. 
      &#23454;&#20307;(Entities)&#21644;&#20540;(values)</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-types-basictypes">5.2.2. 
      &#22522;&#26412;&#20540;&#31867;&#22411;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-types-custom">5.2.3. 
      &#33258;&#23450;&#20041;&#20540;&#31867;&#22411;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#mapping-entityname">5.3. &#22810;&#27425;&#26144;&#23556;&#21516;&#19968;&#20010;&#31867;</A></SPAN>
    <DT><SPAN class=sect1><A href="#mapping-quotedidentifiers">5.4. 
    SQL&#20013;&#24341;&#21495;&#21253;&#22260;&#30340;&#26631;&#35782;&#31526;</A></SPAN>
    <DT><SPAN class=sect1><A href="#mapping-alternatives">5.5. 
    &#20854;&#20182;&#20803;&#25968;&#25454;(Metadata)</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#mapping-xdoclet">5.5.1. &#20351;&#29992; XDoclet 
      &#26631;&#35760;</A></SPAN>
      <DT><SPAN class=sect2><A href="#mapping-annotations">5.5.2. &#20351;&#29992; JDK 5.0 
      &#30340;&#27880;&#35299;(Annotation)</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#mapping-generated">5.6. &#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated 
    Properties&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#mapping-database-object">5.7. 
    &#36741;&#21161;&#25968;&#25454;&#24211;&#23545;&#35937;(Auxiliary Database Objects)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#collections">6. 
&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#collections-persistent">6.1. 
    &#25345;&#20037;&#21270;&#38598;&#21512;&#31867;(Persistent collections)</A></SPAN>
    <DT><SPAN class=sect1><A href="#collections-mapping">6.2. &#38598;&#21512;&#26144;&#23556;&#65288; Collection 
    mappings &#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#collections-foreignkeys">6.2.1. 
      &#38598;&#21512;&#22806;&#38190;(Collection foreign keys)</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-elements">6.2.2. 
      &#38598;&#21512;&#20803;&#32032;&#65288;Collection elements&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-indexed">6.2.3. &#32034;&#24341;&#38598;&#21512;&#31867;(Indexed 
      collections)</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-ofvalues">6.2.4. 
      &#20540;&#38598;&#21512;&#20110;&#22810;&#23545;&#22810;&#20851;&#32852;(Collections of values and many-to-many associations)</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-onetomany">6.2.5. 
      &#19968;&#23545;&#22810;&#20851;&#32852;&#65288;One-to-many Associations&#65289;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#collections-advancedmappings">6.3. 
    &#39640;&#32423;&#38598;&#21512;&#26144;&#23556;&#65288;Advanced collection mappings&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#collections-sorted">6.3.1. &#26377;&#24207;&#38598;&#21512;&#65288;Sorted 
      collections&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-bidirectional">6.3.2. 
      &#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional associations&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-indexedbidirectional">6.3.3. 
      &#21452;&#21521;&#20851;&#32852;&#65292;&#28041;&#21450;&#26377;&#24207;&#38598;&#21512;&#31867;</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-ternary">6.3.4. &#19977;&#37325;&#20851;&#32852;&#65288;Ternary 
      associations&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#collections-idbag">6.3.5. 
      &#20351;&#29992;&lt;idbag&gt;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#collections-example">6.4. &#38598;&#21512;&#20363;&#23376;&#65288;Collection 
    example&#65289;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#associations">7. &#20851;&#32852;&#20851;&#31995;&#26144;&#23556;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#assoc-intro">7.1. &#20171;&#32461;</A></SPAN>
    <DT><SPAN class=sect1><A href="#assoc-unidirectional">7.2. 
    &#21333;&#21521;&#20851;&#32852;&#65288;Unidirectional associations&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-m21">7.2.1. &#22810;&#23545;&#19968;(many 
      to one)</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-121">7.2.2. &#19968;&#23545;&#19968;&#65288;one 
      to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-12m">7.2.3. &#19968;&#23545;&#22810;&#65288;one 
      to many&#65289;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#assoc-unidirectional-join">7.3. 
    &#20351;&#29992;&#36830;&#25509;&#34920;&#30340;&#21333;&#21521;&#20851;&#32852;&#65288;Unidirectional associations with join tables&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-join-12m">7.3.1. 
      &#19968;&#23545;&#22810;(one to many)</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-join-m21">7.3.2. 
      &#22810;&#23545;&#19968;&#65288;many to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-join-121">7.3.3. 
      &#19968;&#23545;&#19968;&#65288;one to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-unidirectional-join-m2m">7.3.4. 
      &#22810;&#23545;&#22810;&#65288;many to many&#65289;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#assoc-bidirectional">7.4. &#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional 
    associations&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#assoc-bidirectional-m21">7.4.1. &#19968;&#23545;&#22810;&#65288;one to 
      many) / &#22810;&#23545;&#19968;&#65288;many to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-bidirectional-121">7.4.2. &#19968;&#23545;&#19968;&#65288;one to 
      one&#65289;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#assoc-bidirectional-join">7.5. 
    &#20351;&#29992;&#36830;&#25509;&#34920;&#30340;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional associations with join tables&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#assoc-bidirectional-join-12m">7.5.1. 
      &#19968;&#23545;&#22810;&#65288;one to many&#65289; /&#22810;&#23545;&#19968;&#65288; many to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-bidirectional-join-121">7.5.2. 
      &#19968;&#23545;&#19968;&#65288;one to one&#65289;</A></SPAN>
      <DT><SPAN class=sect2><A href="#assoc-bidirectional-join-m2m">7.5.3. 
      &#22810;&#23545;&#22810;&#65288;many to many&#65289;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#assoc-complex">7.6. 
  &#26356;&#22797;&#26434;&#30340;&#20851;&#32852;&#26144;&#23556;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#components">8. &#32452;&#20214;&#65288;Component&#65289;&#26144;&#23556;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#components-dependentobjects">8.1. 
    &#20381;&#36182;&#23545;&#35937;&#65288;Dependent objects&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#components-incollections">8.2. &#22312;&#38598;&#21512;&#20013;&#20986;&#29616;&#30340;&#20381;&#36182;&#23545;&#35937; 
    (Collections of dependent objects)</A></SPAN>
    <DT><SPAN class=sect1><A href="#components-asmapindex">8.3. 
    &#32452;&#20214;&#20316;&#20026;Map&#30340;&#32034;&#24341;&#65288;Components as Map indices &#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#components-compositeid">8.4. 
    &#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)</A></SPAN>
    <DT><SPAN class=sect1><A href="#components-dynamic">8.5. &#21160;&#24577;&#32452;&#20214; &#65288;Dynamic 
    components&#65289;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#inheritance">9. &#32487;&#25215;&#26144;&#23556;(Inheritance 
  Mappings)</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#inheritance-strategies">9.1. &#19977;&#31181;&#31574;&#30053;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#inheritance-tableperclass">9.1.1. 
      &#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;(Table per class hierarchy)</A></SPAN>
      <DT><SPAN class=sect2><A href="#inheritance-tablepersubclass">9.1.2. 
      &#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;(Table per subclass)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#inheritance-tablepersubclass-discriminator">9.1.3. &#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;(Table 
      per subclass)&#65292;&#20351;&#29992;&#36776;&#21035;&#26631;&#24535;(Discriminator)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#inheritance-mixing-tableperclass-tablepersubclass">9.1.4. 
      &#28151;&#21512;&#20351;&#29992;“&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;”&#21644;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”</A></SPAN>
      <DT><SPAN class=sect2><A href="#inheritance-tableperconcrete">9.1.5. 
      &#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;(Table per concrete class)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#inheritance-tableperconcreate-polymorphism">9.1.6. Table per 
      concrete class, using implicit polymorphism</A></SPAN>
      <DT><SPAN class=sect2><A href="#inheritace-mixingpolymorphism">9.1.7. 
      &#38544;&#24335;&#22810;&#24577;&#21644;&#20854;&#20182;&#32487;&#25215;&#26144;&#23556;&#28151;&#21512;&#20351;&#29992;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#inheritance-limitations">9.2. 
    &#38480;&#21046;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#objectstate">10. &#19982;&#23545;&#35937;&#20849;&#20107;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#objectstate-overview">10.1. 
    Hibernate&#23545;&#35937;&#29366;&#24577;(object states)</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-makingpersistent">10.2. 
    &#20351;&#23545;&#35937;&#25345;&#20037;&#21270;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-loading">10.3. &#35013;&#36733;&#23545;&#35937;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-querying">10.4. &#26597;&#35810;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#objectstate-querying-executing">10.4.1. 
      &#25191;&#34892;&#26597;&#35810;</A></SPAN>
      <DD>
      <DL>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-iterate">10.4.1.1. 
        &#36845;&#20195;&#24335;&#33719;&#21462;&#32467;&#26524;(Iterating results)</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-tuples">10.4.1.2. 
        &#36820;&#22238;&#20803;&#32452;(tuples)&#30340;&#26597;&#35810;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-scalar">10.4.1.3. 
        &#26631;&#37327;(Scalar)&#32467;&#26524;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-parameters">10.4.1.4. 
        &#32465;&#23450;&#21442;&#25968;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-pagination">10.4.1.5. 
&#20998;&#39029;</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-scrolling">10.4.1.6. 
        &#21487;&#28378;&#21160;&#36941;&#21382;(Scrollable iteration)</A></SPAN>
        <DT><SPAN class=sect3><A 
        href="#objectstate-querying-executing-named">10.4.1.7. 
        &#22806;&#32622;&#21629;&#21517;&#26597;&#35810;(Externalizing named queries)</A></SPAN></DT></DL>
      <DT><SPAN class=sect2><A href="#objectstate-filtering">10.4.2. 
      &#36807;&#28388;&#38598;&#21512;</A></SPAN>
      <DT><SPAN class=sect2><A href="#objecstate-querying-criteria">10.4.3. 
      &#26465;&#20214;&#26597;&#35810;(Criteria queries)</A></SPAN>
      <DT><SPAN class=sect2><A href="#objectstate-querying-nativesql">10.4.4. 
      &#20351;&#29992;&#21407;&#29983;SQL&#30340;&#26597;&#35810;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#objectstate-modifying">10.5. 
    &#20462;&#25913;&#25345;&#20037;&#23545;&#35937;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-detached">10.6. 
    &#20462;&#25913;&#33073;&#31649;(Detached)&#23545;&#35937;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-saveorupdate">10.7. 
    &#33258;&#21160;&#29366;&#24577;&#26816;&#27979;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-deleting">10.8. 
&#21024;&#38500;&#25345;&#20037;&#23545;&#35937;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-replicating">10.9. 
    &#22312;&#20004;&#20010;&#19981;&#21516;&#25968;&#25454;&#24211;&#38388;&#22797;&#21046;&#23545;&#35937;</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-flushing">10.10. 
    Session&#21047;&#20986;(flush)</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-transitive">10.11. 
    &#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-metadata">10.12. 
    &#20351;&#29992;&#20803;&#25968;&#25454;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#transactions">11. &#20107;&#21153;&#21644;&#24182;&#21457;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#transactions-basics">11.1. 
    Session&#21644;&#20107;&#21153;&#33539;&#22260;(transaction scope)</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#transactions-basics-uow">11.1.1. &#25805;&#20316;&#21333;&#20803;(Unit 
      of work)</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-basics-apptx">11.1.2. 
      &#38271;&#23545;&#35805;</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-basics-identity">11.1.3. 
      &#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering object identity)</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-basics-issues">11.1.4. 
      &#24120;&#35265;&#38382;&#39064;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#transactions-demarcation">11.2. 
    &#25968;&#25454;&#24211;&#20107;&#21153;&#22768;&#26126;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A 
      href="#transactions-demarcation-nonmanaged">11.2.1. &#38750;&#25176;&#31649;&#29615;&#22659;</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-demarcation-jta">11.2.2. 
      &#20351;&#29992;JTA</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#transactions-demarcation-exceptions">11.2.3. &#24322;&#24120;&#22788;&#29702;</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-demarcation-timeout">11.2.4. 
      &#20107;&#21153;&#36229;&#26102;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#transactions-optimistic">11.3. 
    &#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic concurrency control)</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#transactions-optimistic-manual">11.3.1. 
      &#24212;&#29992;&#31243;&#24207;&#32423;&#21035;&#30340;&#29256;&#26412;&#26816;&#26597;(Application version checking)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#transactions-optimistic-longsession">11.3.2. 
      &#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;</A></SPAN>
      <DT><SPAN class=sect2><A href="#transactions-optimistic-detached">11.3.3. 
      &#33073;&#31649;&#23545;&#35937;(deatched object)&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#transactions-optimistic-customizing">11.3.4. 
      &#23450;&#21046;&#33258;&#21160;&#29256;&#26412;&#21270;&#34892;&#20026;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#transactions-locking">11.4. &#24754;&#35266;&#38145;&#23450;(Pessimistic 
    Locking)</A></SPAN>
    <DT><SPAN class=sect1><A href="#transactions-connection-release">11.5. 
    &#36830;&#25509;&#37322;&#25918;&#27169;&#24335;(Connection Release Modes)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#events">12. &#25318;&#25130;&#22120;&#19982;&#20107;&#20214;(Interceptors and events) 
  </A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#objectstate-interceptors">12.1. 
    &#25318;&#25130;&#22120;(Interceptors) </A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-events">12.2. &#20107;&#20214;&#31995;&#32479;(Event system) 
    </A></SPAN>
    <DT><SPAN class=sect1><A href="#objectstate-decl-security">12.3. 
    Hibernate&#30340;&#22768;&#26126;&#24335;&#23433;&#20840;&#26426;&#21046; </A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#batch">13. &#25209;&#37327;&#22788;&#29702;&#65288;Batch processing&#65289;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#batch-inserts">13.1. &#25209;&#37327;&#25554;&#20837;&#65288;Batch 
    inserts&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#batch-update">13.2. &#25209;&#37327;&#26356;&#26032;&#65288;Batch 
    updates&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#batch-statelesssession">13.3. 
    StatelessSession (&#26080;&#29366;&#24577;session)&#25509;&#21475;</A></SPAN>
    <DT><SPAN class=sect1><A href="#batch-direct">13.4. 
    DML(&#25968;&#25454;&#25805;&#20316;&#35821;&#35328;)&#39118;&#26684;&#30340;&#25805;&#20316;(DML-style operations)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#queryhql">14. HQL: Hibernate&#26597;&#35810;&#35821;&#35328;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#queryhql-casesensitivity">14.1. 
    &#22823;&#23567;&#20889;&#25935;&#24863;&#24615;&#38382;&#39064;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-from">14.2. from&#23376;&#21477;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-joins">14.3. 
    &#20851;&#32852;(Association)&#19982;&#36830;&#25509;(Join)</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-joins-forms">14.4. join 
    &#35821;&#27861;&#30340;&#24418;&#24335;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-select">14.5. select&#23376;&#21477;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-aggregation">14.6. &#32858;&#38598;&#20989;&#25968;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-polymorphism">14.7. &#22810;&#24577;&#26597;&#35810;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-where">14.8. where&#23376;&#21477;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-expressions">14.9. &#34920;&#36798;&#24335;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-ordering">14.10. order 
    by&#23376;&#21477;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-grouping">14.11. group 
    by&#23376;&#21477;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-subqueries">14.12. &#23376;&#26597;&#35810;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-examples">14.13. HQL&#31034;&#20363;</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-bulk">14.14. 
    &#25209;&#37327;&#30340;UPDATE&#21644;DELETE</A></SPAN>
    <DT><SPAN class=sect1><A href="#queryhql-tipstricks">14.15. &#23567;&#25216;&#24039; &amp; 
    &#23567;&#31373;&#38376;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#querycriteria">15. &#26465;&#20214;&#26597;&#35810;(Criteria Queries) 
  </A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#querycriteria-creating">15.1. &#21019;&#24314;&#19968;&#20010;Criteria 
    &#23454;&#20363;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-narrowing">15.2. 
    &#38480;&#21046;&#32467;&#26524;&#38598;&#20869;&#23481;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-ordering">15.3. 
    &#32467;&#26524;&#38598;&#25490;&#24207;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-associations">15.4. 
    &#20851;&#32852;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-dynamicfetching">15.5. 
    &#21160;&#24577;&#20851;&#32852;&#25235;&#21462;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-examples">15.6. 
&#26597;&#35810;&#31034;&#20363;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-projection">15.7. 
    &#25237;&#24433;(Projections)&#12289;&#32858;&#21512;&#65288;aggregation&#65289;&#21644;&#20998;&#32452;&#65288;grouping&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querycriteria-detachedqueries">15.8. 
    &#31163;&#32447;(detached)&#26597;&#35810;&#21644;&#23376;&#26597;&#35810;</A></SPAN>
    <DT><SPAN class=sect1><A href="#query-criteria-naturalid">15.9. 
    &#26681;&#25454;&#33258;&#28982;&#26631;&#35782;&#26597;&#35810;(Queries by natural identifier)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#querysql">16. Native SQL&#26597;&#35810;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#querysql-creating">16.1. 
    &#20351;&#29992;SQLQuery</A></SPAN>
    <DT><SPAN class=sect1><A href="#querysql-aliasreferences">16.2. 
    &#21035;&#21517;&#21644;&#23646;&#24615;&#24341;&#29992;</A></SPAN>
    <DT><SPAN class=sect1><A href="#querysql-namedqueries">16.3. 
    &#21629;&#21517;SQL&#26597;&#35810;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#propertyresults">16.3.1. 
      &#20351;&#29992;return-property&#26469;&#26126;&#30830;&#22320;&#25351;&#23450;&#23383;&#27573;/&#21035;&#21517;</A></SPAN>
      <DT><SPAN class=sect2><A href="#sp_query">16.3.2. &#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#26469;&#26597;&#35810;</A></SPAN>
      <DD>
      <DL>
        <DT><SPAN class=sect3><A 
        href="#querysql-limits-storedprocedures">16.3.2.1. 
        &#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#30340;&#35268;&#21017;&#21644;&#38480;&#21046;</A></SPAN></DT></DL></DD></DL>
    <DT><SPAN class=sect1><A href="#querysql-cud">16.4. 
    &#23450;&#21046;SQL&#29992;&#26469;create&#65292;update&#21644;delete</A></SPAN>
    <DT><SPAN class=sect1><A href="#querysql-load">16.5. 
  &#23450;&#21046;&#35013;&#36733;SQL</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#filters">17. &#36807;&#28388;&#25968;&#25454;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#objectstate-filters">17.1. Hibernate 
    &#36807;&#28388;&#22120;(filters)</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#xml">18. XML&#26144;&#23556;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#xml-intro">18.1. &#29992;XML&#25968;&#25454;&#36827;&#34892;&#24037;&#20316;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#xml-intro-mapping">18.1.1. 
      &#25351;&#23450;&#21516;&#26102;&#26144;&#23556;XML&#21644;&#31867;</A></SPAN>
      <DT><SPAN class=sect2><A href="#xml-onlyxml">18.1.2. 
      &#21482;&#23450;&#20041;XML&#26144;&#23556;</A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#xml-mapping">18.2. XML&#26144;&#23556;&#20803;&#25968;&#25454;</A></SPAN>
    <DT><SPAN class=sect1><A href="#xml-manipulation">18.3. 
    &#25805;&#20316;XML&#25968;&#25454;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#performance">19. &#25552;&#21319;&#24615;&#33021; </A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#performance-fetching">19.1. &#25235;&#21462;&#31574;&#30053;(Fetching 
    strategies) </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#performance-fetching-lazy">19.1.1. 
      &#25805;&#20316;&#24310;&#36831;&#21152;&#36733;&#30340;&#20851;&#32852;</A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-fetching-custom">19.1.2. 
      &#35843;&#25972;&#25235;&#21462;&#31574;&#30053;&#65288;Tuning fetch strategies&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-fetching-proxies">19.1.3. 
      &#21333;&#31471;&#20851;&#32852;&#20195;&#29702;&#65288;Single-ended association proxies&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#performance-fetching-initialization">19.1.4. &#23454;&#20363;&#21270;&#38598;&#21512;&#21644;&#20195;&#29702;&#65288;Initializing 
      collections and proxies&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-fetching-batch">19.1.5. 
      &#20351;&#29992;&#25209;&#37327;&#25235;&#21462;&#65288;Using batch fetching&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-fetching-subselect">19.1.6. 
      &#20351;&#29992;&#23376;&#26597;&#35810;&#25235;&#21462;&#65288;Using subselect fetching&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#performance-fetching-lazyproperties">19.1.7. &#20351;&#29992;&#24310;&#36831;&#23646;&#24615;&#25235;&#21462;&#65288;Using lazy 
      property fetching&#65289; </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#performance-cache">19.2. &#20108;&#32423;&#32531;&#23384;&#65288;The Second 
    Level Cache&#65289; </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#performance-cache-mapping">19.2.1. 
      &#32531;&#23384;&#26144;&#23556;&#65288;Cache mappings&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-cache-readonly">19.2.2. 
      &#31574;&#30053;&#65306;&#21482;&#35835;&#32531;&#23384;&#65288;Strategy: read only&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-cache-readwrite">19.2.3. 
      &#31574;&#30053;:&#35835;/&#20889;&#32531;&#23384;&#65288;Strategy: read/write&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-cache-nonstrict">19.2.4. 
      &#31574;&#30053;:&#38750;&#20005;&#26684;&#35835;/&#20889;&#32531;&#23384;&#65288;Strategy: nonstrict read/write&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-cache-transactional">19.2.5. 
      &#31574;&#30053;:&#20107;&#21153;&#32531;&#23384;&#65288;transactional&#65289; </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#performance-sessioncache">19.3. 
    &#31649;&#29702;&#32531;&#23384;&#65288;Managing the caches&#65289; </A></SPAN>
    <DT><SPAN class=sect1><A href="#performance-querycache">19.4. &#26597;&#35810;&#32531;&#23384;&#65288;The Query 
    Cache&#65289; </A></SPAN>
    <DT><SPAN class=sect1><A href="#performance-collections">19.5. 
    &#29702;&#35299;&#38598;&#21512;&#24615;&#33021;&#65288;Understanding Collection performance&#65289; </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#performance-collections-taxonomy">19.5.1. 
      &#20998;&#31867;&#65288;Taxonomy&#65289; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#performance-collections-mostefficientupdate">19.5.2. Lists, maps 
      &#21644;sets&#29992;&#20110;&#26356;&#26032;&#25928;&#29575;&#26368;&#39640; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#performance-collections-mostefficentinverse">19.5.3. 
      Bag&#21644;list&#26159;&#21453;&#21521;&#38598;&#21512;&#31867;&#20013;&#25928;&#29575;&#26368;&#39640;&#30340; </A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#performance-collections-oneshotdelete">19.5.4. &#19968;&#27425;&#24615;&#21024;&#38500;&#65288;One shot 
      delete&#65289; </A></SPAN></DT></DL>
    <DT><SPAN class=sect1><A href="#performance-monitoring">19.6. 
    &#30417;&#27979;&#24615;&#33021;&#65288;Monitoring performance&#65289; </A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#performance-monitoring-sf">19.6.1. 
      &#30417;&#27979;SessionFactory </A></SPAN>
      <DT><SPAN class=sect2><A href="#performance-monitoring-metrics">19.6.2. 
      &#25968;&#25454;&#35760;&#24405;&#65288;Metrics&#65289; </A></SPAN></DT></DL></DD></DL>
  <DT><SPAN class=chapter><A href="#toolsetguide">20. &#24037;&#20855;&#31665;&#25351;&#21335;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#toolsetguide-s1">20.1. Schema&#33258;&#21160;&#29983;&#25104;&#65288;Automatic 
    schema generation&#65289;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-2">20.1.1. 
      &#23545;schema&#23450;&#21046;&#21270;(Customizing the schema)</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-3">20.1.2. 
&#36816;&#34892;&#35813;&#24037;&#20855;</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-4">20.1.3. 
      &#23646;&#24615;(Properties)</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-5">20.1.4. &#20351;&#29992;Ant(Using 
      Ant)</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-6">20.1.5. 
      &#23545;schema&#30340;&#22686;&#37327;&#26356;&#26032;(Incremental schema updates)</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-7">20.1.6. 
      &#29992;Ant&#26469;&#22686;&#37327;&#26356;&#26032;schema(Using Ant for incremental schema updates)</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-8">20.1.7. Schema 
      &#26657;&#39564;</A></SPAN>
      <DT><SPAN class=sect2><A href="#toolsetguide-s1-9">20.1.8. 
      &#20351;&#29992;Ant&#36827;&#34892;schema&#26657;&#39564;</A></SPAN></DT></DL></DD></DL>
  <DT><SPAN class=chapter><A href="#example-parentchild">21. &#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent 
  Child Relationships)</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#example-parentchild-collections">21.1. 
    &#20851;&#20110;collections&#38656;&#35201;&#27880;&#24847;&#30340;&#19968;&#28857;</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-parentchild-bidir">21.2. 
    &#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#31995;(Bidirectional one-to-many)</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-parentchild-cascades">21.3. 
    &#32423;&#32852;&#29983;&#21629;&#21608;&#26399;&#65288;Cascading lifecycle&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-parentchild-update">21.4. 
    &#32423;&#32852;&#19982;&#26410;&#20445;&#23384;&#20540;&#65288;Cascades and unsaved-value&#65289;</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-parentchild-conclusion">21.5. 
    &#32467;&#35770;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#example-weblog">22. &#31034;&#20363;&#65306;Weblog 
&#24212;&#29992;&#31243;&#24207;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#example-weblog-classes">22.1. 
&#25345;&#20037;&#21270;&#31867;</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-weblog-mappings">22.2. Hibernate 
    &#26144;&#23556;</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-weblog-code">22.3. Hibernate 
    &#20195;&#30721;</A></SPAN></DT></DL>
  <DT><SPAN class=chapter><A href="#example-mappings">23. &#31034;&#20363;&#65306;&#22797;&#26434;&#26144;&#23556;&#23454;&#20363;</A></SPAN>
  <DD>
  <DL>
    <DT><SPAN class=sect1><A href="#example-mappings-emp">23.1. 
    Employer&#65288;&#38599;&#20027;)/Employee(&#38599;&#21592;)</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-mappings-authorwork">23.2. 
    Author(&#20316;&#23478;)/Work(&#20316;&#21697;)</A></SPAN>
    <DT><SPAN class=sect1><A href="#example-mappings-customerorderproduct">23.3. 
    Customer(&#23458;&#25143;)/Order(&#35746;&#21333;)/Product(&#20135;&#21697;)</A></SPAN>
    <DT><SPAN class=sect1><A href="#misc">23.4. &#26434;&#20363;</A></SPAN>
    <DD>
    <DL>
      <DT><SPAN class=sect2><A href="#example-mappings-typed-onetone">23.4.1. 
      "Typed" one-to-one association</A></SPAN>
      <DT><SPAN class=sect2><A href="#example-mappings-composite-key">23.4.2. 
      Composite key example</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#example-mappings-composite-key-manytomany">23.4.3. 
      &#20849;&#26377;&#32452;&#21512;&#38190;&#23646;&#24615;&#30340;&#22810;&#23545;&#22810;(Many-to-many with shared composite key attribute)</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#example-mappings-content-discrimination">23.4.4. Content based 
      discrimination</A></SPAN>
      <DT><SPAN class=sect2><A 
      href="#example-mappings-association-alternatekeys">23.4.5. Associations on 
      alternate keys</A></SPAN></DT></DL></DD></DL>
  <DT><SPAN class=chapter><A href="#best-practices">24. &#26368;&#20339;&#23454;&#36341;(Best 
  Practices)</A></SPAN></DT></DL></DIV>
<DIV lang=zh-cn class=preface>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=preface></A>&#21069;&#35328;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>WARNING! This is a translated version of the English Hibernate reference 
documentation. The translated version might not be up to date! However, the 
differences should only be very minor. Consult the English reference 
documentation if you are missing information or encounter a translation error. 
If you like to contribute to a particular translation, contact us on the 
Hibernate developer mailing list. </P>
<P>Translator(s): RedSaga Translate Team &#28385;&#27743;&#32418;&#32763;&#35793;&#22242;&#38431; &lt;caoxg@yahoo.com&gt; </P>
<P>&#22312;&#20170;&#26085;&#30340;&#20225;&#19994;&#29615;&#22659;&#20013;&#65292;&#25226;&#38754;&#21521;&#23545;&#35937;&#30340;&#36719;&#20214;&#21644;&#20851;&#31995;&#25968;&#25454;&#24211;&#19968;&#36215;&#20351;&#29992;&#21487;&#33021;&#26159;&#30456;&#24403;&#40635;&#28902;&#12289;&#28010;&#36153;&#26102;&#38388;&#30340;&#12290;Hibernate&#26159;&#19968;&#20010;&#38754;&#21521;Java&#29615;&#22659;&#30340;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#24037;&#20855;&#12290;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;(object/relational 
mapping (ORM))&#36825;&#20010;&#26415;&#35821;&#34920;&#31034;&#19968;&#31181;&#25216;&#26415;&#65292;&#29992;&#26469;&#25226;&#23545;&#35937;&#27169;&#22411;&#34920;&#31034;&#30340;&#23545;&#35937;&#26144;&#23556;&#21040;&#22522;&#20110;SQL&#30340;&#20851;&#31995;&#27169;&#22411;&#25968;&#25454;&#32467;&#26500;&#20013;&#21435;&#12290; </P>
<P>Hibernate&#19981;&#20165;&#20165;&#31649;&#29702;Java&#31867;&#21040;&#25968;&#25454;&#24211;&#34920;&#30340;&#26144;&#23556;&#65288;&#21253;&#25324;Java&#25968;&#25454;&#31867;&#22411;&#21040;SQL&#25968;&#25454;&#31867;&#22411;&#30340;&#26144;&#23556;&#65289;&#65292;&#36824;&#25552;&#20379;&#25968;&#25454;&#26597;&#35810;&#21644;&#33719;&#21462;&#25968;&#25454;&#30340;&#26041;&#27861;&#65292;&#21487;&#20197;&#22823;&#24133;&#24230;&#20943;&#23569;&#24320;&#21457;&#26102;&#20154;&#24037;&#20351;&#29992;SQL&#21644;JDBC&#22788;&#29702;&#25968;&#25454;&#30340;&#26102;&#38388;&#12290; 
</P>
<P>Hibernate&#30340;&#30446;&#26631;&#26159;&#23545;&#20110;&#24320;&#21457;&#32773;&#36890;&#24120;&#30340;&#25968;&#25454;&#25345;&#20037;&#21270;&#30456;&#20851;&#30340;&#32534;&#31243;&#20219;&#21153;&#65292;&#35299;&#25918;&#20854;&#20013;&#30340;95%&#12290;&#23545;&#20110;&#20197;&#25968;&#25454;&#20026;&#20013;&#24515;&#30340;&#31243;&#24207;&#26469;&#35828;,&#23427;&#20204;&#24448;&#24448;&#21482;&#22312;&#25968;&#25454;&#24211;&#20013;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#26469;&#23454;&#29616;&#21830;&#19994;&#36923;&#36753;,Hibernate&#21487;&#33021;&#19981;&#26159;&#26368;&#22909;&#30340;&#35299;&#20915;&#26041;&#26696;;&#23545;&#20110;&#37027;&#20123;&#22312;&#22522;&#20110;Java&#30340;&#20013;&#38388;&#23618;&#24212;&#29992;&#20013;&#65292;&#23427;&#20204;&#23454;&#29616;&#38754;&#21521;&#23545;&#35937;&#30340;&#19994;&#21153;&#27169;&#22411;&#21644;&#21830;&#19994;&#36923;&#36753;&#30340;&#24212;&#29992;&#65292;Hibernate&#26159;&#26368;&#26377;&#29992;&#30340;&#12290;&#19981;&#31649;&#24590;&#26679;&#65292;Hibernate&#19968;&#23450;&#21487;&#20197;&#24110;&#21161;&#20320;&#28040;&#38500;&#25110;&#32773;&#21253;&#35013;&#37027;&#20123;&#38024;&#23545;&#29305;&#23450;&#21378;&#21830;&#30340;SQL&#20195;&#30721;&#65292;&#24182;&#19988;&#24110;&#20320;&#25226;&#32467;&#26524;&#38598;&#20174;&#34920;&#26684;&#24335;&#30340;&#34920;&#31034;&#24418;&#24335;&#36716;&#25442;&#21040;&#19968;&#31995;&#21015;&#30340;&#23545;&#35937;&#21435;&#12290; 
</P>
<P>&#22914;&#26524;&#20320;&#23545;Hibernate&#21644;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#36824;&#26159;&#20010;&#26032;&#25163;&#65292;&#25110;&#32773;&#29978;&#33267;&#23545;Java&#20063;&#19981;&#29087;&#24713;&#65292;&#35831;&#25353;&#29031;&#19979;&#38754;&#30340;&#27493;&#39588;&#26469;&#23398;&#20064;&#12290; </P>
<DIV class=orderedlist>
<OL type=1>
  <LI>
  <P>&#38405;&#35835;<A title="&#31532;&nbsp;1&nbsp;&#31456;&nbsp;&#10;&#9;&#9;Hibernate&#20837;&#38376;&#10;&#9;" 
  href="#tutorial">&#31532;&nbsp;1&nbsp;&#31456; <I>Hibernate&#20837;&#38376; 
  </I></A>&#65292;&#36825;&#26159;&#19968;&#31687;&#21253;&#21547;&#35814;&#32454;&#30340;&#36880;&#27493;&#25351;&#23548;&#30340;&#25351;&#21335;&#12290;&#26412;&#25351;&#21335;&#30340;&#28304;&#20195;&#30721;&#21253;&#21547;&#22312;&#21457;&#34892;&#21253;&#20013;&#65292;&#20320;&#21487;&#20197;&#22312;<TT 
  class=literal>doc/reference/tutorial/</TT>&#30446;&#24405;&#19979;&#25214;&#21040;&#12290; </P>
  <LI>
  <P>&#38405;&#35835;<A title=&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#20307;&#31995;&#32467;&#26500;(Architecture) 
  href="#architecture">&#31532;&nbsp;2&nbsp;&#31456; 
  <I>&#20307;&#31995;&#32467;&#26500;(Architecture)</I></A>&#26469;&#29702;&#35299;Hibernate&#21487;&#20197;&#20351;&#29992;&#30340;&#29615;&#22659;&#12290; </P>
  <LI>
  <P>&#26597;&#30475;Hibernate&#21457;&#34892;&#21253;&#20013;&#30340;<TT 
  class=literal>eg/</TT>&#30446;&#24405;&#65292;&#37324;&#38754;&#26377;&#19968;&#20010;&#31616;&#21333;&#30340;&#29420;&#31435;&#36816;&#34892;&#30340;&#31243;&#24207;&#12290;&#25226;&#20320;&#30340;JDBC&#39537;&#21160;&#25335;&#36125;&#21040;<TT 
  class=literal>lib/</TT>&#30446;&#24405;&#19979;&#65292;&#20462;&#25913;&#19968;&#19979;<TT 
  class=literal>src/hibernate.properties</TT>,&#25351;&#23450;&#20854;&#20013;&#20320;&#30340;&#25968;&#25454;&#24211;&#30340;&#20449;&#24687;&#12290;&#36827;&#20837;&#21629;&#20196;&#34892;&#65292;&#20999;&#25442;&#21040;&#20320;&#30340;&#21457;&#34892;&#21253;&#30340;&#30446;&#24405;&#65292;&#36755;&#20837;<TT 
  class=literal>ant eg</TT>(&#20351;&#29992;&#20102;Ant&#65289;&#65292;&#25110;&#32773;&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#20013;&#20351;&#29992;<TT class=literal>build 
  eg</TT>&#12290; </P>
  <LI>
  <P>&#25226;&#36825;&#20221;&#21442;&#32771;&#25991;&#26723;&#20316;&#20026;&#20320;&#23398;&#20064;&#30340;&#20027;&#35201;&#20449;&#24687;&#26469;&#28304;&#12290; </P>
  <LI>
  <P>&#22312;Hibernate &#30340;&#32593;&#31449;&#19978;&#21487;&#20197;&#25214;&#21040;&#32463;&#24120;&#25552;&#38382;&#30340;&#38382;&#39064;&#19982;&#35299;&#31572;(FAQ)&#12290; </P>
  <LI>
  <P>&#22312;Hibernate&#32593;&#31449;&#19978;&#36824;&#26377;&#31532;&#19977;&#26041;&#30340;&#28436;&#31034;&#12289;&#31034;&#20363;&#21644;&#25945;&#31243;&#30340;&#38142;&#25509;&#12290; </P>
  <LI>
  <P>Hibernate&#32593;&#31449;&#30340;“&#31038;&#21306;(Community Area)”&#26159;&#35752;&#35770;&#20851;&#20110;&#35774;&#35745;&#27169;&#24335;&#20197;&#21450;&#24456;&#22810;&#25972;&#21512;&#26041;&#26696;(Tomcat, JBoss AS, Struts, 
  EJB,&#31561;&#31561;)&#30340;&#22909;&#22320;&#26041;&#12290; </P></LI></OL></DIV>
<P>&#22914;&#26524;&#20320;&#26377;&#38382;&#39064;&#65292;&#35831;&#20351;&#29992;Hibernate&#32593;&#31449;&#19978;&#38142;&#25509;&#30340;&#29992;&#25143;&#35770;&#22363;&#12290;&#25105;&#20204;&#20063;&#25552;&#20379;&#19968;&#20010;JIRA&#38382;&#39064;&#36861;&#36394;&#31995;&#32479;&#65292;&#26469;&#25628;&#38598;bug&#25253;&#21578;&#21644;&#26032;&#21151;&#33021;&#35831;&#27714;&#12290;&#22914;&#26524;&#20320;&#23545;&#24320;&#21457;Hibernate&#26377;&#20852;&#36259;&#65292;&#35831;&#21152;&#20837;&#24320;&#21457;&#32773;&#30340;&#37038;&#20214;&#21015;&#34920;&#12290;&#65288;Hibernate&#32593;&#31449;&#19978;&#30340;&#29992;&#25143;&#35770;&#22363;&#26377;&#19968;&#20010;&#20013;&#25991;&#29256;&#38754;&#65292;JavaEye&#20063;&#26377;Hibernate&#20013;&#25991;&#29256;&#38754;,&#24744;&#21487;&#20197;&#22312;&#37027;&#37324;&#20132;&#27969;&#38382;&#39064;&#19982;&#32463;&#39564;&#12290;&#65289; 
</P>
<P>&#21830;&#19994;&#24320;&#21457;&#12289;&#20135;&#21697;&#25903;&#25345;&#21644;Hibernate&#22521;&#35757;&#21487;&#20197;&#36890;&#36807;JBoss 
Inc.&#33719;&#24471;&#12290;&#65288;&#35831;&#26597;&#38405;&#65306;http://www.hibernate.org/SupportTraining/&#65289;&#12290; 
Hibernate&#26159;&#19968;&#20010;&#19987;&#19994;&#30340;&#24320;&#25918;&#28304;&#20195;&#30721;&#39033;&#30446;(Professional Open Source project)&#65292;&#20063;&#26159;JBoss Enterprise 
Middleware System(JEMS),JBoss&#20225;&#19994;&#32423;&#20013;&#38388;&#20214;&#31995;&#32479;&#30340;&#19968;&#20010;&#26680;&#24515;&#32452;&#20214;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=preface-translate-comments-zh-cn></A>1.&nbsp;&#32763;&#35793;&#35828;&#26126;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26412;&#25991;&#26723;&#30340;&#32763;&#35793;&#26159;&#22312;&#32593;&#32476;&#19978;&#21327;&#20316;&#36827;&#34892;&#30340;&#65292;&#20063;&#20250;&#19981;&#26029;&#26681;&#25454;Hibernate&#30340;&#21319;&#32423;&#36827;&#34892;&#26356;&#26032;&#12290;&#25552;&#20379;&#27492;&#25991;&#26723;&#30340;&#30446;&#30340;&#26159;&#20026;&#20102;&#20943;&#32531;&#23398;&#20064;Hibernate&#30340;&#22369;&#24230;&#65292;&#32780;&#38750;&#20195;&#26367;&#21407;&#25991;&#26723;&#12290;&#25105;&#20204;&#24314;&#35758;&#25152;&#26377;&#26377;&#33021;&#21147;&#30340;&#35835;&#32773;&#37117;&#30452;&#25509;&#38405;&#35835;&#33521;&#25991;&#21407;&#25991;&#12290;&#33509;&#24744;&#23545;&#32763;&#35793;&#26377;&#24322;&#35758;&#65292;&#25110;&#21457;&#29616;&#32763;&#35793;&#38169;&#35823;&#65292;&#25964;&#35831;&#19981;&#21533;&#36176;&#25945;&#65292;&#25253;&#21578;&#21040;&#22914;&#19979;email&#22320;&#22336;&#65306;cao 
at redsaga.com </P>
<P>Hibernate&#29256;&#26412;3&#30340;&#32763;&#35793;&#30001;&#28385;&#27743;&#32418;&#32763;&#35793;&#22242;&#38431;(RedSaga Translate 
Team)&#38598;&#20307;&#36827;&#34892;&#65292;&#36825;&#20063;&#26159;&#19968;&#27425;&#22823;&#35268;&#27169;&#32593;&#32476;&#32763;&#35793;&#30340;&#35797;&#39564;&#12290;&#22312;&#19981;&#21040;20&#22825;&#30340;&#26102;&#38388;&#20869;&#65292;&#25105;&#20204;&#23436;&#25104;&#20102;&#20004;&#30334;&#22810;&#39029;&#25991;&#26723;&#30340;&#32763;&#35793;&#65292;&#36825;&#19968;&#25104;&#26524;&#26159;&#36890;&#36807;&#21313;&#20960;&#20301;&#32593;&#21451;&#38598;&#20307;&#21162;&#21147;&#23436;&#25104;&#30340;&#12290;&#36890;&#36807;&#36825;&#27425;&#32763;&#35793;&#65292;&#25105;&#20204;&#20063;&#26377;&#20102;&#19968;&#22871;&#23436;&#25972;&#30340;&#27969;&#31243;&#65292;&#20174;&#21021;&#35793;&#12289;&#25216;&#26415;&#23457;&#26680;&#19968;&#30452;&#21040;&#25991;&#23383;&#23457;&#26680;&#12289;&#21457;&#24067;&#12290;&#25105;&#20204;&#30340;&#32763;&#35793;&#22242;&#38431;&#36824;&#20250;&#32487;&#32493;&#23436;&#21892;&#25105;&#20204;&#30340;&#32763;&#35793;&#27969;&#31243;&#65292;&#24182;&#32763;&#35793;&#20854;&#20182;&#20248;&#31168;&#30340;Java&#24320;&#28304;&#36164;&#26009;&#65292;&#25964;&#35831;&#26399;&#24453;&#12290; 
</P>
<DIV class=table><A name=redsaga-translate-team></A>
<P class=title><B>&#34920;&nbsp;1.&nbsp; Hibernate v3&#32763;&#35793;&#22242;&#38431; </B></P>
<TABLE summary="&#10;                Hibernate v3&#32763;&#35793;&#22242;&#38431;&#10;            " 
border=1>
  <COLGROUP>
  <COL>
  <COL>
  <COL>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH align=center>&#24207;&#21495; </TH>
    <TH align=center>&#26631;&#39064; </TH>
    <TH align=center>&#20013;&#25991;&#26631;&#39064; </TH>
    <TH align=center>v3&#32763;&#35793; </TH>
    <TH align=center>v3&#23457;&#26657; </TH>
    <TH align=center>v3.1&#23457;&#26657; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD>--</TD>
    <TD>Quickstart with Tomcat</TD>
    <TD>&#22312;Tomcat&#20013;&#24555;&#36895;&#19978;&#25163;(3.1&#29256;&#26412;&#20013;&#21462;&#28040;&#65289;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>zoujm</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#1</TD>
    <TD>Turtotial</TD>
    <TD>Hibernate&#20837;&#38376;</TD>
    <TD>Zheng Shuai</TD>
    <TD>-</TD>
    <TD>Sean Chan</TD></TR>
  <TR>
    <TD>#2</TD>
    <TD>Architecture</TD>
    <TD>&#20307;&#31995;&#32467;&#26500;</TD>
    <TD>Hilton(BJUG)</TD>
    <TD>&#21388;&#20518;&#21457;&#21574;</TD>
    <TD>Sean Chan</TD></TR>
  <TR>
    <TD>#3</TD>
    <TD>Configuration</TD>
    <TD>&#37197;&#32622;</TD>
    <TD>Goncha</TD>
    <TD>mochow</TD>
    <TD>zcgly</TD></TR>
  <TR>
    <TD>#4</TD>
    <TD>Persistent Classes</TD>
    <TD>&#25345;&#20037;&#21270;&#31867;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>mochow</TD>
    <TD>DigitalSonic</TD></TR>
  <TR>
    <TD>#5</TD>
    <TD>Basic O/R Mapping</TD>
    <TD>&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(&#19978;)</TD>
    <TD>moxie</TD>
    <TD>Kingfish</TD>
    <TD>&#24352;&#25104;&#38050;</TD></TR>
  <TR>
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD>
    <TD>&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(&#19979;)</TD>
    <TD>inter_dudu</TD>
    <TD>&#21016;&#22269;&#38596;(vincent)</TD>
    <TD>&#24352;&#25104;&#38050;</TD></TR>
  <TR>
    <TD>#6</TD>
    <TD>Collection Mapping</TD>
    <TD>&#38598;&#21512;&#31867;&#26144;&#23556;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>robbin</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#7</TD>
    <TD>Association Mappings</TD>
    <TD>&#20851;&#32852;&#20851;&#31995;&#26144;&#23556;</TD>
    <TD>Robbin</TD>
    <TD>devils.advocate</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#8</TD>
    <TD>Component Mapping</TD>
    <TD>&#32452;&#20214;&#26144;&#23556;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>Robbin</TD>
    <TD>Song guo qiang</TD></TR>
  <TR>
    <TD>#9</TD>
    <TD>Inheritance Mappings</TD>
    <TD>&#32487;&#25215;&#26144;&#23556;</TD>
    <TD>morning(BJUG)</TD>
    <TD>mochow</TD>
    <TD>Liang cheng</TD></TR>
  <TR>
    <TD>#10</TD>
    <TD>Working with objects</TD>
    <TD>&#19982;&#23545;&#35937;&#20849;&#20107;</TD>
    <TD>&#31243;&#24191;&#26976;</TD>
    <TD>&#21388;&#20518;&#21457;&#21574;</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#11</TD>
    <TD>Transactions And Concurrency</TD>
    <TD>&#20107;&#21153;&#21644;&#24182;&#21457;</TD>
    <TD>Robbin</TD>
    <TD>mochow</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#12</TD>
    <TD>Interceptors and events</TD>
    <TD>&#32487;&#25215;&#26144;&#23556;</TD>
    <TD>&#19971;&#24425;&#29436;(BJUG)</TD>
    <TD>&#21388;&#20518;&#21457;&#21574;</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#13</TD>
    <TD>Batch processing</TD>
    <TD>&#25209;&#37327;&#22788;&#29702;</TD>
    <TD>Kingfish(BJUG)</TD>
    <TD>&#21388;&#20518;&#21457;&#21574;</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#14</TD>
    <TD>HQL: The Hibernate Query Language</TD>
    <TD>HQL: Hibernate&#26597;&#35810;&#35821;&#35328;</TD>
    <TD>&#37073;&#28009;(BJUG)</TD>
    <TD>Zheng Shuai</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#15</TD>
    <TD>Criteria Queries</TD>
    <TD>&#26465;&#20214;&#26597;&#35810;</TD>
    <TD>nemo(BJUG)</TD>
    <TD>Zheng Shuai</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#16</TD>
    <TD>Native SQL</TD>
    <TD>Native SQL&#26597;&#35810;</TD>
    <TD>&#20284;&#27700;&#27969;&#24180;</TD>
    <TD>zoujm</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#17</TD>
    <TD>Filters</TD>
    <TD>&#36807;&#28388;&#25968;&#25454;</TD>
    <TD>&#20912;&#20113;(BJUG)</TD>
    <TD>Goncha</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#18</TD>
    <TD>XML Mapping</TD>
    <TD>XML&#26144;&#23556;</TD>
    <TD>edward(BJUG)</TD>
    <TD>Goncha</TD>
    <TD>huxb</TD></TR>
  <TR>
    <TD>#19</TD>
    <TD>Improving performance</TD>
    <TD>&#24615;&#33021;&#25552;&#21319;</TD>
    <TD>Wangjinfeng</TD>
    <TD>Robbin</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#20</TD>
    <TD>Toolset Guide</TD>
    <TD>&#24037;&#20855;&#31665;&#25351;&#21335;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>Robbin</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#21</TD>
    <TD>Example: Parent/Child</TD>
    <TD>&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>devils.advocate</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#22</TD>
    <TD>Example: Weblog Application</TD>
    <TD>&#31034;&#20363;&#65306;Weblog &#24212;&#29992;&#31243;&#24207;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>devils.advocate</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#23</TD>
    <TD>Example: Various Mappings</TD>
    <TD>&#31034;&#20363;&#65306;&#22810;&#31181;&#26144;&#23556;</TD>
    <TD>shidu(BJUG)</TD>
    <TD>&#20912;&#20113;</TD>
    <TD>--</TD></TR>
  <TR>
    <TD>#24</TD>
    <TD>Best Practices</TD>
    <TD>&#26368;&#20339;&#23454;&#36341;</TD>
    <TD>&#26361;&#26195;&#38050;</TD>
    <TD>&#20912;&#20113;</TD>
    <TD>--</TD></TR></TBODY></TABLE></DIV>
<P>&#20851;&#20110;&#25105;&#20204; </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>&#28385;&#27743;&#32418;.&#24320;&#28304;, http://www.redsaga.com</SPAN>
  <DD>
  <P>&#20174;&#25104;&#31435;&#20043;&#21021;&#23601;&#33268;&#21147;&#20110;Java&#24320;&#25918;&#28304;&#20195;&#30721;&#22312;&#20013;&#22269;&#30340;&#20256;&#25773;&#19982;&#21457;&#23637;,&#19982;&#22269;&#20869;&#22810;&#20010;Java&#22242;&#20307;&#21450;&#20986;&#29256;&#31038;&#26377;&#28145;&#20837;&#20132;&#27969;&#12290;&#22362;&#25345;&#23569;&#35828;&#22810;&#20570;&#30340;&#21407;&#21017;&#65292;&#30446;&#21069;&#26377;&#20004;&#20010;&#22242;&#38431;&#65292;“OpenDoc&#22242;&#38431;”&#19982;“&#32763;&#35793;&#22242;&#38431;”&#65292;&#26412;&#32763;&#35793;&#25991;&#26723;&#21363;&#20026;&#32763;&#35793;&#22242;&#38431;&#20316;&#21697;&#12290;OpenDoc&#22242;&#38431;&#24050;&#32463;&#25512;&#20986;&#21253;&#25324;Hibernate&#12289;iBatis&#12289;Spring&#12289;WebWork&#30340;&#22810;&#20221;&#24320;&#25918;&#25991;&#26723;&#65292;&#24182;&#20110;2005&#24180;5&#26376;&#22312;Hibernate&#24320;&#25918;&#25991;&#26723;&#22522;&#30784;&#19978;&#25193;&#20805;&#25104;&#20070;&#65292;&#20986;&#29256;&#20102;&#21407;&#21019;&#20070;&#31821;&#65306;&#12298;&#28145;&#20837;&#27973;&#20986;Hibernate&#12299;&#65292;&#26412;&#20070;400&#20313;&#39029;&#65292;&#36866;&#21512;&#21508;&#20010;&#23618;&#27425;&#30340;Hibernate&#29992;&#25143;&#12290;(http://www.redsaga.com/hibernate_book.html)&#25964;&#35831;&#25903;&#25345;&#12290; 
  </P>
  <DT><SPAN class=term>&#21271;&#20140;Java&#29992;&#25143;&#32452;, http://www.bjug.org</SPAN>
  <DD>
  <P>Beiing Java User 
  Group&#65292;&#27665;&#38388;&#25216;&#26415;&#20132;&#27969;&#32452;&#32455;&#65292;&#25104;&#31435;&#20110;2004&#24180;6&#26376;&#12290;&#20197;&#20132;&#27969;&#19982;&#20849;&#20139;&#20026;&#23447;&#26088;&#65292;&#27599;&#20004;&#21608;&#20030;&#34892;&#19968;&#27425;&#25216;&#26415;&#32858;&#20250;&#27963;&#21160;&#12290;BJUG&#30340;&#30446;&#26631;&#26159;&#65292;&#36890;&#36807;&#23567;&#37096;&#20998;&#20154;&#30340;&#21162;&#21147;&#65292;&#24418;&#25104;&#19968;&#20010;&#25216;&#26415;&#31038;&#32676;&#65292;&#21019;&#24314;&#33391;&#22909;&#30340;&#20132;&#27969;&#27675;&#22260;&#65292;&#24182;&#23558;&#26032;&#30340;&#25216;&#26415;&#21644;&#24605;&#24819;&#25512;&#24191;&#21040;&#25972;&#20010;IT&#30028;&#65292;&#35753;&#25105;&#20204;&#20849;&#21516;&#36827;&#27493;&#12290; 
  </P>
  <DT><SPAN class=term>Java&#35270;&#32447;, http://www.javaeye.com</SPAN>
  <DD>
  <P>Java&#35270;&#32447;&#22312;&#26159;Hibernate&#20013;&#25991;&#35770;&#22363;&#65288;http://www.hibernate.org.cn&#65292;Hibernate&#20013;&#25991;&#35770;&#22363;&#26159;&#20013;&#22269;&#26368;&#26089;&#30340;Hibernate&#19987;&#19994;&#29992;&#25143;&#35770;&#22363;&#65292;&#20026;Hibernate&#22312;&#20013;&#22269;&#30340;&#25512;&#24191;&#20570;&#20986;&#20102;&#24040;&#22823;&#30340;&#36129;&#29486;&#65289;&#22522;&#30784;&#19978;&#21457;&#23637;&#36215;&#26469;&#30340;Java&#28145;&#24230;&#25216;&#26415;&#32593;&#31449;&#65292;&#30446;&#26631;&#26159;&#25104;&#20026;&#19968;&#20010;&#39640;&#21697;&#36136;&#30340;&#65292;&#26377;&#24605;&#24819;&#28145;&#24230;&#30340;&#12289;&#21407;&#21019;&#31934;&#31070;&#30340;Java&#25216;&#26415;&#20132;&#27969;&#32593;&#31449;&#65292;&#20026;&#36719;&#20214;&#20174;&#19994;&#20154;&#21592;&#25552;&#20379;&#19968;&#20010;&#33258;&#30001;&#30340;&#20132;&#27969;&#25216;&#26415;&#65292;&#20132;&#27969;&#24605;&#24819;&#21644;&#20132;&#27969;&#20449;&#24687;&#30340;&#24179;&#21488;&#12290; 
  </P>
  <DT><SPAN class=term>&#33268;&#35874;</SPAN>
  <DD>
  <P>&#36824;&#26377;&#19968;&#20123;&#26379;&#21451;&#32473;&#25105;&#20204;&#21457;&#26469;&#20102;&#21208;&#35823;&#65292;&#22312;&#27492;&#33268;&#35874;&#65306;Kurapica&#65292;&#26446;&#27589;&#65292;&#26446;&#28023;&#26519;&#12290; </P></DD></DL></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=preface-translate-licence-zh-cn></A>2.&nbsp;&#29256;&#26435;&#22768;&#26126;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#33521;&#25991;&#25991;&#26723;&#23646;&#20110;Hibernate&#21457;&#34892;&#21253;&#30340;&#19968;&#37096;&#20998;&#65292;&#36981;&#24490;LGPL&#21327;&#35758;&#12290;&#26412;&#32763;&#35793;&#29256;&#26412;&#21516;&#26679;&#36981;&#24490;LGPL&#21327;&#35758;&#12290;&#21442;&#19982;&#32763;&#35793;&#30340;&#35793;&#32773;&#19968;&#33268;&#21516;&#24847;&#25918;&#24323;&#38500;&#32626;&#21517;&#26435;&#22806;&#23545;&#26412;&#32763;&#35793;&#29256;&#26412;&#30340;&#20854;&#23427;&#26435;&#21033;&#35201;&#27714;&#12290; 
</P>
<P>&#24744;&#21487;&#20197;&#33258;&#30001;&#38142;&#25509;&#12289;&#19979;&#36733;&#12289;&#20256;&#25773;&#27492;&#25991;&#26723;&#65292;&#25110;&#32773;&#25918;&#32622;&#22312;&#24744;&#30340;&#32593;&#31449;&#19978;&#65292;&#29978;&#33267;&#20316;&#20026;&#20135;&#21697;&#30340;&#19968;&#37096;&#20998;&#21457;&#34892;&#12290;&#20294;&#21069;&#25552;&#26159;&#24517;&#39035;&#20445;&#35777;&#20840;&#25991;&#23436;&#25972;&#36716;&#36733;&#65292;&#21253;&#25324;&#23436;&#25972;&#30340;&#29256;&#26435;&#20449;&#24687;&#21644;&#20316;&#35793;&#32773;&#22768;&#26126;&#65292;&#24182;&#19981;&#33021;&#36829;&#21453;LGPL&#21327;&#35758;&#12290;&#36825;&#37324;“&#23436;&#25972;”&#30340;&#21547;&#20041;&#26159;&#65292;&#19981;&#33021;&#36827;&#34892;&#20219;&#20309;&#21024;&#38500;/&#22686;&#28155;/&#27880;&#35299;&#12290;&#33509;&#26377;&#21024;&#38500;/&#22686;&#28155;/&#27880;&#35299;&#65292;&#24517;&#39035;&#36880;&#27573;&#26126;&#30830;&#22768;&#26126;&#37027;&#20123;&#37096;&#20998;&#24182;&#38750;&#26412;&#25991;&#26723;&#30340;&#19968;&#37096;&#20998;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=tutorial></A>&#31532;&nbsp;1&nbsp;&#31456;&nbsp; Hibernate&#20837;&#38376; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=tutorial-intro></A>1.1.&nbsp; &#21069;&#35328; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26412;&#31456;&#26159;&#38754;&#21521;Hibernate&#21021;&#23398;&#32773;&#30340;&#19968;&#20010;&#20837;&#38376;&#25945;&#31243;&#12290;&#25105;&#20204;&#20174;&#19968;&#20010;&#20351;&#29992;&#39547;&#30041;&#20869;&#23384;&#24335;(in-memory)&#25968;&#25454;&#24211;&#30340;&#31616;&#21333;&#21629;&#20196;&#34892;&#24212;&#29992;&#31243;&#24207;&#24320;&#22987;, 
&#29992;&#26131;&#20110;&#29702;&#35299;&#30340;&#26041;&#24335;&#36880;&#27493;&#24320;&#21457;&#12290; </P>
<P>&#26412;&#31456;&#38754;&#21521;Hibernate&#21021;&#23398;&#32773;&#65292;&#20294;&#38656;&#35201;Java&#21644;SQL&#30693;&#35782;&#12290;&#23427;&#26159;&#22312;Michael 
Goegl&#25152;&#20889;&#30340;&#25351;&#21335;&#30340;&#22522;&#30784;&#19978;&#23436;&#25104;&#30340;&#12290;&#22312;&#36825;&#37324;&#65292;&#25105;&#20204;&#31216;&#31532;&#19977;&#26041;&#24211;&#25991;&#20214;&#26159;&#25351;JDK 1.4&#21644;5.0&#12290;&#33509;&#20351;&#29992;JDK1.3&#65292;&#20320;&#21487;&#33021;&#38656;&#35201;&#20854;&#23427;&#30340;&#24211;&#25991;&#20214;&#12290; </P>
<P>&#26412;&#31456;&#30340;&#28304;&#20195;&#30721;&#24050;&#21253;&#21547;&#22312;&#21457;&#24067;&#21253;&#20013;&#65292;&#20301;&#20110;<TT class=literal>doc/reference/tutorial/</TT>&#30446;&#24405;&#19979;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=tutorial-firstapp></A>1.2.&nbsp; 
&#31532;&#19968;&#37096;&#20998; &#65293; &#31532;&#19968;&#20010;Hibernate&#24212;&#29992;&#31243;&#24207; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#39318;&#20808;&#25105;&#20204;&#23558;&#21019;&#24314;&#19968;&#20010;&#31616;&#21333;&#30340;&#22522;&#20110;&#25511;&#21046;&#21488;&#30340;(console-based)Hibernate&#24212;&#29992;&#31243;&#24207;&#12290;&#30001;&#20110;&#25105;&#20204;&#20351;&#29992;Java&#25968;&#25454;&#24211;(HSQL 
DB)&#65292;&#25152;&#20197;&#19981;&#24517;&#23433;&#35013;&#20219;&#20309;&#25968;&#25454;&#24211;&#26381;&#21153;&#22120;&#12290; </P>
<P>&#20551;&#35774;&#25105;&#20204;&#24076;&#26395;&#26377;&#19968;&#20010;&#23567;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#20445;&#23384;&#25105;&#20204;&#24076;&#26395;&#21442;&#21152;&#30340;&#27963;&#21160;&#65288;events&#65289;&#21644;&#36825;&#20123;&#27963;&#21160;&#20027;&#21150;&#26041;&#30340;&#30456;&#20851;&#20449;&#24687;&#12290; 
&#65288;&#35793;&#32773;&#27880;&#65306;&#22312;&#26412;&#25945;&#31243;&#30340;&#21518;&#38754;&#37096;&#20998;&#65292;&#25105;&#20204;&#23558;&#30452;&#25509;&#20351;&#29992;event&#32780;&#19981;&#26159;&#23427;&#30340;&#20013;&#25991;&#32763;&#35793;“&#27963;&#21160;”&#65292;&#20197;&#20813;&#28151;&#28102;&#12290;&#65289; </P>
<P>&#25105;&#20204;&#25152;&#20570;&#30340;&#31532;&#19968;&#20214;&#20107;&#23601;&#26159;&#21019;&#24314;&#25105;&#20204;&#30340;&#24320;&#21457;&#30446;&#24405;&#65292;&#24182;&#19988;&#25226;&#25152;&#26377;&#38656;&#35201;&#29992;&#21040;&#30340;Java&#24211;&#25991;&#20214;&#25918;&#36827;&#21435;&#12290;&#35299;&#21387;&#32553;&#20174;Hibernate&#32593;&#31449;&#19979;&#36733;&#30340;Hibernate&#21457;&#24067;&#21253;&#65292;&#24182;&#25226;<TT 
class=literal>/lib</TT>&#30446;&#24405;&#19979;&#25152;&#26377;&#38656;&#35201;&#30340;&#24211;&#25991;&#20214;&#25335;&#21040;&#25105;&#20204;&#26032;&#24314;&#24320;&#21457;&#30446;&#24405;&#19979;&#30340;<TT 
class=literal>/lib</TT>&#30446;&#24405;&#19979;&#12290;&#30475;&#36215;&#26469;&#23601;&#20687;&#36825;&#26679;&#65306; </P><PRE class=programlisting>.
+lib
  antlr.jar
  cglib.jar
  asm.jar
  asm-attrs.jars
  commons-collections.jar
  commons-logging.jar
  ehcache.jar
  hibernate3.jar
  jta.jar
  dom4j.jar
  log4j.jar </PRE>
<P><SPAN 
class=emphasis><EM>&#21040;&#32534;&#20889;&#26412;&#25991;&#26102;&#20026;&#27490;</EM></SPAN>&#65292;&#36825;&#20123;&#26159;Hibernate&#36816;&#34892;&#25152;&#38656;&#35201;&#30340;&#26368;&#23567;&#24211;&#25991;&#20214;&#38598;&#21512;&#65288;&#27880;&#24847;&#25105;&#20204;&#20063;&#25335;&#36125;&#20102; 
Hibernate3.jar&#65292;&#36825;&#20010;&#26159;&#26368;&#20027;&#35201;&#30340;&#25991;&#20214;&#65289;&#12290;&#20320;&#27491;&#20351;&#29992;&#30340;Hibernate&#29256;&#26412;&#21487;&#33021;&#38656;&#35201;&#27604;&#36825;&#26356;&#22810;&#25110;&#23569;&#19968;&#20123;&#30340;&#24211;&#25991;&#20214;&#12290;&#35831;&#21442;&#35265;&#21457;&#24067;&#21253;&#20013;&#30340;<TT 
class=literal>lib/</TT>&#30446;&#24405;&#19979;&#30340;<TT 
class=literal>README.txt</TT>&#65292;&#20197;&#33719;&#21462;&#26356;&#22810;&#20851;&#20110;&#25152;&#38656;&#21644;&#21487;&#36873;&#30340;&#31532;&#19977;&#26041;&#24211;&#25991;&#20214;&#20449;&#24687;&#65288;&#20107;&#23454;&#19978;&#65292;Log4j&#24182;&#19981;&#26159;&#24517;&#39035;&#30340;&#24211;&#25991;&#20214;&#65292;&#20294;&#34987;&#35768;&#22810;&#24320;&#21457;&#32773;&#25152;&#21916;&#27426;&#65289;&#12290; 
</P>
<P>&#25509;&#19979;&#26469;&#25105;&#20204;&#21019;&#24314;&#19968;&#20010;&#31867;&#65292;&#29992;&#26469;&#20195;&#34920;&#37027;&#20123;&#25105;&#20204;&#24076;&#26395;&#20648;&#23384;&#22312;&#25968;&#25454;&#24211;&#37324;&#30340;event&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-firstclass></A>1.2.1.&nbsp; &#31532;&#19968;&#20010;class 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#30340;&#31532;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#26159;&#19968;&#20010;&#24102;&#26377;&#19968;&#20123;&#23646;&#24615;&#65288;property&#65289;&#30340;&#31616;&#21333;JavaBean&#31867;&#65306; </P><PRE class=programlisting>package events;

import java.util.Date;

public class Event {
    private Long id;

    private String title;
    private Date date;

    public Event() {}

    public Long getId() {
        return id;
    }

    private void setId(Long id) {
        this.id = id;
    }

    public Date getDate() {
        return date;
    }

    public void setDate(Date date) {
        this.date = date;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }
}</PRE>
<P>&#20320;&#21487;&#20197;&#30475;&#21040;&#36825;&#20010;&#31867;&#23545;&#23646;&#24615;&#30340;&#23384;&#21462;&#26041;&#27861;&#65288;getter and setter 
method&#65289;&#20351;&#29992;&#20102;&#26631;&#20934;JavaBean&#21629;&#21517;&#32422;&#23450;&#65292;&#21516;&#26102;&#25226;&#31867;&#23646;&#24615;&#65288;field&#65289;&#30340;&#35775;&#38382;&#32423;&#21035;&#35774;&#25104;&#31169;&#26377;&#30340;&#65288;private&#65289;&#12290;&#36825;&#26159;&#25512;&#33616;&#30340;&#35774;&#35745;&#65292;&#20294;&#24182;&#19981;&#26159;&#24517;&#39035;&#30340;&#12290;Hibernate&#20063;&#21487;&#20197;&#30452;&#25509;&#35775;&#38382;&#36825;&#20123;field&#65292;&#32780;&#20351;&#29992;&#35775;&#38382;&#26041;&#27861;&#65288;accessor 
method&#65289;&#30340;&#22909;&#22788;&#26159;&#25552;&#20379;&#20102;&#37325;&#26500;&#26102;&#30340;&#20581;&#22766;&#24615;&#65288;robustness&#65289;&#12290;&#20026;&#20102;&#36890;&#36807;&#21453;&#23556;&#26426;&#21046;&#65288;Reflection&#65289;&#26469;&#23454;&#20363;&#21270;&#36825;&#20010;&#31867;&#30340;&#23545;&#35937;&#65292;&#25105;&#20204;&#38656;&#35201;&#25552;&#20379;&#19968;&#20010;&#26080;&#21442;&#30340;&#26500;&#36896;&#22120;&#65288;no-argument 
constructor)&#12290; </P>
<P>&#23545;&#19968;&#29305;&#23450;&#30340;event, <TT class=literal>id</TT> 
&#23646;&#24615;&#25345;&#26377;&#21807;&#19968;&#30340;&#26631;&#35782;&#31526;&#65288;identifier&#65289;&#30340;&#20540;&#12290;&#22914;&#26524;&#25105;&#20204;&#24076;&#26395;&#20351;&#29992;Hibernate&#25552;&#20379;&#30340;&#25152;&#26377;&#29305;&#24615;&#65292;&#37027;&#20040;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#23454;&#20307;&#65288;persistent 
entity&#65289;&#31867;&#65288;&#36825;&#37324;&#20063;&#21253;&#25324;&#19968;&#20123;&#27425;&#35201;&#20381;&#36182;&#31867;&#65289;&#37117;&#38656;&#35201;&#19968;&#20010;&#36825;&#26679;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290;&#32780;&#20107;&#23454;&#19978;&#65292;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#65288;&#29305;&#21035;&#26159;web&#24212;&#29992;&#31243;&#24207;&#65289;&#37117;&#38656;&#35201;&#36890;&#36807;&#26631;&#35782;&#31526;&#26469;&#21306;&#21035;&#23545;&#35937;&#65292;&#25152;&#20197;&#20320;&#24212;&#35813;&#32771;&#34385;&#20351;&#29992;&#26631;&#35782;&#31526;&#23646;&#24615;&#32780;&#19981;&#26159;&#25226;&#23427;&#24403;&#20316;&#19968;&#31181;&#38480;&#21046;&#12290;&#28982;&#32780;&#65292;&#25105;&#20204;&#36890;&#24120;&#19981;&#20250;&#25805;&#20316;&#23545;&#35937;&#30340;&#26631;&#35782;&#65288;identity&#65289;&#65292;&#22240;&#27492;&#23427;&#30340;setter&#26041;&#27861;&#30340;&#35775;&#38382;&#32423;&#21035;&#24212;&#35813;&#22768;&#26126;private&#12290;&#36825;&#26679;&#24403;&#23545;&#35937;&#34987;&#20445;&#23384;&#30340;&#26102;&#20505;&#65292;&#21482;&#26377;Hibernate&#21487;&#20197;&#20026;&#23427;&#20998;&#37197;&#26631;&#35782;&#31526;&#20540;&#12290;&#20320;&#21487;&#30475;&#21040;Hibernate&#21487;&#20197;&#30452;&#25509;&#35775;&#38382;public&#65292;private&#21644;protected&#30340;&#35775;&#38382;&#26041;&#27861;&#21644;field&#12290;&#25152;&#20197;&#36873;&#25321;&#21738;&#31181;&#26041;&#24335;&#23436;&#20840;&#21462;&#20915;&#20110;&#20320;&#65292;&#20320;&#21487;&#20197;&#20351;&#20320;&#30340;&#36873;&#25321;&#19982;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#35774;&#35745;&#30456;&#21563;&#21512;&#12290; 
</P>
<P>&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#65288;persistent 
classes&#65289;&#37117;&#35201;&#27714;&#26377;&#26080;&#21442;&#30340;&#26500;&#36896;&#22120;&#65292;&#22240;&#20026;Hibernate&#24517;&#39035;&#20351;&#29992;Java&#21453;&#23556;&#26426;&#21046;&#26469;&#20026;&#20320;&#21019;&#24314;&#23545;&#35937;&#12290;&#26500;&#36896;&#22120;&#65288;constructor&#65289;&#30340;&#35775;&#38382;&#32423;&#21035;&#21487;&#20197;&#26159;private&#65292;&#28982;&#32780;&#24403;&#29983;&#25104;&#36816;&#34892;&#26102;&#20195;&#29702;&#65288;runtime 
proxy&#65289;&#30340;&#26102;&#20505;&#21017;&#35201;&#27714;&#20351;&#29992;&#33267;&#23569;&#26159;package &#32423;&#21035;&#30340;&#35775;&#38382;&#25511;&#21046;&#65292;&#36825;&#26679;&#22312;&#27809;&#26377;&#23383;&#33410;&#30721;&#25351;&#20196;&#65288;bytecode 
instrumentation&#65289;&#30340;&#24773;&#20917;&#19979;&#65292;&#20174;&#25345;&#20037;&#21270;&#31867;&#37324;&#33719;&#21462;&#25968;&#25454;&#20250;&#26356;&#26377;&#25928;&#29575;&#12290; </P>
<P>&#25226;&#36825;&#20010;Java&#28304;&#20195;&#30721;&#25991;&#20214;&#25918;&#21040;&#24320;&#21457;&#30446;&#24405;&#19979;&#30340;<TT class=literal>src</TT>&#30446;&#24405;&#37324;&#65292;&#27880;&#24847;&#21253;&#20301;&#32622;&#35201;&#27491;&#30830;&#12290; &#29616;&#22312;&#36825;&#20010;&#30446;&#24405;&#30475;&#36215;&#26469;&#24212;&#35813;&#20687;&#36825;&#26679;&#65306; 
</P><PRE class=programlisting>.
+lib
  &lt;Hibernate and third-party libraries&gt;
+src
  +events
    Event.java</PRE>
<P>&#19979;&#19968;&#27493;&#65292;&#25105;&#20204;&#25226;&#36825;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#20449;&#24687;&#21578;&#35785;Hibernate&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-mapping></A>1.2.2.&nbsp; &#26144;&#23556;&#25991;&#20214; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#38656;&#35201;&#30693;&#36947;&#24590;&#26679;&#21435;&#21152;&#36733;&#65288;load&#65289;&#21644;&#23384;&#20648;&#65288;store&#65289;&#25345;&#20037;&#21270;&#31867;&#30340;&#23545;&#35937;&#12290;&#36825;&#27491;&#26159;Hibernate&#26144;&#23556;&#25991;&#20214;&#21457;&#25381;&#20316;&#29992;&#30340;&#22320;&#26041;&#12290;&#26144;&#23556;&#25991;&#20214;&#21578;&#35785;Hibernate&#23427;&#65292;&#24212;&#35813;&#35775;&#38382;&#25968;&#25454;&#24211;(database)&#37324;&#38754;&#30340;&#21738;&#20010;&#34920;&#65288;table&#65289;&#21450;&#24212;&#35813;&#20351;&#29992;&#34920;&#37324;&#38754;&#30340;&#21738;&#20123;&#23383;&#27573;&#65288;column&#65289;&#12290; 
</P>
<P>&#19968;&#20010;&#26144;&#23556;&#25991;&#20214;&#30340;&#22522;&#26412;&#32467;&#26500;&#30475;&#36215;&#26469;&#20687;&#36825;&#26679;&#65306; </P><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping&gt;
[...]
&lt;/hibernate-mapping&gt;</PRE>
<P>&#27880;&#24847;Hibernate&#30340;DTD&#26159;&#38750;&#24120;&#22797;&#26434;&#30340;&#12290;&#20320;&#30340;&#32534;&#36753;&#22120;&#25110;&#32773;IDE&#37324;&#20351;&#29992;&#23427;&#26469;&#33258;&#21160;&#23436;&#25104;&#37027;&#20123;&#29992;&#26469;&#26144;&#23556;&#30340;XML&#20803;&#32032;&#65288;element&#65289;&#21644;&#23646;&#24615;&#65288;attribute&#65289;&#12290;&#20320;&#20063;&#21487;&#20197;&#22312;&#25991;&#26412;&#32534;&#36753;&#22120;&#37324;&#25171;&#24320;DTD&#65293;&#36825;&#26159;&#26368;&#31616;&#21333;&#30340;&#26041;&#24335;&#26469;&#27010;&#35272;&#25152;&#26377;&#30340;&#20803;&#32032;&#21644;attribute&#65292;&#24182;&#26597;&#30475;&#23427;&#20204;&#30340;&#32570;&#30465;&#20540;&#20197;&#21450;&#27880;&#37322;&#12290;&#27880;&#24847;Hibernate&#19981;&#20250;&#20174;web&#21152;&#36733;DTD&#25991;&#20214;&#65292;&#20294;&#23427;&#20250;&#39318;&#20808;&#22312;&#24212;&#29992;&#31243;&#24207;&#30340;classpath&#20013;&#26597;&#25214;&#12290;DTD&#25991;&#20214;&#24050;&#21253;&#25324;&#22312;<TT 
class=literal>hibernate3.jar</TT>&#37324;&#65292;&#21516;&#26102;&#20063;&#22312;Hibernate&#21457;&#24067;&#21253;&#30340;<TT 
class=literal>src/</TT>&#30446;&#24405;&#19979;&#12290; </P>
<P>&#20026;&#32553;&#30701;&#20195;&#30721;&#38271;&#24230;&#65292;&#22312;&#20197;&#21518;&#30340;&#20363;&#23376;&#37324;&#25105;&#20204;&#20250;&#30465;&#30053;DTD&#30340;&#22768;&#26126;&#12290;&#24403;&#28982;&#65292;&#22312;&#23454;&#38469;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;DTD&#22768;&#26126;&#26159;&#24517;&#39035;&#30340;&#12290; </P>
<P>&#22312;<TT class=literal>hibernate-mapping</TT>&#26631;&#31614;&#65288;tag&#65289;&#20043;&#38388;, &#21547;&#26377;&#19968;&#20010;<TT 
class=literal>class</TT>&#20803;&#32032;&#12290;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#23454;&#20307;&#31867;&#65288;&#20877;&#27425;&#22768;&#26126;&#65292;&#25110;&#35768;&#25509;&#19979;&#26469;&#20250;&#26377;&#20381;&#36182;&#31867;&#65292;&#23601;&#26159;&#37027;&#20123;&#27425;&#35201;&#30340;&#23454;&#20307;&#65289;&#37117;&#38656;&#35201;&#19968;&#20010;&#36825;&#26679;&#30340;&#26144;&#23556;&#65292;&#26469;&#25226;&#31867;&#23545;&#35937;&#26144;&#23556;&#21040;SQL&#25968;&#25454;&#24211;&#37324;&#30340;&#34920;&#12290; 
</P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="events.Event" table="EVENTS"&gt;

    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#21040;&#30446;&#21069;&#20026;&#27490;&#65292;&#25105;&#20204;&#21578;&#35785;&#20102;Hibernate&#24590;&#26679;&#25226;<TT class=literal>Events</TT>&#31867;&#30340;&#23545;&#35937;&#25345;&#20037;&#21270;&#21040;&#25968;&#25454;&#24211;&#30340;<TT 
class=literal>EVENTS</TT>&#34920;&#37324;&#65292;&#20197;&#21450;&#24590;&#26679;&#20174;<TT class=literal>EVENTS</TT>&#34920;&#21152;&#36733;&#21040;<TT 
class=literal>Events</TT>&#31867;&#30340;&#23545;&#35937;&#12290;&#27599;&#20010;&#23454;&#20363;&#23545;&#24212;&#30528;&#25968;&#25454;&#24211;&#34920;&#20013;&#30340;&#19968;&#34892;&#12290;&#29616;&#22312;&#25105;&#20204;&#23558;&#32487;&#32493;&#35752;&#35770;&#26377;&#20851;&#21807;&#19968;&#26631;&#35782;&#31526;&#23646;&#24615;&#21040;&#25968;&#25454;&#24211;&#34920;&#30340;&#26144;&#23556;&#12290;&#21478;&#22806;&#65292;&#30001;&#20110;&#25105;&#20204;&#19981;&#20851;&#24515;&#24590;&#26679;&#22788;&#29702;&#36825;&#20010;&#26631;&#35782;&#31526;&#65292;&#25105;&#20204;&#23601;&#37197;&#32622;&#30001;Hibernate&#30340;&#26631;&#35782;&#31526;&#29983;&#25104;&#31574;&#30053;&#26469;&#20135;&#29983;&#20195;&#29702;&#20027;&#38190;&#23383;&#27573;&#12290; 
</P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="events.Event" table="EVENTS"&gt;
        &lt;id name="id" column="EVENT_ID"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P><TT class=literal>id</TT>&#20803;&#32032;&#26159;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#22768;&#26126;&#65292;<TT class=literal>name="id"</TT> 
&#22768;&#26126;&#20102;Java&#23646;&#24615;&#30340;&#21517;&#23383; &#65293; Hibernate&#20250;&#20351;&#29992;<TT class=literal>getId()</TT>&#21644;<TT 
class=literal>setId()</TT>&#26469;&#35775;&#38382;&#23427;&#12290; <TT class=literal>column</TT>&#23646;&#24615;&#21017;&#21578;&#35785;Hibernate, 
&#25105;&#20204;&#20351;&#29992;<TT class=literal>EVENTS</TT>&#34920;&#30340;&#21738;&#20010;&#23383;&#27573;&#20316;&#20026;&#20027;&#38190;&#12290;&#23884;&#22871;&#30340;<TT 
class=literal>generator</TT>&#20803;&#32032;&#25351;&#23450;&#20102;&#26631;&#35782;&#31526;&#29983;&#25104;&#31574;&#30053;&#65292;&#22312;&#36825;&#37324;&#25105;&#20204;&#25351;&#23450;<TT 
class=literal>native</TT>&#65292;&#23427;&#26681;&#25454;&#24050;&#37197;&#32622;&#30340;&#25968;&#25454;&#24211;&#65288;&#26041;&#35328;&#65289;&#33258;&#21160;&#36873;&#25321;&#26368;&#20339;&#30340;&#26631;&#35782;&#31526;&#29983;&#25104;&#31574;&#30053;&#12290;Hibernate&#25903;&#25345;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#65292;&#20840;&#23616;&#21807;&#19968;&#24615;&#65288;globally 
unique&#65289;&#21644;&#24212;&#29992;&#31243;&#24207;&#25351;&#23450;&#65288;&#25110;&#32773;&#20320;&#33258;&#24049;&#20026;&#20219;&#20309;&#24050;&#26377;&#31574;&#30053;&#25152;&#20889;&#30340;&#25193;&#23637;&#65289;&#36825;&#20123;&#31574;&#30053;&#26469;&#29983;&#25104;&#26631;&#35782;&#31526;&#12290; </P>
<P>&#26368;&#21518;&#25105;&#20204;&#22312;&#26144;&#23556;&#25991;&#20214;&#37324;&#38754;&#21253;&#21547;&#38656;&#35201;&#25345;&#20037;&#21270;&#23646;&#24615;&#30340;&#22768;&#26126;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#31867;&#37324;&#38754;&#30340;&#23646;&#24615;&#37117;&#34987;&#35270;&#20026;&#38750;&#25345;&#20037;&#21270;&#30340;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="events.Event" table="EVENTS"&gt;
        &lt;id name="id" column="EVENT_ID"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="date" type="timestamp" column="EVENT_DATE"/&gt;
        &lt;property name="title"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#21644;<TT class=literal>id</TT>&#20803;&#32032;&#19968;&#26679;&#65292;<TT class=literal>property</TT>&#20803;&#32032;&#30340;<TT 
class=literal>name</TT>&#23646;&#24615;&#21578;&#35785;Hibernate&#20351;&#29992;&#21738;&#20010;getter&#21644;setter&#26041;&#27861;&#12290;&#22312;&#27492;&#20363;&#20013;&#65292;Hibernate&#20250;&#23547;&#25214;<TT 
class=literal>getDate()/setDate()</TT>, &#20197;&#21450;<TT 
class=literal>getTitle()/setTitle()</TT>&#12290; </P>
<P>&#20026;&#20160;&#20040;<TT class=literal>date</TT>&#23646;&#24615;&#30340;&#26144;&#23556;&#21547;&#26377;<TT class=literal>column</TT> 
attribute&#65292;&#32780;<TT class=literal>title</TT>&#21364;&#27809;&#26377;&#65311;&#24403;&#27809;&#26377;&#35774;&#23450;<TT class=literal>column</TT> 
attribute &#30340;&#26102;&#20505;&#65292;Hibernate&#32570;&#30465;&#22320;&#20351;&#29992;JavaBean&#30340;&#23646;&#24615;&#21517;&#20316;&#20026;&#23383;&#27573;&#21517;&#12290;&#23545;&#20110;<TT 
class=literal>title</TT>&#65292;&#36825;&#26679;&#24037;&#20316;&#24471;&#24456;&#22909;&#12290;&#28982;&#32780;&#65292;<TT 
class=literal>date</TT>&#22312;&#22810;&#25968;&#30340;&#25968;&#25454;&#24211;&#37324;&#65292;&#26159;&#19968;&#20010;&#20445;&#30041;&#20851;&#38190;&#23383;&#65292;&#25152;&#20197;&#25105;&#20204;&#26368;&#22909;&#25226;&#23427;&#26144;&#23556;&#25104;&#19968;&#20010;&#19981;&#21516;&#30340;&#21517;&#23383;&#12290; </P>
<P>&#21478;&#19968;&#26377;&#36259;&#30340;&#20107;&#24773;&#26159;<TT class=literal>title</TT>&#23646;&#24615;&#32570;&#23569;&#19968;&#20010;<TT class=literal>type</TT> 
attribute&#12290;&#25105;&#20204;&#22312;&#26144;&#23556;&#25991;&#20214;&#37324;&#22768;&#26126;&#24182;&#20351;&#29992;&#30340;&#31867;&#22411;&#65292;&#21364;&#19981;&#26159;&#25105;&#20204;&#26399;&#26395;&#30340;&#37027;&#26679;&#65292;&#26159;Java&#25968;&#25454;&#31867;&#22411;&#65292;&#21516;&#26102;&#20063;&#19981;&#26159;SQL&#25968;&#25454;&#24211;&#30340;&#25968;&#25454;&#31867;&#22411;&#12290;&#36825;&#20123;&#31867;&#22411;&#23601;&#26159;&#25152;&#35859;&#30340;Hibernate 
&#26144;&#23556;&#31867;&#22411;<SPAN class=emphasis><EM>&#65288;mapping 
types&#65289;</EM></SPAN>&#65292;&#23427;&#20204;&#33021;&#25226;Java&#25968;&#25454;&#31867;&#22411;&#36716;&#25442;&#21040;SQL&#25968;&#25454;&#31867;&#22411;&#65292;&#21453;&#20043;&#20134;&#28982;&#12290;&#20877;&#27425;&#37325;&#30003;&#65292;&#22914;&#26524;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#27809;&#26377;&#35774;&#32622;<TT 
class=literal>type</TT>&#23646;&#24615;&#30340;&#35805;&#65292;Hibernate&#20250;&#33258;&#24049;&#35797;&#30528;&#21435;&#30830;&#23450;&#27491;&#30830;&#30340;&#36716;&#25442;&#31867;&#22411;&#21644;&#23427;&#30340;&#26144;&#23556;&#31867;&#22411;&#12290;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#36825;&#20010;&#33258;&#21160;&#26816;&#27979;&#26426;&#21046;&#65288;&#22312;Java 
&#31867;&#19978;&#20351;&#29992;&#21453;&#23556;&#26426;&#21046;&#65289;&#19981;&#20250;&#20135;&#29983;&#20320;&#25152;&#26399;&#24453;&#25110;&#38656;&#35201;&#30340;&#32570;&#30465;&#20540;&#12290;<TT 
class=literal>date</TT>&#23646;&#24615;&#23601;&#26159;&#20010;&#24456;&#22909;&#30340;&#20363;&#23376;&#65292;Hibernate&#26080;&#27861;&#30693;&#36947;&#36825;&#20010;&#23646;&#24615;&#65288;<TT 
class=literal>java.util.Date</TT>&#31867;&#22411;&#30340;&#65289;&#24212;&#35813;&#34987;&#26144;&#23556;&#25104;&#65306;SQL <TT class=literal>date</TT>&#65292;&#25110;<TT 
class=literal>timestamp</TT>&#65292;&#36824;&#26159;<TT class=literal>time</TT> &#23383;&#27573;&#12290;&#22312;&#27492;&#20363;&#20013;&#65292;&#25226;&#36825;&#20010;&#23646;&#24615;&#26144;&#23556;&#25104;<TT 
class=literal>timestamp</TT> &#36716;&#25442;&#22120;&#65292;&#36825;&#26679;&#25105;&#20204;&#39044;&#30041;&#20102;&#26085;&#26399;&#21644;&#26102;&#38388;&#30340;&#20840;&#37096;&#20449;&#24687;&#12290; </P>
<P>&#24212;&#35813;&#25226;&#36825;&#20010;&#26144;&#23556;&#25991;&#20214;&#20445;&#23384;&#20026;<TT class=literal>Event.hbm.xml</TT>&#65292;&#19988;&#23601;&#22312;<TT 
class=literal>Event</TT>Java&#31867;&#30340;&#28304;&#25991;&#20214;&#30446;&#24405;&#19979;&#12290;&#26144;&#23556;&#25991;&#20214;&#21487;&#38543;&#24847;&#22320;&#21629;&#21517;&#65292;&#20294;<TT 
class=literal>hbm.xml</TT>&#30340;&#21518;&#32512;&#24050;&#25104;&#20026;Hibernate&#24320;&#21457;&#32773;&#31038;&#21306;&#30340;&#32422;&#23450;&#12290;&#29616;&#22312;&#30446;&#24405;&#32467;&#26500;&#30475;&#36215;&#26469;&#24212;&#35813;&#20687;&#36825;&#26679;&#65306; </P><PRE class=programlisting>.
+lib
  &lt;Hibernate and third-party libraries&gt;
+src
 +events
  Event.java
  Event.hbm.xml</PRE>
<P>&#25105;&#20204;&#32487;&#32493;&#36827;&#34892;Hibernate&#30340;&#20027;&#35201;&#37197;&#32622;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-configuration></A>1.2.3.&nbsp; 
Hibernate&#37197;&#32622; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#29616;&#22312;&#25105;&#20204;&#24050;&#32463;&#26377;&#20102;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#21644;&#23427;&#30340;&#26144;&#23556;&#25991;&#20214;&#65292;&#35813;&#26159;&#37197;&#32622;Hibernate&#30340;&#26102;&#20505;&#20102;&#12290;&#22312;&#27492;&#20043;&#21069;&#65292;&#25105;&#20204;&#38656;&#35201;&#19968;&#20010;&#25968;&#25454;&#24211;&#12290; HSQL DB&#26159;&#31181;&#22522;&#20110;Java 
&#30340;SQL&#25968;&#25454;&#24211;&#31649;&#29702;&#31995;&#32479;&#65288;DBMS&#65289;&#65292;&#21487;&#20197;&#20174;HSQL DB&#30340;&#32593;&#31449;&#19978;&#19979;&#36733;&#12290;&#23454;&#38469;&#19978;&#65292;&#20320;&#21482;&#38656;&#19979;&#36733;&#30340;&#21253;&#20013;&#30340;<TT 
class=literal>hsqldb.jar</TT>&#25991;&#20214;&#65292;&#24182;&#25226;&#36825;&#20010;&#25991;&#20214;&#25918;&#22312;&#24320;&#21457;&#25991;&#20214;&#22841;&#30340;<TT class=literal>lib/</TT>&#30446;&#24405;&#19979;&#21363;&#21487;&#12290; 
</P>
<P>&#22312;&#24320;&#21457;&#30340;&#26681;&#30446;&#24405;&#19979;&#21019;&#24314;&#19968;&#20010;<TT class=literal>data</TT>&#30446;&#24405; &#65293; &#36825;&#26159;HSQL 
DB&#23384;&#20648;&#25968;&#25454;&#25991;&#20214;&#30340;&#22320;&#26041;&#12290;&#27492;&#26102;&#22312;data&#30446;&#24405;&#20013;&#36816;&#34892;<TT class=literal>java -classpath lib/hsqldb.jar 
org.hsqldb.Server</TT>&#23601;&#21487;&#21551;&#21160;&#25968;&#25454;&#24211;&#12290;&#20320;&#21487;&#20197;&#22312;log&#20013;&#30475;&#21040;&#23427;&#30340;&#21551;&#21160;&#65292;&#21450;&#32465;&#23450;&#21040;TCP/IP&#22871;&#32467;&#23383;&#65292;&#36825;&#27491;&#26159;&#25105;&#20204;&#30340;&#24212;&#29992;&#31243;&#24207;&#31245;&#21518;&#20250;&#36830;&#25509;&#30340;&#22320;&#26041;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#22312;&#26412;&#20363;&#20013;&#36816;&#34892;&#19968;&#20010;&#20840;&#26032;&#30340;&#25968;&#25454;&#24211;&#65292;&#23601;&#22312;&#31383;&#21475;&#20013;&#25353;&#19979;<TT 
class=literal>CTRL + C</TT>&#26469;&#20851;&#38381;HSQL&#25968;&#25454;&#24211;&#65292;&#24182;&#21024;&#38500;<TT 
class=literal>data/</TT>&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#65292;&#20877;&#37325;&#26032;&#21551;&#21160;HSQL&#25968;&#25454;&#24211;&#12290; </P>
<P>Hibernate&#26159;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#37324;&#36830;&#25509;&#25968;&#25454;&#24211;&#30340;&#37027;&#23618;&#65292;&#25152;&#20197;&#23427;&#38656;&#35201;&#36830;&#25509;&#29992;&#30340;&#20449;&#24687;&#12290;&#36830;&#25509;&#65288;connection&#65289;&#26159;&#36890;&#36807;&#19968;&#20010;&#20063;&#30001;&#25105;&#20204;&#37197;&#32622;&#30340;JDBC&#36830;&#25509;&#27744;&#65288;connection 
pool&#65289;&#26469;&#23436;&#25104;&#30340;&#12290;Hibernate&#30340;&#21457;&#24067;&#21253;&#37324;&#21253;&#21547;&#20102;&#35768;&#22810;&#24320;&#28304;&#30340;&#65288;open 
source&#65289;&#36830;&#25509;&#27744;&#65292;&#20294;&#22312;&#25105;&#20204;&#20363;&#23376;&#20013;&#20351;&#29992;Hibernate&#20869;&#32622;&#30340;&#36830;&#25509;&#27744;&#12290;&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#19968;&#20010;&#20135;&#21697;&#32423;(production-quality)&#30340;&#31532;&#19977;&#26041;&#36830;&#25509;&#27744;&#36719;&#20214;&#65292;&#20320;&#24517;&#39035;&#25335;&#36125;&#25152;&#38656;&#30340;&#24211;&#25991;&#20214;&#21040;&#20320;&#30340;classpath&#19979;&#65292;&#24182;&#20351;&#29992;&#19981;&#21516;&#30340;&#36830;&#25509;&#27744;&#35774;&#32622;&#12290; 
</P>
<P>&#20026;&#20102;&#20445;&#23384;Hibernate&#30340;&#37197;&#32622;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#31616;&#21333;&#30340;<TT 
class=literal>hibernate.properties</TT>&#25991;&#20214;&#65292;&#25110;&#32773;&#19968;&#20010;&#31245;&#24494;&#22797;&#26434;&#30340;<TT 
class=literal>hibernate.cfg.xml</TT>&#65292;&#29978;&#33267;&#21487;&#20197;&#23436;&#20840;&#20351;&#29992;&#31243;&#24207;&#26469;&#37197;&#32622;Hibernate&#12290;&#22810;&#25968;&#29992;&#25143;&#26356;&#21916;&#27426;&#20351;&#29992;XML&#37197;&#32622;&#25991;&#20214;&#65306; 
</P><PRE class=programlisting>&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;session-factory&gt;

        &lt;!-- Database connection settings --&gt;
        &lt;property name="connection.driver_class"&gt;org.hsqldb.jdbcDriver&lt;/property&gt;
        &lt;property name="connection.url"&gt;jdbc:hsqldb:hsql://localhost&lt;/property&gt;
        &lt;property name="connection.username"&gt;sa&lt;/property&gt;
        &lt;property name="connection.password"&gt;&lt;/property&gt;

        &lt;!-- JDBC connection pool (use the built-in) --&gt;
        &lt;property name="connection.pool_size"&gt;1&lt;/property&gt;

        &lt;!-- SQL dialect --&gt;
        &lt;property name="dialect"&gt;org.hibernate.dialect.HSQLDialect&lt;/property&gt;

        &lt;!-- Enable Hibernate's automatic session context management --&gt;
        &lt;property name="current_session_context_class"&gt;thread&lt;/property&gt;

        &lt;!-- Disable the second-level cache  --&gt;
        &lt;property name="cache.provider_class"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;

        &lt;!-- Echo all executed SQL to stdout --&gt;
        &lt;property name="show_sql"&gt;true&lt;/property&gt;

        &lt;!-- Drop and re-create the database schema on startup --&gt;
        &lt;property name="hbm2ddl.auto"&gt;create&lt;/property&gt;

        &lt;mapping resource="events/Event.hbm.xml"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</PRE>
<P>&#27880;&#24847;&#36825;&#20010;XML&#37197;&#32622;&#20351;&#29992;&#20102;&#19968;&#20010;&#19981;&#21516;&#30340;DTD&#12290;&#22312;&#36825;&#37324;&#65292;&#25105;&#20204;&#37197;&#32622;&#20102;Hibernate&#30340;<TT 
class=literal>SessionFactory</TT>&#65293;&#19968;&#20010;&#20851;&#32852;&#20110;&#29305;&#23450;&#25968;&#25454;&#24211;&#20840;&#23616;&#30340;&#24037;&#21378;&#65288;factory&#65289;&#12290;&#22914;&#26524;&#20320;&#35201;&#20351;&#29992;&#22810;&#20010;&#25968;&#25454;&#24211;&#65292;&#23601;&#35201;&#29992;&#22810;&#20010;&#30340;<TT 
class=literal>&lt;session-factory&gt;</TT>&#65292;&#36890;&#24120;&#25226;&#23427;&#20204;&#25918;&#22312;&#22810;&#20010;&#37197;&#32622;&#25991;&#20214;&#20013;&#65288;&#20026;&#20102;&#26356;&#23481;&#26131;&#21551;&#21160;&#65289;&#12290; </P>
<P>&#26368;&#24320;&#22987;&#30340;4&#20010;<TT class=literal>property</TT>&#20803;&#32032;&#21253;&#21547;&#24517;&#35201;&#30340;JDBC&#36830;&#25509;&#20449;&#24687;&#12290;&#26041;&#35328;&#65288;dialect&#65289;&#30340;<TT 
class=literal>property</TT>&#20803;&#32032;&#25351;&#26126;Hibernate 
&#29983;&#25104;&#30340;&#29305;&#23450;SQL&#21464;&#37327;&#12290;&#20320;&#24456;&#24555;&#20250;&#30475;&#21040;&#65292;Hibernate&#23545;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#30340;&#33258;&#21160;session&#31649;&#29702;&#23601;&#20250;&#27966;&#19978;&#29992;&#22330;&#12290; &#25171;&#24320;<TT 
class=literal>hbm2ddl.auto</TT>&#36873;&#39033;&#23558;&#33258;&#21160;&#29983;&#25104;&#25968;&#25454;&#24211;&#27169;&#24335;&#65288;schema&#65289;&#65293; 
&#30452;&#25509;&#21152;&#20837;&#25968;&#25454;&#24211;&#20013;&#12290;&#24403;&#28982;&#36825;&#20010;&#36873;&#39033;&#20063;&#21487;&#20197;&#34987;&#20851;&#38381;&#65288;&#36890;&#36807;&#21435;&#38500;&#36825;&#20010;&#37197;&#32622;&#36873;&#39033;&#65289;&#25110;&#32773;&#36890;&#36807;Ant&#20219;&#21153;<TT 
class=literal>SchemaExport</TT>&#30340;&#24110;&#21161;&#26469;&#25226;&#25968;&#25454;&#24211;schema&#37325;&#23450;&#21521;&#21040;&#25991;&#20214;&#20013;&#12290;&#26368;&#21518;&#65292;&#22312;&#37197;&#32622;&#20013;&#20026;&#25345;&#20037;&#21270;&#31867;&#21152;&#20837;&#26144;&#23556;&#25991;&#20214;&#12290; </P>
<P>&#25226;&#36825;&#20010;&#25991;&#20214;&#25335;&#36125;&#21040;&#28304;&#20195;&#30721;&#30446;&#24405;&#19979;&#38754;&#65292;&#36825;&#26679;&#23427;&#23601;&#20301;&#20110;classpath&#30340;&#26681;&#30446;&#24405;&#30340;&#26368;&#21518;&#12290;Hibernate&#22312;&#21551;&#21160;&#26102;&#20250;&#33258;&#21160;&#22312;classpath&#30340;&#26681;&#30446;&#24405;&#26597;&#25214;&#21517;&#20026;<TT 
class=literal>hibernate.cfg.xml</TT>&#30340;&#37197;&#32622;&#25991;&#20214;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-ant></A>1.2.4.&nbsp; &#29992;Ant&#26500;&#24314; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#29616;&#22312;&#25105;&#20204;&#29992;Ant&#26469;&#26500;&#24314;&#24212;&#29992;&#31243;&#24207;&#12290;&#20320;&#24517;&#39035;&#20808;&#23433;&#35013;Ant&#65293;&#21487;&#20197;&#20174;<A href="http://ant.apache.org/bindownload.cgi" 
target=_top>Ant &#19979;&#36733;&#39029;&#38754;</A>&#24471;&#21040;&#23427;&#12290;&#24590;&#26679;&#23433;&#35013;Ant&#23601;&#19981;&#22312;&#36825;&#37324;&#20171;&#32461;&#20102;&#65292;&#35831;&#21442;&#32771;<A 
href="http://ant.apache.org/manual/index.html" target=_top>Ant 
&#29992;&#25143;&#25163;&#20876;</A>&#12290;&#24403;&#20320;&#23433;&#35013;&#23436;&#20102;Ant&#65292;&#23601;&#21487;&#20197;&#24320;&#22987;&#21019;&#24314;<TT class=literal>build.xml</TT>&#25991;&#20214;&#65292;&#25226;&#23427;&#30452;&#25509;&#25918;&#22312;&#24320;&#21457;&#30446;&#24405;&#19979;&#38754;&#12290; </P>
<P>&#19968;&#20010;&#31616;&#21333;&#30340;build&#25991;&#20214;&#30475;&#36215;&#26469;&#20687;&#36825;&#26679;&#65306; </P><PRE class=programlisting>&lt;project name="hibernate-tutorial" default="compile"&gt;

    &lt;property name="sourcedir" value="${basedir}/src"/&gt;
    &lt;property name="targetdir" value="${basedir}/bin"/&gt;
    &lt;property name="librarydir" value="${basedir}/lib"/&gt;

    &lt;path id="libraries"&gt;
        &lt;fileset dir="${librarydir}"&gt;
            &lt;include name="*.jar"/&gt;
        &lt;/fileset&gt;
    &lt;/path&gt;

    &lt;target name="clean"&gt;
        &lt;delete dir="${targetdir}"/&gt;
        &lt;mkdir dir="${targetdir}"/&gt;
    &lt;/target&gt;

    &lt;target name="compile" depends="clean, copy-resources"&gt;
      &lt;javac srcdir="${sourcedir}"
             destdir="${targetdir}"
             classpathref="libraries"/&gt;
    &lt;/target&gt;

    &lt;target name="copy-resources"&gt;
        &lt;copy todir="${targetdir}"&gt;
            &lt;fileset dir="${sourcedir}"&gt;
                &lt;exclude name="**/*.java"/&gt;
            &lt;/fileset&gt;
        &lt;/copy&gt;
    &lt;/target&gt;

&lt;/project&gt;</PRE>
<P>&#36825;&#23558;&#21578;&#35785;Ant&#25226;&#25152;&#26377;&#22312;lib&#30446;&#24405;&#19979;&#20197;<TT 
class=literal>.jar</TT>&#32467;&#23614;&#30340;&#25991;&#20214;&#25335;&#36125;&#21040;classpath&#20013;&#20197;&#20379;&#32534;&#35793;&#20043;&#29992;&#12290;&#23427;&#20063;&#25226;&#25152;&#26377;&#30340;&#38750;Java&#28304;&#20195;&#30721;&#25991;&#20214;&#65292;&#20363;&#22914;&#37197;&#32622;&#21644;Hibernate&#26144;&#23556;&#25991;&#20214;&#65292;&#25335;&#36125;&#21040;&#30446;&#26631;&#30446;&#24405;&#12290;&#22914;&#26524;&#20320;&#29616;&#22312;&#36816;&#34892;Ant&#65292;&#20250;&#24471;&#21040;&#20197;&#19979;&#36755;&#20986;&#65306; 
</P><PRE class=programlisting>C:\hibernateTutorial\&gt;ant
Buildfile: build.xml

copy-resources:
     [copy] Copying 2 files to C:\hibernateTutorial\bin

compile:
    [javac] Compiling 1 source file to C:\hibernateTutorial\bin

BUILD SUCCESSFUL
Total time: 1 second </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-helpers></A>1.2.5.&nbsp; &#21551;&#21160;&#21644;&#36741;&#21161;&#31867; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26159;&#26102;&#20505;&#26469;&#21152;&#36733;&#21644;&#20648;&#23384;&#19968;&#20123;<TT 
class=literal>Event</TT>&#23545;&#35937;&#20102;&#65292;&#20294;&#39318;&#20808;&#25105;&#20204;&#24471;&#32534;&#20889;&#19968;&#20123;&#22522;&#30784;&#30340;&#20195;&#30721;&#20197;&#23436;&#25104;&#35774;&#32622;&#12290;&#25105;&#20204;&#24517;&#39035;&#21551;&#21160;Hibernate&#65292;&#27492;&#36807;&#31243;&#21253;&#25324;&#21019;&#24314;&#19968;&#20010;&#20840;&#23616;&#30340;<TT 
class=literal>SessoinFactory</TT>&#65292;&#24182;&#25226;&#23427;&#20648;&#23384;&#22312;&#24212;&#29992;&#31243;&#24207;&#20195;&#30721;&#23481;&#26131;&#35775;&#38382;&#30340;&#22320;&#26041;&#12290;<TT 
class=literal>SessionFactory</TT>&#21487;&#20197;&#21019;&#24314;&#24182;&#25171;&#24320;&#26032;&#30340;<TT class=literal>Session</TT>&#12290;&#19968;&#20010;<TT 
class=literal>Session</TT>&#20195;&#34920;&#19968;&#20010;&#21333;&#32447;&#31243;&#30340;&#21333;&#20803;&#25805;&#20316;&#65292;<TT 
class=literal>SessionFactory</TT>&#21017;&#26159;&#20010;&#32447;&#31243;&#23433;&#20840;&#30340;&#20840;&#23616;&#23545;&#35937;&#65292;&#21482;&#38656;&#35201;&#34987;&#23454;&#20363;&#21270;&#19968;&#27425;&#12290; </P>
<P>&#25105;&#20204;&#23558;&#21019;&#24314;&#19968;&#20010;<TT class=literal>HibernateUtil</TT>&#36741;&#21161;&#31867;&#65288;helper 
class&#65289;&#26469;&#36127;&#36131;&#21551;&#21160;Hibernate&#21644;&#26356;&#26041;&#20415;&#22320;&#25805;&#20316;<TT class=literal>SessionFactory</TT>&#12290;&#35753;&#25105;&#20204;&#26469;&#30475;&#19968;&#19979;&#23427;&#30340;&#23454;&#29616;&#65306; 
</P><PRE class=programlisting>package util;

import org.hibernate.*;
import org.hibernate.cfg.*;

public class HibernateUtil {

    private static final SessionFactory sessionFactory;

    static {
        try {
            // Create the SessionFactory from hibernate.cfg.xml
            sessionFactory = new Configuration().configure().buildSessionFactory();
        } catch (Throwable ex) {
            // Make sure you log the exception, as it might be swallowed
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }

}</PRE>
<P>&#36825;&#20010;&#31867;&#19981;&#20294;&#22312;&#23427;&#30340;&#38745;&#24577;&#21021;&#22987;&#21270;&#36807;&#31243;&#65288;&#20165;&#24403;&#21152;&#36733;&#36825;&#20010;&#31867;&#30340;&#26102;&#20505;&#34987;JVM&#25191;&#34892;&#19968;&#27425;&#65289;&#20013;&#20135;&#29983;&#20840;&#23616;&#30340;<TT 
class=literal>SessionFactory</TT>&#65292;&#32780;&#19988;&#38544;&#34255;&#20102;&#23427;&#20351;&#29992;&#20102;&#38745;&#24577;singleton&#30340;&#20107;&#23454;&#12290;&#23427;&#20063;&#21487;&#33021;&#22312;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#20013;&#30340;JNDI&#26597;&#25214;<TT 
class=literal>SessionFactory</TT>&#12290; </P>
<P>&#22914;&#26524;&#20320;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#32473;<TT class=literal>SessionFactory</TT>&#19968;&#20010;&#21517;&#23383;&#65292;&#22312;<TT 
class=literal>SessionFactory</TT>&#21019;&#24314;&#21518;&#65292;Hibernate&#20250;&#35797;&#30528;&#25226;&#23427;&#32465;&#23450;&#21040;JNDI&#12290;&#35201;&#23436;&#20840;&#36991;&#20813;&#36825;&#26679;&#30340;&#20195;&#30721;&#65292;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;JMX&#37096;&#32626;&#65292;&#35753;&#20855;&#26377;JMX&#33021;&#21147;&#30340;&#23481;&#22120;&#26469;&#23454;&#20363;&#21270;<TT 
class=literal>HibernateService</TT>&#24182;&#25226;&#23427;&#32465;&#23450;&#21040;JNDI&#12290;&#36825;&#20123;&#39640;&#32423;&#21487;&#36873;&#39033;&#22312;&#21518;&#38754;&#30340;&#31456;&#33410;&#20013;&#20250;&#35752;&#35770;&#21040;&#12290; </P>
<P>&#25226;<TT class=literal>HibernateUtil.java</TT>&#25918;&#22312;&#24320;&#21457;&#30446;&#24405;&#30340;&#28304;&#20195;&#30721;&#36335;&#24452;&#19979;&#65292;&#19982;&#25918;<TT 
class=literal>events</TT>&#30340;&#21253;&#24182;&#21015;&#65306; </P><PRE class=programlisting>.
+lib
  &lt;Hibernate and third-party libraries&gt;
+src
  +events
    Event.java
    Event.hbm.xml
  +util
    HibernateUtil.java
  hibernate.cfg.xml
+data
build.xml</PRE>
<P>&#20877;&#27425;&#32534;&#35793;&#36825;&#20010;&#24212;&#29992;&#31243;&#24207;&#24212;&#35813;&#19981;&#20250;&#26377;&#38382;&#39064;&#12290;&#26368;&#21518;&#25105;&#20204;&#38656;&#35201;&#37197;&#32622;&#19968;&#20010;&#26085;&#24535;&#65288;logging)&#31995;&#32479; &#65293; Hibernate&#20351;&#29992;&#36890;&#29992;&#26085;&#24535;&#25509;&#21475;&#65292;&#20801;&#35768;&#20320;&#22312;Log4j&#21644;JDK 
1.4 &#26085;&#24535;&#20043;&#38388;&#36827;&#34892;&#36873;&#25321;&#12290;&#22810;&#25968;&#24320;&#21457;&#32773;&#26356;&#21916;&#27426;Log4j&#65306;&#20174;Hibernate&#30340;&#21457;&#24067;&#21253;&#20013;&#65288;&#23427;&#22312;<TT 
class=literal>etc/</TT>&#30446;&#24405;&#19979;&#65289;&#25335;&#36125;<TT class=literal>log4j.properties</TT>&#21040;&#20320;&#30340;<TT 
class=literal>src</TT>&#30446;&#24405;&#65292;&#19982;<TT 
class=literal>hibernate.cfg.xml</TT>.&#25918;&#22312;&#19968;&#36215;&#12290;&#30475;&#19968;&#19979;&#37197;&#32622;&#31034;&#20363;&#65292;&#22914;&#26524;&#20320;&#24076;&#26395;&#30475;&#21040;&#26356;&#21152;&#35814;&#32454;&#30340;&#36755;&#20986;&#20449;&#24687;&#65292;&#20320;&#21487;&#20197;&#20462;&#25913;&#37197;&#32622;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#21482;&#26377;Hibernate&#30340;&#21551;&#21160;&#20449;&#24687;&#25165;&#20250;&#26174;&#31034;&#22312;&#26631;&#20934;&#36755;&#20986;&#19978;&#12290; 
</P>
<P>&#31034;&#20363;&#30340;&#22522;&#26412;&#26694;&#26550;&#23436;&#25104;&#20102; &#65293; &#29616;&#22312;&#25105;&#20204;&#21487;&#20197;&#29992;Hibernate&#26469;&#20570;&#20123;&#30495;&#27491;&#30340;&#24037;&#20316;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-firstapp-workingpersistence></A>1.2.6.&nbsp; 
&#21152;&#36733;&#24182;&#23384;&#20648;&#23545;&#35937; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#32456;&#20110;&#21487;&#20197;&#20351;&#29992;Hibernate&#26469;&#21152;&#36733;&#21644;&#23384;&#20648;&#23545;&#35937;&#20102;&#65292;&#32534;&#20889;&#19968;&#20010;&#24102;&#26377;<TT class=literal>main()</TT>&#26041;&#27861;&#30340;<TT 
class=literal>EventManager</TT>&#31867;&#65306; </P><PRE class=programlisting>package events;
import org.hibernate.Session;

import java.util.Date;

import util.HibernateUtil;

public class EventManager {

    public static void main(String[] args) {
        EventManager mgr = new EventManager();

        if (args[0].equals("store")) {
            mgr.createAndStoreEvent("My Event", new Date());
        }

        HibernateUtil.getSessionFactory().close();
    }

    private void createAndStoreEvent(String title, Date theDate) {

        Session session = HibernateUtil.getSessionFactory().getCurrentSession();

        session.beginTransaction();

        Event theEvent = new Event();
        theEvent.setTitle(title);
        theEvent.setDate(theDate);

        session.save(theEvent);

        session.getTransaction().commit();
    }

}</PRE>
<P>&#25105;&#20204;&#21019;&#24314;&#20102;&#20010;&#26032;&#30340;<TT 
class=literal>Event</TT>&#23545;&#35937;&#24182;&#25226;&#23427;&#20256;&#36882;&#32473;Hibernate&#12290;&#29616;&#22312;Hibernate&#36127;&#36131;&#19982;SQL&#25171;&#20132;&#36947;&#65292;&#24182;&#25226;<TT 
class=literal>INSERT</TT>&#21629;&#20196;&#20256;&#32473;&#25968;&#25454;&#24211;&#12290;&#22312;&#36816;&#34892;&#20043;&#21069;&#65292;&#35753;&#25105;&#20204;&#30475;&#19968;&#19979;&#22788;&#29702;<TT 
class=literal>Session</TT>&#21644;<TT class=literal>Transaction</TT>&#30340;&#20195;&#30721;&#12290; </P>
<P>&#19968;&#20010;<TT class=literal>Session</TT>&#23601;&#26159;&#20010;&#21333;&#19968;&#30340;&#24037;&#20316;&#21333;&#20803;&#12290;&#25105;&#20204;&#26242;&#26102;&#35753;&#20107;&#24773;&#31616;&#21333;&#19968;&#20123;&#65292;&#24182;&#20551;&#35774;Hibernate<TT 
class=literal>Session</TT>&#21644;&#25968;&#25454;&#24211;&#20107;&#21153;&#26159;&#19968;&#19968;&#23545;&#24212;&#30340;&#12290;&#20026;&#20102;&#35753;&#25105;&#20204;&#30340;&#20195;&#30721;&#20174;&#24213;&#23618;&#30340;&#20107;&#21153;&#31995;&#32479;&#20013;&#33073;&#31163;&#20986;&#26469;&#65288;&#27492;&#20363;&#20013;&#26159;JDBC&#65292;&#20294;&#20063;&#21487;&#33021;&#26159;JTA&#65289;&#65292;&#25105;&#20204;&#20351;&#29992;Hibernate 
<TT class=literal>Session</TT>&#20013;&#30340;<TT class=literal>Transaction</TT> API&#12290; </P>
<P><TT class=literal>sessionFactory.getCurrentSession()</TT>&#26159;&#24178;&#20160;&#20040;&#30340;&#21602;&#65311;&#39318;&#20808;&#65292;&#21482;&#35201;&#20320;&#25345;&#26377;<TT 
class=literal>SessionFactory</TT>&#65288;&#24184;&#20111;&#25105;&#20204;&#26377;<TT 
class=literal>HibernateUtil</TT>&#65292;&#21487;&#20197;&#38543;&#26102;&#33719;&#24471;&#65289;&#65292;&#22823;&#21487;&#22312;&#20219;&#20309;&#26102;&#20505;&#12289;&#20219;&#20309;&#22320;&#28857;&#35843;&#29992;&#36825;&#20010;&#26041;&#27861;&#12290;<TT 
class=literal>getCurrentSession()</TT>&#26041;&#27861;&#24635;&#20250;&#36820;&#22238;“&#24403;&#21069;&#30340;”&#24037;&#20316;&#21333;&#20803;&#12290;&#35760;&#24471;&#25105;&#20204;&#22312;<TT 
class=literal>hibernate.cfg.xml</TT>&#20013;&#25226;&#36825;&#19968;&#37197;&#32622;&#36873;&#39033;&#35843;&#25972;&#20026;"thread"&#20102;&#21527;&#65311;&#22240;&#27492;&#65292;&#24403;&#21069;&#24037;&#20316;&#21333;&#20803;&#30340;&#33539;&#22260;&#23601;&#26159;&#24403;&#21069;&#25191;&#34892;&#25105;&#20204;&#24212;&#29992;&#31243;&#24207;&#30340;Java&#32447;&#31243;&#12290;&#20294;&#26159;&#65292;&#36825;&#24182;&#38750;&#24635;&#26159;&#27491;&#30830;&#30340;&#12290; 
<TT class=literal>Session</TT>&#22312;&#31532;&#19968;&#27425;&#34987;&#20351;&#29992;&#30340;&#26102;&#20505;,&#25110;&#32773;&#31532;&#19968;&#27425;&#35843;&#29992;<TT 
class=literal>getCurrentSession()</TT>&#30340;&#26102;&#20505;,&#20854;&#29983;&#21629;&#21608;&#26399;&#23601;&#24320;&#22987;&#12290;&#28982;&#21518;&#23427;&#34987;Hibernate&#32465;&#23450;&#21040;&#24403;&#21069;&#32447;&#31243;&#12290;&#24403;&#20107;&#21153;&#32467;&#26463;&#30340;&#26102;&#20505;&#65292;&#19981;&#31649;&#26159;&#25552;&#20132;&#36824;&#26159;&#22238;&#28378;&#65292;Hibernate&#20063;&#20250;&#25226;<TT 
class=literal>Session</TT>&#20174;&#24403;&#21069;&#32447;&#31243;&#21093;&#31163;&#65292;&#24182;&#19988;&#20851;&#38381;&#23427;&#12290;&#20551;&#33509;&#20320;&#20877;&#27425;&#35843;&#29992;<TT 
class=literal>getCurrentSession()</TT>&#65292;&#20320;&#20250;&#24471;&#21040;&#19968;&#20010;&#26032;&#30340;<TT 
class=literal>Session</TT>&#65292;&#24182;&#19988;&#24320;&#22987;&#19968;&#20010;&#26032;&#30340;&#24037;&#20316;&#21333;&#20803;&#12290;&#36825;&#31181;<SPAN 
class=emphasis><EM>&#32447;&#31243;&#32465;&#23450;(thread-bound)</EM></SPAN>&#30340;&#32534;&#31243;&#27169;&#22411;&#65288;model&#65289;&#26159;&#20351;&#29992;Hibernate&#30340;&#26368;&#24191;&#27867;&#30340;&#26041;&#24335;&#12290; 
</P>
<P>&#20851;&#20110;&#20107;&#21153;&#22788;&#29702;&#21450;&#20107;&#21153;&#36793;&#30028;&#30028;&#23450;&#30340;&#35814;&#32454;&#20449;&#24687;&#65292;&#35831;&#21442;&#30475;<A title=&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457; 
href="#transactions">&#31532;&nbsp;11&nbsp;&#31456; 
<I>&#20107;&#21153;&#21644;&#24182;&#21457;</I></A>&#12290;&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#20063;&#24573;&#30053;&#20102;&#25152;&#26377;&#30340;&#38169;&#35823;&#19982;&#22238;&#28378;&#30340;&#22788;&#29702;&#12290; </P>
<P>&#20026;&#31532;&#19968;&#27425;&#36816;&#34892;&#25105;&#20204;&#30340;&#31243;&#24207;&#65292;&#25105;&#20204;&#24471;&#22312;Ant&#30340;build&#25991;&#20214;&#20013;&#22686;&#21152;&#19968;&#20010;&#21487;&#20197;&#35843;&#29992;&#24471;&#21040;&#30340;target&#12290; </P><PRE class=programlisting>&lt;target name="run" depends="compile"&gt;
    &lt;java fork="true" classname="events.EventManager" classpathref="libraries"&gt;
        &lt;classpath path="${targetdir}"/&gt;
        &lt;arg value="${action}"/&gt;
    &lt;/java&gt;
&lt;/target&gt;</PRE>
<P><TT class=literal>action</TT>&#21442;&#25968;&#65288;argument&#65289;&#30340;&#20540;&#26159;&#36890;&#36807;&#21629;&#20196;&#34892;&#35843;&#29992;&#36825;&#20010;target&#30340;&#26102;&#20505;&#35774;&#32622;&#30340;&#65306; </P><PRE class=programlisting>C:\hibernateTutorial\&gt;ant run -Daction=store</PRE>
<P>&#20320;&#24212;&#35813;&#20250;&#30475;&#21040;&#65292;&#32534;&#35793;&#20197;&#21518;&#65292;Hibernate&#26681;&#25454;&#20320;&#30340;&#37197;&#32622;&#21551;&#21160;&#65292;&#24182;&#20135;&#29983;&#19968;&#22823;&#22534;&#30340;&#36755;&#20986;&#26085;&#24535;&#12290;&#22312;&#26085;&#24535;&#26368;&#21518;&#20320;&#20250;&#30475;&#21040;&#19979;&#38754;&#36825;&#34892;&#65306; </P><PRE class=programlisting>[java] Hibernate: insert into EVENTS (EVENT_DATE, title, EVENT_ID) values (?, ?, ?)</PRE>
<P>&#36825;&#26159;Hibernate&#25191;&#34892;&#30340;<TT 
class=literal>INSERT</TT>&#21629;&#20196;&#65292;&#38382;&#21495;&#20195;&#34920;JDBC&#30340;&#32465;&#23450;&#21442;&#25968;&#12290;&#22914;&#26524;&#24819;&#35201;&#30475;&#21040;&#32465;&#23450;&#21442;&#25968;&#30340;&#20540;&#25110;&#32773;&#20943;&#23569;&#26085;&#24535;&#30340;&#38271;&#24230;&#65292;&#23601;&#35201;&#35843;&#25972;&#20320;&#22312;<TT 
class=literal>log4j.properties</TT>&#25991;&#20214;&#37324;&#30340;&#35774;&#32622;&#12290; </P>
<P>&#25105;&#20204;&#24819;&#35201;&#21015;&#20986;&#25152;&#26377;&#24050;&#32463;&#34987;&#23384;&#20648;&#30340;events&#65292;&#23601;&#35201;&#22686;&#21152;&#19968;&#20010;&#26465;&#20214;&#20998;&#25903;&#36873;&#39033;&#21040;main&#26041;&#27861;&#20013;&#21435;&#12290; </P><PRE class=programlisting>if (args[0].equals("store")) {
    mgr.createAndStoreEvent("My Event", new Date());
}
else if (args[0].equals("list")) {
    List events = mgr.listEvents();
    for (int i = 0; i &lt; events.size(); i++) {
        Event theEvent = (Event) events.get(i);
        System.out.println("Event: " + theEvent.getTitle() +
                           " Time: " + theEvent.getDate());
    }
}</PRE>
<P>&#25105;&#20204;&#20063;&#22686;&#21152;&#19968;&#20010;&#26032;&#30340;<TT class=literal>listEvents()</TT>&#26041;&#27861;: </P><PRE class=programlisting>private List listEvents() {

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();

    session.beginTransaction();

    List result = session.createQuery("from Event").list();

    session.getTransaction().commit();

    return result;
}</PRE>
<P>&#25105;&#20204;&#22312;&#36825;&#37324;&#26159;&#29992;&#19968;&#20010;HQL&#65288;Hibernate Query Language&#65293;Hibernate&#26597;&#35810;&#35821;&#35328;&#65289;&#26597;&#35810;&#35821;&#21477;&#26469;&#20174;&#25968;&#25454;&#24211;&#20013;&#21152;&#36733;&#25152;&#26377;&#23384;&#22312;&#30340;<TT 
class=literal>Event</TT>&#23545;&#35937;&#12290;Hibernate&#20250;&#29983;&#25104;&#36866;&#24403;&#30340;SQL&#65292;&#25226;&#23427;&#21457;&#36865;&#21040;&#25968;&#25454;&#24211;&#65292;&#24182;&#25805;&#20316;&#20174;&#26597;&#35810;&#24471;&#21040;&#25968;&#25454;&#30340;<TT 
class=literal>Event</TT>&#23545;&#35937;&#12290;&#24403;&#28982;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;HQL&#26469;&#21019;&#24314;&#26356;&#21152;&#22797;&#26434;&#30340;&#26597;&#35810;&#12290; </P>
<P>&#29616;&#22312;&#65292;&#26681;&#25454;&#20197;&#19979;&#27493;&#39588;&#26469;&#25191;&#34892;&#24182;&#27979;&#35797;&#20197;&#19978;&#21508;&#39033;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#36816;&#34892;<TT class=literal>ant run 
  -Daction=store</TT>&#26469;&#20445;&#23384;&#19968;&#20123;&#20869;&#23481;&#21040;&#25968;&#25454;&#24211;&#12290;&#24403;&#28982;&#65292;&#20808;&#24471;&#29992;hbm2ddl&#26469;&#29983;&#25104;&#25968;&#25454;&#24211;schema&#12290; </P>
  <LI>
  <P>&#29616;&#22312;&#25226;<TT 
  class=literal>hibernate.cfg.xml</TT>&#25991;&#20214;&#20013;hbm2ddl&#23646;&#24615;&#27880;&#37322;&#25481;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#21462;&#28040;&#20102;&#22312;&#21551;&#21160;&#26102;&#29992;hbm2ddl&#26469;&#29983;&#25104;&#25968;&#25454;&#24211;schema&#12290;&#36890;&#24120;&#21482;&#26377;&#22312;&#19981;&#26029;&#37325;&#22797;&#36827;&#34892;&#21333;&#20803;&#27979;&#35797;&#30340;&#26102;&#20505;&#25165;&#38656;&#35201;&#25171;&#24320;&#23427;&#65292;&#20294;&#20877;&#27425;&#36816;&#34892;hbm2ddl&#20250;&#25226;&#20320;&#20445;&#23384;&#30340;&#19968;&#20999;&#37117;&#21024;&#25481;&#65288;<SPAN 
  class=emphasis><EM>drop</EM></SPAN>&#65289;——<TT 
  class=literal>create</TT>&#37197;&#32622;&#30340;&#30495;&#23454;&#21547;&#20041;&#26159;&#65306;“&#22312;&#21019;&#24314;SessionFactory&#30340;&#26102;&#20505;&#65292;&#20174;schema &#20013;drop 
  &#25481;&#25152;&#26377;&#30340;&#34920;&#65292;&#20877;&#37325;&#26032;&#21019;&#24314;&#23427;&#20204;”&#12290; </P></LI></UL></DIV>
<P>&#22914;&#26524;&#20320;&#29616;&#22312;&#20351;&#29992;&#21629;&#20196;&#34892;&#21442;&#25968;<TT 
class=literal>-Daction=list</TT>&#36816;&#34892;Ant&#65292;&#20320;&#20250;&#30475;&#21040;&#37027;&#20123;&#33267;&#20170;&#20026;&#27490;&#25105;&#20204;&#25152;&#20648;&#23384;&#30340;events&#12290;&#24403;&#28982;&#65292;&#20320;&#20063;&#21487;&#20197;&#22810;&#35843;&#29992;&#20960;&#27425;<TT 
class=literal>store</TT>&#20197;&#20445;&#23384;&#26356;&#22810;&#30340;envents&#12290; </P>
<P>&#27880;&#24847;&#65292;&#24456;&#22810;Hibernate&#26032;&#25163;&#22312;&#36825;&#19968;&#27493;&#20250;&#22833;&#36133;&#65292;&#25105;&#20204;&#19981;&#26102;&#30475;&#21040;&#20851;&#20110;<SPAN class=emphasis><EM>Table not 
found</EM></SPAN>&#38169;&#35823;&#20449;&#24687;&#30340;&#25552;&#38382;&#12290;&#20294;&#26159;&#65292;&#21482;&#35201;&#20320;&#26681;&#25454;&#19978;&#38754;&#25551;&#36848;&#30340;&#27493;&#39588;&#26469;&#25191;&#34892;&#65292;&#23601;&#19981;&#20250;&#26377;&#36825;&#20010;&#38382;&#39064;&#65292;&#22240;&#20026;hbm2ddl&#20250;&#22312;&#31532;&#19968;&#27425;&#36816;&#34892;&#30340;&#26102;&#20505;&#21019;&#24314;&#25968;&#25454;&#24211;schema&#65292;&#21518;&#32487;&#30340;&#24212;&#29992;&#31243;&#24207;&#37325;&#36215;&#21518;&#36824;&#33021;&#32487;&#32493;&#20351;&#29992;&#36825;&#20010;schema&#12290;&#20551;&#33509;&#20320;&#20462;&#25913;&#20102;&#26144;&#23556;&#65292;&#25110;&#32773;&#20462;&#25913;&#20102;&#25968;&#25454;&#24211;schema&#65292;&#20320;&#24517;&#39035;&#25226;hbm2ddl&#37325;&#26032;&#25171;&#24320;&#19968;&#27425;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=tutorial-associations></A>1.3.&nbsp; 
&#31532;&#20108;&#37096;&#20998; &#65293; &#20851;&#32852;&#26144;&#23556; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#24050;&#32463;&#26144;&#23556;&#20102;&#19968;&#20010;&#25345;&#20037;&#21270;&#23454;&#20307;&#31867;&#21040;&#34920;&#19978;&#12290;&#35753;&#25105;&#20204;&#22312;&#36825;&#20010;&#22522;&#30784;&#19978;&#22686;&#21152;&#19968;&#20123;&#31867;&#20043;&#38388;&#30340;&#20851;&#32852;&#12290;&#39318;&#20808;&#25105;&#20204;&#24448;&#24212;&#29992;&#31243;&#24207;&#37324;&#22686;&#21152;&#20154;&#65288;people&#65289;&#30340;&#27010;&#24565;&#65292;&#24182;&#23384;&#20648;&#20182;&#20204;&#25152;&#21442;&#19982;&#30340;&#19968;&#20010;Event&#21015;&#34920;&#12290;&#65288;&#35793;&#32773;&#27880;&#65306;&#19982;Event&#19968;&#26679;&#65292;&#25105;&#20204;&#22312;&#21518;&#38754;&#23558;&#30452;&#25509;&#20351;&#29992;person&#26469;&#34920;&#31034;“&#20154;”&#32780;&#19981;&#26159;&#23427;&#30340;&#20013;&#25991;&#32763;&#35793;&#65289; 
</P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-mappinguser></A>1.3.1.&nbsp; 
&#26144;&#23556;Person&#31867; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26368;&#21021;&#31616;&#21333;&#30340;<TT class=literal>Person</TT>&#31867;&#65306; </P><PRE class=programlisting>package events;

public class Person {

    private Long id;
    private int age;
    private String firstname;
    private String lastname;

    public Person() {}

    // Accessor methods for all properties, private setter for 'id'

}</PRE>
<P>&#21019;&#24314;&#19968;&#20010;&#21517;&#20026;<TT class=literal>Person.hbm.xml</TT>&#30340;&#26032;&#26144;&#23556;&#25991;&#20214;&#65288;&#21035;&#24536;&#20102;&#26368;&#19978;&#38754;&#30340;DTD&#24341;&#29992;&#65289;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="events.Person" table="PERSON"&gt;
        &lt;id name="id" column="PERSON_ID"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="age"/&gt;
        &lt;property name="firstname"/&gt;
        &lt;property name="lastname"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#26368;&#21518;&#65292;&#25226;&#26032;&#30340;&#26144;&#23556;&#21152;&#20837;&#21040;Hibernate&#30340;&#37197;&#32622;&#20013;&#65306; </P><PRE class=programlisting>&lt;mapping resource="events/Event.hbm.xml"/&gt;
&lt;mapping resource="events/Person.hbm.xml"/&gt;</PRE>
<P>&#29616;&#22312;&#25105;&#20204;&#22312;&#36825;&#20004;&#20010;&#23454;&#20307;&#20043;&#38388;&#21019;&#24314;&#19968;&#20010;&#20851;&#32852;&#12290;&#26174;&#28982;&#65292;persons&#21487;&#20197;&#21442;&#19982;&#19968;&#31995;&#21015;events&#65292;&#32780;events&#20063;&#26377;&#19981;&#21516;&#30340;&#21442;&#21152;&#32773;&#65288;persons&#65289;&#12290;&#25105;&#20204;&#38656;&#35201;&#22788;&#29702;&#30340;&#35774;&#35745;&#38382;&#39064;&#26159;&#20851;&#32852;&#26041;&#21521;&#65288;directionality&#65289;&#65292;&#38454;&#25968;&#65288;multiplicity&#65289;&#21644;&#38598;&#21512;&#65288;collection&#65289;&#30340;&#34892;&#20026;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-unidirset></A>1.3.2.&nbsp; 
&#21333;&#21521;Set-based&#30340;&#20851;&#32852; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#23558;&#21521;<TT class=literal>Person</TT>&#31867;&#22686;&#21152;&#19968;&#36830;&#20018;&#30340;events&#12290;&#37027;&#26679;&#65292;&#36890;&#36807;&#35843;&#29992;<TT 
class=literal>aPerson.getEvents()</TT>&#65292;&#23601;&#21487;&#20197;&#36731;&#26494;&#22320;&#23548;&#33322;&#21040;&#29305;&#23450;person&#25152;&#21442;&#19982;&#30340;events&#65292;&#32780;&#19981;&#29992;&#21435;&#25191;&#34892;&#19968;&#20010;&#26174;&#24335;&#30340;&#26597;&#35810;&#12290;&#25105;&#20204;&#20351;&#29992;Java&#30340;&#38598;&#21512;&#31867;&#65288;collection&#65289;&#65306;<TT 
class=literal>Set</TT>&#65292;&#22240;&#20026;set &#19981;&#21253;&#21547;&#37325;&#22797;&#30340;&#20803;&#32032;&#21450;&#19982;&#25105;&#20204;&#26080;&#20851;&#30340;&#25490;&#24207;&#12290; </P>
<P>&#25105;&#20204;&#38656;&#35201;&#29992;set &#23454;&#29616;&#19968;&#20010;&#21333;&#21521;&#22810;&#20540;&#20851;&#32852;&#12290;&#35753;&#25105;&#20204;&#22312;Java&#31867;&#37324;&#20026;&#36825;&#20010;&#20851;&#32852;&#32534;&#30721;&#65292;&#25509;&#30528;&#26144;&#23556;&#23427;&#65306; </P><PRE class=programlisting>public class Person {

    private Set events = new HashSet();

    public Set getEvents() {
        return events;
    }

    public void setEvents(Set events) {
        this.events = events;
    }
}</PRE>
<P>&#22312;&#26144;&#23556;&#36825;&#20010;&#20851;&#32852;&#20043;&#21069;&#65292;&#20808;&#32771;&#34385;&#19968;&#19979;&#27492;&#20851;&#32852;&#30340;&#21478;&#22806;&#19968;&#31471;&#12290;&#24456;&#26174;&#28982;&#65292;&#25105;&#20204;&#21487;&#20197;&#20445;&#25345;&#36825;&#20010;&#20851;&#32852;&#26159;&#21333;&#21521;&#30340;&#12290;&#25110;&#32773;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;<TT 
class=literal>Event</TT>&#37324;&#21019;&#24314;&#21478;&#22806;&#19968;&#20010;&#38598;&#21512;&#65292;&#22914;&#26524;&#24076;&#26395;&#33021;&#22815;&#21452;&#21521;&#22320;&#23548;&#33322;&#65292;&#22914;&#65306;<TT 
class=literal>anEvent.getParticipants()</TT>&#12290;&#20174;&#21151;&#33021;&#30340;&#35282;&#24230;&#26469;&#35828;&#65292;&#36825;&#24182;&#19981;&#26159;&#24517;&#39035;&#30340;&#12290;&#22240;&#20026;&#20320;&#24635;&#21487;&#20197;&#26174;&#24335;&#22320;&#25191;&#34892;&#19968;&#20010;&#26597;&#35810;&#65292;&#20197;&#33719;&#24471;&#26576;&#20010;&#29305;&#23450;event&#30340;&#25152;&#26377;&#21442;&#19982;&#32773;&#12290;&#36825;&#26159;&#20010;&#22312;&#35774;&#35745;&#26102;&#38656;&#35201;&#20570;&#20986;&#30340;&#36873;&#25321;&#65292;&#23436;&#20840;&#30001;&#20320;&#26469;&#20915;&#23450;&#65292;&#20294;&#27492;&#35752;&#35770;&#20013;&#20851;&#20110;&#20851;&#32852;&#30340;&#38454;&#25968;&#26159;&#28165;&#26970;&#30340;&#65306;&#21363;&#20004;&#31471;&#37117;&#26159;“&#22810;”&#20540;&#30340;&#65292;&#25105;&#20204;&#25226;&#23427;&#21483;&#20570;<SPAN 
class=emphasis><EM>&#22810;&#23545;&#22810;(many-to-many)</EM></SPAN>&#20851;&#32852;&#12290;&#22240;&#32780;&#65292;&#25105;&#20204;&#20351;&#29992;Hibernate&#30340;&#22810;&#23545;&#22810;&#26144;&#23556;&#65306; </P><PRE class=programlisting>&lt;class name="events.Person" table="PERSON"&gt;
    &lt;id name="id" column="PERSON_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="age"/&gt;
    &lt;property name="firstname"/&gt;
    &lt;property name="lastname"/&gt;

    &lt;set name="events" table="PERSON_EVENT"&gt;
        &lt;key column="PERSON_ID"/&gt;
        &lt;many-to-many column="EVENT_ID" class="events.Event"/&gt;
    &lt;/set&gt;

&lt;/class&gt;</PRE>
<P>Hibernate&#25903;&#25345;&#21508;&#31181;&#21508;&#26679;&#30340;&#38598;&#21512;&#26144;&#23556;&#65292;<TT 
class=literal>&lt;set&gt;</TT>&#20351;&#29992;&#30340;&#26368;&#20026;&#26222;&#36941;&#12290;&#23545;&#20110;&#22810;&#23545;&#22810;&#20851;&#32852;&#65288;&#25110;&#21483;<SPAN 
class=emphasis><EM>n:m</EM></SPAN>&#23454;&#20307;&#20851;&#31995;&#65289;, &#38656;&#35201;&#19968;&#20010;&#20851;&#32852;&#34920;&#65288;association table&#65289;&#12290;<TT 
class=literal>&#34920;</TT>&#37324;&#38754;&#30340;&#27599;&#19968;&#34892;&#20195;&#34920;&#20174;person&#21040;event&#30340;&#19968;&#20010;&#20851;&#32852;&#12290;&#34920;&#21517;&#26159;&#30001;<TT 
class=literal>set</TT>&#20803;&#32032;&#30340;<TT 
class=literal>table</TT>&#23646;&#24615;&#37197;&#32622;&#30340;&#12290;&#20851;&#32852;&#37324;&#38754;&#30340;&#26631;&#35782;&#31526;&#23383;&#27573;&#21517;&#65292;&#23545;&#20110;person&#30340;&#19968;&#31471;&#65292;&#26159;&#30001;<TT 
class=literal>&lt;key&gt;</TT>&#20803;&#32032;&#23450;&#20041;&#65292;&#32780;event&#19968;&#31471;&#30340;&#23383;&#27573;&#21517;&#26159;&#30001;<TT 
class=literal>&lt;many-to-many&gt;</TT>&#20803;&#32032;&#30340;<TT 
class=literal>column</TT>&#23646;&#24615;&#23450;&#20041;&#12290;&#20320;&#20063;&#24517;&#39035;&#21578;&#35785;Hibernate&#38598;&#21512;&#20013;&#23545;&#35937;&#30340;&#31867;&#65288;&#20063;&#23601;&#26159;&#20301;&#20110;&#36825;&#20010;&#38598;&#21512;&#25152;&#20195;&#34920;&#30340;&#20851;&#32852;&#21478;&#22806;&#19968;&#31471;&#30340;&#31867;&#65289;&#12290; 
</P>
<P>&#22240;&#32780;&#36825;&#20010;&#26144;&#23556;&#30340;&#25968;&#25454;&#24211;schema&#26159;&#65306; </P><PRE class=programlisting>    _____________        __________________
   |             |      |                  |       _____________
   |   EVENTS    |      |   PERSON_EVENT   |      |             |
   |_____________|      |__________________|      |    PERSON   |
   |             |      |                  |      |_____________|
   | *EVENT_ID   | &lt;--&gt; | *EVENT_ID        |      |             |
   |  EVENT_DATE |      | *PERSON_ID       | &lt;--&gt; | *PERSON_ID  |
   |  TITLE      |      |__________________|      |  AGE        |
   |_____________|                                |  FIRSTNAME  |
                                                  |  LASTNAME   |
                                                  |_____________|
 </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-working></A>1.3.3.&nbsp; &#20351;&#20851;&#32852;&#24037;&#20316; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#25226;&#19968;&#20123;people&#21644;events &#19968;&#36215;&#25918;&#21040;<TT class=literal>EventManager</TT>&#30340;&#26032;&#26041;&#27861;&#20013;&#65306; </P><PRE class=programlisting>private void addPersonToEvent(Long personId, Long eventId) {

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();

    Person aPerson = (Person) session.load(Person.class, personId);
    Event anEvent = (Event) session.load(Event.class, eventId);

    aPerson.getEvents().add(anEvent);

    session.getTransaction().commit();
}</PRE>
<P>&#22312;&#21152;&#36733;&#19968;<TT class=literal>Person</TT>&#21644;<TT 
class=literal>Event</TT>&#21518;&#65292;&#20351;&#29992;&#26222;&#36890;&#30340;&#38598;&#21512;&#26041;&#27861;&#23601;&#21487;&#23481;&#26131;&#22320;&#20462;&#25913;&#25105;&#20204;&#23450;&#20041;&#30340;&#38598;&#21512;&#12290;&#22914;&#20320;&#25152;&#35265;&#65292;&#27809;&#26377;&#26174;&#24335;&#30340;<TT 
class=literal>update()</TT>&#25110;<TT 
class=literal>save()</TT>&#65292;Hibernate&#20250;&#33258;&#21160;&#26816;&#27979;&#21040;&#38598;&#21512;&#24050;&#32463;&#34987;&#20462;&#25913;&#24182;&#38656;&#35201;&#26356;&#26032;&#22238;&#25968;&#25454;&#24211;&#12290;&#36825;&#21483;&#20570;&#33258;&#21160;&#33039;&#26816;&#26597;&#65288;<SPAN 
class=emphasis><EM>automatic dirty 
checking</EM></SPAN>&#65289;&#65292;&#20320;&#20063;&#21487;&#20197;&#23581;&#35797;&#20462;&#25913;&#20219;&#20309;&#23545;&#35937;&#30340;name&#25110;&#32773;date&#23646;&#24615;&#65292;&#21482;&#35201;&#20182;&#20204;&#22788;&#20110;<SPAN 
class=emphasis><EM>&#25345;&#20037;&#21270;</EM></SPAN>&#29366;&#24577;&#65292;&#20063;&#23601;&#26159;&#34987;&#32465;&#23450;&#21040;&#26576;&#20010;Hibernate &#30340;<TT 
class=literal>Session</TT>&#19978;&#65288;&#22914;&#65306;&#20182;&#20204;&#21018;&#21018;&#22312;&#19968;&#20010;&#21333;&#20803;&#25805;&#20316;&#34987;&#21152;&#36733;&#25110;&#32773;&#20445;&#23384;&#65289;&#65292;Hibernate&#30417;&#35270;&#20219;&#20309;&#25913;&#21464;&#24182;&#22312;&#21518;&#21488;&#38544;&#24335;&#20889;&#30340;&#26041;&#24335;&#25191;&#34892;SQL&#12290;&#21516;&#27493;&#20869;&#23384;&#29366;&#24577;&#21644;&#25968;&#25454;&#24211;&#30340;&#36807;&#31243;&#65292;&#36890;&#24120;&#21482;&#22312;&#21333;&#20803;&#25805;&#20316;&#32467;&#26463;&#30340;&#26102;&#20505;&#21457;&#29983;&#65292;&#31216;&#27492;&#36807;&#31243;&#20026;&#28165;&#29702;&#32531;&#23384;<SPAN 
class=emphasis><EM>&#65288;flushing&#65289;</EM></SPAN>&#12290;&#22312;&#25105;&#20204;&#30340;&#20195;&#30721;&#20013;&#65292;&#24037;&#20316;&#21333;&#20803;&#30001;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#25552;&#20132;&#65288;&#25110;&#32773;&#22238;&#28378;&#65289;&#26469;&#32467;&#26463;——&#36825;&#26159;&#30001;<TT 
class=literal>CurrentSessionContext</TT>&#31867;&#30340;<TT class=literal>thread</TT>&#37197;&#32622;&#36873;&#39033;&#23450;&#20041;&#30340;&#12290; 
</P>
<P>&#24403;&#28982;&#65292;&#20320;&#20063;&#21487;&#20197;&#22312;&#19981;&#21516;&#30340;&#21333;&#20803;&#25805;&#20316;&#37324;&#38754;&#21152;&#36733;person&#21644;event&#12290;&#25110;&#22312;<TT 
class=literal>Session</TT>&#20197;&#22806;&#20462;&#25913;&#19981;&#26159;&#22788;&#22312;&#25345;&#20037;&#21270;&#65288;persistent&#65289;&#29366;&#24577;&#19979;&#30340;&#23545;&#35937;&#65288;&#22914;&#26524;&#35813;&#23545;&#35937;&#20197;&#21069;&#26366;&#32463;&#34987;&#25345;&#20037;&#21270;&#65292;&#37027;&#20040;&#25105;&#20204;&#31216;&#36825;&#20010;&#29366;&#24577;&#20026;<SPAN 
class=emphasis><EM>&#33073;&#31649;&#65288;detached&#65289;</EM></SPAN>&#65289;&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#22312;&#19968;&#20010;&#38598;&#21512;&#34987;&#33073;&#31649;&#26102;&#20462;&#25913;&#23427;&#65306; </P><PRE class=programlisting>private void addPersonToEvent(Long personId, Long eventId) {

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();

    Person aPerson = (Person) session
            .createQuery("select p from Person p left join fetch p.events where p.id = :pid")
            .setParameter("pid", personId)
            .uniqueResult(); // Eager fetch the collection so we can use it detached

    Event anEvent = (Event) session.load(Event.class, eventId);

    session.getTransaction().commit();

    // End of first unit of work

    aPerson.getEvents().add(anEvent); // aPerson (and its collection) is detached

    // Begin second unit of work

    Session session2 = HibernateUtil.getSessionFactory().getCurrentSession();
    session2.beginTransaction();

    session2.update(aPerson); // Reattachment of aPerson

    session2.getTransaction().commit();
}</PRE>
<P>&#23545;<TT 
class=literal>update</TT>&#30340;&#35843;&#29992;&#20351;&#19968;&#20010;&#33073;&#31649;&#23545;&#35937;&#37325;&#26032;&#25345;&#20037;&#21270;&#65292;&#20320;&#21487;&#20197;&#35828;&#23427;&#34987;&#32465;&#23450;&#21040;&#19968;&#20010;&#26032;&#30340;&#21333;&#20803;&#25805;&#20316;&#19978;&#65292;&#25152;&#20197;&#22312;&#33073;&#31649;&#29366;&#24577;&#19979;&#23545;&#23427;&#25152;&#20570;&#30340;&#20219;&#20309;&#20462;&#25913;&#37117;&#20250;&#34987;&#20445;&#23384;&#21040;&#25968;&#25454;&#24211;&#37324;&#12290;&#36825;&#20063;&#21253;&#25324;&#20320;&#23545;&#36825;&#20010;&#23454;&#20307;&#23545;&#35937;&#30340;&#38598;&#21512;&#25152;&#20316;&#30340;&#20219;&#20309;&#25913;&#21160;&#65288;&#22686;&#21152;/&#21024;&#38500;&#65289;&#12290; 
</P>
<P>&#36825;&#23545;&#25105;&#20204;&#24403;&#21069;&#30340;&#24773;&#24418;&#19981;&#26159;&#24456;&#26377;&#29992;&#65292;&#20294;&#23427;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#27010;&#24565;&#65292;&#20320;&#21487;&#20197;&#25226;&#23427;&#34701;&#20837;&#21040;&#20320;&#33258;&#24049;&#30340;&#24212;&#29992;&#31243;&#24207;&#35774;&#35745;&#20013;&#12290;&#22312;<TT 
class=literal>EventManager</TT>&#30340;main&#26041;&#27861;&#20013;&#28155;&#21152;&#19968;&#20010;&#26032;&#30340;&#21160;&#20316;&#65292;&#24182;&#20174;&#21629;&#20196;&#34892;&#36816;&#34892;&#23427;&#26469;&#23436;&#25104;&#25105;&#20204;&#25152;&#20570;&#30340;&#32451;&#20064;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;person&#21450;event&#30340;&#26631;&#35782;&#31526; 
— &#37027;&#23601;&#29992;<TT class=literal>save()</TT>&#26041;&#27861;&#36820;&#22238;&#23427;&#65288;&#20320;&#21487;&#33021;&#38656;&#35201;&#20462;&#25913;&#21069;&#38754;&#30340;&#19968;&#20123;&#26041;&#27861;&#26469;&#36820;&#22238;&#37027;&#20010;&#26631;&#35782;&#31526;&#65289;&#65306; </P><PRE class=programlisting>else if (args[0].equals("addpersontoevent")) {
    Long eventId = mgr.createAndStoreEvent("My Event", new Date());
    Long personId = mgr.createAndStorePerson("Foo", "Bar");
    mgr.addPersonToEvent(personId, eventId);
    System.out.println("Added person " + personId + " to event " + eventId);</PRE>
<P>&#19978;&#38754;&#26159;&#20010;&#20851;&#20110;&#20004;&#20010;&#21516;&#31561;&#37325;&#35201;&#30340;&#23454;&#20307;&#31867;&#38388;&#20851;&#32852;&#30340;&#20363;&#23376;&#12290;&#20687;&#21069;&#38754;&#25152;&#25552;&#21040;&#30340;&#37027;&#26679;&#65292;&#22312;&#29305;&#23450;&#30340;&#27169;&#22411;&#20013;&#20063;&#23384;&#22312;&#20854;&#23427;&#30340;&#31867;&#21644;&#31867;&#22411;&#65292;&#36825;&#20123;&#31867;&#21644;&#31867;&#22411;&#36890;&#24120;&#26159;“&#27425;&#35201;&#30340;”&#12290;&#20320;&#24050;&#30475;&#21040;&#36807;&#20854;&#20013;&#30340;&#19968;&#20123;&#65292;&#20687;<TT 
class=literal>int</TT>&#25110;<TT class=literal>String</TT>&#12290;&#25105;&#20204;&#31216;&#36825;&#20123;&#31867;&#20026;<SPAN 
class=emphasis><EM>&#20540;&#31867;&#22411;&#65288;value type&#65289;</EM></SPAN>&#65292;&#23427;&#20204;&#30340;&#23454;&#20363;<SPAN 
class=emphasis><EM>&#20381;&#36182;&#65288;depend&#65289;</EM></SPAN>&#22312;&#26576;&#20010;&#29305;&#23450;&#30340;&#23454;&#20307;&#19978;&#12290;&#36825;&#20123;&#31867;&#22411;&#30340;&#23454;&#20363;&#27809;&#26377;&#23427;&#20204;&#33258;&#24049;&#30340;&#26631;&#35782;&#65288;identity&#65289;&#65292;&#20063;&#19981;&#33021;&#22312;&#23454;&#20307;&#38388;&#34987;&#20849;&#20139;&#65288;&#27604;&#22914;&#65292;&#20004;&#20010;person&#19981;&#33021;&#24341;&#29992;&#21516;&#19968;&#20010;<TT 
class=literal>firstname</TT>&#23545;&#35937;&#65292;&#21363;&#20351;&#20182;&#20204;&#26377;&#30456;&#21516;&#30340;first 
name&#65289;&#12290;&#24403;&#28982;&#65292;&#20540;&#31867;&#22411;&#24182;&#19981;&#20165;&#20165;&#22312;JDK&#20013;&#23384;&#22312;&#65288;&#20107;&#23454;&#19978;&#65292;&#22312;&#19968;&#20010;Hibernate&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#25152;&#26377;&#30340;JDK&#31867;&#37117;&#34987;&#35270;&#20026;&#20540;&#31867;&#22411;&#65289;&#65292;&#32780;&#19988;&#20320;&#20063;&#21487;&#20197;&#32534;&#20889;&#20320;&#33258;&#24049;&#30340;&#20381;&#36182;&#31867;&#65292;&#20363;&#22914;<TT 
class=literal>Address</TT>&#65292;<TT class=literal>MonetaryAmount</TT>&#12290; </P>
<P>&#20320;&#20063;&#21487;&#20197;&#35774;&#35745;&#19968;&#20010;&#20540;&#31867;&#22411;&#30340;&#38598;&#21512;&#65292;&#36825;&#22312;&#27010;&#24565;&#19978;&#19982;&#24341;&#29992;&#20854;&#23427;&#23454;&#20307;&#30340;&#38598;&#21512;&#26377;&#24456;&#22823;&#30340;&#19981;&#21516;&#65292;&#20294;&#26159;&#22312;Java&#37324;&#38754;&#30475;&#36215;&#26469;&#20960;&#20046;&#26159;&#19968;&#26679;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-valuecollections></A>1.3.4.&nbsp; 
&#20540;&#31867;&#22411;&#30340;&#38598;&#21512; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#25226;&#19968;&#20010;&#20540;&#31867;&#22411;&#23545;&#35937;&#30340;&#38598;&#21512;&#21152;&#20837;<TT class=literal>Person</TT>&#23454;&#20307;&#20013;&#12290;&#25105;&#20204;&#24076;&#26395;&#20445;&#23384;email&#22320;&#22336;&#65292;&#25152;&#20197;&#20351;&#29992;<TT 
class=literal>String</TT>&#31867;&#22411;&#65292;&#32780;&#19988;&#36825;&#27425;&#30340;&#38598;&#21512;&#31867;&#22411;&#21448;&#26159;<TT class=literal>Set</TT>&#65306; </P><PRE class=programlisting>private Set emailAddresses = new HashSet();

public Set getEmailAddresses() {
    return emailAddresses;
}

public void setEmailAddresses(Set emailAddresses) {
    this.emailAddresses = emailAddresses;
}</PRE>
<P>&#36825;&#20010;<TT class=literal>Set</TT>&#30340;&#26144;&#23556; </P><PRE class=programlisting>&lt;set name="emailAddresses" table="PERSON_EMAIL_ADDR"&gt;
    &lt;key column="PERSON_ID"/&gt;
    &lt;element type="string" column="EMAIL_ADDR"/&gt;
&lt;/set&gt;</PRE>
<P>&#27604;&#36739;&#36825;&#27425;&#21644;&#27492;&#21069;&#26144;&#23556;&#30340;&#24046;&#21035;&#65292;&#20027;&#35201;&#22312;&#20110;<TT 
class=literal>element</TT>&#37096;&#20998;&#65292;&#36825;&#27425;&#24182;&#27809;&#26377;&#21253;&#21547;&#23545;&#20854;&#23427;&#23454;&#20307;&#24341;&#29992;&#30340;&#38598;&#21512;&#65292;&#32780;&#26159;&#20803;&#32032;&#31867;&#22411;&#20026;<TT 
class=literal>String</TT>&#30340;&#38598;&#21512;&#65288;&#22312;&#26144;&#23556;&#20013;&#20351;&#29992;&#23567;&#20889;&#30340;&#21517;&#23383;”string“&#26159;&#21521;&#20320;&#34920;&#26126;&#23427;&#26159;&#19968;&#20010;Hibernate&#30340;&#26144;&#23556;&#31867;&#22411;&#25110;&#32773;&#31867;&#22411;&#36716;&#25442;&#22120;&#65289;&#12290;&#21644;&#20043;&#21069;&#19968;&#26679;&#65292;<TT 
class=literal>set</TT>&#20803;&#32032;&#30340;<TT class=literal>table</TT>&#23646;&#24615;&#20915;&#23450;&#20102;&#29992;&#20110;&#38598;&#21512;&#30340;&#34920;&#21517;&#12290;<TT 
class=literal>key</TT>&#20803;&#32032;&#23450;&#20041;&#20102;&#22312;&#38598;&#21512;&#34920;&#20013;&#22806;&#38190;&#30340;&#23383;&#27573;&#21517;&#12290;<TT class=literal>element</TT>&#20803;&#32032;&#30340;<TT 
class=literal>column</TT>&#23646;&#24615;&#23450;&#20041;&#29992;&#20110;&#23454;&#38469;&#20445;&#23384;<TT class=literal>String</TT>&#20540;&#30340;&#23383;&#27573;&#21517;&#12290; </P>
<P>&#30475;&#19968;&#19979;&#20462;&#25913;&#21518;&#30340;&#25968;&#25454;&#24211;schema&#12290; </P><PRE class=programlisting>  _____________        __________________
 |             |      |                  |       _____________
 |   EVENTS    |      |   PERSON_EVENT   |      |             |       ___________________
 |_____________|      |__________________|      |    PERSON   |      |                   |
 |             |      |                  |      |_____________|      | PERSON_EMAIL_ADDR |
 | *EVENT_ID   | &lt;--&gt; | *EVENT_ID        |      |             |      |___________________|
 |  EVENT_DATE |      | *PERSON_ID       | &lt;--&gt; | *PERSON_ID  | &lt;--&gt; |  *PERSON_ID       |
 |  TITLE      |      |__________________|      |  AGE        |      |  *EMAIL_ADDR      |
 |_____________|                                |  FIRSTNAME  |      |___________________|
                                                |  LASTNAME   |
                                                |_____________|
 </PRE>
<P>&#20320;&#21487;&#20197;&#30475;&#21040;&#38598;&#21512;&#34920;&#30340;&#20027;&#38190;&#23454;&#38469;&#19978;&#26159;&#20010;&#22797;&#21512;&#20027;&#38190;&#65292;&#21516;&#26102;&#20351;&#29992;&#20102;2&#20010;&#23383;&#27573;&#12290;&#36825;&#20063;&#26263;&#31034;&#20102;&#23545;&#20110;&#21516;&#19968;&#20010;person&#19981;&#33021;&#26377;&#37325;&#22797;&#30340;email&#22320;&#22336;&#65292;&#36825;&#27491;&#26159;Java&#37324;&#38754;&#20351;&#29992;Set&#26102;&#20505;&#25152;&#38656;&#35201;&#30340;&#35821;&#20041;&#65288;Set&#37324;&#20803;&#32032;&#19981;&#33021;&#37325;&#22797;&#65289;&#12290; 
</P>
<P>&#20320;&#29616;&#22312;&#21487;&#20197;&#35797;&#30528;&#25226;&#20803;&#32032;&#21152;&#20837;&#21040;&#36825;&#20010;&#38598;&#21512;&#65292;&#23601;&#20687;&#25105;&#20204;&#22312;&#20043;&#21069;&#20851;&#32852;person&#21644;event&#30340;&#37027;&#26679;&#12290;&#20854;&#23454;&#29616;&#30340;Java&#20195;&#30721;&#26159;&#30456;&#21516;&#30340;&#65306; </P><PRE class=programlisting>private void addEmailToPerson(Long personId, String emailAddress) {

    Session session = HibernateUtil.getSessionFactory().getCurrentSession();
    session.beginTransaction();

    Person aPerson = (Person) session.load(Person.class, personId);

    // The getEmailAddresses() might trigger a lazy load of the collection
    aPerson.getEmailAddresses().add(emailAddress);

    session.getTransaction().commit();
}</PRE>
<P>&#36825;&#27425;&#25105;&#20204;&#27809;&#26377;&#20351;&#29992;<SPAN 
class=emphasis><EM>fetch</EM></SPAN>&#26597;&#35810;&#26469;&#21021;&#22987;&#21270;&#38598;&#21512;&#12290;&#22240;&#27492;&#65292;&#35843;&#29992;&#20854;getter&#26041;&#27861;&#20250;&#35302;&#21457;&#21478;&#19968;&#38468;&#21152;&#30340;select&#26469;&#21021;&#22987;&#21270;&#38598;&#21512;&#65292;&#36825;&#26679;&#25105;&#20204;&#25165;&#33021;&#25226;&#20803;&#32032;&#28155;&#21152;&#36827;&#21435;&#12290;&#26816;&#26597;SQL 
log&#65292;&#35797;&#30528;&#36890;&#36807;&#39044;&#20808;&#25235;&#21462;&#26469;&#20248;&#21270;&#23427;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-bidirectional></A>1.3.5.&nbsp; 
&#21452;&#21521;&#20851;&#32852; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25509;&#19979;&#26469;&#25105;&#20204;&#23558;&#26144;&#23556;&#21452;&#21521;&#20851;&#32852;&#65288;bi-directional association&#65289;&#65293; 
&#22312;Java&#37324;&#35753;person&#21644;event&#21487;&#20197;&#20174;&#20851;&#32852;&#30340;&#20219;&#20309;&#19968;&#31471;&#35775;&#38382;&#21478;&#19968;&#31471;&#12290;&#24403;&#28982;&#65292;&#25968;&#25454;&#24211;schema&#27809;&#26377;&#25913;&#21464;&#65292;&#25105;&#20204;&#20173;&#28982;&#38656;&#35201;&#22810;&#23545;&#22810;&#30340;&#38454;&#25968;&#12290;&#19968;&#20010;&#20851;&#31995;&#22411;&#25968;&#25454;&#24211;&#35201;&#27604;&#32593;&#32476;&#32534;&#31243;&#35821;&#35328; 
&#26356;&#21152;&#28789;&#27963;&#65292;&#25152;&#20197;&#23427;&#24182;&#19981;&#38656;&#35201;&#20219;&#20309;&#20687;&#23548;&#33322;&#26041;&#21521;&#65288;navigation direction&#65289;&#30340;&#19996;&#35199; &#65293; &#25968;&#25454;&#21487;&#20197;&#29992;&#20219;&#20309;&#21487;&#33021;&#30340;&#26041;&#24335;&#36827;&#34892;&#26597;&#30475;&#21644;&#33719;&#21462;&#12290; </P>
<P>&#39318;&#20808;&#65292;&#25226;&#19968;&#20010;&#21442;&#19982;&#32773;&#65288;person&#65289;&#30340;&#38598;&#21512;&#21152;&#20837;<TT class=literal>Event</TT>&#31867;&#20013;&#65306; </P><PRE class=programlisting>private Set participants = new HashSet();

public Set getParticipants() {
    return participants;
}

public void setParticipants(Set participants) {
    this.participants = participants;
}</PRE>
<P>&#22312;<TT class=literal>Event.hbm.xml</TT>&#37324;&#38754;&#20063;&#26144;&#23556;&#36825;&#20010;&#20851;&#32852;&#12290; </P><PRE class=programlisting>&lt;set name="participants" table="PERSON_EVENT" inverse="true"&gt;
    &lt;key column="EVENT_ID"/&gt;
    &lt;many-to-many column="PERSON_ID" class="events.Person"/&gt;
&lt;/set&gt;</PRE>
<P>&#22914;&#20320;&#25152;&#35265;&#65292;&#20004;&#20010;&#26144;&#23556;&#25991;&#20214;&#37324;&#37117;&#26377;&#26222;&#36890;&#30340;<TT class=literal>set</TT>&#26144;&#23556;&#12290;&#27880;&#24847;&#22312;&#20004;&#20010;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#20114;&#25442;&#20102;<TT 
class=literal>key</TT>&#21644;<TT class=literal>many-to-many</TT>&#30340;&#23383;&#27573;&#21517;&#12290;&#36825;&#37324;&#26368;&#37325;&#35201;&#30340;&#26159;<TT 
class=literal>Event</TT>&#26144;&#23556;&#25991;&#20214;&#37324;&#22686;&#21152;&#20102;<TT class=literal>set</TT>&#20803;&#32032;&#30340;<TT 
class=literal>inverse="true"</TT>&#23646;&#24615;&#12290; </P>
<P>&#36825;&#24847;&#21619;&#30528;&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#65292;Hibernate&#33021;&#22312;&#20851;&#32852;&#30340;&#21478;&#19968;&#31471; &#65293; <TT 
class=literal>Person</TT>&#31867;&#24471;&#21040;&#20004;&#20010;&#23454;&#20307;&#38388;&#20851;&#32852;&#30340;&#20449;&#24687;&#12290;&#36825;&#23558;&#20250;&#26497;&#22823;&#22320;&#24110;&#21161;&#20320;&#29702;&#35299;&#21452;&#21521;&#20851;&#32852;&#26159;&#22914;&#20309;&#22312;&#20004;&#20010;&#23454;&#20307;&#38388;&#34987;&#21019;&#24314;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=tutorial-associations-usingbidir></A>1.3.6.&nbsp; &#20351;&#21452;&#21521;&#36830;&#36215;&#26469; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#39318;&#20808;&#35831;&#35760;&#20303;&#65292;Hibernate&#24182;&#19981;&#24433;&#21709;&#36890;&#24120;&#30340;Java&#35821;&#20041;&#12290; &#22312;&#21333;&#21521;&#20851;&#32852;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#26159;&#24590;&#26679;&#22312;<TT 
class=literal>Person</TT>&#21644;<TT class=literal>Event</TT>&#20043;&#38388;&#21019;&#24314;&#32852;&#31995;&#30340;&#65311;&#25105;&#20204;&#25226;<TT 
class=literal>Event</TT>&#23454;&#20363;&#28155;&#21152;&#21040;<TT 
class=literal>Person</TT>&#23454;&#20363;&#20869;&#30340;event&#24341;&#29992;&#38598;&#21512;&#37324;&#12290;&#22240;&#27492;&#24456;&#26174;&#28982;&#65292;&#22914;&#26524;&#25105;&#20204;&#35201;&#35753;&#36825;&#20010;&#20851;&#32852;&#21487;&#20197;&#21452;&#21521;&#22320;&#24037;&#20316;&#65292;&#25105;&#20204;&#38656;&#35201;&#22312;&#21478;&#22806;&#19968;&#31471;&#20570;&#21516;&#26679;&#30340;&#20107;&#24773; 
&#65293; &#25226;<TT class=literal>Person</TT>&#23454;&#20363;&#21152;&#20837;<TT 
class=literal>Event</TT>&#31867;&#20869;&#30340;Person&#24341;&#29992;&#38598;&#21512;&#12290;&#36825;“&#22312;&#20851;&#32852;&#30340;&#20004;&#31471;&#35774;&#32622;&#32852;&#31995;”&#26159;&#23436;&#20840;&#24517;&#35201;&#30340;&#32780;&#19988;&#20320;&#37117;&#24471;&#36825;&#20040;&#20570;&#12290; </P>
<P>&#35768;&#22810;&#24320;&#21457;&#20154;&#21592;&#38450;&#24481;&#24335;&#22320;&#32534;&#31243;&#65292;&#21019;&#24314;&#31649;&#29702;&#20851;&#32852;&#30340;&#26041;&#27861;&#26469;&#20445;&#35777;&#27491;&#30830;&#30340;&#35774;&#32622;&#20102;&#20851;&#32852;&#30340;&#20004;&#31471;&#65292;&#27604;&#22914;&#22312;<TT class=literal>Person</TT>&#37324;&#65306; </P><PRE class=programlisting>protected Set getEvents() {
    return events;
}

protected void setEvents(Set events) {
    this.events = events;
}

public void addToEvent(Event event) {
    this.getEvents().add(event);
    event.getParticipants().add(this);
}

public void removeFromEvent(Event event) {
    this.getEvents().remove(event);
    event.getParticipants().remove(this);
}</PRE>
<P>&#27880;&#24847;&#29616;&#22312;&#23545;&#20110;&#38598;&#21512;&#30340;get&#21644;set&#26041;&#27861;&#30340;&#35775;&#38382;&#32423;&#21035;&#26159;protected - 
&#36825;&#20801;&#35768;&#22312;&#20301;&#20110;&#21516;&#19968;&#20010;&#21253;&#65288;package&#65289;&#20013;&#30340;&#31867;&#20197;&#21450;&#32487;&#25215;&#33258;&#36825;&#20010;&#31867;&#30340;&#23376;&#31867;&#21487;&#20197;&#35775;&#38382;&#36825;&#20123;&#26041;&#27861;&#65292;&#20294;&#31105;&#27490;&#20854;&#20182;&#20219;&#20309;&#20154;&#30340;&#30452;&#25509;&#35775;&#38382;&#65292;&#36991;&#20813;&#20102;&#38598;&#21512;&#20869;&#23481;&#30340;&#28151;&#20081;&#12290;&#20320;&#24212;&#23613;&#21487;&#33021;&#22320;&#22312;&#21478;&#19968;&#31471;&#20063;&#25226;&#38598;&#21512;&#30340;&#35775;&#38382;&#32423;&#21035;&#35774;&#25104;protected&#12290; 
</P>
<P><TT 
class=literal>inverse</TT>&#26144;&#23556;&#23646;&#24615;&#31350;&#31455;&#34920;&#31034;&#20160;&#20040;&#21602;&#65311;&#23545;&#20110;&#20320;&#21644;Java&#26469;&#35828;&#65292;&#19968;&#20010;&#21452;&#21521;&#20851;&#32852;&#20165;&#20165;&#26159;&#22312;&#20004;&#31471;&#31616;&#21333;&#22320;&#27491;&#30830;&#35774;&#32622;&#24341;&#29992;&#12290;&#28982;&#32780;&#65292;Hibernate&#24182;&#27809;&#26377;&#36275;&#22815;&#30340;&#20449;&#24687;&#21435;&#27491;&#30830;&#22320;&#25191;&#34892;<TT 
class=literal>INSERT</TT>&#21644;<TT 
class=literal>UPDATE</TT>&#35821;&#21477;&#65288;&#20197;&#36991;&#20813;&#36829;&#21453;&#25968;&#25454;&#24211;&#32422;&#26463;&#65289;&#65292;&#25152;&#20197;&#23427;&#38656;&#35201;&#19968;&#20123;&#24110;&#21161;&#26469;&#27491;&#30830;&#30340;&#22788;&#29702;&#21452;&#21521;&#20851;&#32852;&#12290;&#25226;&#20851;&#32852;&#30340;&#19968;&#31471;&#35774;&#32622;&#20026;<TT 
class=literal>inverse</TT>&#23558;&#21578;&#35785;Hibernate&#24573;&#30053;&#20851;&#32852;&#30340;&#36825;&#19968;&#31471;&#65292;&#25226;&#36825;&#31471;&#30475;&#25104;&#26159;&#21478;&#22806;&#19968;&#31471;&#30340;&#19968;&#20010;<SPAN 
class=emphasis><EM>&#38236;&#35937;&#65288;mirror&#65289;</EM></SPAN>&#12290;&#36825;&#23601;&#26159;&#25152;&#38656;&#30340;&#20840;&#37096;&#20449;&#24687;&#65292;Hibernate&#21033;&#29992;&#36825;&#20123;&#20449;&#24687;&#26469;&#22788;&#29702;&#25226;&#19968;&#20010;&#26377;&#21521;&#23548;&#33322;&#27169;&#22411;&#36716;&#31227;&#21040;&#25968;&#25454;&#24211;schema&#26102;&#30340;&#25152;&#26377;&#38382;&#39064;&#12290;&#20320;&#21482;&#38656;&#35201;&#35760;&#20303;&#36825;&#20010;&#30452;&#35266;&#30340;&#35268;&#21017;&#65306;&#25152;&#26377;&#30340;&#21452;&#21521;&#20851;&#32852;&#38656;&#35201;&#26377;&#19968;&#31471;&#34987;&#35774;&#32622;&#20026;<TT 
class=literal>inverse</TT>&#12290;&#22312;&#19968;&#23545;&#22810;&#20851;&#32852;&#20013;&#23427;&#24517;&#39035;&#26159;&#20195;&#34920;&#22810;&#65288;many&#65289;&#30340;&#37027;&#31471;&#12290;&#32780;&#22312;&#22810;&#23545;&#22810;&#65288;many-to-many&#65289;&#20851;&#32852;&#20013;&#65292;&#20320;&#21487;&#20197;&#20219;&#24847;&#36873;&#21462;&#19968;&#31471;&#65292;&#22240;&#20026;&#20004;&#31471;&#20043;&#38388;&#24182;&#27809;&#26377;&#24046;&#21035;&#12290; 
</P></DIV>
<P>&#35753;&#25105;&#20204;&#25226;&#36827;&#20837;&#19968;&#20010;&#23567;&#22411;&#30340;web&#24212;&#29992;&#31243;&#24207;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=tutorial-webapp></A>1.4.&nbsp;&#31532;&#19977;&#37096;&#20998; - 
EventManager web&#24212;&#29992;&#31243;&#24207;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate web&#24212;&#29992;&#31243;&#24207;&#20351;&#29992;<TT class=literal>Session</TT> &#21644;<TT 
class=literal>Transaction</TT>&#30340;&#26041;&#24335;&#20960;&#20046;&#21644;&#29420;&#31435;&#24212;&#29992;&#31243;&#24207;&#26159;&#19968;&#26679;&#30340;&#12290;&#20294;&#26159;&#65292;&#26377;&#19968;&#20123;&#24120;&#35265;&#30340;&#27169;&#24335;&#65288;pattern&#65289;&#38750;&#24120;&#26377;&#29992;&#12290;&#29616;&#22312;&#25105;&#20204;&#32534;&#20889;&#19968;&#20010;<TT 
class=literal>EventManagerServlet</TT>&#12290;&#36825;&#20010;servlet&#21487;&#20197;&#21015;&#20986;&#25968;&#25454;&#24211;&#20013;&#20445;&#23384;&#30340;&#25152;&#26377;&#30340;events&#65292;&#36824;&#25552;&#20379;&#19968;&#20010;HTML&#34920;&#21333;&#26469;&#22686;&#21152;&#26032;&#30340;events&#12290; 
</P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=tutorial-webapp-servlet></A>1.4.1.&nbsp;&#32534;&#20889;&#22522;&#26412;&#30340;servlet</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#20320;&#30340;&#28304;&#20195;&#30721;&#30446;&#24405;&#30340;<TT class=literal>events</TT>&#21253;&#20013;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#31867;&#65306; </P><PRE class=programlisting>package events;

// Imports

public class EventManagerServlet extends HttpServlet {

    private final SimpleDateFormat dateFormatter =
                            new SimpleDateFormat("dd.MM.yyyy");

    // Servlet code
}</PRE>
<P>&#25105;&#20204;&#21518;&#38754;&#20250;&#29992;&#21040;<TT class=literal>dateFormatter</TT> &#30340;&#24037;&#20855;&#65292; &#23427;&#25226;<TT 
class=literal>Date</TT>&#23545;&#35937;&#36716;&#25442;&#20026;&#23383;&#31526;&#20018;&#12290;&#21482;&#35201;&#19968;&#20010;formatter&#20316;&#20026;servlet&#30340;&#25104;&#21592;&#23601;&#21487;&#20197;&#20102;&#12290; </P>
<P>&#36825;&#20010;servlet&#21482;&#22788;&#29702; HTTP <TT class=literal>GET</TT> &#35831;&#27714;&#65292;&#22240;&#27492;&#65292;&#25105;&#20204;&#35201;&#23454;&#29616;&#30340;&#26159;<TT 
class=literal>doGet()</TT>&#26041;&#27861;&#65306; </P><PRE class=programlisting>protected void doGet(HttpServletRequest request,
                     HttpServletResponse response)
        throws ServletException, IOException {

    try {
        // Begin unit of work
        HibernateUtil.getSessionFactory()
                .getCurrentSession().beginTransaction();

        // Process request and render page...

        // End unit of work
        HibernateUtil.getSessionFactory()
                .getCurrentSession().getTransaction().commit();

    } catch (Exception ex) {
        HibernateUtil.getSessionFactory()
                .getCurrentSession().getTransaction().rollback();
        throw new ServletException(ex);
    }

}</PRE>
<P>&#25105;&#20204;&#31216;&#36825;&#37324;&#24212;&#29992;&#30340;&#27169;&#24335;&#20026;&#27599;&#27425;&#35831;&#27714;&#19968;&#20010;session<SPAN 
class=emphasis><EM>(session-per-request)</EM></SPAN>&#12290;&#24403;&#26377;&#35831;&#27714;&#21040;&#36798;&#36825;&#20010;servlet&#30340;&#26102;&#20505;&#65292;&#36890;&#36807;&#23545;<TT 
class=literal>SessionFactory</TT>&#30340;&#31532;&#19968;&#27425;&#35843;&#29992;&#65292;&#25171;&#24320;&#19968;&#20010;&#26032;&#30340;Hibernate <TT 
class=literal>Session</TT>&#12290;&#28982;&#21518;&#21551;&#21160;&#19968;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;—&#25152;&#26377;&#30340;&#25968;&#25454;&#35775;&#38382;&#37117;&#26159;&#22312;&#20107;&#21153;&#20013;&#36827;&#34892;&#65292;&#19981;&#31649;&#26159;&#35835;&#36824;&#26159;&#20889;&#65288;&#25105;&#20204;&#22312;&#24212;&#29992;&#31243;&#24207;&#20013;&#19981;&#20351;&#29992;auto-commit&#27169;&#24335;&#65289;&#12290; 
</P>
<P>&#19979;&#19968;&#27493;&#65292;&#23545;&#35831;&#27714;&#30340;&#21487;&#33021;&#21160;&#20316;&#36827;&#34892;&#22788;&#29702;&#65292;&#28210;&#26579;&#20986;&#21453;&#39304;&#30340;HTML&#12290;&#25105;&#20204;&#24456;&#24555;&#23601;&#20250;&#28041;&#21450;&#21040;&#37027;&#37096;&#20998;&#12290; </P>
<P>&#26368;&#21518;&#65292;&#24403;&#22788;&#29702;&#19982;&#28210;&#26579;&#37117;&#32467;&#26463;&#30340;&#26102;&#20505;&#65292;&#36825;&#20010;&#24037;&#20316;&#21333;&#20803;&#23601;&#32467;&#26463;&#20102;&#12290;&#20551;&#33509;&#22312;&#22788;&#29702;&#25110;&#28210;&#26579;&#30340;&#26102;&#20505;&#26377;&#20219;&#20309;&#38169;&#35823;&#21457;&#29983;&#65292;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#65292;&#22238;&#28378;&#25968;&#25454;&#24211;&#20107;&#21153;&#12290;&#36825;&#26679;&#65292;<TT 
class=literal>session-per-request</TT>&#27169;&#24335;&#23601;&#23436;&#25104;&#20102;&#12290;&#20026;&#20102;&#36991;&#20813;&#22312;&#27599;&#20010;servlet&#20013;&#37117;&#32534;&#20889;&#20107;&#21153;&#36793;&#30028;&#30028;&#23450;&#30340;&#20195;&#30721;&#65292;&#21487;&#20197;&#32771;&#34385;&#20889;&#19968;&#20010;servlet 
&#36807;&#28388;&#22120;&#65288;filter&#65289;&#26469;&#26356;&#22909;&#22320;&#35299;&#20915;&#12290;&#20851;&#20110;&#36825;&#19968;&#27169;&#24335;&#30340;&#26356;&#22810;&#20449;&#24687;&#65292;&#35831;&#21442;&#38405;Hibernate&#32593;&#31449;&#21644;Wiki&#65292;&#36825;&#19968;&#27169;&#24335;&#21483;&#20570;<SPAN 
class=emphasis><EM>Open Session in 
View</EM></SPAN>—&#21482;&#35201;&#20320;&#32771;&#34385;&#29992;JSP&#26469;&#28210;&#26579;&#20320;&#30340;&#35270;&#22270;&#65288;view&#65289;&#65292;&#32780;&#19981;&#26159;&#22312;servlet&#20013;&#65292;&#20320;&#23601;&#20250;&#24456;&#24555;&#29992;&#21040;&#23427;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=tutorial-webapp-processing></A>1.4.2.&nbsp;&#22788;&#29702;&#19982;&#28210;&#26579;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#26469;&#23454;&#29616;&#22788;&#29702;&#35831;&#27714;&#20197;&#21450;&#28210;&#26579;&#39029;&#38754;&#30340;&#24037;&#20316;&#12290; </P><PRE class=programlisting>// Write HTML header
PrintWriter out = response.getWriter();
out.println("&lt;html&gt;&lt;head&gt;&lt;title&gt;Event Manager&lt;/title&gt;&lt;/head&gt;&lt;body&gt;");

// Handle actions
if ( "store".equals(request.getParameter("action")) ) {

    String eventTitle = request.getParameter("eventTitle");
    String eventDate = request.getParameter("eventDate");

    if ( "".equals(eventTitle) || "".equals(eventDate) ) {
        out.println("&lt;b&gt;&lt;i&gt;Please enter event title and date.&lt;/i&gt;&lt;/b&gt;");
    } else {
        createAndStoreEvent(eventTitle, dateFormatter.parse(eventDate));
        out.println("&lt;b&gt;&lt;i&gt;Added event.&lt;/i&gt;&lt;/b&gt;");
    }
}

// Print page
printEventForm(out);
listEvents(out);

// Write HTML footer
out.println("&lt;/body&gt;&lt;/html&gt;");
out.flush();
out.close();</PRE>
<P>&#24517;&#39035;&#25215;&#35748;&#65292;&#36825;&#31181;&#32534;&#30721;&#39118;&#26684;&#35753;Java&#19982;HTML&#28151;&#21512;&#22312;&#20102;&#19968;&#36215;&#65292;&#22312;&#26356;&#22797;&#26434;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#19981;&#24212;&#22823;&#37327;&#22320;&#20351;&#29992;—&#35760;&#20303;&#25105;&#20204;&#22312;&#31456;&#20013;&#20165;&#20026;&#20102;&#23637;&#31034;Hibernate&#30340;&#22522;&#26412;&#27010;&#24565;&#12290;&#36825;&#27573;&#20195;&#30721;&#25171;&#21360;&#20986;&#20102;HTML&#22836;&#21644;&#23614;&#37096;&#12290;&#22312;&#39029;&#38754;&#20013;&#65292;&#25171;&#21360;&#20986;&#19968;&#20010;&#36755;&#20837;event&#26465;&#30446;&#30340;&#34920;&#21333;&#65292;&#24182;&#21015;&#20986;&#25968;&#25454;&#24211;&#20013;&#25152;&#26377;events&#12290;&#31532;&#19968;&#20010;&#26041;&#27861;&#24494;&#19981;&#36275;&#36947;&#65292;&#20165;&#20165;&#26159;&#36755;&#20986;HTML: 
</P><PRE class=programlisting>private void printEventForm(PrintWriter out) {
    out.println("&lt;h2&gt;Add new event:&lt;/h2&gt;");
    out.println("&lt;form&gt;");
    out.println("Title: &lt;input name='eventTitle' length='50'/&gt;&lt;br/&gt;");
    out.println("Date (e.g. 24.12.2009): &lt;input name='eventDate' length='10'/&gt;&lt;br/&gt;");
    out.println("&lt;input type='submit' name='action' value='store'/&gt;");
    out.println("&lt;/form&gt;");
}</PRE>
<P><TT class=literal>listEvents()</TT>&#26041;&#27861;&#20351;&#29992;&#32465;&#23450;&#21040;&#24403;&#21069;&#32447;&#31243;&#30340;Hibernate <TT 
class=literal>Session</TT>&#26469;&#25191;&#34892;&#26597;&#35810;&#65306; </P><PRE class=programlisting>private void listEvents(PrintWriter out) {
    List result = HibernateUtil.getSessionFactory()
                    .getCurrentSession().createCriteria(Event.class).list();
    if (result.size() &gt; 0) {
        out.println("&lt;h2&gt;Events in database:&lt;/h2&gt;");
        out.println("&lt;table border='1'&gt;");
        out.println("&lt;tr&gt;");
        out.println("&lt;th&gt;Event title&lt;/th&gt;");
        out.println("&lt;th&gt;Event date&lt;/th&gt;");
        out.println("&lt;/tr&gt;");
        for (Iterator it = result.iterator(); it.hasNext();) {
            Event event = (Event) it.next();
            out.println("&lt;tr&gt;");
            out.println("&lt;td&gt;" + event.getTitle() + "&lt;/td&gt;");
            out.println("&lt;td&gt;" + dateFormatter.format(event.getDate()) + "&lt;/td&gt;");
            out.println("&lt;/tr&gt;");
        }
        out.println("&lt;/table&gt;");
    }
}</PRE>
<P>&#26368;&#21518;&#65292;<TT class=literal>store</TT>&#21160;&#20316;&#20250;&#34987;&#23548;&#21521;&#21040;<TT 
class=literal>createAndStoreEvent()</TT>&#26041;&#27861;&#65292;&#23427;&#20063;&#20351;&#29992;&#24403;&#21069;&#32447;&#31243;&#30340;<TT 
class=literal>Session</TT>: </P><PRE class=programlisting>protected void createAndStoreEvent(String title, Date theDate) {
    Event theEvent = new Event();
    theEvent.setTitle(title);
    theEvent.setDate(theDate);

    HibernateUtil.getSessionFactory()
                    .getCurrentSession().save(theEvent);
}</PRE>
<P>&#22823;&#21151;&#21578;&#25104;&#65292;&#36825;&#20010;servlet&#20889;&#23436;&#20102;&#12290;Hibernate&#20250;&#22312;&#21333;&#19968;&#30340;<TT class=literal>Session</TT> &#21644;<TT 
class=literal>Transaction</TT>&#20013;&#22788;&#29702;&#21040;&#36798;&#30340;servlet&#35831;&#27714;&#12290;&#22914;&#21516;&#22312;&#21069;&#38754;&#30340;&#29420;&#31435;&#24212;&#29992;&#31243;&#24207;&#20013;&#37027;&#26679;&#65292;Hibernate&#21487;&#20197;&#33258;&#21160;&#30340;&#25226;&#36825;&#20123;&#23545;&#35937;&#32465;&#23450;&#21040;&#24403;&#21069;&#36816;&#34892;&#30340;&#32447;&#31243;&#20013;&#12290;&#36825;&#32473;&#20102;&#20320;&#29992;&#20219;&#20309;&#20320;&#21916;&#27426;&#30340;&#26041;&#24335;&#26469;&#23545;&#20195;&#30721;&#20998;&#23618;&#21450;&#35775;&#38382;<TT 
class=literal>SessionFactory</TT>&#30340;&#33258;&#30001;&#12290;&#36890;&#24120;&#65292;&#20320;&#20250;&#29992;&#26356;&#21152;&#23436;&#22791;&#30340;&#35774;&#35745;&#65292;&#25226;&#25968;&#25454;&#35775;&#38382;&#20195;&#30721;&#36716;&#31227;&#21040;&#25968;&#25454;&#35775;&#38382;&#23545;&#35937;&#20013;(DAO&#27169;&#24335;&#65289;&#12290;&#35831;&#21442;&#35265;Hibernate 
Wiki&#65292;&#37027;&#37324;&#26377;&#26356;&#22810;&#30340;&#20363;&#23376;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=tutorial-webapp-deploy></A>1.4.3.&nbsp;&#37096;&#32626;&#19982;&#27979;&#35797;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#35201;&#21457;&#24067;&#36825;&#20010;&#31243;&#24207;&#65292;&#20320;&#24471;&#25226;&#23427;&#25171;&#25104;web&#21457;&#24067;&#21253;&#65306;WAR&#25991;&#20214;&#12290;&#25226;&#19979;&#38754;&#30340;&#33050;&#26412;&#21152;&#20837;&#21040;&#20320;&#30340;<TT class=literal>build.xml</TT>&#20013;&#65306; </P><PRE class=programlisting>&lt;target name="war" depends="compile"&gt;
    &lt;war destfile="hibernate-tutorial.war" webxml="web.xml"&gt;
        &lt;lib dir="${librarydir}"&gt;
          &lt;exclude name="jsdk*.jar"/&gt;
        &lt;/lib&gt;

        &lt;classes dir="${targetdir}"/&gt;
    &lt;/war&gt;
&lt;/target&gt;</PRE>
<P>&#36825;&#27573;&#20195;&#30721;&#22312;&#20320;&#30340;&#24320;&#21457;&#30446;&#24405;&#20013;&#21019;&#24314;&#19968;&#20010;<TT class=literal>hibernate-tutorial.war</TT>&#30340;&#25991;&#20214;&#12290;&#23427;&#25226;&#25152;&#26377;&#30340;&#31867;&#24211;&#21644;<TT 
class=literal>web.xml</TT>&#25551;&#36848;&#25991;&#20214;&#37117;&#25171;&#21253;&#36827;&#21435;&#65292;web.xml &#25991;&#20214;&#24212;&#35813;&#20301;&#20110;&#20320;&#30340;&#24320;&#21457;&#26681;&#30446;&#24405;&#20013;&#65306; </P><PRE class=programlisting>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;Event Manager&lt;/servlet-name&gt;
        &lt;servlet-class&gt;events.EventManagerServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;Event Manager&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/eventmanager&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</PRE>
<P>&#35831;&#27880;&#24847;&#22312;&#20320;&#32534;&#35793;&#21644;&#37096;&#32626;web&#24212;&#29992;&#31243;&#20043;&#21069;&#65292;&#38656;&#35201;&#19968;&#20010;&#38468;&#21152;&#30340;&#31867;&#24211;&#65306;<TT class=literal>jsdk.jar</TT>&#12290;&#36825;&#26159;Java 
Servlet&#24320;&#21457;&#21253;&#65292;&#20551;&#33509;&#20320;&#36824;&#27809;&#26377;&#65292;&#21487;&#20197;&#20174;Sun&#32593;&#31449;&#19978;&#19979;&#36733;&#65292;&#25226;&#23427;copy&#21040;&#20320;&#30340;lib&#30446;&#24405;&#12290;&#20294;&#26159;&#65292;&#23427;&#20165;&#20165;&#26159;&#22312;&#32534;&#35793;&#26102;&#38656;&#35201;&#65292;&#19981;&#20250;&#34987;&#25171;&#20837;WAR&#21253;&#12290; </P>
<P>&#22312;&#20320;&#30340;&#24320;&#21457;&#30446;&#24405;&#20013;&#65292;&#35843;&#29992;<TT class=literal>ant war</TT>&#26469;&#26500;&#24314;&#12289;&#25171;&#21253;&#65292;&#28982;&#21518;&#25226;<TT 
class=literal>hibernate-tutorial.war</TT>&#25991;&#20214;&#25335;&#36125;&#21040;&#20320;&#30340;tomcat&#30340;<TT 
class=literal>webapps</TT>&#30446;&#24405;&#19979;&#12290;&#20551;&#33509;&#20320;&#36824;&#27809;&#23433;&#35013;Tomcat&#65292;&#23601;&#21435;&#19979;&#36733;&#19968;&#20010;&#65292;&#25353;&#29031;&#25351;&#21335;&#26469;&#23433;&#35013;&#12290;&#23545;&#27492;&#24212;&#29992;&#30340;&#21457;&#24067;&#65292;&#20320;&#19981;&#38656;&#35201;&#20462;&#25913;&#20219;&#20309;Tomcat&#30340;&#37197;&#32622;&#12290; 
</P>
<P>&#22312;&#37096;&#32626;&#23436;&#65292;&#21551;&#21160;Tomcat&#20043;&#21518;&#65292;&#36890;&#36807;<TT 
class=literal>http://localhost:8080/hibernate-tutorial/eventmanager</TT>&#36827;&#34892;&#35775;&#38382;&#20320;&#30340;&#24212;&#29992;&#65292;&#22312;&#31532;&#19968;&#27425;servlet 
&#35831;&#27714;&#21457;&#29983;&#26102;&#65292;&#35831;&#22312;Tomcat log&#20013;&#30830;&#35748;&#20320;&#30475;&#21040;Hibernate&#34987;&#21021;&#22987;&#21270;&#20102;&#65288;<TT 
class=literal>HibernateUtil</TT>&#30340;&#38745;&#24577;&#21021;&#22987;&#21270;&#22120;&#34987;&#35843;&#29992;&#65289;&#65292;&#20551;&#33509;&#26377;&#20219;&#20309;&#24322;&#24120;&#25243;&#20986;&#65292;&#20063;&#21487;&#20197;&#30475;&#21040;&#35814;&#32454;&#30340;&#36755;&#20986;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=tutorial-summary></A>1.5.&nbsp; &#24635;&#32467; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26412;&#31456;&#35206;&#30422;&#20102;&#22914;&#20309;&#32534;&#20889;&#19968;&#20010;&#31616;&#21333;&#29420;&#31435;&#30340;Hibernate&#21629;&#20196;&#34892;&#24212;&#29992;&#31243;&#24207;&#21450;&#23567;&#22411;&#30340;Hibernate web&#24212;&#29992;&#31243;&#24207;&#30340;&#22522;&#26412;&#35201;&#32032;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#24050;&#32463;&#23545;Hibernate&#24863;&#21040;&#33258;&#20449;&#65292;&#36890;&#36807;&#24320;&#21457;&#25351;&#21335;&#30446;&#24405;&#65292;&#32487;&#32493;&#27983;&#35272;&#20320;&#24863;&#20852;&#36259;&#30340;&#20869;&#23481;&#65293;&#37027;&#20123;&#20250;&#34987;&#38382;&#21040;&#30340;&#38382;&#39064;&#22823;&#22810;&#26159;&#20107;&#21153;&#22788;&#29702; (<A 
title=&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457; href="#transactions">&#31532;&nbsp;11&nbsp;&#31456; 
<I>&#20107;&#21153;&#21644;&#24182;&#21457;</I></A>)&#65292;&#25235;&#21462;&#65288;fetch&#65289;&#30340;&#25928;&#29575; (<A title="&#31532;&nbsp;19&nbsp;&#31456;&nbsp;&#25552;&#21319;&#24615;&#33021;&#10;&#9;" 
href="#performance">&#31532;&nbsp;19&nbsp;&#31456; <I>&#25552;&#21319;&#24615;&#33021; </I></A>)&#65292;&#25110;&#32773;API&#30340;&#20351;&#29992; (<A 
title=&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107; href="#objectstate">&#31532;&nbsp;10&nbsp;&#31456; 
<I>&#19982;&#23545;&#35937;&#20849;&#20107;</I></A>)&#21644;&#26597;&#35810;&#30340;&#29305;&#24615;(<A title=10.4.&nbsp;&#26597;&#35810; 
href="#objectstate-querying">&#31532;&nbsp;10.4&nbsp;&#33410; “&#26597;&#35810;”</A>)&#12290; </P>
<P>&#21035;&#24536;&#20102;&#21435;Hibernate&#30340;&#32593;&#31449;&#26597;&#30475;&#26356;&#22810;&#65288;&#26377;&#38024;&#23545;&#24615;&#30340;&#65289;&#31034;&#20363;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=architecture></A>&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#20307;&#31995;&#32467;&#26500;(Architecture)</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=architecture-overview></A>2.1.&nbsp;&#27010;&#20917;(Overview)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;&#38750;&#24120;&#31616;&#35201;&#30340;Hibernate&#20307;&#31995;&#32467;&#26500;&#30340;&#27010;&#35201;&#22270;&#65306; </P>
<DIV class=mediaobject align=center><IMG src="../shared/images/overview.gif" 
align=middle></DIV>
<P>&#20174;&#36825;&#20010;&#22270;&#21487;&#20197;&#30475;&#20986;&#65292;Hibernate&#20351;&#29992;&#25968;&#25454;&#24211;&#21644;&#37197;&#32622;&#20449;&#24687;&#26469;&#20026;&#24212;&#29992;&#31243;&#24207;&#25552;&#20379;&#25345;&#20037;&#21270;&#26381;&#21153;&#65288;&#20197;&#21450;&#25345;&#20037;&#30340;&#23545;&#35937;&#65289;&#12290; </P>
<P>&#25105;&#20204;&#26469;&#26356;&#35814;&#32454;&#22320;&#30475;&#19968;&#19979;Hibernate&#36816;&#34892;&#26102;&#20307;&#31995;&#32467;&#26500;&#12290;&#30001;&#20110;Hibernate&#38750;&#24120;&#28789;&#27963;&#65292;&#19988;&#25903;&#25345;&#22810;&#31181;&#24212;&#29992;&#26041;&#26696;&#65292; 
&#25152;&#20197;&#25105;&#20204;&#36825;&#21482;&#25551;&#36848;&#19968;&#19979;&#20004;&#31181;&#26497;&#31471;&#30340;&#24773;&#20917;&#12290;“&#36731;&#22411;”&#30340;&#20307;&#31995;&#32467;&#26500;&#26041;&#26696;&#65292;&#35201;&#27714;&#24212;&#29992;&#31243;&#24207;&#25552;&#20379;&#33258;&#24049;&#30340;JDBC &#36830;&#25509;&#24182;&#31649;&#29702;&#33258;&#24049;&#30340;&#20107;&#21153;&#12290;&#36825;&#31181;&#26041;&#26696;&#20351;&#29992;&#20102;Hibernate 
API&#30340;&#26368;&#23567;&#23376;&#38598;&#65306; </P>
<DIV class=mediaobject align=center><IMG src="../shared/images/lite.gif" 
align=middle></DIV>
<P>“&#20840;&#38754;&#35299;&#20915;”&#30340;&#20307;&#31995;&#32467;&#26500;&#26041;&#26696;&#65292;&#23558;&#24212;&#29992;&#23618;&#20174;&#24213;&#23618;&#30340;JDBC/JTA API&#20013;&#25277;&#35937;&#20986;&#26469;&#65292;&#32780;&#35753;Hibernate&#26469;&#22788;&#29702;&#36825;&#20123;&#32454;&#33410;&#12290; </P>
<DIV class=mediaobject align=center><IMG src="../shared/images/full_cream.gif" 
align=middle></DIV>
<P>&#22270;&#20013;&#21508;&#20010;&#23545;&#35937;&#30340;&#23450;&#20041;&#22914;&#19979;&#65306; </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>SessionFactory (<TT 
  class=literal>org.hibernate.SessionFactory</TT>)</SPAN>
  <DD>
  <P>&#38024;&#23545;&#21333;&#20010;&#25968;&#25454;&#24211;&#26144;&#23556;&#20851;&#31995;&#32463;&#36807;&#32534;&#35793;&#21518;&#30340;&#20869;&#23384;&#38236;&#20687;&#65292;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#65288;&#19981;&#21487;&#21464;&#65289;&#12290; &#23427;&#26159;&#29983;&#25104;<TT 
  class=literal>Session</TT>&#30340;&#24037;&#21378;&#65292;&#26412;&#36523;&#35201;&#29992;&#21040;<TT class=literal>ConnectionProvider</TT>&#12290; 
  &#35813;&#23545;&#35937;&#21487;&#20197;&#22312;&#36827;&#31243;&#25110;&#38598;&#32676;&#30340;&#32423;&#21035;&#19978;&#65292;&#20026;&#37027;&#20123;&#20107;&#21153;&#20043;&#38388;&#21487;&#20197;&#37325;&#29992;&#30340;&#25968;&#25454;&#25552;&#20379;&#21487;&#36873;&#30340;&#20108;&#32423;&#32531;&#23384;&#12290; </P>
  <DT><SPAN class=term>Session (<TT 
  class=literal>org.hibernate.Session</TT>)</SPAN>
  <DD>
  <P>&#34920;&#31034;&#24212;&#29992;&#31243;&#24207;&#19982;&#25345;&#20037;&#20648;&#23384;&#23618;&#20043;&#38388;&#20132;&#20114;&#25805;&#20316;&#30340;&#19968;&#20010;&#21333;&#32447;&#31243;&#23545;&#35937;&#65292;&#27492;&#23545;&#35937;&#29983;&#23384;&#26399;&#24456;&#30701;&#12290; &#20854;&#38544;&#34255;&#20102;JDBC&#36830;&#25509;&#65292;&#20063;&#26159;<TT 
  class=literal>Transaction</TT>&#30340;&#24037;&#21378;&#12290; 
  &#20854;&#20250;&#25345;&#26377;&#19968;&#20010;&#38024;&#23545;&#25345;&#20037;&#21270;&#23545;&#35937;&#30340;&#24517;&#36873;&#65288;&#31532;&#19968;&#32423;&#65289;&#32531;&#23384;&#65292;&#22312;&#36941;&#21382;&#23545;&#35937;&#22270;&#25110;&#32773;&#26681;&#25454;&#25345;&#20037;&#21270;&#26631;&#35782;&#26597;&#25214;&#23545;&#35937;&#26102;&#20250;&#29992;&#21040;&#12290; </P>
  <DT><SPAN class=term>&#25345;&#20037;&#30340;&#23545;&#35937;&#21450;&#20854;&#38598;&#21512;</SPAN>
  <DD>
  <P>&#24102;&#26377;&#25345;&#20037;&#21270;&#29366;&#24577;&#30340;&#12289;&#20855;&#26377;&#19994;&#21153;&#21151;&#33021;&#30340;&#21333;&#32447;&#31243;&#23545;&#35937;&#65292;&#27492;&#23545;&#35937;&#29983;&#23384;&#26399;&#24456;&#30701;&#12290; 
  &#36825;&#20123;&#23545;&#35937;&#21487;&#33021;&#26159;&#26222;&#36890;&#30340;JavaBeans/POJO&#65292;&#21807;&#19968;&#29305;&#27530;&#30340;&#26159;&#20182;&#20204;&#27491;&#19982;&#65288;&#20165;&#20165;&#19968;&#20010;&#65289;<TT class=literal>Session</TT>&#30456;&#20851;&#32852;&#12290; 
  &#19968;&#26086;&#36825;&#20010;<TT class=literal>Session</TT>&#34987;&#20851;&#38381;&#65292;&#36825;&#20123;&#23545;&#35937;&#23601;&#20250;&#33073;&#31163;&#25345;&#20037;&#21270;&#29366;&#24577;&#65292;&#36825;&#26679;&#23601;&#21487;&#34987;&#24212;&#29992;&#31243;&#24207;&#30340;&#20219;&#20309;&#23618;&#33258;&#30001;&#20351;&#29992;&#12290; 
  &#65288;&#20363;&#22914;&#65292;&#29992;&#20316;&#36319;&#34920;&#31034;&#23618;&#25171;&#20132;&#36947;&#30340;&#25968;&#25454;&#20256;&#36755;&#23545;&#35937;&#12290;&#65289; </P>
  <DT><SPAN class=term>&#30636;&#24577;(transient)&#21644;&#33073;&#31649;(detached)&#30340;&#23545;&#35937;&#21450;&#20854;&#38598;&#21512;</SPAN>
  <DD>
  <P>&#37027;&#20123;&#30446;&#21069;&#27809;&#26377;&#19982;session&#20851;&#32852;&#30340;&#25345;&#20037;&#21270;&#31867;&#23454;&#20363;&#12290; &#20182;&#20204;&#21487;&#33021;&#26159;&#22312;&#34987;&#24212;&#29992;&#31243;&#24207;&#23454;&#20363;&#21270;&#21518;&#65292;&#23578;&#26410;&#36827;&#34892;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#12290; &#20063;&#21487;&#33021;&#26159;&#22240;&#20026;&#23454;&#20363;&#21270;&#20182;&#20204;&#30340;<TT 
  class=literal>Session</TT>&#24050;&#32463;&#34987;&#20851;&#38381;&#32780;&#33073;&#31163;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#12290; </P>
  <DT><SPAN class=term>&#20107;&#21153;Transaction (<TT 
  class=literal>org.hibernate.Transaction</TT>)</SPAN>
  <DD>
  <P>&#65288;&#21487;&#36873;&#30340;&#65289;&#24212;&#29992;&#31243;&#24207;&#29992;&#26469;&#25351;&#23450;&#21407;&#23376;&#25805;&#20316;&#21333;&#20803;&#33539;&#22260;&#30340;&#23545;&#35937;&#65292;&#23427;&#26159;&#21333;&#32447;&#31243;&#30340;&#65292;&#29983;&#21629;&#21608;&#26399;&#24456;&#30701;&#12290; &#23427;&#36890;&#36807;&#25277;&#35937;&#23558;&#24212;&#29992;&#20174;&#24213;&#23618;&#20855;&#20307;&#30340;JDBC&#12289;JTA&#20197;&#21450;CORBA&#20107;&#21153;&#38548;&#31163;&#24320;&#12290; 
  &#26576;&#20123;&#24773;&#20917;&#19979;&#65292;&#19968;&#20010;<TT class=literal>Session</TT>&#20043;&#20869;&#21487;&#33021;&#21253;&#21547;&#22810;&#20010;<TT 
  class=literal>Transaction</TT>&#23545;&#35937;&#12290; &#23613;&#31649;&#26159;&#21542;&#20351;&#29992;&#35813;&#23545;&#35937;&#26159;&#21487;&#36873;&#30340;&#65292;&#20294;&#26080;&#35770;&#26159;&#20351;&#29992;&#24213;&#23618;&#30340;API&#36824;&#26159;&#20351;&#29992;<TT 
  class=literal>Transaction</TT>&#23545;&#35937;&#65292;&#20107;&#21153;&#36793;&#30028;&#30340;&#24320;&#21551;&#19982;&#20851;&#38381;&#26159;&#24517;&#19981;&#21487;&#23569;&#30340;&#12290; </P>
  <DT><SPAN class=term>ConnectionProvider (<TT 
  class=literal>org.hibernate.connection.ConnectionProvider</TT>)</SPAN>
  <DD>
  <P>&#65288;&#21487;&#36873;&#30340;&#65289;&#29983;&#25104;JDBC&#36830;&#25509;&#30340;&#24037;&#21378;&#65288;&#21516;&#26102;&#20063;&#36215;&#21040;&#36830;&#25509;&#27744;&#30340;&#20316;&#29992;&#65289;&#12290; &#23427;&#36890;&#36807;&#25277;&#35937;&#23558;&#24212;&#29992;&#20174;&#24213;&#23618;&#30340;<TT 
  class=literal>Datasource</TT>&#25110;<TT class=literal>DriverManager</TT>&#38548;&#31163;&#24320;&#12290; 
  &#20165;&#20379;&#24320;&#21457;&#32773;&#25193;&#23637;/&#23454;&#29616;&#29992;&#65292;&#24182;&#19981;&#26292;&#38706;&#32473;&#24212;&#29992;&#31243;&#24207;&#20351;&#29992;&#12290; </P>
  <DT><SPAN class=term>TransactionFactory (<TT 
  class=literal>org.hibernate.TransactionFactory</TT>)</SPAN>
  <DD>
  <P>&#65288;&#21487;&#36873;&#30340;&#65289;&#29983;&#25104;<TT class=literal>Transaction</TT>&#23545;&#35937;&#23454;&#20363;&#30340;&#24037;&#21378;&#12290; &#20165;&#20379;&#24320;&#21457;&#32773;&#25193;&#23637;/&#23454;&#29616;&#29992;&#65292;&#24182;&#19981;&#26292;&#38706;&#32473;&#24212;&#29992;&#31243;&#24207;&#20351;&#29992;&#12290; 
  </P>
  <DT><SPAN class=term><SPAN class=emphasis><EM>&#25193;&#23637;&#25509;&#21475;</EM></SPAN></SPAN>
  <DD>
  <P>Hibernate&#25552;&#20379;&#20102;&#24456;&#22810;&#21487;&#36873;&#30340;&#25193;&#23637;&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#23454;&#29616;&#23427;&#20204;&#26469;&#23450;&#21046;&#20320;&#30340;&#25345;&#20037;&#23618;&#30340;&#34892;&#20026;&#12290; &#20855;&#20307;&#35831;&#21442;&#32771;API&#25991;&#26723;&#12290; </P></DD></DL></DIV>
<P></P>
<P>&#22312;&#29305;&#23450;“&#36731;&#22411;”&#30340;&#20307;&#31995;&#32467;&#26500;&#20013;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#32469;&#36807; <TT class=literal>Transaction</TT>/<TT 
class=literal>TransactionFactory</TT> &#20197;&#21450; <TT 
class=literal>ConnectionProvider</TT> &#31561;API&#30452;&#25509;&#36319;JTA&#25110;JDBC&#25171;&#20132;&#36947;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=architecture-states></A>2.2.&nbsp;&#23454;&#20363;&#29366;&#24577;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#21487;&#33021;&#22788;&#20110;&#19977;&#31181;&#19981;&#21516;&#29366;&#24577;&#20013;&#30340;&#26576;&#19968;&#31181;&#12290; &#36825;&#19977;&#31181;&#29366;&#24577;&#30340;&#23450;&#20041;&#21017;&#19982;&#25152;&#35859;&#30340;<SPAN 
class=emphasis><EM>&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;(persistence context)</EM></SPAN>&#26377;&#20851;&#12290; Hibernate&#30340;<TT 
class=literal>Session</TT>&#23545;&#35937;&#23601;&#26159;&#36825;&#20010;&#25152;&#35859;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65306; </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>&#30636;&#24577;&#65288;transient&#65289;</SPAN>
  <DD>
  <P>&#35813;&#23454;&#20363;&#20174;&#26410;&#19982;&#20219;&#20309;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#20851;&#32852;&#36807;&#12290;&#23427;&#27809;&#26377;&#25345;&#20037;&#21270;&#26631;&#35782;&#65288;&#30456;&#24403;&#20110;&#20027;&#38190;&#20540;&#65289;&#12290; </P>
  <DT><SPAN class=term>&#25345;&#20037;&#21270;(persistent)</SPAN>
  <DD>
  <P>&#23454;&#20363;&#30446;&#21069;&#19982;&#26576;&#20010;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#26377;&#20851;&#32852;&#12290; &#23427;&#25317;&#26377;&#25345;&#20037;&#21270;&#26631;&#35782;&#65288;&#30456;&#24403;&#20110;&#20027;&#38190;&#20540;&#65289;&#65292;&#24182;&#19988;&#21487;&#33021;&#22312;&#25968;&#25454;&#24211;&#20013;&#26377;&#19968;&#20010;&#23545;&#24212;&#30340;&#34892;&#12290; 
  &#23545;&#20110;&#26576;&#19968;&#20010;&#29305;&#23450;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65292;Hibernate<SPAN 
  class=emphasis><EM>&#20445;&#35777;</EM></SPAN>&#25345;&#20037;&#21270;&#26631;&#35782;&#19982;Java&#26631;&#35782;&#65288;&#20854;&#20540;&#20195;&#34920;&#23545;&#35937;&#22312;&#20869;&#23384;&#20013;&#30340;&#20301;&#32622;&#65289;&#31561;&#20215;&#12290; </P>
  <DT><SPAN class=term>&#33073;&#31649;(detached)</SPAN>
  <DD>
  <P>&#23454;&#20363;&#26366;&#32463;&#19982;&#26576;&#20010;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#21457;&#29983;&#36807;&#20851;&#32852;&#65292;&#19981;&#36807;&#37027;&#20010;&#19978;&#19979;&#25991;&#34987;&#20851;&#38381;&#20102;&#65292; &#25110;&#32773;&#36825;&#20010;&#23454;&#20363;&#26159;&#34987;&#24207;&#21015;&#21270;(serialize)&#21040;&#21478;&#22806;&#30340;&#36827;&#31243;&#12290; 
  &#23427;&#25317;&#26377;&#25345;&#20037;&#21270;&#26631;&#35782;&#65292;&#24182;&#19988;&#22312;&#25968;&#25454;&#24211;&#20013;&#21487;&#33021;&#23384;&#22312;&#19968;&#20010;&#23545;&#24212;&#30340;&#34892;&#12290; &#23545;&#20110;&#33073;&#31649;&#29366;&#24577;&#30340;&#23454;&#20363;&#65292;Hibernate&#19981;&#20445;&#35777;&#20219;&#20309;&#25345;&#20037;&#21270;&#26631;&#35782;&#21644;Java&#26631;&#35782;&#30340;&#20851;&#31995;&#12290; 
</P></DD></DL></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=architecture-jmx></A>2.3.&nbsp;JMX&#25972;&#21512;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>JMX&#26159;&#31649;&#29702;Java&#32452;&#20214;(Java components)&#30340;J2EE&#26631;&#20934;&#12290; Hibernate &#21487;&#20197;&#36890;&#36807;&#19968;&#20010;JMX&#26631;&#20934;&#26381;&#21153;&#26469;&#31649;&#29702;&#12290; 
&#22312;&#36825;&#20010;&#21457;&#34892;&#29256;&#26412;&#20013;&#65292;&#25105;&#20204;&#25552;&#20379;&#20102;&#19968;&#20010;MBean&#25509;&#21475;&#30340;&#23454;&#29616;,&#21363; <TT 
class=literal>org.hibernate.jmx.HibernateService</TT>&#12290; </P>
<P>&#24819;&#35201;&#30475;&#22914;&#20309;&#22312;JBoss&#24212;&#29992;&#26381;&#21153;&#22120;&#19978;&#23558;Hibernate&#37096;&#32626;&#20026;&#19968;&#20010;JMX&#26381;&#21153;&#30340;&#20363;&#23376;&#65292;&#24744;&#21487;&#20197;&#21442;&#32771;JBoss&#29992;&#25143;&#25351;&#21335;&#12290; 
&#25105;&#20204;&#29616;&#22312;&#35828;&#19968;&#19979;&#22312;Jboss&#24212;&#29992;&#26381;&#21153;&#22120;&#19978;&#65292;&#20351;&#29992;JMX&#26469;&#37096;&#32626;Hibernate&#30340;&#22909;&#22788;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>Session&#31649;&#29702;&#65306;</EM></SPAN> Hibernate&#30340;<TT 
  class=literal>Session</TT>&#23545;&#35937;&#30340;&#29983;&#21629;&#21608;&#26399;&#21487;&#20197; &#33258;&#21160;&#36319;&#19968;&#20010;JTA&#20107;&#21153;&#36793;&#30028;&#32465;&#23450;&#12290;&#36825;&#24847;&#21619;&#30528;&#20320;&#26080;&#38656;&#25163;&#24037;&#24320;&#20851;<TT 
  class=literal>Session</TT>&#20102;, &#36825;&#39033; &#24037;&#20316;&#20250;&#30001;JBoss EJB 
  &#25318;&#25130;&#22120;&#26469;&#23436;&#25104;&#12290;&#20320;&#20877;&#20063;&#19981;&#29992;&#25285;&#24515;&#20320;&#30340;&#20195;&#30721;&#20013;&#30340;&#20107;&#21153;&#36793;&#30028;&#20102;(&#38500;&#38750;&#20320;&#24819;&#21033;&#29992;Hibernate&#25552;&#20379;&#21487;&#36873; &#30340;<TT 
  class=literal>Transaction</TT> API&#26469;&#33258;&#24049;&#20889;&#19968;&#20010;&#20415;&#20110;&#31227;&#26893;&#30340;&#30340;&#25345;&#20037;&#23618;)&#12290; &#20320;&#36890;&#36807;&#35843;&#29992;<TT 
  class=literal>HibernateContext</TT>&#26469;&#35775;&#38382;<TT class=literal>Session</TT>&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>HAR &#37096;&#32626;:</EM></SPAN> 
  &#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#20320;&#20250;&#20351;&#29992;JBoss&#30340;&#26381;&#21153;&#37096;&#32626;&#25551;&#36848;&#31526;&#65288;&#22312;EAR&#25110;/&#21644;SAR&#25991;&#20214;&#20013;&#65289;&#26469;&#37096;&#32626;Hibernate JMX&#26381;&#21153;&#12290; 
  &#36825;&#31181;&#37096;&#32626;&#26041;&#24335;&#25903;&#25345;&#25152;&#26377;&#24120;&#35265;&#30340;Hibernate <TT class=literal>SessionFactory</TT>&#30340;&#37197;&#32622;&#36873;&#39033;&#12290; 
  &#19981;&#36807;&#65292;&#20320;&#20173;&#38656;&#22312;&#37096;&#32626;&#25551;&#36848;&#31526;&#20013;&#65292;&#21015;&#20986;&#20320;&#25152;&#26377;&#30340;&#26144;&#23556;&#25991;&#20214;&#30340;&#21517;&#23383;&#12290;&#22914;&#26524;&#20320;&#20351;&#29992;HAR&#37096;&#32626;&#26041;&#24335;, JBoss &#20250;&#33258;&#21160;&#25506;&#27979;&#20986;&#20320;&#30340;HAR&#25991;&#20214;&#20013;&#25152;&#26377;&#30340;&#26144;&#23556;&#25991;&#20214;&#12290; 
  </P></LI></UL></DIV>
<P>&#36825;&#20123;&#36873;&#39033;&#26356;&#22810;&#30340;&#25551;&#36848;&#65292;&#35831;&#21442;&#32771;JBoss &#24212;&#29992;&#31243;&#24207;&#29992;&#25143;&#25351;&#21335;&#12290; </P>
<P>&#23558;Hibernate&#20197;&#37096;&#32626;&#20026;JMX&#26381;&#21153;&#30340;&#21478;&#19968;&#20010;&#22909;&#22788;&#65292;&#26159;&#21487;&#20197;&#26597;&#30475;Hibernate&#30340;&#36816;&#34892;&#26102;&#32479;&#35745;&#20449;&#24687;&#12290;&#21442;&#30475; <A 
title="3.4.6.&nbsp;&#10;                Hibernate&#30340;&#32479;&#35745;(statistics)&#26426;&#21046;&#10;            " 
href="#configuration-optional-statistics">&#31532;&nbsp;3.4.6&nbsp;&#33410; “ 
Hibernate&#30340;&#32479;&#35745;(statistics)&#26426;&#21046; ”</A>. </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=architecture-jca></A>2.4.&nbsp;&#23545;JCA&#30340;&#25903;&#25345;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20063;&#21487;&#20197;&#34987;&#37197;&#32622;&#20026;&#19968;&#20010;JCA&#36830;&#25509;&#22120;&#65288;JCA connector&#65289;&#12290;&#26356;&#22810;&#20449;&#24687;&#35831;&#21442;&#30475;&#32593;&#31449;&#12290; 
&#35831;&#27880;&#24847;&#65292;Hibernate&#23545;JCA&#30340;&#25903;&#25345;&#65292;&#20173;&#22788;&#20110;&#23454;&#39564;&#24615;&#38454;&#27573;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=architecture-current-session></A>2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20351;&#29992;Hibernate&#30340;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#26576;&#31181;&#24418;&#24335;&#30340;“&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;” 
session&#65292;&#29305;&#23450;&#30340;session&#22312;&#25972;&#20010;&#29305;&#23450;&#30340;&#19978;&#19979;&#25991;&#33539;&#22260;&#20869;&#22987;&#32456;&#26377;&#25928;&#12290;&#28982;&#32780;&#65292;&#23545;&#19981;&#21516;&#31867;&#22411;&#30340;&#24212;&#29992;&#31243;&#24207;&#32780;&#35328;&#65292;&#35201;&#20026;&#20160;&#20040;&#26159;&#32452;&#25104;&#36825;&#31181;“&#19978;&#19979;&#25991;”&#19979;&#19968;&#20010;&#23450;&#20041;&#36890;&#24120;&#26159;&#22256;&#38590;&#30340;&#65307;&#19981;&#21516;&#30340;&#19978;&#19979;&#25991;&#23545;“&#24403;&#21069;”&#36825;&#20010;&#27010;&#24565;&#23450;&#20041;&#20102;&#19981;&#21516;&#30340;&#33539;&#22260;&#12290;&#22312;3.0&#29256;&#26412;&#20043;&#21069;&#65292;&#20351;&#29992;Hibernate&#30340;&#31243;&#24207;&#35201;&#20040;&#37319;&#29992;&#33258;&#34892;&#32534;&#20889;&#30340;&#22522;&#20110;<TT 
class=literal>ThreadLocal</TT>&#30340;&#19978;&#19979;&#25991;session&#65292;&#35201;&#20040;&#37319;&#29992;<TT 
class=literal>HibernateUtil</TT>&#36825;&#26679;&#30340;&#36741;&#21161;&#31867;&#65292;&#35201;&#20040;&#37319;&#29992;&#31532;&#19977;&#26041;&#26694;&#26550;&#65288;&#27604;&#22914;Spring&#25110;Pico)&#65292;&#23427;&#20204;&#25552;&#20379;&#20102;&#22522;&#20110;&#20195;&#29702;(proxy)&#25110;&#32773;&#22522;&#20110;&#25318;&#25130;&#22120;(interception)&#30340;&#19978;&#19979;&#25991;&#30456;&#20851;session&#12290; 
</P>
<P>&#20174;3.0.1&#29256;&#26412;&#24320;&#22987;&#65292;Hibernate&#22686;&#21152;&#20102;<TT 
class=literal>SessionFactory.getCurrentSession()</TT>&#26041;&#27861;&#12290;&#19968;&#24320;&#22987;&#65292;&#23427;&#20551;&#23450;&#20102;&#37319;&#29992;<TT 
class=literal>JTA</TT>&#20107;&#21153;&#65292;<TT class=literal>JTA</TT>&#20107;&#21153;&#23450;&#20041;&#20102;&#24403;&#21069;session&#30340;&#33539;&#22260;&#21644;&#19978;&#19979;&#25991;(scope 
and context)&#12290;Hibernate&#24320;&#21457;&#22242;&#38431;&#22362;&#20449;&#65292;&#22240;&#20026;&#26377;&#22909;&#20960;&#20010;&#29420;&#31435;&#30340;<TT class=literal>JTA 
TransactionManager</TT>&#23454;&#29616;&#31283;&#23450;&#21487;&#29992;&#65292;&#19981;&#35770;&#26159;&#21542;&#34987;&#37096;&#32626;&#21040;&#19968;&#20010;<TT 
class=literal>J2EE</TT>&#23481;&#22120;&#20013;&#65292;&#22823;&#22810;&#25968;(&#20551;&#33509;&#19981;&#26159;&#25152;&#26377;&#30340;&#65289;&#24212;&#29992;&#31243;&#24207;&#37117;&#24212;&#35813;&#37319;&#29992;<TT 
class=literal>JTA</TT>&#20107;&#21153;&#31649;&#29702;&#12290;&#22522;&#20110;&#36825;&#19968;&#28857;&#65292;&#37319;&#29992;<TT 
class=literal>JTA</TT>&#30340;&#19978;&#19979;&#25991;&#30456;&#20851;session&#21487;&#20197;&#28385;&#36275;&#20320;&#19968;&#20999;&#38656;&#35201;&#12290; </P>
<P>&#26356;&#22909;&#30340;&#26159;&#65292;&#20174;3.1&#24320;&#22987;&#65292;<TT 
class=literal>SessionFactory.getCurrentSession()</TT>&#30340;&#21518;&#21488;&#23454;&#29616;&#26159;&#21487;&#25300;&#25554;&#30340;&#12290;&#22240;&#27492;&#65292;&#25105;&#20204;&#24341;&#20837;&#20102;&#26032;&#30340;&#25193;&#23637;&#25509;&#21475;(<TT 
class=literal>org.hibernate.context.CurrentSessionContext</TT>)&#21644;&#26032;&#30340;&#37197;&#32622;&#21442;&#25968;(<TT 
class=literal>hibernate.current_session_context_class</TT>)&#65292;&#20197;&#20415;&#23545;&#20160;&#20040;&#26159;“&#24403;&#21069;session”&#30340;&#33539;&#22260;&#21644;&#19978;&#19979;&#25991;(scope 
and context)&#30340;&#23450;&#20041;&#36827;&#34892;&#25300;&#25554;&#12290; </P>
<P>&#35831;&#21442;&#38405;<TT 
class=literal>org.hibernate.context.CurrentSessionContext</TT>&#25509;&#21475;&#30340;Javadoc,&#37027;&#37324;&#26377;&#20851;&#20110;&#23427;&#30340;&#22865;&#32422;&#30340;&#35814;&#32454;&#35752;&#35770;&#12290;&#23427;&#23450;&#20041;&#20102;&#21333;&#19968;&#30340;&#26041;&#27861;&#65292;<TT 
class=literal>currentSession()</TT>&#65292;&#29305;&#23450;&#30340;&#23454;&#29616;&#29992;&#23427;&#26469;&#36127;&#36131;&#36319;&#36394;&#24403;&#21069;&#30340;&#19978;&#19979;&#25991;session&#12290;Hibernate&#20869;&#32622;&#20102;&#27492;&#25509;&#21475;&#30340;&#20004;&#31181;&#23454;&#29616;&#12290; 
</P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><TT class=literal>org.hibernate.context.JTASessionContext</TT> - 
  &#24403;&#21069;session&#26681;&#25454;<TT class=literal>JTA</TT>&#26469;&#36319;&#36394;&#21644;&#30028;&#23450;&#12290;&#36825;&#21644;&#20197;&#21069;&#30340;&#20165;&#25903;&#25345;JTA&#30340;&#26041;&#27861;&#26159;&#23436;&#20840;&#19968;&#26679;&#30340;&#12290;&#35814;&#24773;&#35831;&#21442;&#38405;Javadoc&#12290; 
  </P>
  <LI>
  <P><TT class=literal>org.hibernate.context.ThreadLocalSessionContext</TT> - 
  &#24403;&#21069;session&#36890;&#36807;&#24403;&#21069;&#25191;&#34892;&#30340;&#32447;&#31243;&#26469;&#36319;&#36394;&#21644;&#30028;&#23450;&#12290;&#35814;&#24773;&#20063;&#35831;&#21442;&#38405;Javadoc&#12290; </P></LI></UL></DIV>
<P>&#36825;&#20004;&#31181;&#23454;&#29616;&#37117;&#25552;&#20379;&#20102;“&#27599;&#25968;&#25454;&#24211;&#20107;&#21153;&#23545;&#24212;&#19968;&#20010;session”&#30340;&#32534;&#31243;&#27169;&#22411;&#65292;&#20063;&#31216;&#20316;<SPAN 
class=emphasis><EM>&#27599;&#27425;&#35831;&#27714;&#19968;&#20010;session</EM></SPAN>&#12290;Hibernate 
session&#30340;&#36215;&#22987;&#21644;&#32456;&#32467;&#30001;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#29983;&#23384;&#26469;&#25511;&#21046;&#12290;&#20551;&#33509;&#20320;&#37319;&#29992;&#33258;&#34892;&#32534;&#20889;&#20195;&#30721;&#26469;&#31649;&#29702;&#20107;&#21153;&#65288;&#27604;&#22914;&#65292;&#22312;&#32431;&#31929;&#30340;J2SE,&#25110;&#32773;JTA/UserTransaction/BMT&#65289;&#65292;&#24314;&#35758;&#20320;&#20351;&#29992;Hibernate 
<TT class=literal>Transaction</TT> 
API&#26469;&#25226;&#24213;&#23618;&#20107;&#21153;&#23454;&#29616;&#20174;&#20320;&#30340;&#20195;&#30721;&#20013;&#38544;&#34255;&#25481;&#12290;&#22914;&#26524;&#20320;&#22312;&#25903;&#25345;CMT&#30340;EJB&#23481;&#22120;&#20013;&#25191;&#34892;&#65292;&#20107;&#21153;&#36793;&#30028;&#26159;&#22768;&#26126;&#24335;&#23450;&#20041;&#30340;&#65292;&#20320;&#19981;&#38656;&#35201;&#22312;&#20195;&#30721;&#20013;&#36827;&#34892;&#20219;&#20309;&#20107;&#21153;&#25110;session&#31649;&#29702;&#25805;&#20316;&#12290;&#35831;&#21442;&#38405;<A 
title=&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457; href="#transactions">&#31532;&nbsp;11&nbsp;&#31456; 
<I>&#20107;&#21153;&#21644;&#24182;&#21457;</I></A>&#19968;&#33410;&#26469;&#38405;&#35835;&#26356;&#22810;&#30340;&#20869;&#23481;&#21644;&#31034;&#20363;&#20195;&#30721;&#12290; </P>
<P><TT 
class=literal>hibernate.current_session_context_class</TT>&#37197;&#32622;&#21442;&#25968;&#23450;&#20041;&#20102;&#24212;&#35813;&#37319;&#29992;&#21738;&#20010;<TT 
class=literal>org.hibernate.context.CurrentSessionContext</TT>&#23454;&#29616;&#12290;&#27880;&#24847;&#65292;&#20026;&#20102;&#21521;&#19979;&#20860;&#23481;&#65292;&#22914;&#26524;&#26410;&#37197;&#32622;&#27492;&#21442;&#25968;&#65292;&#20294;&#26159;&#23384;&#22312;<TT 
class=literal>org.hibernate.transaction.TransactionManagerLookup</TT>&#30340;&#37197;&#32622;&#65292;Hibernate&#20250;&#37319;&#29992;<TT 
class=literal>org.hibernate.context.JTASessionContext</TT>&#12290;&#19968;&#33324;&#32780;&#35328;&#65292;&#27492;&#21442;&#25968;&#30340;&#20540;&#25351;&#26126;&#20102;&#35201;&#20351;&#29992;&#30340;&#23454;&#29616;&#31867;&#30340;&#20840;&#21517;&#65292;&#20294;&#37027;&#20004;&#20010;&#20869;&#32622;&#30340;&#23454;&#29616;&#21487;&#20197;&#20351;&#29992;&#31616;&#20889;&#65292;&#21363;"jta"&#21644;"thread"&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=session-configuration></A>&#31532;&nbsp;3&nbsp;&#31456;&nbsp; &#37197;&#32622; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#30001;&#20110;Hibernate&#26159;&#20026;&#20102;&#33021;&#22312;&#21508;&#31181;&#19981;&#21516;&#29615;&#22659;&#19979;&#24037;&#20316;&#32780;&#35774;&#35745;&#30340;, &#22240;&#27492;&#23384;&#22312;&#30528;&#22823;&#37327;&#30340;&#37197;&#32622;&#21442;&#25968;. &#24184;&#36816;&#30340;&#26159;&#22810;&#25968;&#37197;&#32622;&#21442;&#25968;&#37117; &#26377;&#27604;&#36739;&#30452;&#35266;&#30340;&#40664;&#35748;&#20540;, 
&#24182;&#26377;&#38543;Hibernate&#19968;&#21516;&#20998;&#21457;&#30340;&#37197;&#32622;&#26679;&#20363;<TT class=literal>hibernate.properties</TT> (&#20301;&#20110;<TT 
class=literal>etc/</TT>)&#26469;&#23637;&#31034;&#21508;&#31181;&#37197;&#32622;&#36873;&#39033;. &#25152;&#38656;&#20570;&#30340;&#20165;&#20165;&#26159;&#23558;&#36825;&#20010;&#26679;&#20363;&#25991;&#20214;&#22797;&#21046;&#21040;&#31867;&#36335;&#24452; (classpath)&#19979;&#24182;&#20570;&#19968;&#20123;&#33258;&#23450;&#20041;&#30340;&#20462;&#25913;. 
</P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-programmatic></A>3.1.&nbsp; &#21487;&#32534;&#31243;&#30340;&#37197;&#32622;&#26041;&#24335; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;<TT class=literal>org.hibernate.cfg.Configuration</TT>&#23454;&#20363;&#20195;&#34920;&#20102;&#19968;&#20010;&#24212;&#29992;&#31243;&#24207;&#20013;Java&#31867;&#22411; 
&#21040;SQL&#25968;&#25454;&#24211;&#26144;&#23556;&#30340;&#23436;&#25972;&#38598;&#21512;. <TT class=literal>Configuration</TT>&#34987;&#29992;&#26469;&#26500;&#24314;&#19968;&#20010;(&#19981;&#21487;&#21464;&#30340; (immutable))<TT 
class=literal>SessionFactory</TT>. &#26144;&#23556;&#23450;&#20041;&#21017;&#30001;&#19981;&#21516;&#30340;XML&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;&#32534;&#35793;&#32780;&#26469;. </P>
<P>&#20320;&#21487;&#20197;&#30452;&#25509;&#23454;&#20363;&#21270;<TT class=literal>Configuration</TT>&#26469;&#33719;&#21462;&#19968;&#20010;&#23454;&#20363;&#65292;&#24182;&#20026;&#23427;&#25351;&#23450;XML&#26144;&#23556;&#23450;&#20041; &#25991;&#20214;. &#22914;&#26524;&#26144;&#23556;&#23450; 
&#20041;&#25991;&#20214;&#22312;&#31867;&#36335;&#24452;(classpath)&#20013;, &#35831;&#20351;&#29992;<TT class=literal>addResource()</TT>: </P><PRE class=programlisting>Configuration cfg = new Configuration()
    .addResource("Item.hbm.xml")
    .addResource("Bid.hbm.xml");</PRE>
<P>&#19968;&#20010;&#26367;&#20195;&#26041;&#27861;&#65288;&#26377;&#26102;&#26159;&#26356;&#22909;&#30340;&#36873;&#25321;&#65289;&#26159;&#65292;&#25351;&#23450;&#34987;&#26144;&#23556;&#30340;&#31867;&#65292;&#35753;Hibernate&#24110;&#20320;&#23547;&#25214;&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;: </P><PRE class=programlisting>Configuration cfg = new Configuration()
    .addClass(org.hibernate.auction.Item.class)
    .addClass(org.hibernate.auction.Bid.class);</PRE>
<P>Hibernate&#23558;&#20250;&#22312;&#31867;&#36335;&#24452;(classpath)&#20013;&#23547;&#25214;&#21517;&#23383;&#20026; <TT 
class=literal>/org/hibernate/auction/Item.hbm.xml</TT>&#21644; <TT 
class=literal>/org/hibernate/auction/Bid.hbm.xml</TT>&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;. 
&#36825;&#31181;&#26041;&#24335;&#28040;&#38500;&#20102;&#20219;&#20309;&#23545;&#25991;&#20214;&#21517;&#30340;&#30828;&#32534;&#30721;(hardcoded). </P>
<P><TT class=literal>Configuration</TT>&#20063;&#20801;&#35768;&#20320;&#25351;&#23450;&#37197;&#32622;&#23646;&#24615;: </P><PRE class=programlisting>Configuration cfg = new Configuration()
    .addClass(org.hibernate.auction.Item.class)
    .addClass(org.hibernate.auction.Bid.class)
    .setProperty("hibernate.dialect", "org.hibernate.dialect.MySQLInnoDBDialect")
    .setProperty("hibernate.connection.datasource", "java:comp/env/jdbc/test")
    .setProperty("hibernate.order_updates", "true");</PRE>
<P>&#24403;&#28982;&#36825;&#19981;&#26159;&#21807;&#19968;&#30340;&#20256;&#36882;Hibernate&#37197;&#32622;&#23646;&#24615;&#30340;&#26041;&#24335;, &#20854;&#20182;&#21487;&#36873;&#26041;&#24335;&#36824;&#21253;&#25324;: </P>
<DIV class=orderedlist>
<OL type=1 compact>
  <LI>
  <P>&#20256;&#19968;&#20010;<TT class=literal>java.util.Properties</TT>&#23454;&#20363;&#32473; <TT 
  class=literal>Configuration.setProperties()</TT>. </P>
  <LI>
  <P>&#23558;<TT class=literal>hibernate.properties</TT>&#25918;&#32622;&#22312;&#31867;&#36335;&#24452;(classpath)&#30340;&#26681;&#30446;&#24405;&#19979; (root 
  directory). </P>
  <LI>
  <P>&#36890;&#36807;<TT class=literal>java -Dproperty=value</TT>&#26469;&#35774;&#32622;&#31995;&#32479; (<TT 
  class=literal>System</TT>)&#23646;&#24615;. </P>
  <LI>
  <P>&#22312;<TT class=literal>hibernate.cfg.xml</TT>&#20013;&#21152;&#20837;&#20803;&#32032; <TT 
  class=literal>&lt;property&gt;</TT> (&#31245;&#21518;&#35752;&#35770;). </P></LI></OL></DIV>
<P>&#22914;&#26524;&#24819;&#23613;&#24555;&#20307;&#39564;Hibernate, <TT class=literal>hibernate.properties</TT>&#26159;&#26368;&#31616;&#21333;&#30340;&#26041;&#24335;. </P>
<P><TT class=literal>Configuration</TT>&#23454;&#20363;&#34987;&#35774;&#35745;&#25104;&#21551;&#21160;&#26399;&#38388;&#65288;startup-time&#65289;&#23545;&#35937;, &#19968;&#26086;<TT 
class=literal>SessionFactory</TT>&#21019;&#24314;&#23436;&#25104;&#23427;&#23601;&#34987;&#20002;&#24323;&#20102;. </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-sessionfactory></A>3.2.&nbsp; &#33719;&#24471;SessionFactory 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24403;&#25152;&#26377;&#26144;&#23556;&#23450;&#20041;&#34987;<TT class=literal>Configuration</TT>&#35299;&#26512;&#21518;, &#24212;&#29992;&#31243;&#24207;&#24517;&#39035;&#33719;&#24471;&#19968;&#20010;&#29992;&#20110;&#26500;&#36896;<TT 
class=literal>Session</TT>&#23454;&#20363;&#30340;&#24037;&#21378;. &#36825;&#20010;&#24037;&#21378;&#23558;&#34987;&#24212;&#29992;&#31243;&#24207;&#30340;&#25152;&#26377;&#32447;&#31243;&#20849;&#20139;: </P><PRE class=programlisting>SessionFactory sessions = cfg.buildSessionFactory();</PRE>
<P>Hibernate&#20801;&#35768;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#21019;&#24314;&#22810;&#20010;<TT class=literal>SessionFactory</TT>&#23454;&#20363;. &#36825;&#23545; 
&#20351;&#29992;&#22810;&#20010;&#25968;&#25454;&#24211;&#30340;&#24212;&#29992;&#26469;&#35828;&#24456;&#26377;&#29992;. </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-hibernatejdbc></A>3.3.&nbsp; JDBC&#36830;&#25509; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36890;&#24120;&#20320;&#24076;&#26395;<TT class=literal>SessionFactory</TT>&#26469;&#20026;&#20320;&#21019;&#24314;&#21644;&#32531;&#23384;(pool)JDBC&#36830;&#25509;. &#22914;&#26524;&#20320;&#37319;&#29992;&#36825;&#31181;&#26041;&#24335;, 
&#21482;&#38656;&#35201;&#22914;&#19979;&#20363;&#25152;&#31034;&#37027;&#26679;&#65292;&#25171;&#24320;&#19968;&#20010;<TT class=literal>Session</TT>: </P><PRE class=programlisting>Session session = sessions.openSession(); // open a new Session</PRE>
<P>&#19968;&#26086;&#20320;&#38656;&#35201;&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;&#26102;, &#23601;&#20250;&#20174;&#36830;&#25509;&#27744;(connection pool)&#33719;&#24471;&#19968;&#20010;JDBC&#36830;&#25509;. </P>
<P>&#20026;&#20102;&#20351;&#36825;&#31181;&#26041;&#24335;&#24037;&#20316;&#36215;&#26469;, &#25105;&#20204;&#38656;&#35201;&#21521;Hibernate&#20256;&#36882;&#19968;&#20123;JDBC&#36830;&#25509;&#30340;&#23646;&#24615;. &#25152;&#26377;Hibernate&#23646;&#24615;&#30340;&#21517;&#23383;&#21644;&#35821;&#20041;&#37117;&#22312;<TT 
class=literal>org.hibernate.cfg.Environment</TT>&#20013;&#23450;&#20041;. &#25105;&#20204;&#29616;&#22312;&#23558;&#25551;&#36848;JDBC&#36830;&#25509;&#37197;&#32622;&#20013;&#26368;&#37325;&#35201;&#30340;&#35774;&#32622;. 
</P>
<P>&#22914;&#26524;&#20320;&#35774;&#32622;&#22914;&#19979;&#23646;&#24615;&#65292;Hibernate&#23558;&#20351;&#29992;<TT 
class=literal>java.sql.DriverManager</TT>&#26469;&#33719;&#24471;(&#21644;&#32531;&#23384;)JDBC&#36830;&#25509; : </P>
<DIV class=table><A name=d0e2006></A>
<P class=title><B>&#34920;&nbsp;3.1.&nbsp; Hibernate JDBC&#23646;&#24615; </B></P>
<TABLE summary="&#10;                Hibernate JDBC&#23646;&#24615;&#10;            " 
border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.connection.driver_class</TT></TD>
    <TD><SPAN class=emphasis><EM>jdbc&#39537;&#21160;&#31867;</EM></SPAN></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.url</TT></TD>
    <TD><SPAN class=emphasis><EM>jdbc URL</EM></SPAN></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.username</TT></TD>
    <TD><SPAN class=emphasis><EM>&#25968;&#25454;&#24211;&#29992;&#25143;</EM></SPAN></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.password</TT></TD>
    <TD><SPAN class=emphasis><EM>&#25968;&#25454;&#24211;&#29992;&#25143;&#23494;&#30721;</EM></SPAN></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.pool_size</TT></TD>
    <TD><SPAN 
class=emphasis><EM>&#36830;&#25509;&#27744;&#23481;&#37327;&#19978;&#38480;&#25968;&#30446;</EM></SPAN></TD></TR></TBODY></TABLE></DIV>
<P>&#20294;Hibernate&#33258;&#24102;&#30340;&#36830;&#25509;&#27744;&#31639;&#27861;&#30456;&#24403;&#19981;&#25104;&#29087;. &#23427;&#21482;&#26159;&#20026;&#20102;&#35753;&#20320;&#24555;&#20123;&#19978;&#25163;<SPAN 
class=emphasis><EM>&#65292;&#24182;&#19981;&#36866;&#21512;&#29992;&#20110;&#20135;&#21697;&#31995;&#32479;</EM></SPAN>&#25110;&#24615;&#33021;&#27979;&#35797;&#20013;&#12290; 
&#20986;&#20110;&#26368;&#20339;&#24615;&#33021;&#21644;&#31283;&#23450;&#24615;&#32771;&#34385;&#20320;&#24212;&#35813;&#20351;&#29992;&#31532;&#19977;&#26041;&#30340;&#36830;&#25509;&#27744;&#12290;&#21482;&#38656;&#35201;&#29992;&#29305;&#23450;&#36830;&#25509;&#27744;&#30340;&#35774;&#32622;&#26367;&#25442; <TT 
class=literal>hibernate.connection.pool_size</TT>&#21363;&#21487;&#12290;&#36825;&#23558;&#20851;&#38381;Hibernate&#33258;&#24102;&#30340;&#36830;&#25509;&#27744;. &#20363;&#22914;, 
&#20320;&#21487;&#33021;&#20250;&#24819;&#29992;C3P0. </P>
<P>C3P0&#26159;&#19968;&#20010;&#38543;Hibernate&#19968;&#21516;&#20998;&#21457;&#30340;&#24320;&#28304;&#30340;JDBC&#36830;&#25509;&#27744;, &#23427;&#20301;&#20110;<TT class=literal>lib</TT>&#30446;&#24405;&#19979;&#12290; &#22914;&#26524;&#20320;&#35774;&#32622;&#20102;<TT 
class=literal>hibernate.c3p0.*</TT>&#30456;&#20851;&#30340;&#23646;&#24615;, Hibernate&#23558;&#20351;&#29992; <TT 
class=literal>C3P0ConnectionProvider</TT>&#26469;&#32531;&#23384;JDBC&#36830;&#25509;. &#22914;&#26524;&#20320;&#26356;&#21407;&#24847;&#20351;&#29992;Proxool, &#35831;&#21442;&#32771;&#21457; 
&#34892;&#21253;&#20013;&#30340;<TT class=literal>hibernate.properties</TT>&#24182;&#21040;Hibernate&#32593;&#31449;&#33719;&#21462;&#26356;&#22810;&#30340;&#20449;&#24687;. </P>
<P>&#36825;&#26159;&#19968;&#20010;&#20351;&#29992;C3P0&#30340;<TT class=literal>hibernate.properties</TT>&#26679;&#20363;&#25991;&#20214;: </P><A 
name=c3p0-configuration></A><PRE class=programlisting>hibernate.connection.driver_class = org.postgresql.Driver
hibernate.connection.url = jdbc:postgresql://localhost/mydatabase
hibernate.connection.username = myuser
hibernate.connection.password = secret
hibernate.c3p0.min_size=5
hibernate.c3p0.max_size=20
hibernate.c3p0.timeout=1800
hibernate.c3p0.max_statements=50
hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect</PRE>
<P>&#20026;&#20102;&#33021;&#22312;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;(application server)&#20013;&#20351;&#29992;Hibernate, &#24212;&#24403;&#24635;&#26159;&#23558;Hibernate &#37197;&#32622;&#25104;&#20174;&#27880;&#20876;&#22312;JNDI&#20013;&#30340;<TT 
class=literal>Datasource</TT>&#22788;&#33719;&#24471;&#36830;&#25509;&#65292;&#20320;&#33267;&#23569;&#38656;&#35201;&#35774;&#32622;&#19979;&#21015;&#23646;&#24615;&#20013;&#30340;&#19968;&#20010;: </P>
<DIV class=table><A name=d0e2088></A>
<P class=title><B>&#34920;&nbsp;3.2.&nbsp; Hibernate&#25968;&#25454;&#28304;&#23646;&#24615; </B></P>
<TABLE summary="&#10;                Hibernate&#25968;&#25454;&#28304;&#23646;&#24615;&#10;            " 
  border=1><COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.connection.datasource</TT></TD>
    <TD><SPAN class=emphasis><EM>&#25968;&#25454;&#28304;JNDI&#21517;&#23383;</EM></SPAN></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jndi.url</TT></TD>
    <TD><SPAN class=emphasis><EM>JNDI&#25552;&#20379;&#32773;&#30340;URL</EM></SPAN> (&#21487;&#36873;) </TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jndi.class</TT></TD>
    <TD><SPAN class=emphasis><EM>JNDI <TT 
      class=literal>InitialContextFactory</TT>&#31867;</EM></SPAN> (&#21487;&#36873;) </TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.username</TT></TD>
    <TD><SPAN class=emphasis><EM>&#25968;&#25454;&#24211;&#29992;&#25143;</EM></SPAN> (&#21487;&#36873;) </TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.password</TT></TD>
    <TD><SPAN class=emphasis><EM>&#25968;&#25454;&#24211;&#29992;&#25143;&#23494;&#30721;</EM></SPAN> (&#21487;&#36873;) 
</TD></TR></TBODY></TABLE></DIV>
<P>&#36825;&#26159;&#19968;&#20010;&#20351;&#29992;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#25552;&#20379;&#30340;JNDI&#25968;&#25454;&#28304;&#30340;<TT class=literal>hibernate.properties</TT>&#26679;&#20363;&#25991;&#20214;: </P><PRE class=programlisting>hibernate.connection.datasource = java:/comp/env/jdbc/test
hibernate.transaction.factory_class = \
    org.hibernate.transaction.JTATransactionFactory
hibernate.transaction.manager_lookup_class = \
    org.hibernate.transaction.JBossTransactionManagerLookup
hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect</PRE>
<P>&#20174;JNDI&#25968;&#25454;&#28304;&#33719;&#24471;&#30340;JDBC&#36830;&#25509;&#23558;&#33258;&#21160;&#21442;&#19982;&#21040;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#20013;&#23481;&#22120;&#31649;&#29702;&#30340;&#20107;&#21153;(container-managed transactions)&#20013;&#21435;. 
</P>
<P>&#20219;&#20309;&#36830;&#25509;(connection)&#23646;&#24615;&#30340;&#23646;&#24615;&#21517;&#37117;&#35201;&#20197;"<TT class=literal>hibernate.connnection</TT>"&#24320;&#22836;. 
&#20363;&#22914;, &#20320;&#21487;&#33021;&#20250;&#20351;&#29992;<TT class=literal>hibernate.connection.charSet</TT>&#26469;&#25351;&#23450;&#23383;&#31526;&#38598;<TT 
class=literal>charSet</TT>. </P>
<P>&#36890;&#36807;&#23454;&#29616;<TT 
class=literal>org.hibernate.connection.ConnectionProvider</TT>&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#23450;&#20041;&#23646;&#20110; 
&#20320;&#33258;&#24049;&#30340;&#33719;&#24471;JDBC&#36830;&#25509;&#30340;&#25554;&#20214;&#31574;&#30053;&#12290;&#36890;&#36807;&#35774;&#32622;<TT 
class=literal>hibernate.connection.provider_class</TT>&#65292; &#20320;&#21487;&#20197;&#36873;&#25321;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;&#23454;&#29616;. 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-optional></A>3.4.&nbsp; &#21487;&#36873;&#30340;&#37197;&#32622;&#23646;&#24615; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26377;&#22823;&#37327;&#23646;&#24615;&#33021;&#29992;&#26469;&#25511;&#21046;Hibernate&#22312;&#36816;&#34892;&#26399;&#30340;&#34892;&#20026;. &#23427;&#20204;&#37117;&#26159;&#21487;&#36873;&#30340;, &#24182;&#25317;&#26377;&#36866;&#24403;&#30340;&#40664;&#35748;&#20540;. </P>
<P><SPAN class=emphasis><EM>&#35686;&#21578;: &#20854;&#20013;&#19968;&#20123;&#23646;&#24615;&#26159;"&#31995;&#32479;&#32423;(system-level)&#30340;".</EM></SPAN> 
&#31995;&#32479;&#32423;&#23646;&#24615;&#21482;&#33021;&#36890;&#36807;<TT class=literal>java -Dproperty=value</TT>&#25110; <TT 
class=literal>hibernate.properties</TT>&#26469;&#35774;&#32622;, &#32780;<SPAN 
class=emphasis><EM>&#19981;&#33021;</EM></SPAN>&#29992;&#19978;&#38754;&#25551;&#36848;&#30340;&#20854;&#20182;&#26041;&#27861;&#26469;&#35774;&#32622;. </P>
<DIV class=table><A name=configuration-optional-properties></A>
<P class=title><B>&#34920;&nbsp;3.3.&nbsp; Hibernate&#37197;&#32622;&#23646;&#24615; </B></P>
<TABLE summary="&#10;                Hibernate&#37197;&#32622;&#23646;&#24615;&#10;            " border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.dialect</TT></TD>
    <TD>&#19968;&#20010;Hibernate <TT 
      class=literal>Dialect</TT>&#31867;&#21517;&#20801;&#35768;Hibernate&#38024;&#23545;&#29305;&#23450;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#29983;&#25104;&#20248;&#21270;&#30340;SQL. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>full.classname.of.Dialect</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.show_sql</TT></TD>
    <TD>&#36755;&#20986;&#25152;&#26377;SQL&#35821;&#21477;&#21040;&#25511;&#21046;&#21488;. &#26377;&#19968;&#20010;&#21478;&#22806;&#30340;&#36873;&#25321;&#26159;&#25226;<TT class=literal>org.hibernate.SQL</TT>&#36825;&#20010;log 
      category&#35774;&#20026;<TT class=literal>debug</TT>&#12290; 
      <P><SPAN class=strong>eg.</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.format_sql</TT></TD>
    <TD>&#22312;log&#21644;console&#20013;&#25171;&#21360;&#20986;&#26356;&#28418;&#20142;&#30340;SQL&#12290; 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.default_schema</TT></TD>
    <TD>&#22312;&#29983;&#25104;&#30340;SQL&#20013;, &#23558;&#32473;&#23450;&#30340;schema/tablespace&#38468;&#21152;&#20110;&#38750;&#20840;&#38480;&#23450;&#21517;&#30340;&#34920;&#21517;&#19978;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>SCHEMA_NAME</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.default_catalog</TT></TD>
    <TD>&#22312;&#29983;&#25104;&#30340;SQL&#20013;, &#23558;&#32473;&#23450;&#30340;catalog&#38468;&#21152;&#20110;&#38750;&#20840;&#38480;&#23450;&#21517;&#30340;&#34920;&#21517;&#19978;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>CATALOG_NAME</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.session_factory_name</TT></TD>
    <TD><TT class=literal>SessionFactory</TT>&#21019;&#24314;&#21518;&#65292;&#23558;&#33258;&#21160;&#20351;&#29992;&#36825;&#20010;&#21517;&#23383;&#32465;&#23450;&#21040;JNDI&#20013;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>jndi/composite/name</TT> 
      </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.max_fetch_depth</TT></TD>
    <TD>&#20026;&#21333;&#21521;&#20851;&#32852;(&#19968;&#23545;&#19968;, &#22810;&#23545;&#19968;)&#30340;&#22806;&#36830;&#25509;&#25235;&#21462;&#65288;outer join fetch&#65289;&#26641;&#35774;&#32622;&#26368;&#22823;&#28145;&#24230;. &#20540;&#20026;<TT 
      class=literal>0</TT>&#24847;&#21619;&#30528;&#23558;&#20851;&#38381;&#40664;&#35748;&#30340;&#22806;&#36830;&#25509;&#25235;&#21462;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> &#24314;&#35758;&#22312;<TT class=literal>0</TT>&#21040;<TT 
      class=literal>3</TT>&#20043;&#38388;&#21462;&#20540; </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.default_batch_fetch_size</TT></TD>
    <TD>&#20026;Hibernate&#20851;&#32852;&#30340;&#25209;&#37327;&#25235;&#21462;&#35774;&#32622;&#40664;&#35748;&#25968;&#37327;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> &#24314;&#35758;&#30340;&#21462;&#20540;&#20026;<TT class=literal>4</TT>, <TT 
      class=literal>8</TT>, &#21644;<TT class=literal>16</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.default_entity_mode</TT></TD>
    <TD>&#20026;&#30001;&#36825;&#20010;<TT class=literal>SessionFactory</TT>&#25171;&#24320;&#30340;&#25152;&#26377;Session&#25351;&#23450;&#40664;&#35748;&#30340;&#23454;&#20307;&#34920;&#29616;&#27169;&#24335;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>dynamic-map</TT>, <TT 
      class=literal>dom4j</TT>, <TT class=literal>pojo</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.order_updates</TT></TD>
    <TD>&#24378;&#21046;Hibernate&#25353;&#29031;&#34987;&#26356;&#26032;&#25968;&#25454;&#30340;&#20027;&#38190;&#65292;&#20026;SQL&#26356;&#26032;&#25490;&#24207;&#12290;&#36825;&#20040;&#20570;&#23558;&#20943;&#23569;&#22312;&#39640;&#24182;&#21457;&#31995;&#32479;&#20013;&#20107;&#21153;&#30340;&#27515;&#38145;&#12290; 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.generate_statistics</TT></TD>
    <TD>&#22914;&#26524;&#24320;&#21551;, Hibernate&#23558;&#25910;&#38598;&#26377;&#21161;&#20110;&#24615;&#33021;&#35843;&#33410;&#30340;&#32479;&#35745;&#25968;&#25454;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.use_identifer_rollback</TT></TD>
    <TD>&#22914;&#26524;&#24320;&#21551;, &#22312;&#23545;&#35937;&#34987;&#21024;&#38500;&#26102;&#29983;&#25104;&#30340;&#26631;&#35782;&#23646;&#24615;&#23558;&#34987;&#37325;&#35774;&#20026;&#40664;&#35748;&#20540;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.use_sql_comments</TT></TD>
    <TD>&#22914;&#26524;&#24320;&#21551;, Hibernate&#23558;&#22312;SQL&#20013;&#29983;&#25104;&#26377;&#21161;&#20110;&#35843;&#35797;&#30340;&#27880;&#37322;&#20449;&#24687;, &#40664;&#35748;&#20540;&#20026;<TT class=literal>false</TT>. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR></TBODY></TABLE></DIV>
<DIV class=table><A name=configuration-jdbc-properties></A>
<P class=title><B>&#34920;&nbsp;3.4.&nbsp; Hibernate JDBC&#21644;&#36830;&#25509;(connection)&#23646;&#24615; </B></P>
<TABLE 
summary="&#10;                Hibernate JDBC&#21644;&#36830;&#25509;(connection)&#23646;&#24615;&#10;            " 
border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.fetch_size</TT></TD>
    <TD>&#38750;&#38646;&#20540;&#65292;&#25351;&#23450;JDBC&#25235;&#21462;&#25968;&#37327;&#30340;&#22823;&#23567; (&#35843;&#29992;<TT class=literal>Statement.setFetchSize()</TT>). 
    </TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.batch_size</TT></TD>
    <TD>&#38750;&#38646;&#20540;&#65292;&#20801;&#35768;Hibernate&#20351;&#29992;JDBC2&#30340;&#25209;&#37327;&#26356;&#26032;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> &#24314;&#35758;&#21462;<TT class=literal>5</TT>&#21040;<TT 
      class=literal>30</TT>&#20043;&#38388;&#30340;&#20540; </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.batch_versioned_data</TT></TD>
    <TD>&#22914;&#26524;&#20320;&#24819;&#35753;&#20320;&#30340;JDBC&#39537;&#21160;&#20174;<TT class=literal>executeBatch()</TT>&#36820;&#22238;&#27491;&#30830;&#30340;&#34892;&#35745;&#25968; , 
      &#37027;&#20040;&#23558;&#27492;&#23646;&#24615;&#35774;&#20026;<TT class=literal>true</TT>(&#24320;&#21551;&#36825;&#20010;&#36873;&#39033;&#36890;&#24120;&#26159;&#23433;&#20840;&#30340;). 
      &#21516;&#26102;&#65292;Hibernate&#23558;&#20026;&#33258;&#21160;&#29256;&#26412;&#21270;&#30340;&#25968;&#25454;&#20351;&#29992;&#25209;&#37327;DML. &#40664;&#35748;&#20540;&#20026;<TT class=literal>false</TT>. 
      <P><SPAN class=strong>eg.</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.factory_class</TT></TD>
    <TD>&#36873;&#25321;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<TT class=literal>Batcher</TT>. &#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#19981;&#38656;&#35201;&#36825;&#20010;&#37197;&#32622;&#23646;&#24615;. 
      <P><SPAN class=strong>eg.</SPAN> <TT 
      class=literal>classname.of.Batcher</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.use_scrollable_resultset</TT></TD>
    <TD>&#20801;&#35768;Hibernate&#20351;&#29992;JDBC2&#30340;&#21487;&#28378;&#21160;&#32467;&#26524;&#38598;. &#21482;&#26377;&#22312;&#20351;&#29992;&#29992;&#25143;&#25552;&#20379;&#30340;JDBC&#36830;&#25509;&#26102;&#65292;&#36825;&#20010;&#36873;&#39033;&#25165;&#26159;&#24517;&#35201;&#30340;, 
      &#21542;&#21017;Hibernate&#20250;&#20351;&#29992;&#36830;&#25509;&#30340;&#20803;&#25968;&#25454;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.use_streams_for_binary</TT></TD>
    <TD>&#22312;JDBC&#35835;&#20889;<TT class=literal>binary (&#20108;&#36827;&#21046;)</TT>&#25110;<TT 
      class=literal>serializable (&#21487;&#24207;&#21015;&#21270;)</TT> &#30340;&#31867;&#22411;&#26102;&#20351;&#29992;&#27969;(stream)(&#31995;&#32479;&#32423;&#23646;&#24615;). 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jdbc.use_get_generated_keys</TT></TD>
    <TD>&#22312;&#25968;&#25454;&#25554;&#20837;&#25968;&#25454;&#24211;&#20043;&#21518;&#65292;&#20801;&#35768;&#20351;&#29992;JDBC3 <TT 
      class=literal>PreparedStatement.getGeneratedKeys()</TT> 
      &#26469;&#33719;&#21462;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;key(&#38190;)&#12290;&#38656;&#35201;JDBC3+&#39537;&#21160;&#21644;JRE1.4+, &#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#39537;&#21160;&#22312;&#20351;&#29992;Hibernate&#30340;&#26631; 
      &#35782;&#29983;&#25104;&#22120;&#26102;&#36935;&#21040;&#38382;&#39064;&#65292;&#35831;&#23558;&#27492;&#20540;&#35774;&#20026;false. &#40664;&#35748;&#24773;&#20917;&#19979;&#23558;&#20351;&#29992;&#36830;&#25509;&#30340;&#20803;&#25968;&#25454;&#26469;&#21028;&#23450;&#39537;&#21160;&#30340;&#33021;&#21147;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true|false</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.provider_class</TT></TD>
    <TD>&#33258;&#23450;&#20041;<TT class=literal>ConnectionProvider</TT>&#30340;&#31867;&#21517;, 
      &#27492;&#31867;&#29992;&#26469;&#21521;Hibernate&#25552;&#20379;JDBC&#36830;&#25509;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>classname.of.ConnectionProvider</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.isolation</TT></TD>
    <TD>&#35774;&#32622;JDBC&#20107;&#21153;&#38548;&#31163;&#32423;&#21035;. &#26597;&#30475;<TT class=literal>java.sql.Connection</TT>&#26469;&#20102;&#35299;&#21508;&#20010;&#20540;&#30340;&#20855;&#20307;&#24847;&#20041;, 
      &#20294;&#35831;&#27880;&#24847;&#22810;&#25968;&#25968;&#25454;&#24211;&#37117;&#19981;&#25903;&#25345;&#25152;&#26377;&#30340;&#38548;&#31163;&#32423;&#21035;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>1, 2, 4, 8</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.autocommit</TT></TD>
    <TD>&#20801;&#35768;&#34987;&#32531;&#23384;&#30340;JDBC&#36830;&#25509;&#24320;&#21551;&#33258;&#21160;&#25552;&#20132;(autocommit) (&#19981;&#24314;&#35758;). 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.release_mode</TT></TD>
    <TD>&#25351;&#23450;Hibernate&#22312;&#20309;&#26102;&#37322;&#25918;JDBC&#36830;&#25509;. &#40664;&#35748;&#24773;&#20917;&#19979;,&#30452;&#21040;Session&#34987;&#26174;&#24335;&#20851;&#38381;&#25110;&#34987;&#26029;&#24320;&#36830;&#25509;&#26102;,&#25165;&#20250;&#37322;&#25918;JDBC&#36830;&#25509;. 
      &#23545;&#20110;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#30340;JTA&#25968;&#25454;&#28304;, &#20320;&#24212;&#24403;&#20351;&#29992;<TT class=literal>after_statement</TT>, 
      &#36825;&#26679;&#22312;&#27599;&#27425;JDBC&#35843;&#29992;&#21518;&#65292;&#37117;&#20250;&#20027;&#21160;&#30340;&#37322;&#25918;&#36830;&#25509;. &#23545;&#20110;&#38750;JTA&#30340;&#36830;&#25509;, &#20351;&#29992;<TT 
      class=literal>after_transaction</TT>&#22312;&#27599;&#20010;&#20107;&#21153;&#32467;&#26463;&#26102;&#37322;&#25918;&#36830;&#25509;&#26159;&#21512;&#29702;&#30340;. <TT 
      class=literal>auto</TT>&#23558;&#20026;JTA&#21644;CMT&#20107;&#21153;&#31574;&#30053;&#36873;&#25321;<TT 
      class=literal>after_statement</TT>, &#20026;JDBC&#20107;&#21153;&#31574;&#30053;&#36873;&#25321;<TT 
      class=literal>after_transaction</TT>. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>on_close</TT> | <TT 
      class=literal>after_transaction</TT> | <TT 
      class=literal>after_statement</TT> | <TT class=literal>auto</TT> 
</P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.<SPAN 
      class=emphasis><EM>&lt;propertyName&gt;</EM></SPAN></TT></TD>
    <TD>&#23558;JDBC&#23646;&#24615;<TT class=literal>propertyName</TT>&#20256;&#36882;&#21040;<TT 
      class=literal>DriverManager.getConnection()</TT>&#20013;&#21435;. </TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.jndi.<SPAN 
      class=emphasis><EM>&lt;propertyName&gt;</EM></SPAN></TT></TD>
    <TD>&#23558;&#23646;&#24615;<TT class=literal>propertyName</TT>&#20256;&#36882;&#21040;JNDI <TT 
      class=literal>InitialContextFactory</TT>&#20013;&#21435;. </TD></TR></TBODY></TABLE></DIV>
<DIV class=table><A name=configuration-cache-properties></A>
<P class=title><B>&#34920;&nbsp;3.5.&nbsp; Hibernate&#32531;&#23384;&#23646;&#24615; </B></P>
<TABLE summary="&#10;                Hibernate&#32531;&#23384;&#23646;&#24615;&#10;            " border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.cache.provider_class</TT></TD>
    <TD>&#33258;&#23450;&#20041;&#30340;<TT class=literal>CacheProvider</TT>&#30340;&#31867;&#21517;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>classname.of.CacheProvider</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.use_minimal_puts</TT></TD>
    <TD>&#20197;&#39057;&#32321;&#30340;&#35835;&#25805;&#20316;&#20026;&#20195;&#20215;, &#20248;&#21270;&#20108;&#32423;&#32531;&#23384;&#26469;&#26368;&#23567;&#21270;&#20889;&#25805;&#20316;. &#22312;Hibernate3&#20013;&#65292;&#36825;&#20010;&#35774;&#32622;&#23545;&#30340;&#38598;&#32676;&#32531;&#23384;&#38750;&#24120;&#26377;&#29992;, 
      &#23545;&#38598;&#32676;&#32531;&#23384;&#30340;&#23454;&#29616;&#32780;&#35328;&#65292;&#40664;&#35748;&#26159;&#24320;&#21551;&#30340;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true|false</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.use_query_cache</TT></TD>
    <TD>&#20801;&#35768;&#26597;&#35810;&#32531;&#23384;, &#20010;&#21035;&#26597;&#35810;&#20173;&#28982;&#38656;&#35201;&#34987;&#35774;&#32622;&#20026;&#21487;&#32531;&#23384;&#30340;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true|false</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.use_second_level_cache</TT></TD>
    <TD>&#33021;&#29992;&#26469;&#23436;&#20840;&#31105;&#27490;&#20351;&#29992;&#20108;&#32423;&#32531;&#23384;. &#23545;&#37027;&#20123;&#22312;&#31867;&#30340;&#26144;&#23556;&#23450;&#20041;&#20013;&#25351;&#23450;<TT 
      class=literal>&lt;cache&gt;</TT>&#30340;&#31867;&#65292;&#20250;&#40664;&#35748;&#24320;&#21551;&#20108;&#32423;&#32531;&#23384;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true|false</TT> 
  </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.query_cache_factory</TT></TD>
    <TD>&#33258;&#23450;&#20041;&#23454;&#29616;<TT class=literal>QueryCache</TT>&#25509;&#21475;&#30340;&#31867;&#21517;, &#40664;&#35748;&#20026;&#20869;&#24314;&#30340;<TT 
      class=literal>StandardQueryCache</TT>. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>classname.of.QueryCache</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.region_prefix</TT></TD>
    <TD>&#20108;&#32423;&#32531;&#23384;&#21306;&#22495;&#21517;&#30340;&#21069;&#32512;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>prefix</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cache.use_structured_entries</TT></TD>
    <TD>&#24378;&#21046;Hibernate&#20197;&#26356;&#20154;&#24615;&#21270;&#30340;&#26684;&#24335;&#23558;&#25968;&#25454;&#23384;&#20837;&#20108;&#32423;&#32531;&#23384;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true|false</TT> 
  </P></TD></TR></TBODY></TABLE></DIV>
<DIV class=table><A name=configuration-transaction-properties></A>
<P class=title><B>&#34920;&nbsp;3.6.&nbsp; Hibernate&#20107;&#21153;&#23646;&#24615; </B></P>
<TABLE summary="&#10;                Hibernate&#20107;&#21153;&#23646;&#24615;&#10;            " border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.transaction.factory_class</TT></TD>
    <TD>&#19968;&#20010;<TT class=literal>TransactionFactory</TT>&#30340;&#31867;&#21517;, &#29992;&#20110;Hibernate <TT 
      class=literal>Transaction</TT> API (&#40664;&#35748;&#20026;<TT 
      class=literal>JDBCTransactionFactory</TT>). 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>classname.of.TransactionFactory</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>jta.UserTransaction</TT></TD>
    <TD>&#19968;&#20010;JNDI&#21517;&#23383;&#65292;&#34987;<TT class=literal>JTATransactionFactory</TT>&#29992;&#26469;&#20174;&#24212;&#29992;&#26381;&#21153;&#22120;&#33719;&#21462;JTA 
      <TT class=literal>UserTransaction</TT>. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>jndi/composite/name</TT> 
      </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.transaction.manager_lookup_class</TT></TD>
    <TD>&#19968;&#20010;<TT class=literal>TransactionManagerLookup</TT>&#30340;&#31867;&#21517; - 
      &#24403;&#20351;&#29992;JVM&#32423;&#32531;&#23384;&#65292;&#25110;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;hilo&#29983;&#25104;&#22120;&#30340;&#26102;&#20505;&#38656;&#35201;&#35813;&#31867;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>classname.of.TransactionManagerLookup</TT> </P></TD></TR>
  <TR>
    <TD><TT 
class=literal>hibernate.transaction.flush_before_completion</TT></TD>
    <TD>&#22914;&#26524;&#24320;&#21551;, session&#22312;&#20107;&#21153;&#23436;&#25104;&#21518;&#23558;&#34987;&#33258;&#21160;&#28165;&#27927;(flush)&#12290; &#29616;&#22312;&#26356;&#22909;&#30340;&#26041;&#27861;&#26159;&#20351;&#29992;&#33258;&#21160;session&#19978;&#19979;&#25991;&#31649;&#29702;&#12290;&#35831;&#21442;&#35265;<A 
      title=2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session 
      href="#architecture-current-session">&#31532;&nbsp;2.5&nbsp;&#33410; 
      “&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session”</A>&#12290; 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.transaction.auto_close_session</TT></TD>
    <TD>&#22914;&#26524;&#24320;&#21551;, session&#22312;&#20107;&#21153;&#23436;&#25104;&#21518;&#23558;&#34987;&#33258;&#21160;&#20851;&#38381;&#12290; &#29616;&#22312;&#26356;&#22909;&#30340;&#26041;&#27861;&#26159;&#20351;&#29992;&#33258;&#21160;session&#19978;&#19979;&#25991;&#31649;&#29702;&#12290;&#35831;&#21442;&#35265;<A 
      title=2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session 
      href="#architecture-current-session">&#31532;&nbsp;2.5&nbsp;&#33410; 
      “&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session”</A>&#12290; 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR></TBODY></TABLE></DIV>
<DIV class=table><A name=configuration-misc-properties></A>
<P class=title><B>&#34920;&nbsp;3.7.&nbsp; &#20854;&#20182;&#23646;&#24615; </B></P>
<TABLE summary="&#10;                &#20854;&#20182;&#23646;&#24615;&#10;            " border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517; </TH>
    <TH>&#29992;&#36884; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.current_session_context_class</TT></TD>
    <TD>&#20026;"&#24403;&#21069;" <TT class=literal>Session</TT>&#25351;&#23450;&#19968;&#20010;(&#33258;&#23450;&#20041;&#30340;)&#31574;&#30053;&#12290;&#20851;&#20110;&#20869;&#32622;&#31574;&#30053;&#30340;&#35814;&#24773;&#65292;&#35831;&#21442;&#35265;<A 
      title=2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session 
      href="#architecture-current-session">&#31532;&nbsp;2.5&nbsp;&#33410; 
      “&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session”</A> &#12290; 
      <P><SPAN class=strong>eg.</SPAN> <TT class=literal>jta</TT> | <TT 
      class=literal>thread</TT> | <TT class=literal>custom.Class</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.query.factory_class</TT></TD>
    <TD>&#36873;&#25321;HQL&#35299;&#26512;&#22120;&#30340;&#23454;&#29616;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT 
      class=literal>org.hibernate.hql.ast.ASTQueryTranslatorFactory</TT> or <TT 
      class=literal>org.hibernate.hql.classic.ClassicQueryTranslatorFactory</TT> 
      </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.query.substitutions</TT></TD>
    <TD>&#23558;Hibernate&#26597;&#35810;&#20013;&#30340;&#31526;&#21495;&#26144;&#23556;&#21040;SQL&#26597;&#35810;&#20013;&#30340;&#31526;&#21495; (&#31526;&#21495;&#21487;&#33021;&#26159;&#20989;&#25968;&#21517;&#25110;&#24120;&#37327;&#21517;&#23383;). 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>hqlLiteral=SQL_LITERAL, 
      hqlFunction=SQLFUNC</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.hbm2ddl.auto</TT></TD>
    <TD>&#22312;<TT 
      class=literal>SessionFactory</TT>&#21019;&#24314;&#26102;&#65292;&#33258;&#21160;&#26816;&#26597;&#25968;&#25454;&#24211;&#32467;&#26500;&#65292;&#25110;&#32773;&#23558;&#25968;&#25454;&#24211;schema&#30340;DDL&#23548;&#20986;&#21040;&#25968;&#25454;&#24211;. &#20351;&#29992; 
      <TT class=literal>create-drop</TT>&#26102;,&#22312;&#26174;&#24335;&#20851;&#38381;<TT 
      class=literal>SessionFactory</TT>&#26102;&#65292;&#23558;drop&#25481;&#25968;&#25454;&#24211;schema. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>validate</TT> | <TT 
      class=literal>update</TT> | <TT class=literal>create</TT> | <TT 
      class=literal>create-drop</TT> </P></TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.cglib.use_reflection_optimizer</TT></TD>
    <TD>&#24320;&#21551;CGLIB&#26469;&#26367;&#20195;&#36816;&#34892;&#26102;&#21453;&#23556;&#26426;&#21046;(&#31995;&#32479;&#32423;&#23646;&#24615;). &#21453;&#23556;&#26426;&#21046;&#26377;&#26102;&#22312;&#38500;&#38169;&#26102;&#27604;&#36739;&#26377;&#29992;. &#27880;&#24847;&#21363;&#20351;&#20851;&#38381;&#36825;&#20010;&#20248;&#21270;, 
      Hibernate&#36824;&#26159;&#38656;&#35201;CGLIB. &#20320;&#19981;&#33021;&#22312;<TT class=literal>hibernate.cfg.xml</TT>&#20013;&#35774;&#32622;&#27492;&#23646;&#24615;. 
      <P><SPAN class=strong>&#21462;&#20540;</SPAN> <TT class=literal>true</TT> | <TT 
      class=literal>false</TT> </P></TD></TR></TBODY></TABLE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-dialects></A>3.4.1.&nbsp; SQL&#26041;&#35328; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#24212;&#24403;&#24635;&#26159;&#20026;&#20320;&#30340;&#25968;&#25454;&#24211;&#23558;<TT class=literal>hibernate.dialect</TT>&#23646;&#24615;&#35774;&#32622;&#25104;&#27491;&#30830;&#30340; <TT 
class=literal>org.hibernate.dialect.Dialect</TT>&#23376;&#31867;. &#22914;&#26524;&#20320;&#25351;&#23450;&#19968;&#31181;&#26041;&#35328;, 
Hibernate&#23558;&#20026;&#19978;&#38754;&#21015;&#20986;&#30340;&#19968;&#20123;&#23646;&#24615;&#20351;&#29992;&#21512;&#29702;&#30340;&#40664;&#35748;&#20540;, &#20026;&#20320;&#30465;&#21435;&#20102;&#25163;&#24037;&#25351;&#23450;&#23427;&#20204;&#30340;&#21151;&#22827;. </P>
<DIV class=table><A name=sql-dialects></A>
<P class=title><B>&#34920;&nbsp;3.8.&nbsp; Hibernate SQL&#26041;&#35328; (<TT 
class=literal>hibernate.dialect</TT>) </B></P>
<TABLE 
summary="&#10;                    Hibernate SQL&#26041;&#35328; (hibernate.dialect)&#10;                " 
border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>RDBMS</TH>
    <TH>&#26041;&#35328; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD>DB2</TD>
    <TD><TT class=literal>org.hibernate.dialect.DB2Dialect</TT></TD></TR>
  <TR>
    <TD>DB2 AS/400</TD>
    <TD><TT class=literal>org.hibernate.dialect.DB2400Dialect</TT></TD></TR>
  <TR>
    <TD>DB2 OS390</TD>
    <TD><TT class=literal>org.hibernate.dialect.DB2390Dialect</TT></TD></TR>
  <TR>
    <TD>PostgreSQL</TD>
    <TD><TT class=literal>org.hibernate.dialect.PostgreSQLDialect</TT></TD></TR>
  <TR>
    <TD>MySQL</TD>
    <TD><TT class=literal>org.hibernate.dialect.MySQLDialect</TT></TD></TR>
  <TR>
    <TD>MySQL with InnoDB</TD>
    <TD><TT class=literal>org.hibernate.dialect.MySQLInnoDBDialect</TT></TD></TR>
  <TR>
    <TD>MySQL with MyISAM</TD>
    <TD><TT class=literal>org.hibernate.dialect.MySQLMyISAMDialect</TT></TD></TR>
  <TR>
    <TD>Oracle (any version)</TD>
    <TD><TT class=literal>org.hibernate.dialect.OracleDialect</TT></TD></TR>
  <TR>
    <TD>Oracle 9i/10g</TD>
    <TD><TT class=literal>org.hibernate.dialect.Oracle9Dialect</TT></TD></TR>
  <TR>
    <TD>Sybase</TD>
    <TD><TT class=literal>org.hibernate.dialect.SybaseDialect</TT></TD></TR>
  <TR>
    <TD>Sybase Anywhere</TD>
    <TD><TT 
  class=literal>org.hibernate.dialect.SybaseAnywhereDialect</TT></TD></TR>
  <TR>
    <TD>Microsoft SQL Server</TD>
    <TD><TT class=literal>org.hibernate.dialect.SQLServerDialect</TT></TD></TR>
  <TR>
    <TD>SAP DB</TD>
    <TD><TT class=literal>org.hibernate.dialect.SAPDBDialect</TT></TD></TR>
  <TR>
    <TD>Informix</TD>
    <TD><TT class=literal>org.hibernate.dialect.InformixDialect</TT></TD></TR>
  <TR>
    <TD>HypersonicSQL</TD>
    <TD><TT class=literal>org.hibernate.dialect.HSQLDialect</TT></TD></TR>
  <TR>
    <TD>Ingres</TD>
    <TD><TT class=literal>org.hibernate.dialect.IngresDialect</TT></TD></TR>
  <TR>
    <TD>Progress</TD>
    <TD><TT class=literal>org.hibernate.dialect.ProgressDialect</TT></TD></TR>
  <TR>
    <TD>Mckoi SQL</TD>
    <TD><TT class=literal>org.hibernate.dialect.MckoiDialect</TT></TD></TR>
  <TR>
    <TD>Interbase</TD>
    <TD><TT class=literal>org.hibernate.dialect.InterbaseDialect</TT></TD></TR>
  <TR>
    <TD>Pointbase</TD>
    <TD><TT class=literal>org.hibernate.dialect.PointbaseDialect</TT></TD></TR>
  <TR>
    <TD>FrontBase</TD>
    <TD><TT class=literal>org.hibernate.dialect.FrontbaseDialect</TT></TD></TR>
  <TR>
    <TD>Firebird</TD>
    <TD><TT 
  class=literal>org.hibernate.dialect.FirebirdDialect</TT></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-outerjoin></A>3.4.2.&nbsp; 
&#22806;&#36830;&#25509;&#25235;&#21462;(Outer Join Fetching) </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;ANSI, Oracle&#25110;Sybase&#39118;&#26684;&#30340;&#22806;&#36830;&#25509;, <SPAN 
class=emphasis><EM>&#22806;&#36830;&#25509;&#25235;&#21462;</EM></SPAN>&#36890;&#24120;&#33021;&#36890;&#36807;&#38480;&#21046;&#24448;&#36820;&#25968;&#25454;&#24211;&#27425;&#25968; (&#26356;&#22810;&#30340;&#24037;&#20316;&#20132;&#30001;&#25968;&#25454;&#24211;&#33258;&#24049;&#26469;&#23436;&#25104;)&#26469;&#25552;&#39640;&#25928;&#29575;. 
&#22806;&#36830;&#25509;&#25235;&#21462;&#20801;&#35768;&#22312;&#21333;&#20010;<TT class=literal>SELECT</TT>SQL&#35821;&#21477;&#20013;&#65292; &#36890;&#36807;many-to-one, one-to-many, 
many-to-many&#21644;one-to-one&#20851;&#32852;&#33719;&#21462;&#36830;&#25509;&#23545;&#35937;&#30340;&#25972;&#20010;&#23545;&#35937;&#22270;. </P>
<P>&#23558;<TT class=literal>hibernate.max_fetch_depth</TT>&#35774;&#20026;<TT 
class=literal>0</TT>&#33021;&#22312;<SPAN class=emphasis><EM>&#20840;&#23616;</EM></SPAN> &#33539;&#22260;&#20869;&#31105;&#27490;&#22806;&#36830;&#25509;&#25235;&#21462;. &#35774;&#20026;<TT 
class=literal>1</TT>&#25110;&#26356;&#39640;&#20540;&#33021;&#21551;&#29992;one-to-one&#21644;many-to-oneouter&#20851;&#32852;&#30340;&#22806;&#36830;&#25509;&#25235;&#21462;, &#23427;&#20204;&#36890;&#36807; <TT 
class=literal>fetch="join"</TT>&#26469;&#26144;&#23556;. </P>
<P>&#21442;&#35265;<A 
title="19.1.&nbsp;&#10;&#9;&#9;&#9;&#25235;&#21462;&#31574;&#30053;(Fetching strategies)&#10;&#9;&#9;" 
href="#performance-fetching">&#31532;&nbsp;19.1&nbsp;&#33410; “ &#25235;&#21462;&#31574;&#30053;(Fetching strategies) 
”</A>&#33719;&#24471;&#26356;&#22810;&#20449;&#24687;. </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-binarystreams></A>3.4.3.&nbsp; 
&#20108;&#36827;&#21046;&#27969; (Binary Streams) </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Oracle&#38480;&#21046;&#37027;&#20123;&#36890;&#36807;JDBC&#39537;&#21160;&#20256;&#36755;&#30340;<TT class=literal>&#23383;&#33410;</TT>&#25968;&#32452;&#30340;&#25968;&#30446;. &#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;<TT 
class=literal>&#20108;&#36827;&#20540; (binary)</TT>&#25110; <TT class=literal>&#21487;&#24207;&#21015;&#21270;&#30340; 
(serializable)</TT>&#31867;&#22411;&#30340;&#22823;&#23545;&#35937;, &#20320;&#24212;&#35813;&#24320;&#21551; <TT 
class=literal>hibernate.jdbc.use_streams_for_binary</TT>&#23646;&#24615;. <SPAN 
class=emphasis><EM>&#36825;&#26159;&#31995;&#32479;&#32423;&#23646;&#24615;.</EM></SPAN> </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-cacheprovider></A>3.4.4.&nbsp; 
&#20108;&#32423;&#32531;&#23384;&#19982;&#26597;&#35810;&#32531;&#23384; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20197;<TT 
class=literal>hibernate.cache</TT>&#20026;&#21069;&#32512;&#30340;&#23646;&#24615;&#20801;&#35768;&#20320;&#22312;Hibernate&#20013;&#65292;&#20351;&#29992;&#36827;&#31243;&#25110;&#32676;&#38598;&#33539;&#22260;&#20869;&#30340;&#20108;&#32423;&#32531;&#23384;&#31995;&#32479;. &#21442;&#35265;<A 
title="19.2.&nbsp;&#20108;&#32423;&#32531;&#23384;&#65288;The Second Level Cache&#65289;&#10;&#9;&#9;" 
href="#performance-cache">&#31532;&nbsp;19.2&nbsp;&#33410; “&#20108;&#32423;&#32531;&#23384;&#65288;The Second Level Cache&#65289; 
”</A>&#33719;&#21462;&#26356;&#22810;&#30340;&#35814;&#24773;. </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=configuration-optional-querysubstitution></A>3.4.5.&nbsp; &#26597;&#35810;&#35821;&#35328;&#20013;&#30340;&#26367;&#25442; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>hibernate.query.substitutions</TT>&#22312;Hibernate&#20013;&#23450;&#20041;&#26032;&#30340;&#26597;&#35810;&#31526;&#21495;. 
&#20363;&#22914;: </P><PRE class=programlisting>hibernate.query.substitutions true=1, false=0</PRE>
<P>&#23558;&#23548;&#33268;&#31526;&#21495;<TT class=literal>true</TT>&#21644;<TT 
class=literal>false</TT>&#22312;&#29983;&#25104;&#30340;SQL&#20013;&#34987;&#32763;&#35793;&#25104;&#25972;&#25968;&#24120;&#37327;. </P><PRE class=programlisting>hibernate.query.substitutions toLowercase=LOWER</PRE>
<P>&#23558;&#20801;&#35768;&#20320;&#37325;&#21629;&#21517;SQL&#20013;&#30340;<TT class=literal>LOWER</TT>&#20989;&#25968;. </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-statistics></A>3.4.6.&nbsp; 
Hibernate&#30340;&#32479;&#35745;(statistics)&#26426;&#21046; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#24320;&#21551;<TT class=literal>hibernate.generate_statistics</TT>, &#37027;&#20040;&#24403;&#20320;&#36890;&#36807; <TT 
class=literal>SessionFactory.getStatistics()</TT>&#35843;&#25972;&#27491;&#22312;&#36816;&#34892;&#30340;&#31995;&#32479;&#26102;&#65292;Hibernate&#23558;&#23548;&#20986;&#22823;&#37327;&#26377;&#29992;&#30340;&#25968;&#25454;. 
Hibernate&#29978;&#33267;&#33021;&#34987;&#37197;&#32622;&#25104;&#36890;&#36807;JMX&#23548;&#20986;&#36825;&#20123;&#32479;&#35745;&#20449;&#24687;. &#21442;&#32771;<TT 
class=literal>org.hibernate.stats</TT>&#20013;&#25509;&#21475;&#30340;Javadoc&#65292;&#20197;&#33719;&#24471;&#26356;&#22810;&#20449;&#24687;. </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=configuration-logging></A>3.5.&nbsp; 
&#26085;&#24535; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20351;&#29992;Apache commons-logging&#26469;&#20026;&#21508;&#31181;&#20107;&#20214;&#35760;&#24405;&#26085;&#24535;. </P>
<P>commons-logging&#23558;&#30452;&#25509;&#36755;&#20986;&#21040;Apache Log4j(&#22914;&#26524;&#22312;&#31867;&#36335;&#24452;&#20013;&#21253;&#25324;<TT class=literal>log4j.jar</TT>)&#25110; 
JDK1.4 logging (&#22914;&#26524;&#36816;&#34892;&#22312;JDK1.4&#25110;&#20197;&#19978;&#30340;&#29615;&#22659;&#19979;). &#20320;&#21487;&#20197;&#20174;<TT 
class=literal>http://jakarta.apache.org</TT> &#19979;&#36733;Log4j. &#35201;&#20351;&#29992;Log4j&#65292;&#20320;&#38656;&#35201;&#23558;<TT 
class=literal>log4j.properties</TT>&#25991;&#20214;&#25918;&#32622;&#22312;&#31867;&#36335;&#24452;&#19979;, &#38543;Hibernate &#19968;&#21516;&#20998;&#21457;&#30340;&#26679;&#20363;&#23646;&#24615;&#25991;&#20214;&#22312;<TT 
class=literal>src/</TT>&#30446;&#24405;&#19979;. </P>
<P>&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#20320;&#29087;&#24713;&#19968;&#19979;Hibernate&#30340;&#26085;&#24535;&#28040;&#24687;. &#22312;&#19981;&#22833;&#21487;&#35835;&#24615;&#30340;&#21069;&#25552;&#19979;&#65292; &#25105;&#20204;&#20570;&#20102;&#24456;&#22810;&#24037;&#20316;&#65292;&#20351;Hibernate&#30340;&#26085;&#24535;&#21487;&#33021;&#22320;&#35814;&#32454;. 
&#36825;&#26159;&#24517;&#35201;&#30340;&#26597;&#38169;&#21033;&#22120;. &#26368;&#20196;&#20154;&#24863;&#20852;&#36259;&#30340;&#26085;&#24535;&#20998;&#31867;&#26377;&#22914;&#19979;&#36825;&#20123;: </P>
<DIV class=table><A name=log-categories></A>
<P class=title><B>&#34920;&nbsp;3.9.&nbsp; Hibernate&#26085;&#24535;&#31867;&#21035; </B></P>
<TABLE summary="&#10;                    Hibernate&#26085;&#24535;&#31867;&#21035;&#10;                " 
border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#31867;&#21035; </TH>
    <TH>&#21151;&#33021; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>org.hibernate.SQL</TT></TD>
    <TD>&#22312;&#25152;&#26377;SQL DML&#35821;&#21477;&#34987;&#25191;&#34892;&#26102;&#20026;&#23427;&#20204;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.type</TT></TD>
    <TD>&#20026;&#25152;&#26377;JDBC&#21442;&#25968;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.tool.hbm2ddl</TT></TD>
    <TD>&#22312;&#25152;&#26377;SQL DDL&#35821;&#21477;&#25191;&#34892;&#26102;&#20026;&#23427;&#20204;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.pretty</TT></TD>
    <TD>&#22312;session&#28165;&#27927;(flush)&#26102;&#65292;&#20026;&#25152;&#26377;&#19982;&#20854;&#20851;&#32852;&#30340;&#23454;&#20307;(&#26368;&#22810;20&#20010;)&#30340;&#29366;&#24577;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.cache</TT></TD>
    <TD>&#20026;&#25152;&#26377;&#20108;&#32423;&#32531;&#23384;&#30340;&#27963;&#21160;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.transaction</TT></TD>
    <TD>&#20026;&#20107;&#21153;&#30456;&#20851;&#30340;&#27963;&#21160;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.jdbc</TT></TD>
    <TD>&#20026;&#25152;&#26377;JDBC&#36164;&#28304;&#30340;&#33719;&#21462;&#35760;&#24405;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.hql.AST</TT></TD>
    <TD>&#22312;&#35299;&#26512;&#26597;&#35810;&#30340;&#26102;&#20505;,&#35760;&#24405;HQL&#21644;SQL&#30340;AST&#20998;&#26512;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate.secure</TT></TD>
    <TD>&#20026;JAAS&#35748;&#35777;&#35831;&#27714;&#20570;&#26085;&#24535; </TD></TR>
  <TR>
    <TD><TT class=literal>org.hibernate</TT></TD>
    <TD>&#20026;&#20219;&#20309;Hibernate&#30456;&#20851;&#20449;&#24687;&#20570;&#26085;&#24535; (&#20449;&#24687;&#37327;&#36739;&#22823;, &#20294;&#23545;&#26597;&#38169;&#38750;&#24120;&#26377;&#24110;&#21161;) </TD></TR></TBODY></TABLE></DIV>
<P>&#22312;&#20351;&#29992;Hibernate&#24320;&#21457;&#24212;&#29992;&#31243;&#24207;&#26102;, &#20320;&#24212;&#24403;&#24635;&#26159;&#20026;<TT class=literal>org.hibernate.SQL</TT> &#24320;&#21551;<TT 
class=literal>debug</TT>&#32423;&#21035;&#30340;&#26085;&#24535;&#35760;&#24405;,&#25110;&#32773;&#24320;&#21551;<TT class=literal>hibernate.show_sql</TT>&#23646;&#24615;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-namingstrategy></A>3.6.&nbsp; &#23454;&#29616;<TT 
class=literal>NamingStrategy</TT> </H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.cfg.NamingStrategy</TT>&#25509;&#21475;&#20801;&#35768;&#20320;&#20026;&#25968;&#25454;&#24211;&#20013;&#30340;&#23545;&#35937;&#21644;schema 
&#20803;&#32032;&#25351;&#23450;&#19968;&#20010;“&#21629;&#21517;&#26631;&#20934;”. </P>
<P>&#20320;&#21487;&#33021;&#20250;&#25552;&#20379;&#19968;&#20123;&#36890;&#36807;Java&#26631;&#35782;&#29983;&#25104;&#25968;&#25454;&#24211;&#26631;&#35782;&#25110;&#23558;&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;&#20013;"&#36923;&#36753;"&#34920;/&#21015;&#21517;&#22788;&#29702;&#25104;"&#29289;&#29702;"&#34920;/&#21015;&#21517;&#30340;&#35268;&#21017;. &#36825;&#20010;&#29305;&#24615;&#26377;&#21161;&#20110;&#20943;&#23569;&#20887;&#38271;&#30340;&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;. 
</P>
<P>&#22312;&#21152;&#20837;&#26144;&#23556;&#23450;&#20041;&#21069;&#65292;&#20320;&#21487;&#20197;&#35843;&#29992; <TT 
class=literal>Configuration.setNamingStrategy()</TT>&#25351;&#23450;&#19968;&#20010;&#19981;&#21516;&#30340;&#21629;&#21517;&#31574;&#30053;: </P><PRE class=programlisting>SessionFactory sf = new Configuration()
    .setNamingStrategy(ImprovedNamingStrategy.INSTANCE)
    .addFile("Item.hbm.xml")
    .addFile("Bid.hbm.xml")
    .buildSessionFactory();</PRE>
<P><TT class=literal>org.hibernate.cfg.ImprovedNamingStrategy</TT>&#26159;&#19968;&#20010;&#20869;&#24314;&#30340;&#21629;&#21517;&#31574;&#30053;, &#23545; 
&#19968;&#20123;&#24212;&#29992;&#31243;&#24207;&#32780;&#35328;&#65292;&#21487;&#33021;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#36215;&#28857;. </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=configuration-xmlconfig></A>3.7.&nbsp; XML&#37197;&#32622;&#25991;&#20214; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21478;&#19968;&#20010;&#37197;&#32622;&#26041;&#27861;&#26159;&#22312;<TT class=literal>hibernate.cfg.xml</TT>&#25991;&#20214;&#20013;&#25351;&#23450;&#19968;&#22871;&#23436;&#25972;&#30340;&#37197;&#32622;. &#36825;&#20010;&#25991;&#20214;&#21487;&#20197;&#24403;&#25104;<TT 
class=literal>hibernate.properties</TT>&#30340;&#26367;&#20195;&#12290; &#33509;&#20004;&#20010;&#25991;&#20214;&#21516;&#26102;&#23384;&#22312;&#65292;&#23427;&#23558;&#35206;&#30422;&#21069;&#32773;&#30340;&#23646;&#24615;. </P>
<P>XML&#37197;&#32622;&#25991;&#20214;&#34987;&#40664;&#35748;&#26159;&#25918;&#22312;<TT class=literal>CLASSPATH</TT>&#30340;&#26681;&#30446;&#24405;&#19979;. &#36825;&#26159;&#19968;&#20010;&#20363;&#23376;: </P>
<P></P><PRE class=programlisting>&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;!-- &#20197;/jndi/name&#32465;&#23450;&#21040;JNDI&#30340;SessionFactory&#23454;&#20363; --&gt;
    &lt;session-factory
        name="java:hibernate/SessionFactory"&gt;

        &lt;!-- &#23646;&#24615; --&gt;
        &lt;property name="connection.datasource"&gt;java:/comp/env/jdbc/MyDB&lt;/property&gt;
        &lt;property name="dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
        &lt;property name="show_sql"&gt;false&lt;/property&gt;
        &lt;property name="transaction.factory_class"&gt;
            org.hibernate.transaction.JTATransactionFactory
        &lt;/property&gt;
        &lt;property name="jta.UserTransaction"&gt;java:comp/UserTransaction&lt;/property&gt;

        &lt;!-- &#26144;&#23556;&#23450;&#20041;&#25991;&#20214; --&gt;
        &lt;mapping resource="org/hibernate/auction/Item.hbm.xml"/&gt;
        &lt;mapping resource="org/hibernate/auction/Bid.hbm.xml"/&gt;

        &lt;!-- &#32531;&#23384;&#35774;&#32622; --&gt;
        &lt;class-cache class="org.hibernate.auction.Item" usage="read-write"/&gt;
        &lt;class-cache class="org.hibernate.auction.Bid" usage="read-only"/&gt;
        &lt;collection-cache collection="org.hibernate.auction.Item.bids" usage="read-write"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</PRE>
<P>&#22914;&#20320;&#25152;&#35265;, &#36825;&#20010;&#26041;&#27861;&#20248;&#21183;&#22312;&#20110;&#65292;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#25351;&#20986;&#20102;&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;&#30340;&#21517;&#23383;. &#19968;&#26086;&#20320;&#38656;&#35201;&#35843;&#25972;Hibernate&#30340;&#32531;&#23384;&#65292; <TT 
class=literal>hibernate.cfg.xml</TT>&#20063;&#26159;&#26356;&#26041;&#20415;. &#27880;&#24847;&#65292;&#20351;&#29992;<TT 
class=literal>hibernate.properties</TT>&#36824;&#26159; <TT 
class=literal>hibernate.cfg.xml</TT>&#23436;&#20840;&#26159;&#30001;&#20320;&#26469;&#20915;&#23450;, &#38500;&#20102;&#19978;&#38754;&#25552;&#21040;&#30340;XML&#35821;&#27861;&#30340;&#20248;&#21183;&#20043;&#22806;, &#20004;&#32773;&#26159;&#31561;&#20215;&#30340;. </P>
<P>&#20351;&#29992;XML&#37197;&#32622;&#65292;&#20351;&#24471;&#21551;&#21160;Hibernate&#21464;&#30340;&#24322;&#24120;&#31616;&#21333;, &#22914;&#19979;&#25152;&#31034;&#65292;&#19968;&#34892;&#20195;&#30721;&#23601;&#21487;&#20197;&#25630;&#23450;&#65306; </P><PRE class=programlisting>SessionFactory sf = new Configuration().configure().buildSessionFactory();</PRE>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#20195;&#30721;&#26469;&#28155;&#21152;&#19968;&#20010;&#19981;&#21516;&#30340;XML&#37197;&#32622;&#25991;&#20214; </P><PRE class=programlisting>SessionFactory sf = new Configuration()
    .configure("catdb.cfg.xml")
    .buildSessionFactory();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=configuration-j2ee></A>3.8.&nbsp; 
J2EE&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#30340;&#38598;&#25104; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38024;&#23545;J2EE&#20307;&#31995;,Hibernate&#26377;&#22914;&#19979;&#20960;&#20010;&#38598;&#25104;&#30340;&#26041;&#38754;: </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>&#23481;&#22120;&#31649;&#29702;&#30340;&#25968;&#25454;&#28304;(Container-managed 
  datasources)</EM></SPAN>: Hibernate&#33021;&#20351;&#29992;&#36890;&#36807;&#23481;&#22120;&#31649;&#29702;&#65292;&#24182;&#30001;JNDI&#25552;&#20379;&#30340;JDBC&#36830;&#25509;. &#36890;&#24120;, 
  &#29305;&#21035;&#26159;&#24403;&#22788;&#29702;&#22810;&#20010;&#25968;&#25454;&#28304;&#30340;&#20998;&#24067;&#24335;&#20107;&#21153;&#30340;&#26102;&#20505;, &#30001;&#19968;&#20010;JTA&#20860;&#23481;&#30340;<TT class=literal>TransactionManager</TT>&#21644;&#19968;&#20010; 
  <TT class=literal>ResourceManager</TT>&#26469;&#22788;&#29702;&#20107;&#21153;&#31649;&#29702;(CMT, &#23481;&#22120;&#31649;&#29702;&#30340;&#20107;&#21153;). &#24403;&#28982;&#20320;&#21487;&#20197;&#36890;&#36807; 
  &#32534;&#31243;&#26041;&#24335;&#26469;&#21010;&#20998;&#20107;&#21153;&#36793;&#30028;(BMT, Bean&#31649;&#29702;&#30340;&#20107;&#21153;). &#25110;&#32773;&#20026;&#20102;&#20195;&#30721;&#30340;&#21487;&#31227;&#26893;&#24615;&#65292;&#20320;&#20063;&#20063;&#35768;&#20250;&#24819;&#20351;&#29992;&#21487;&#36873;&#30340; Hibernate <TT 
  class=literal>Transaction</TT> API. </P></LI></UL></DIV>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>&#33258;&#21160;JNDI&#32465;&#23450;</EM></SPAN>: Hibernate&#21487;&#20197;&#22312;&#21551;&#21160;&#21518;&#23558; <TT 
  class=literal>SessionFactory</TT>&#32465;&#23450;&#21040;JNDI. </P></LI></UL></DIV>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>JTA Session&#32465;&#23450;:</EM></SPAN> Hibernate <TT 
  class=literal>Session</TT> &#21487;&#20197;&#33258;&#21160;&#32465;&#23450;&#21040;JTA&#20107;&#21153;&#20316;&#29992;&#30340;&#33539;&#22260;. &#21482;&#38656;&#31616;&#21333;&#22320;&#20174;JNDI&#26597;&#25214;<TT 
  class=literal>SessionFactory</TT>&#24182;&#33719;&#24471;&#24403;&#21069;&#30340; <TT class=literal>Session</TT>. 
  &#24403;JTA&#20107;&#21153;&#23436;&#25104;&#26102;, &#35753;Hibernate&#26469;&#22788;&#29702; <TT class=literal>Session</TT>&#30340;&#28165;&#27927;(flush)&#19982;&#20851;&#38381;. 
  &#20107;&#21153;&#30340;&#21010;&#20998;&#21487;&#20197;&#26159;&#22768;&#26126;&#24335;&#30340;(CMT),&#20063;&#21487;&#20197;&#26159;&#32534;&#31243;&#24335;&#30340;(BMT/UserTransaction). </P></LI></UL></DIV>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>JMX&#37096;&#32626;:</EM></SPAN> &#22914;&#26524;&#20320;&#20351;&#29992;&#25903;&#25345;JMX&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;(&#22914;, JBoss AS), 
  &#37027;&#20040;&#20320;&#21487;&#20197;&#36873;&#25321;&#23558;Hibernate&#37096;&#32626;&#25104;&#25176;&#31649;MBean. &#36825;&#23558;&#20026;&#20320;&#30465;&#21435;&#19968;&#34892;&#20174;<TT 
  class=literal>Configuration</TT>&#26500;&#24314;<TT class=literal>SessionFactory</TT>&#30340;&#21551;&#21160;&#20195;&#30721;. 
  &#23481;&#22120;&#23558;&#21551;&#21160;&#20320;&#30340;<TT class=literal>HibernateService</TT>, &#24182;&#23436;&#32654;&#22320;&#22788;&#29702;&#22909;&#26381;&#21153;&#38388;&#30340;&#20381;&#36182;&#20851;&#31995; 
  (&#22312;Hibernate&#21551;&#21160;&#21069;&#65292;&#25968;&#25454;&#28304;&#24517;&#39035;&#26159;&#21487;&#29992;&#30340;&#65292;&#31561;&#31561;). </P></LI></UL></DIV>
<P>&#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#25243;&#20986;"connection containment"&#24322;&#24120;, &#26681;&#25454;&#20320;&#30340;&#29615;&#22659;&#65292;&#20063;&#35768;&#35813;&#23558;&#37197;&#32622;&#23646;&#24615; <TT 
class=literal>hibernate.connection.release_mode</TT>&#35774;&#20026;<TT 
class=literal>after_statement</TT>. </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=configuration-optional-transactionstrategy></A>3.8.1.&nbsp; &#20107;&#21153;&#31574;&#30053;&#37197;&#32622; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#20320;&#30340;&#26550;&#26500;&#20013;&#65292;Hibernate&#30340;<TT class=literal>Session</TT> API&#26159;&#29420;&#31435;&#20110;&#20219;&#20309;&#20107;&#21153;&#20998;&#30028;&#31995;&#32479;&#30340;. 
&#22914;&#26524;&#20320;&#35753;Hibernate&#36890;&#36807;&#36830;&#25509;&#27744;&#30452;&#25509;&#20351;&#29992;JDBC, &#20320;&#38656;&#35201;&#35843;&#29992;JDBC API&#26469;&#25171;&#24320;&#21644;&#20851;&#38381;&#20320;&#30340;&#20107;&#21153;. &#22914;&#26524;&#20320;&#36816;&#34892;&#22312;J2EE&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#20013;, 
&#20320;&#20063;&#35768;&#24819;&#29992;Bean&#31649;&#29702;&#30340;&#20107;&#21153;&#24182;&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#35843;&#29992;JTA API&#21644;<TT class=literal>UserTransaction</TT>. </P>
<P>&#20026;&#20102;&#35753;&#20320;&#30340;&#20195;&#30721;&#22312;&#20004;&#31181;(&#25110;&#20854;&#20182;)&#29615;&#22659;&#20013;&#21487;&#20197;&#31227;&#26893;&#65292;&#25105;&#20204;&#24314;&#35758;&#20351;&#29992;&#21487;&#36873;&#30340;Hibernate <TT class=literal>Transaction</TT> 
API, &#23427;&#21253;&#35013;&#24182;&#38544;&#34255;&#20102;&#24213;&#23618;&#31995;&#32479;. &#20320;&#24517;&#39035;&#36890;&#36807;&#35774;&#32622;Hibernate&#37197;&#32622;&#23646;&#24615;<TT 
class=literal>hibernate.transaction.factory_class</TT>&#26469;&#25351;&#23450; &#19968;&#20010;<TT 
class=literal>Transaction</TT>&#23454;&#20363;&#30340;&#24037;&#21378;&#31867;. </P>
<P>&#26377;&#19977;&#20010;&#26631;&#20934;(&#20869;&#24314;)&#30340;&#36873;&#25321;: </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term><TT 
  class=literal>org.hibernate.transaction.JDBCTransactionFactory</TT></SPAN>
  <DD>
  <P>&#22996;&#25176;&#32473;&#25968;&#25454;&#24211;(JDBC)&#20107;&#21153;&#65288;&#40664;&#35748;&#65289; </P>
  <DT><SPAN class=term><TT 
  class=literal>org.hibernate.transaction.JTATransactionFactory</TT></SPAN>
  <DD>
  <P>&#22914;&#26524;&#22312;&#19978;&#19979;&#25991;&#29615;&#22659;&#20013;&#23384;&#22312;&#36816;&#34892;&#30528;&#30340;&#20107;&#21153;(&#22914;, EJB&#20250;&#35805;Bean&#30340;&#26041;&#27861;), &#21017;&#22996;&#25176;&#32473;&#23481;&#22120;&#31649; &#29702;&#30340;&#20107;&#21153;, 
  &#21542;&#21017;&#65292;&#23558;&#21551;&#21160;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#65292;&#24182;&#20351;&#29992;Bean&#31649;&#29702;&#30340;&#20107;&#21153;. </P>
  <DT><SPAN class=term><TT 
  class=literal>org.hibernate.transaction.CMTTransactionFactory</TT></SPAN>
  <DD>
  <P>&#22996;&#25176;&#32473;&#23481;&#22120;&#31649;&#29702;&#30340;JTA&#20107;&#21153; </P></DD></DL></DIV>
<P>&#20320;&#20063;&#21487;&#20197;&#23450;&#20041;&#23646;&#20110;&#20320;&#33258;&#24049;&#30340;&#20107;&#21153;&#31574;&#30053; (&#22914;, &#38024;&#23545;CORBA&#30340;&#20107;&#21153;&#26381;&#21153;) </P>
<P>Hibernate&#30340;&#19968;&#20123;&#29305;&#24615; (&#27604;&#22914;&#20108;&#32423;&#32531;&#23384;, Contextual Sessions with JTA&#31561;&#31561;)&#38656;&#35201;&#35775;&#38382;&#22312;&#25176;&#31649;&#29615;&#22659;&#20013;&#30340;JTA <TT 
class=literal>TransactionManager</TT>. 
&#30001;&#20110;J2EE&#27809;&#26377;&#26631;&#20934;&#21270;&#19968;&#20010;&#21333;&#19968;&#30340;&#26426;&#21046;,Hibernate&#22312;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#20013;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;Hibernate&#22914;&#20309;&#33719;&#24471;<TT 
class=literal>TransactionManager</TT>&#30340;&#24341;&#29992;: </P>
<DIV class=table><A name=jtamanagerlookup></A>
<P class=title><B>&#34920;&nbsp;3.10.&nbsp;JTA TransactionManagers</B></P>
<TABLE summary="JTA TransactionManagers" border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>Transaction&#24037;&#21378;&#31867; </TH>
    <TH align=center>&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120; </TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.JBossTransactionManagerLookup</TT></TD>
    <TD align=center>JBoss</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.WeblogicTransactionManagerLookup</TT></TD>
    <TD align=center>Weblogic</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.WebSphereTransactionManagerLookup</TT></TD>
    <TD align=center>WebSphere</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</TT></TD>
    <TD align=center>WebSphere 6</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.OrionTransactionManagerLookup</TT></TD>
    <TD align=center>Orion</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.ResinTransactionManagerLookup</TT></TD>
    <TD align=center>Resin</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.JOTMTransactionManagerLookup</TT></TD>
    <TD align=center>JOTM</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.JOnASTransactionManagerLookup</TT></TD>
    <TD align=center>JOnAS</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.JRun4TransactionManagerLookup</TT></TD>
    <TD align=center>JRun4</TD></TR>
  <TR>
    <TD><TT 
      class=literal>org.hibernate.transaction.BESTransactionManagerLookup</TT></TD>
    <TD align=center>Borland ES</TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-optional-jndi></A>3.8.2.&nbsp; JNDI&#32465;&#23450;&#30340;<TT 
class=literal>SessionFactory</TT> </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19982;JNDI&#32465;&#23450;&#30340;Hibernate&#30340;<TT class=literal>SessionFactory</TT>&#33021;&#31616;&#21270;&#24037;&#21378;&#30340;&#26597;&#35810;&#65292;&#31616;&#21270;&#21019;&#24314;&#26032;&#30340;<TT 
class=literal>Session</TT>. &#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#36825;&#19982;JNDI&#32465;&#23450;<TT class=literal>Datasource</TT>&#27809;&#26377;&#20851;&#31995;, 
&#23427;&#20204;&#21482;&#26159;&#24688;&#24039;&#29992;&#20102;&#30456;&#21516;&#30340;&#27880;&#20876;&#34920;! </P>
<P>&#22914;&#26524;&#20320;&#24076;&#26395;&#23558;<TT class=literal>SessionFactory</TT>&#32465;&#23450;&#21040;&#19968;&#20010;JNDI&#30340;&#21517;&#23383;&#31354;&#38388;, &#29992;&#23646;&#24615;<TT 
class=literal>hibernate.session_factory_name</TT>&#25351;&#23450;&#19968;&#20010;&#21517;&#23383;(&#22914;, <TT 
class=literal>java:hibernate/SessionFactory</TT>). &#22914;&#26524;&#19981;&#35774;&#32622;&#36825;&#20010;&#23646;&#24615;, <TT 
class=literal>SessionFactory</TT>&#23558;&#19981;&#20250;&#34987;&#32465;&#23450;&#21040;JNDI&#20013;. (&#22312;&#20197;&#21482;&#35835;JNDI&#20026;&#40664;&#35748;&#23454;&#29616;&#30340;&#29615;&#22659;&#20013;&#65292;&#36825;&#20010;&#35774;&#32622;&#23588;&#20854;&#26377;&#29992;, 
&#22914;Tomcat.) </P>
<P>&#22312;&#23558;<TT class=literal>SessionFactory</TT>&#32465;&#23450;&#33267;JNDI&#26102;, Hibernate&#23558;&#20351;&#29992;<TT 
class=literal>hibernate.jndi.url</TT>, &#21644;<TT 
class=literal>hibernate.jndi.class</TT>&#30340;&#20540;&#26469;&#23454;&#20363;&#21270;&#21021;&#22987;&#29615;&#22659;(initial context). &#22914;&#26524;&#23427;&#20204;&#27809;&#26377;&#34987;&#25351;&#23450;, 
&#23558;&#20351;&#29992;&#40664;&#35748;&#30340;<TT class=literal>InitialContext</TT>. </P>
<P>&#22312;&#20320;&#35843;&#29992;<TT class=literal>cfg.buildSessionFactory()</TT>&#21518;, Hibernate&#20250;&#33258;&#21160;&#23558;<TT 
class=literal>SessionFactory</TT>&#27880;&#20876;&#21040;JNDI. &#36825;&#24847;&#21619;&#36825;&#20320;&#33267;&#23569;&#38656;&#35201;&#22312;&#20320;&#24212;&#29992;&#31243;&#24207;&#30340;&#21551;&#21160;&#20195;&#30721;(&#25110;&#24037;&#20855;&#31867;)&#20013;&#23436;&#25104;&#36825;&#20010;&#35843;&#29992;, 
&#38500;&#38750;&#20320;&#20351;&#29992;<TT class=literal>HibernateService</TT>&#26469;&#20570;JMX&#37096;&#32626; (&#35265;&#21518;&#38754;&#35752;&#35770;). </P>
<P>&#20551;&#33509;&#20320;&#20351;&#29992;JNDI <TT class=literal>SessionFactory</TT>,EJB&#25110;&#32773;&#20219;&#20309;&#20854;&#23427;&#31867;&#37117;&#21487;&#20197;&#20174;JNDI&#20013;&#25214;&#21040;&#27492;<TT 
class=literal>SessionFactory</TT>&#12290; </P>
<P>&#25105;&#20204;&#24314;&#35758;&#65292;&#22312;&#21463;&#31649;&#29702;&#30340;&#29615;&#22659;&#20013;&#65292;&#25226;<TT class=literal>SessionFactory</TT>&#32465;&#23450;&#21040;JNDI&#65292;&#22312;&#20854;&#23427;&#24773;&#20917;&#19979;&#65292;&#20351;&#29992;&#19968;&#20010;<TT 
class=literal>static(&#38745;&#24577;&#30340;)</TT>singleton&#12290;&#20026;&#20102;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20195;&#30721;&#20013;&#38544;&#34255;&#36825;&#20123;&#32454;&#33410;&#65292;&#25105;&#20204;&#36824;&#24314;&#35758;&#20320;&#29992;&#19968;&#20010;helper&#31867;&#25226;&#23454;&#38469;&#26597;&#25214;<TT 
class=literal>SessionFactory</TT>&#30340;&#20195;&#30721;&#38544;&#34255;&#36215;&#26469;,&#27604;&#22914;<TT 
class=literal>HibernateUtil.getSessionFactory()</TT>&#12290;&#27880;&#24847;&#65292;&#36825;&#20010;&#31867;&#20063;&#23601;&#21487;&#20197;&#26041;&#20415;&#22320;&#21551;&#21160;Hibernate&#65292;&#21442;&#35265;&#31532;&#19968;&#31456;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=configuration-j2ee-currentsession></A>3.8.3.&nbsp;&#22312;JTA&#29615;&#22659;&#19979;&#20351;&#29992;Current Session 
context (&#24403;&#21069;session&#19978;&#19979;&#25991;)&#31649;&#29702;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;Hibernate&#20013;&#65292;&#31649;&#29702;<TT class=literal>Session</TT>&#21644;transaction&#26368;&#22909;&#30340;&#26041;&#27861;&#26159;&#33258;&#21160;&#30340;"&#24403;&#21069;"<TT 
class=literal>Session</TT>&#31649;&#29702;&#12290;&#35831;&#21442;&#35265;<A title=2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session 
href="#architecture-current-session">&#31532;&nbsp;2.5&nbsp;&#33410; 
“&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session”</A>&#19968;&#33410;&#30340;&#35752;&#35770;&#12290;&#20351;&#29992;<TT 
class=literal>"jta"</TT>session&#19978;&#19979;&#25991;&#65292;&#20551;&#33509;&#22312;&#24403;&#21069;JTA&#20107;&#21153;&#20013;&#36824;&#27809;&#26377;Hibernate<TT 
class=literal>Session</TT>&#20851;&#32852;&#65292;&#31532;&#19968;&#27425;<TT 
class=literal>sessionFactory.getCurrentSession()</TT>&#35843;&#29992;&#20250;&#21551;&#21160;&#19968;&#20010;Session,&#24182;&#20851;&#32852;&#21040;&#24403;&#21069;&#30340;JTA&#20107;&#21153;&#12290;&#22312;<TT 
class=literal>"jta"</TT>&#19978;&#19979;&#25991;&#20013;&#35843;&#29992;<TT class=literal>getCurrentSession()</TT>&#33719;&#24471;&#30340;<TT 
class=literal>Session</TT>&#65292;&#20250;&#34987;&#35774;&#32622;&#20026;&#22312;transaction&#20851;&#38381;&#30340;&#26102;&#20505;&#33258;&#21160;flush&#65288;&#28165;&#27927;&#65289;&#12289;&#22312;transaction&#20851;&#38381;&#20043;&#21518;&#33258;&#21160;&#20851;&#38381;&#65292;&#27599;&#21477;&#35821;&#21477;&#20043;&#21518;&#20027;&#21160;&#37322;&#25918;JDBC&#36830;&#25509;&#12290;&#36825;&#23601;&#21487;&#20197;&#26681;&#25454;JTA&#20107;&#21153;&#30340;&#29983;&#21629;&#21608;&#26399;&#26469;&#31649;&#29702;&#19982;&#20043;&#20851;&#32852;&#30340;<TT 
class=literal>Session</TT>&#65292;&#29992;&#25143;&#20195;&#30721;&#20013;&#23601;&#21487;&#20197;&#19981;&#20877;&#32771;&#34385;&#36825;&#20123;&#31649;&#29702;&#12290;&#20320;&#30340;&#20195;&#30721;&#20063;&#21487;&#20197;&#36890;&#36807;<TT 
class=literal>UserTransaction</TT>&#29992;&#32534;&#31243;&#26041;&#24335;&#20351;&#29992;JTA&#65292;&#25110;&#32773;(&#25105;&#20204;&#24314;&#35758;&#65292;&#20026;&#20102;&#20415;&#20110;&#31227;&#26893;&#20195;&#30721;&#65289;&#20351;&#29992;Hibernate&#30340;<TT 
class=literal>Transaction</TT> 
API&#26469;&#35774;&#32622;transaction&#36793;&#30028;&#12290;&#22914;&#26524;&#20320;&#30340;&#20195;&#30721;&#36816;&#34892;&#22312;EJB&#23481;&#22120;&#20013;&#65292;&#24314;&#35758;&#23545;CMT&#20351;&#29992;&#22768;&#26126;&#24335;&#20107;&#21153;&#22768;&#26126;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=configuration-j2ee-jmx></A>3.8.4.&nbsp; JMX&#37096;&#32626; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20026;&#20102;&#23558;<TT class=literal>SessionFactory</TT>&#27880;&#20876;&#21040;JNDI&#20013;&#65292;<TT 
class=literal>cfg.buildSessionFactory()</TT>&#36825;&#34892;&#20195;&#30721;&#20173;&#38656;&#22312;&#26576;&#22788;&#34987;&#25191;&#34892;. &#20320;&#21487;&#22312;&#19968;&#20010;<TT 
class=literal>static</TT>&#21021;&#22987;&#21270;&#22359;(&#20687;<TT 
class=literal>HibernateUtil</TT>&#20013;&#30340;&#37027;&#26679;)&#20013;&#25191;&#34892;&#23427;&#25110;&#23558;Hibernate&#37096;&#32626;&#20026;&#19968;&#20010;<SPAN 
class=emphasis><EM>&#25176;&#31649;&#30340;&#26381;&#21153;</EM></SPAN>. </P>
<P>&#20026;&#20102;&#37096;&#32626;&#22312;&#19968;&#20010;&#25903;&#25345;JMX&#30340;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#19978;&#65292;Hibernate&#21644; <TT 
class=literal>org.hibernate.jmx.HibernateService</TT>&#19968;&#21516;&#20998;&#21457;&#65292;&#22914;Jboss AS&#12290; 
&#23454;&#38469;&#30340;&#37096;&#32626;&#21644;&#37197;&#32622;&#26159;&#30001;&#24212;&#29992;&#31243;&#24207;&#26381;&#21153;&#22120;&#25552;&#20379;&#32773;&#25351;&#23450;&#30340;. &#36825;&#37324;&#26159;JBoss 4.0.x&#30340;<TT 
class=literal>jboss-service.xml</TT>&#26679;&#20363;: </P><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;server&gt;

&lt;mbean code="org.hibernate.jmx.HibernateService"
    name="jboss.jca:service=HibernateFactory,name=HibernateFactory"&gt;

    &lt;!-- &#24517;&#39035;&#30340;&#26381;&#21153; --&gt;
    &lt;depends&gt;jboss.jca:service=RARDeployer&lt;/depends&gt;
    &lt;depends&gt;jboss.jca:service=LocalTxCM,name=HsqlDS&lt;/depends&gt;

    &lt;!-- &#23558;Hibernate&#26381;&#21153;&#32465;&#23450;&#21040;JNDI --&gt;
    &lt;attribute name="JndiName"&gt;java:/hibernate/SessionFactory&lt;/attribute&gt;

    &lt;!-- &#25968;&#25454;&#28304;&#35774;&#32622; --&gt;
    &lt;attribute name="Datasource"&gt;java:HsqlDS&lt;/attribute&gt;
    &lt;attribute name="Dialect"&gt;org.hibernate.dialect.HSQLDialect&lt;/attribute&gt;

    &lt;!-- &#20107;&#21153;&#38598;&#25104; --&gt;
    &lt;attribute name="TransactionStrategy"&gt;
        org.hibernate.transaction.JTATransactionFactory&lt;/attribute&gt;
    &lt;attribute name="TransactionManagerLookupStrategy"&gt;
        org.hibernate.transaction.JBossTransactionManagerLookup&lt;/attribute&gt;
    &lt;attribute name="FlushBeforeCompletionEnabled"&gt;true&lt;/attribute&gt;
    &lt;attribute name="AutoCloseSessionEnabled"&gt;true&lt;/attribute&gt;

    &lt;!-- &#25235;&#21462;&#36873;&#39033; --&gt;
    &lt;attribute name="MaximumFetchDepth"&gt;5&lt;/attribute&gt;

    &lt;!-- &#20108;&#32423;&#32531;&#23384; --&gt;
    &lt;attribute name="SecondLevelCacheEnabled"&gt;true&lt;/attribute&gt;
    &lt;attribute name="CacheProviderClass"&gt;org.hibernate.cache.EhCacheProvider&lt;/attribute&gt;
    &lt;attribute name="QueryCacheEnabled"&gt;true&lt;/attribute&gt;

    &lt;!-- &#26085;&#24535; --&gt;
    &lt;attribute name="ShowSqlEnabled"&gt;true&lt;/attribute&gt;

    &lt;!-- &#26144;&#23556;&#23450;&#20041;&#25991;&#20214; --&gt;
    &lt;attribute name="MapResources"&gt;auction/Item.hbm.xml,auction/Category.hbm.xml&lt;/attribute&gt;

&lt;/mbean&gt;

&lt;/server&gt;</PRE>
<P>&#36825;&#20010;&#25991;&#20214;&#26159;&#37096;&#32626;&#22312;<TT class=literal>META-INF</TT>&#30446;&#24405;&#19979;&#30340;, &#24182;&#20250;&#34987;&#25171;&#21253;&#21040;&#20197;<TT 
class=literal>.sar</TT> (service archive)&#20026;&#25193;&#23637;&#21517;&#30340;JAR&#25991;&#20214;&#20013;. 
&#21516;&#26102;&#65292;&#20320;&#38656;&#35201;&#23558;Hibernate&#12289;&#23427;&#25152;&#38656;&#35201;&#30340;&#31532;&#19977;&#26041;&#24211;&#12289;&#20320;&#32534;&#35793;&#22909;&#30340;&#25345;&#20037;&#21270;&#31867;&#20197;&#21450;&#20320;&#30340;&#26144;&#23556;&#23450;&#20041;&#25991;&#20214;&#25171;&#21253;&#36827;&#21516;&#19968;&#20010;&#25991;&#26723;. 
&#20320;&#30340;&#20225;&#19994;Bean(&#19968;&#33324;&#20026;&#20250;&#35805;Bean)&#21487;&#33021;&#20250;&#34987;&#25171;&#21253;&#25104;&#23427;&#20204;&#33258;&#24049;&#30340;JAR&#25991;&#20214;, &#20294;&#20320;&#20063;&#35768;&#20250;&#23558;EJB JAR&#25991;&#20214;&#19968;&#21516;&#21253;&#21547;&#36827;&#33021;&#29420;&#31435;(&#28909;)&#37096;&#32626;&#30340;&#20027;&#26381;&#21153;&#25991;&#26723;. 
&#21442;&#32771;JBoss AS&#25991;&#26723;&#20197;&#20102;&#35299;&#26356;&#22810;&#30340;JMX&#26381;&#21153;&#19982;EJB&#37096;&#32626;&#30340;&#20449;&#24687;. </P></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=persistent-classes></A>&#31532;&nbsp;4&nbsp;&#31456;&nbsp;&#25345;&#20037;&#21270;&#31867;(Persistent 
Classes)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#29992;&#26469;&#23454;&#29616;&#19994;&#21153;&#38382;&#39064;&#23454;&#20307;&#30340;&#65288;&#22914;&#65292;&#22312;&#30005;&#23376;&#21830;&#21153;&#24212;&#29992;&#31243;&#24207;&#20013;&#30340;Customer&#21644;Order&#65289; 
&#31867;&#23601;&#26159;&#25345;&#20037;&#21270;&#31867;&#12290;&#19981;&#33021;&#35748;&#20026;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#37117;&#26159;&#25345;&#20037;&#30340;&#29366;&#24577;——&#19968;&#20010;&#23454;&#20363;&#30340;&#29366;&#24577;&#20063;&#21487;&#33021; &#26159;&#30636;&#26102;&#30340;&#25110;&#33073;&#31649;&#30340;&#12290; </P>
<P>&#22914;&#26524;&#36825;&#20123;&#25345;&#20037;&#21270;&#31867;&#36981;&#24490;&#19968;&#20123;&#31616;&#21333;&#30340;&#35268;&#21017;&#65292;Hibernate&#33021;&#22815;&#24037;&#20316;&#24471;&#26356;&#22909;&#65292;&#36825;&#20123;&#35268;&#21017;&#20063;&#34987;&#31216;&#20316; &#31616;&#21333;&#20256;&#32479;Java&#23545;&#35937;(POJO:Plain Old Java 
Object)&#32534;&#31243;&#27169;&#22411;&#12290;&#20294;&#26159;&#36825;&#20123;&#35268;&#21017;&#24182;&#19981;&#26159;&#24517;&#38656;&#30340;&#12290; &#23454;&#38469;&#19978;&#65292;Hibernate3&#23545;&#20110;&#20320;&#30340;&#25345;&#20037;&#21270;&#31867;&#20960;&#20046;&#19981;&#20570;&#20219;&#20309;&#35774;&#24819;&#12290;&#20320;&#21487;&#20197;&#29992;&#20854;&#20182;&#30340;&#26041;&#27861;&#26469;&#34920;&#36798;&#39046;&#22495;&#27169;&#22411;&#65306; 
&#27604;&#22914;&#65292;&#20351;&#29992;<TT class=literal>Map</TT>&#23454;&#20363;&#30340;&#26641;&#22411;&#32467;&#26500;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-pojo></A>4.1.&nbsp;&#19968;&#20010;&#31616;&#21333;&#30340;POJO&#20363;&#23376;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22823;&#22810;&#25968;Java&#31243;&#24207;&#38656;&#35201;&#29992;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#26469;&#34920;&#31034;&#29483;&#31185;&#21160;&#29289;&#12290; </P><PRE class=programlisting>package eg;
import java.util.Set;
import java.util.Date;

public class Cat {
    private Long id; // identifier

    private Date birthdate;
    private Color color;
    private char sex;
    private float weight;
    private int litterId;

    private Cat mother;
    private Set kittens = new HashSet();

    private void setId(Long id) {
        this.id=id;
    }
    public Long getId() {
        return id;
    }

    void setBirthdate(Date date) {
        birthdate = date;
    }
    public Date getBirthdate() {
        return birthdate;
    }

    void setWeight(float weight) {
        this.weight = weight;
    }
    public float getWeight() {
        return weight;
    }

    public Color getColor() {
        return color;
    }
    void setColor(Color color) {
        this.color = color;
    }

    void setSex(char sex) {
        this.sex=sex;
    }
    public char getSex() {
        return sex;
    }

    void setLitterId(int id) {
        this.litterId = id;
    }
    public int getLitterId() {
        return litterId;
    }

    void setMother(Cat mother) {
        this.mother = mother;
    }
    public Cat getMother() {
        return mother;
    }
    void setKittens(Set kittens) {
        this.kittens = kittens;
    }
    public Set getKittens() {
        return kittens;
    }
    
    // addKitten not needed by Hibernate
    public void addKitten(Cat kitten) {
    	kitten.setMother(this);
	kitten.setLitterId( kittens.size() ); 
        kittens.add(kitten);
    }
}</PRE>
<P>&#36825;&#37324;&#35201;&#36981;&#24490;&#22235;&#26465;&#20027;&#35201;&#30340;&#35268;&#21017;&#65306; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-constructor></A>4.1.1.&nbsp;&#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#65288;&#21363;&#26080;&#21442;&#25968;&#30340;&#65289;&#26500;&#36896;&#26041;&#27861;&#65288;constructor&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#26377;&#19968;&#20010;&#26080;&#21442;&#25968;&#30340;&#26500;&#36896;&#26041;&#27861;&#12290;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#37117;&#24517;&#39035;&#26377;&#19968;&#20010; 
&#40664;&#35748;&#30340;&#26500;&#36896;&#26041;&#27861;&#65288;&#21487;&#20197;&#19981;&#26159;public&#30340;&#65289;&#65292;&#36825;&#26679;&#30340;&#35805;Hibernate&#23601;&#21487;&#20197;&#20351;&#29992; <TT 
class=literal>Constructor.newInstance()</TT>&#26469;&#23454;&#20363;&#21270;&#23427;&#20204;&#12290; 
&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#65292;&#22312;Hibernate&#20013;&#65292;&#20026;&#20102;&#36816;&#34892;&#26399;&#20195;&#29702;&#30340;&#29983;&#25104;&#65292;&#26500;&#36896;&#26041;&#27861;&#33267;&#23569;&#26159; <SPAN 
class=emphasis><EM>&#21253;(package)</EM></SPAN>&#20869;&#21487;&#35265;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-identifier></A>4.1.2.&nbsp;&#25552;&#20379;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;identifier 
property&#65289;&#65288;&#21487;&#36873;&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#26377;&#19968;&#20010;&#23646;&#24615;&#21483;&#20570;<TT class=literal>id</TT>&#12290;&#36825;&#20010;&#23646;&#24615;&#26144;&#23556;&#25968;&#25454;&#24211;&#34920;&#30340;&#20027; 
&#38190;&#23383;&#27573;&#12290;&#36825;&#20010;&#23646;&#24615;&#21487;&#20197;&#21483;&#20219;&#20309;&#21517;&#23383;&#65292;&#20854;&#31867;&#22411;&#21487;&#20197;&#26159;&#20219;&#20309;&#30340;&#21407;&#22987;&#31867;&#22411;&#12289;&#21407;&#22987;&#31867;&#22411;&#30340;&#21253;&#35013;&#31867;&#22411;&#12289; <TT class=literal>java.lang.String</TT> 
&#25110;&#32773;&#26159; <TT class=literal>java.util.Date</TT>&#12290; 
&#65288;&#22914;&#26524;&#20320;&#30340;&#36951;&#30041;&#25968;&#25454;&#24211;&#34920;&#26377;&#32852;&#21512;&#20027;&#38190;&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#19968;&#20010;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#31867;&#65292;&#35813;&#31867;&#25317;&#26377;&#36825;&#20123;&#31867;&#22411; &#30340;&#23646;&#24615;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;&#20851;&#20110;&#32852;&#21512;&#26631;&#35782;&#31526;&#30340;&#31456;&#33410;&#12290;&#65289; </P>
<P>&#26631;&#35782;&#31526;&#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#12290;&#21487;&#20197;&#19981;&#29992;&#31649;&#23427;&#65292;&#35753;Hibernate&#20869;&#37096;&#26469;&#36861;&#36394;&#23545;&#35937;&#30340;&#35782;&#21035;&#12290; &#20294;&#26159;&#25105;&#20204;&#24182;&#19981;&#25512;&#33616;&#36825;&#26679;&#20570;&#12290; </P>
<P>&#23454;&#38469;&#19978;&#65292;&#19968;&#20123;&#21151;&#33021;&#21482;&#23545;&#37027;&#20123;&#22768;&#26126;&#20102;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#31867;&#36215;&#20316;&#29992;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#25176;&#31649;&#23545;&#35937;&#30340;&#20256;&#25773;&#24615;&#20877;&#36830;&#25509;&#65288;&#32423;&#32852;&#26356;&#26032;&#25110;&#32423;&#32852;&#21512;&#24182;&#65289; ——&#21442;&#38405; <A 
  title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)" 
  href="#objectstate-transitive">&#31532;&nbsp;10.11&nbsp;&#33410; “&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
  persistence)”</A> </P>
  <LI>
  <P><TT class=literal>Session.saveOrUpdate()</TT> </P>
  <LI>
  <P><TT class=literal>Session.merge()</TT> </P></LI></UL></DIV>
<P>&#25105;&#20204;&#24314;&#35758;&#20320;&#23545;&#25345;&#20037;&#21270;&#31867;&#22768;&#26126;&#21629;&#21517;&#19968;&#33268;&#30340;&#26631;&#35782;&#23646;&#24615;&#12290;&#25105;&#20204;&#36824;&#24314;&#35758;&#20320;&#20351;&#29992;&#19968; &#20010;&#21487;&#20197;&#20026;&#31354;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#19981;&#26159;&#21407;&#22987;&#31867;&#22411;&#65289;&#30340;&#31867;&#22411;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=persistent-classes-pojo-final></A>4.1.3.&nbsp;&#20351;&#29992;&#38750;final&#30340;&#31867; 
(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#20195;&#29702;&#65288;proxies&#65289;</EM></SPAN>&#26159;Hibernate&#30340;&#19968;&#20010;&#37325;&#35201;&#30340;&#21151;&#33021;&#65292;&#23427;&#20381;&#36182;&#30340;&#26465;&#20214;&#26159;&#65292;&#25345;&#20037; 
&#21270;&#31867;&#25110;&#32773;&#26159;&#38750;final&#30340;&#65292;&#25110;&#32773;&#26159;&#23454;&#29616;&#20102;&#19968;&#20010;&#25152;&#26377;&#26041;&#27861;&#37117;&#22768;&#26126;&#20026;public&#30340;&#25509;&#21475;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#29992;Hibernate&#25345;&#20037;&#21270;&#19968;&#20010;&#27809;&#26377;&#23454;&#29616;&#20219;&#20309;&#25509;&#21475;&#30340;<TT class=literal>final</TT>&#31867;&#65292;&#20294;&#26159;&#20320; 
&#19981;&#33021;&#20351;&#29992;&#20195;&#29702;&#26469;&#24310;&#36831;&#20851;&#32852;&#21152;&#36733;&#65292;&#36825;&#20250;&#38480;&#21046;&#20320;&#36827;&#34892;&#24615;&#33021;&#20248;&#21270;&#30340;&#36873;&#25321;&#12290; </P>
<P>&#20320;&#20063;&#24212;&#35813;&#36991;&#20813;&#22312;&#38750;final&#31867;&#20013;&#22768;&#26126; <TT class=literal>public final</TT>&#30340;&#26041;&#27861;&#12290;&#22914;&#26524;&#20320;&#24819;&#20351;&#29992;&#19968; &#20010;&#26377;<TT 
class=literal>public final</TT>&#26041;&#27861;&#30340;&#31867;&#65292;&#20320;&#24517;&#39035;&#36890;&#36807;&#35774;&#32622;<TT class=literal>lazy="false"</TT> 
&#26469;&#26126;&#30830;&#22320;&#31105;&#29992;&#20195;&#29702;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-accessors></A>4.1.4.&nbsp;&#20026;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#35775;&#38382;&#22120;(accessors)&#21644;&#26159;&#21542;&#21487;&#21464;&#30340;&#26631;&#24535;(mutators)(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#20026;&#23427;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#20102;&#35775;&#38382;&#26041;&#27861;&#12290;&#24456;&#22810;&#20854;&#20182;ORM&#24037;&#20855;&#30452;&#25509;&#23545; 
&#23454;&#20363;&#21464;&#37327;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290;&#25105;&#20204;&#30456;&#20449;&#65292;&#22312;&#20851;&#31995;&#25968;&#25454;&#24211;schema&#21644;&#31867;&#30340;&#20869;&#37096;&#25968;&#25454;&#32467;&#26500;&#20043;&#38388;&#24341;&#20837;&#38388;&#25509;&#23618;(&#21407;&#25991;&#20026;"&#38750;&#30452;&#25509;"&#65292;indirection)&#20250;&#22909;&#19968;&#20123;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;Hibernate&#25345;&#20037;&#21270;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#65292;&#35748;&#21487; 
<TT class=literal>getFoo</TT>&#65292;<TT class=literal>isFoo</TT> &#21644; <TT 
class=literal>setFoo</TT>&#36825;&#31181;&#24418;&#24335;&#30340;&#26041;&#27861;&#21517;&#12290; &#22914;&#26524;&#38656;&#35201;&#65292;&#20320;&#21487;&#20197;&#23545;&#26576;&#20123;&#29305;&#23450;&#23646;&#24615;&#23454;&#34892;&#30452;&#25509;&#23383;&#27573;&#35775;&#38382;&#12290; </P>
<P>&#23646;&#24615;<SPAN class=emphasis><EM>&#19981;&#38656;&#35201;</EM></SPAN>&#35201;&#22768;&#26126;&#20026;public&#30340;&#12290;Hibernate&#21487;&#20197;&#25345;&#20037;&#21270;&#19968;&#20010;&#26377; <TT 
class=literal>default</TT>&#12289;<TT class=literal>protected</TT>&#25110;<TT 
class=literal>private</TT>&#30340;get/set&#26041;&#27861;&#23545; &#30340;&#23646;&#24615;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-inheritance></A>4.2.&nbsp;&#23454;&#29616;&#32487;&#25215;&#65288;Inheritance&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23376;&#31867;&#20063;&#24517;&#39035;&#36981;&#23432;&#31532;&#19968;&#26465;&#21644;&#31532;&#20108;&#26465;&#35268;&#21017;&#12290;&#23427;&#20174;&#36229;&#31867;<TT class=literal>Cat</TT>&#32487;&#25215;&#20102;&#26631;&#35782;&#23646;&#24615;&#12290; </P><PRE class=programlisting>package eg;

public class DomesticCat extends Cat {
        private String name;

        public String getName() {
                return name;
        }
        protected void setName(String name) {
                this.name=name;
        }
}</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-equalshashcode></A>4.3.&nbsp;&#23454;&#29616;<TT 
class=literal>equals()</TT>&#21644;<TT class=literal>hashCode()</TT></H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#26377;&#22914;&#19979;&#38656;&#27714;&#65292;&#20320;&#24517;&#39035;&#37325;&#36733; <TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#26041;&#27861;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#24819;&#25226;&#25345;&#20037;&#31867;&#30340;&#23454;&#20363;&#25918;&#20837;<TT class=literal>Set</TT>&#20013;&#65288;&#24403;&#34920;&#31034;&#22810;&#20540;&#20851;&#32852;&#26102;&#65292;&#25512;&#33616;&#36825;&#20040;&#20570;&#65289; </P>
  <LI>
  <P>&#24819;&#37325;&#29992;&#33073;&#31649;&#23454;&#20363; </P></LI></UL></DIV>
<P>Hibernate&#20445;&#35777;&#65292;&#20165;&#22312;&#29305;&#23450;&#20250;&#35805;&#33539;&#22260;&#20869;&#65292;&#25345;&#20037;&#21270;&#26631;&#35782;&#65288;&#25968;&#25454;&#24211;&#30340;&#34892;&#65289;&#21644;Java&#26631;&#35782;&#26159;&#31561;&#20215;&#30340;&#12290;&#22240;&#27492;&#65292;&#19968;&#26086; &#25105;&#20204;&#28151;&#21512;&#20102;&#20174;&#19981;&#21516;&#20250;&#35805;&#20013;&#33719;&#21462;&#30340;&#23454;&#20363;&#65292;&#22914;&#26524;&#24076;&#26395;<TT 
class=literal>Set</TT>&#26377;&#26126;&#30830;&#30340;&#35821;&#20041;&#65292;&#23601;&#24517; &#39035;&#23454;&#29616;<TT class=literal>equals()</TT> &#21644;<TT 
class=literal>hashCode()</TT>&#12290; </P>
<P>&#23454;&#29616;<TT class=literal>equals()</TT>/<TT 
class=literal>hashCode()</TT>&#26368;&#26174;&#32780;&#26131;&#35265;&#30340;&#26041;&#27861;&#26159;&#27604;&#36739;&#20004;&#20010;&#23545;&#35937; 
&#26631;&#35782;&#31526;&#30340;&#20540;&#12290;&#22914;&#26524;&#20540;&#30456;&#21516;&#65292;&#21017;&#20004;&#20010;&#23545;&#35937;&#23545;&#24212;&#20110;&#25968;&#25454;&#24211;&#30340;&#21516;&#19968;&#34892;&#65292;&#22240;&#27492;&#23427;&#20204;&#26159;&#30456;&#31561;&#30340;&#65288;&#22914;&#26524;&#37117;&#34987;&#28155;&#21152;&#21040; <TT class=literal>Set</TT>&#65292;&#21017;&#22312;<TT 
class=literal>Set</TT>&#20013;&#21482;&#26377;&#19968;&#20010;&#20803;&#32032;&#65289;&#12290;&#19981;&#24184;&#30340;&#26159;&#65292;&#23545;&#29983;&#25104;&#30340;&#26631;&#35782;&#19981;&#33021; 
&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#12290;Hibernate&#20165;&#23545;&#37027;&#20123;&#25345;&#20037;&#21270;&#23545;&#35937;&#36171;&#26631;&#35782;&#20540;&#65292;&#19968;&#20010;&#26032;&#21019;&#24314;&#30340;&#23454;&#20363;&#23558;&#19981;&#20250;&#26377;&#20219;&#20309;&#26631;&#35782;&#20540;&#12290;&#27492;&#22806;&#65292; 
&#22914;&#26524;&#19968;&#20010;&#23454;&#20363;&#27809;&#26377;&#34987;&#20445;&#23384;(unsaved)&#65292;&#24182;&#19988;&#23427;&#24403;&#21069;&#27491;&#22312;&#19968;&#20010;<TT class=literal>Set</TT>&#20013;&#65292;&#20445;&#23384;&#23427;&#23558;&#20250;&#32473;&#36825;&#20010;&#23545;&#35937; 
&#36171;&#19968;&#20010;&#26631;&#35782;&#20540;&#12290;&#22914;&#26524;<TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#26159;&#22522;&#20110;&#26631;&#35782;&#20540; &#23454;&#29616;&#30340;&#65292;&#21017;&#20854;&#21704;&#24076;&#30721;&#23558;&#20250;&#25913;&#21464;&#65292;&#36825;&#36829;&#21453;&#20102;<TT 
class=literal>Set</TT>&#30340;&#22865;&#32422;&#12290;&#24314;&#35758;&#21435;Hibernate&#30340;&#31449;&#28857;&#38405;&#35835;&#20851;&#20110;&#36825;&#20010; 
&#38382;&#39064;&#30340;&#20840;&#37096;&#35752;&#35770;&#12290;&#27880;&#24847;&#65292;&#36825;&#19981;&#26159;Hibernate&#30340;&#38382;&#39064;&#65292;&#32780;&#26159;&#19968;&#33324;&#30340;Java&#23545;&#35937;&#26631;&#35782;&#21644;Java&#23545;&#35937;&#31561;&#20215;&#30340;&#35821;&#20041;&#38382;&#39064;&#12290; </P>
<P>&#25105;&#20204;&#24314;&#35758;&#20351;&#29992;<SPAN class=emphasis><EM>&#19994;&#21153;&#38190;&#20540;&#30456;&#31561;(Business key 
equality)</EM></SPAN>&#26469;&#23454;&#29616;<TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#12290;&#19994;&#21153;&#38190;&#20540;&#30456;&#31561;&#30340;&#24847;&#24605;&#26159;&#65292;<TT class=literal>equals()</TT>&#26041;&#27861; 
&#20165;&#20165;&#27604;&#36739;&#24418;&#25104;&#19994;&#21153;&#38190;&#30340;&#23646;&#24615;&#65292;&#23427;&#33021;&#22312;&#29616;&#23454;&#19990;&#30028;&#37324;&#26631;&#35782;&#25105;&#20204;&#30340;&#23454;&#20363;&#65288;&#26159;&#19968;&#20010;<SPAN class=emphasis><EM>&#33258;&#28982;&#30340;</EM></SPAN>&#20505;&#36873;&#30721;&#65289;&#12290; 
</P><PRE class=programlisting>public class Cat {

    ...
    public boolean equals(Object other) {
        if (this == other) return true;
        if ( !(other instanceof Cat) ) return false;

        final Cat cat = (Cat) other;

        if ( !cat.getLitterId().equals( getLitterId() ) ) return false;
        if ( !cat.getMother().equals( getMother() ) ) return false;

        return true;
    }

    public int hashCode() {
        int result;
        result = getMother().hashCode();
        result = 29 * result + getLitterId();
        return result;
    }

}</PRE>
<P>&#27880;&#24847;&#65292;&#19994;&#21153;&#38190;&#19981;&#24517;&#20687;&#25968;&#25454;&#24211;&#30340;&#20027;&#38190;&#37027;&#26679;&#22266;&#23450;&#19981;&#21464;&#65288;&#21442;&#35265;<A 
title="11.1.3.&nbsp;&#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering object identity)" 
href="#transactions-basics-identity">&#31532;&nbsp;11.1.3&nbsp;&#33410; “&#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering 
object identity)”</A>&#65289;&#12290; &#23545;&#19994;&#21153;&#38190;&#32780;&#35328;&#65292;&#19981;&#21487;&#21464;&#25110;&#21807;&#19968;&#30340;&#23646;&#24615;&#26159;&#19981;&#38169;&#30340;&#36873;&#25321;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-dynamicmodels></A>4.4.&nbsp;&#21160;&#24577;&#27169;&#22411;(Dynamic 
models)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#27880;&#24847;&#65292;&#20197;&#19979;&#29305;&#24615;&#22312;&#24403;&#21069;&#22788;&#20110;&#35797;&#39564;&#38454;&#27573;&#65292;&#23558;&#26469;&#21487;&#33021;&#20250;&#26377;&#21464;&#21270;&#12290;</EM></SPAN> </P>
<P>&#36816;&#34892;&#26399;&#30340;&#25345;&#20037;&#21270;&#23454;&#20307;&#27809;&#26377;&#24517;&#35201;&#19968;&#23450;&#34920;&#31034;&#20026;&#20687;POJO&#31867;&#25110;JavaBean&#23545;&#35937;&#37027;&#26679;&#30340;&#24418;&#24335;&#12290;Hibernate&#20063;&#25903;&#25345;&#21160;&#24577;&#27169;&#22411; &#65288;&#22312;&#36816;&#34892;&#26399;&#20351;&#29992;<TT 
class=literal>Map</TT>&#30340;<TT class=literal>Map</TT>&#65289;&#21644;&#35937;DOM4J&#30340;&#26641;&#27169;&#22411;&#37027; 
&#26679;&#30340;&#23454;&#20307;&#34920;&#31034;&#12290;&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#65292;&#20320;&#19981;&#29992;&#20889;&#25345;&#20037;&#21270;&#31867;&#65292;&#21482;&#20889;&#26144;&#23556;&#25991;&#20214;&#23601;&#34892;&#20102;&#12290; </P>
<P>Hibernate&#40664;&#35748;&#24037;&#20316;&#22312;&#26222;&#36890;POJO&#27169;&#24335;&#12290;&#20320;&#21487;&#20197;&#20351;&#29992;&#37197;&#32622;&#36873;&#39033;<TT class=literal>default_entity_mode</TT>&#65292; 
&#23545;&#29305;&#23450;&#30340;<TT class=literal>SessionFactory</TT>&#65292;&#35774;&#32622;&#19968;&#20010;&#40664;&#35748;&#30340;&#23454;&#20307;&#34920;&#31034;&#27169;&#24335;&#12290; &#65288;&#21442;&#35265;<A 
title="&#34920;&nbsp;3.3.&nbsp;&#10;                Hibernate&#37197;&#32622;&#23646;&#24615;&#10;            " 
href="#configuration-optional-properties">&#34920;&nbsp;3.3 “ Hibernate&#37197;&#32622;&#23646;&#24615; ”</A>&#12290;&#65289; 
</P>
<P>&#19979;&#38754;&#26159;&#29992;<TT class=literal>Map</TT>&#26469;&#34920;&#31034;&#30340;&#20363;&#23376;&#12290;&#39318;&#20808;&#65292;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#35201;&#22768;&#26126; <TT 
class=literal>entity-name</TT>&#26469;&#20195;&#26367;&#19968;&#20010;&#31867;&#21517;&#65288;&#25110;&#20316;&#20026;&#19968;&#31181;&#38468;&#23646;&#65289;&#12290; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class entity-name="Customer"&gt;

        &lt;id name="id"
            type="long"
            column="ID"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;

        &lt;property name="name"
            column="NAME"
            type="string"/&gt;

        &lt;property name="address"
            column="ADDRESS"
            type="string"/&gt;

        &lt;many-to-one name="organization"
            column="ORGANIZATION_ID"
            class="Organization"/&gt;

        &lt;bag name="orders"
            inverse="true"
            lazy="false"
            cascade="all"&gt;
            &lt;key column="CUSTOMER_ID"/&gt;
            &lt;one-to-many class="Order"/&gt;
        &lt;/bag&gt;

    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</PRE>
<P>&#27880;&#24847;&#65292;&#34429;&#28982;&#26159;&#29992;&#30446;&#26631;&#31867;&#21517;&#26469;&#22768;&#26126;&#20851;&#32852;&#30340;&#65292;&#20294;&#26159;&#20851;&#32852;&#30340;&#30446;&#26631;&#31867;&#22411;&#38500;&#20102;&#26159;POJO&#20043;&#22806;&#65292;&#20063;&#21487;&#20197; &#26159;&#19968;&#20010;&#21160;&#24577;&#30340;&#23454;&#20307;&#12290; </P>
<P>&#22312;&#20351;&#29992;<TT class=literal>dynamic-map</TT>&#20026;<TT class=literal>SessionFactory</TT> 
&#35774;&#32622;&#20102;&#40664;&#35748;&#30340;&#23454;&#20307;&#27169;&#24335;&#20043;&#21518;&#65292;&#21487;&#20197;&#22312;&#36816;&#34892;&#26399;&#20351;&#29992;<TT class=literal>Map</TT>&#30340; <TT class=literal>Map</TT>&#12290; 
</P><PRE class=programlisting>Session s = openSession();
Transaction tx = s.beginTransaction();
Session s = openSession();

// Create a customer
Map david = new HashMap();
david.put("name", "David");

// Create an organization
Map foobar = new HashMap();
foobar.put("name", "Foobar Inc.");

// Link both
david.put("organization", foobar);

// Save both
s.save("Customer", david);
s.save("Organization", foobar);

tx.commit();
s.close();</PRE>
<P>&#21160;&#24577;&#26144;&#23556;&#30340;&#22909;&#22788;&#26159;&#65292;&#21464;&#21270;&#25152;&#38656;&#35201;&#30340;&#26102;&#38388;&#23569;&#20102;&#65292;&#22240;&#20026;&#21407;&#22411;&#19981;&#38656;&#35201;&#23454;&#29616;&#23454;&#20307;&#31867;&#12290;&#28982;&#32780;&#65292;&#20320;&#26080;&#27861;&#36827;&#34892; 
&#32534;&#35793;&#26399;&#30340;&#31867;&#22411;&#26816;&#26597;&#65292;&#24182;&#21487;&#33021;&#30001;&#27492;&#20250;&#22788;&#29702;&#24456;&#22810;&#30340;&#36816;&#34892;&#26399;&#24322;&#24120;&#12290;&#24184;&#20111;&#26377;&#20102;Hibernate&#26144;&#23556;&#65292;&#23427;&#20351;&#24471;&#25968; 
&#25454;&#24211;&#30340;schema&#33021;&#23481;&#26131;&#30340;&#35268;&#26684;&#21270;&#21644;&#21512;&#29702;&#21270;&#65292;&#24182;&#20801;&#35768;&#31245;&#21518;&#22312;&#27492;&#20043;&#19978;&#28155;&#21152;&#21512;&#36866;&#30340;&#39046;&#22495;&#27169;&#22411;&#23454;&#29616;&#12290; </P>
<P>&#23454;&#20307;&#34920;&#31034;&#27169;&#24335;&#20063;&#33021;&#22312;&#27599;&#20010;<TT class=literal>Session</TT>&#30340;&#22522;&#30784;&#19978;&#35774;&#32622;&#65306; </P><PRE class=programlisting>Session dynamicSession = pojoSession.getSession(EntityMode.MAP);

// Create a customer
Map david = new HashMap();
david.put("name", "David");
dynamicSession.save("Customer", david);
...
dynamicSession.flush();
dynamicSession.close()
...
// Continue on pojoSession
</PRE>
<P>&#35831;&#27880;&#24847;&#65292;&#29992;<TT class=literal>EntityMode</TT>&#35843;&#29992;<TT class=literal>getSession()</TT>&#26159;&#22312; 
<TT class=literal>Session</TT>&#30340;API&#20013;&#65292;&#32780;&#19981;&#26159;<TT class=literal>SessionFactory</TT>&#12290; 
&#36825;&#26679;&#65292;&#26032;&#30340;<TT class=literal>Session</TT>&#20849;&#20139;&#24213;&#23618;&#30340;JDBC&#36830;&#25509;&#65292;&#20107;&#21153;&#65292;&#21644;&#20854;&#20182;&#30340;&#19978;&#19979;&#25991;&#20449; &#24687;&#12290;&#36825;&#24847;&#21619;&#30528;&#65292;&#20320;&#19981;&#38656;&#35201;&#22312;&#31532;&#20108;&#20010;<TT 
class=literal>Session</TT>&#20013;&#35843;&#29992; <TT class=literal>flush()</TT>&#21644;<TT 
class=literal>close()</TT>&#65292;&#21516;&#26679;&#30340;&#65292;&#25226;&#20107;&#21153;&#21644;&#36830;&#25509;&#30340;&#22788;&#29702; &#20132;&#32473;&#21407;&#26469;&#30340;&#24037;&#20316;&#21333;&#20803;&#12290; </P>
<P>&#20851;&#20110;XML&#34920;&#31034;&#33021;&#21147;&#30340;&#26356;&#22810;&#20449;&#24687;&#21487;&#20197;&#22312;<A title=&#31532;&nbsp;18&nbsp;&#31456;&nbsp;XML&#26144;&#23556; 
href="#xml">&#31532;&nbsp;18&nbsp;&#31456; <I>XML&#26144;&#23556;</I></A>&#20013;&#25214;&#21040;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-tuplizers></A>4.5.&nbsp;&#20803;&#32452;&#29255;&#26029;&#26144;&#23556;(Tuplizers)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.tuple.Tuplizer</TT>&#65292;&#20197;&#21450;&#20854;&#23376;&#25509;&#21475;&#65292;&#36127;&#36131;&#26681;&#25454;&#32473;&#23450;&#30340;<TT 
class=literal>org.hibernate.EntityMode</TT>&#65292;&#26469;&#22797;&#29616;&#29255;&#26029;&#25968;&#25454;&#12290;&#22914;&#26524;&#32473;&#23450;&#30340;&#29255;&#26029;&#25968;&#25454;&#34987;&#35748;&#20026;&#20854;&#26159;&#19968;&#31181;&#25968;&#25454;&#32467;&#26500;&#65292;"tuplizer"&#23601;&#26159;&#19968;&#20010;&#30693;&#36947;&#22914;&#20309;&#21019;&#24314;&#36825;&#26679;&#30340;&#25968;&#25454;&#32467;&#26500;&#65292;&#20197;&#21450;&#22914;&#20309;&#32473;&#36825;&#20010;&#25968;&#25454;&#32467;&#26500;&#36171;&#20540;&#30340;&#19996;&#35199;&#12290;&#27604;&#22914;&#35828;&#65292;&#23545;&#20110;POJO&#36825;&#31181;Entity 
Mode&#65292;&#23545;&#24212;&#30340;tuplizer&#30693;&#36947;&#36890;&#36807;&#20854;&#26500;&#36896;&#26041;&#27861;&#26469;&#21019;&#24314;&#19968;&#20010;POJO&#65292;&#20877;&#36890;&#36807;&#20854;&#23646;&#24615;&#35775;&#38382;&#22120;&#26469;&#35775;&#38382;POJO&#23646;&#24615;&#12290;&#26377;&#20004;&#22823;&#31867;&#39640;&#23618;Tuplizer&#65292;&#20998;&#21035;&#26159;<TT 
class=literal>org.hibernate.tuple.EntityTuplizer</TT> &#21644;<TT 
class=literal>org.hibernate.tuple.ComponentTuplizer</TT>&#25509;&#21475;&#12290;<TT 
class=literal>EntityTuplizer</TT>&#36127;&#36131;&#31649;&#29702;&#19978;&#38754;&#25552;&#21040;&#30340;&#23454;&#20307;&#30340;&#22865;&#32422;&#65292;&#32780;<TT 
class=literal>ComponentTuplizer</TT>&#21017;&#26159;&#38024;&#23545;&#32452;&#20214;&#30340;&#12290; </P>
<P>&#29992;&#25143;&#20063;&#21487;&#20197;&#25554;&#20837;&#20854;&#33258;&#23450;&#20041;&#30340;tuplizer&#12290;&#25110;&#35768;&#24744;&#38656;&#35201;&#19968;&#31181;&#19981;&#21516;&#20110;dynamic-map entity-mode&#20013;&#20351;&#29992;&#30340;<TT 
class=literal>java.util.HashMap</TT>&#30340;<TT 
class=literal>java.util.Map</TT>&#23454;&#29616;&#65307;&#25110;&#35768;&#24744;&#38656;&#35201;&#19982;&#40664;&#35748;&#31574;&#30053;&#19981;&#21516;&#30340;&#20195;&#29702;&#29983;&#25104;&#31574;&#30053;(proxy generation 
strategy)&#12290;&#36890;&#36807;&#33258;&#23450;&#20041;tuplizer&#23454;&#29616;&#65292;&#36825;&#20004;&#20010;&#30446;&#26631;&#24744;&#37117;&#21487;&#20197;&#36798;&#21040;&#12290;Tuplizer&#23450;&#20041;&#34987;&#38468;&#21152;&#21040;&#23427;&#20204;&#26399;&#26395;&#31649;&#29702;&#30340;entity&#25110;&#32773;component&#26144;&#23556;&#20013;&#12290;&#22238;&#21040;&#25105;&#20204;&#30340;customer 
entity&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
    &lt;class entity-name="Customer"&gt;
        &lt;!--
            Override the dynamic-map entity-mode
            tuplizer for the customer entity
        --&gt;
        &lt;tuplizer entity-mode="dynamic-map"
                class="CustomMapTuplizerImpl"/&gt;

        &lt;id name="id" type="long" column="ID"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;

        &lt;!-- other properties --&gt;
        ...
    &lt;/class&gt;
&lt;/hibernate-mapping&gt;


public class CustomMapTuplizerImpl
        extends org.hibernate.tuple.DynamicMapEntityTuplizer {
    // override the buildInstantiator() method to plug in our custom map...
    protected final Instantiator buildInstantiator(
            org.hibernate.mapping.PersistentClass mappingInfo) {
        return new CustomMapInstantiator( mappingInfo );
    }

    private static final class CustomMapInstantiator
            extends org.hibernate.tuple.DynamicMapInstantitor {
        // override the generateMap() method to return our custom map...
	    protected final Map generateMap() {
		    return new CustomMap();
	    }
    }
}</PRE></DIV>
<P>TODO&#65306;property&#21644;proxy&#21253;&#37324;&#30340;&#29992;&#25143;&#25193;&#23637;&#26694;&#26550;&#25991;&#26723;&#12290; </P></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=mapping></A>&#31532;&nbsp;5&nbsp;&#31456;&nbsp;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R 
Mapping)</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-declaration></A>5.1.&nbsp;&#26144;&#23556;&#23450;&#20041;&#65288;Mapping 
declaration&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#35937;&#21644;&#20851;&#31995;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340;&#26144;&#23556;&#36890;&#24120;&#26159;&#29992;&#19968;&#20010;XML&#25991;&#26723;(XML document)&#26469;&#23450;&#20041;&#30340;&#12290;&#36825;&#20010;&#26144;&#23556;&#25991;&#26723;&#34987;&#35774;&#35745;&#20026;&#26131;&#35835;&#30340;&#65292; 
&#24182;&#19988;&#21487;&#20197;&#25163;&#24037;&#20462;&#25913;&#12290;&#26144;&#23556;&#35821;&#35328;&#26159;&#20197;Java&#20026;&#20013;&#24515;&#65292;&#36825;&#24847;&#21619;&#30528;&#26144;&#23556;&#25991;&#26723;&#26159;&#25353;&#29031;&#25345;&#20037;&#21270;&#31867;&#30340;&#23450;&#20041;&#26469;&#21019;&#24314;&#30340;&#65292; &#32780;&#38750;&#34920;&#30340;&#23450;&#20041;&#12290; </P>
<P>&#35831;&#27880;&#24847;&#65292;&#34429;&#28982;&#24456;&#22810;Hibernate&#29992;&#25143;&#36873;&#25321;&#25163;&#20889;XML&#26144;&#23556;&#25991;&#26723;&#65292;&#20294;&#20063;&#26377;&#19968;&#20123;&#24037;&#20855;&#21487;&#20197;&#29992;&#26469;&#29983;&#25104;&#26144;&#23556;&#25991;&#26723;&#65292; 
&#21253;&#25324;XDoclet,Middlegen&#21644;AndroMDA&#12290; </P>
<P>&#35753;&#25105;&#20204;&#20174;&#19968;&#20010;&#26144;&#23556;&#30340;&#20363;&#23376;&#24320;&#22987;&#65306; </P><A name=mapping-declaration-ex1></A><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
      "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;

        &lt;class name="Cat" 
            table="cats"
            discriminator-value="C"&gt;
                
                &lt;id name="id"&gt;
                        &lt;generator class="native"/&gt;
                &lt;/id&gt;

                &lt;discriminator column="subclass" 
                     type="character"/&gt;

                &lt;property name="weight"/&gt;

                &lt;property name="birthdate"
                    type="date" 
                    not-null="true" 
                    update="false"/&gt;

                &lt;property name="color"
                    type="eg.types.ColorUserType"
                    not-null="true"
                    update="false"/&gt;

                &lt;property name="sex"
                    not-null="true" 
                    update="false"/&gt;

                &lt;property name="litterId"
                    column="litterId"
                    update="false"/&gt;

                &lt;many-to-one name="mother"
                    column="mother_id"
                    update="false"/&gt;

                &lt;set name="kittens"
                    inverse="true"
                    order-by="litter_id"&gt;
                        &lt;key column="mother_id"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;

                &lt;subclass name="DomesticCat"
                    discriminator-value="D"&gt;

                        &lt;property name="name" 
                            type="string"/&gt;

                &lt;/subclass&gt;

        &lt;/class&gt;

        &lt;class name="Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#25105;&#20204;&#29616;&#22312;&#24320;&#22987;&#35752;&#35770;&#26144;&#23556;&#25991;&#26723;&#30340;&#20869;&#23481;&#12290;&#25105;&#20204;&#21482;&#25551;&#36848;Hibernate&#22312;&#36816;&#34892;&#26102;&#29992;&#21040;&#30340;&#25991;&#26723;&#20803;&#32032;&#21644;&#23646;&#24615;&#12290; 
&#26144;&#23556;&#25991;&#26723;&#36824;&#21253;&#25324;&#19968;&#20123;&#39069;&#22806;&#30340;&#21487;&#36873;&#23646;&#24615;&#21644;&#20803;&#32032;&#65292;&#23427;&#20204;&#22312;&#20351;&#29992;schema&#23548;&#20986;&#24037;&#20855;&#30340;&#26102;&#20505;&#20250;&#24433;&#21709;&#23548;&#20986;&#30340;&#25968;&#25454;&#24211;schema&#32467;&#26524;&#12290; &#65288;&#27604;&#22914;&#65292;<TT class=literal> 
not-null</TT> &#23646;&#24615;&#12290;&#65289; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-doctype></A>5.1.1.&nbsp;Doctype</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25152;&#26377;&#30340;XML&#26144;&#23556;&#37117;&#38656;&#35201;&#23450;&#20041;&#22914;&#19978;&#25152;&#31034;&#30340;doctype&#12290;DTD&#21487;&#20197;&#20174;&#19978;&#36848;URL&#20013;&#33719;&#21462;&#65292; &#20063;&#21487;&#20197;&#20174;<TT 
class=literal>hibernate-x.x.x/src/net/sf/hibernate</TT>&#30446;&#24405;&#20013;&#12289; &#25110;<TT 
class=literal>hibernate.jar</TT>&#25991;&#20214;&#20013;&#25214;&#21040;&#12290;Hibernate&#24635;&#26159;&#20250;&#39318;&#20808;&#22312;&#23427;&#30340;classptah&#20013;&#25628;&#32034;DTD&#25991;&#20214;&#12290; 
&#22914;&#26524;&#20320;&#21457;&#29616;&#23427;&#26159;&#36890;&#36807;&#36830;&#25509;Internet&#26597;&#25214;DTD&#25991;&#20214;&#65292;&#23601;&#23545;&#29031;&#20320;&#30340;classpath&#30446;&#24405;&#26816;&#26597;XML&#25991;&#20214;&#37324;&#30340;DTD&#22768;&#26126;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-mapping></A>5.1.2.&nbsp;hibernate-mapping</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#20010;&#20803;&#32032;&#21253;&#25324;&#19968;&#20123;&#21487;&#36873;&#30340;&#23646;&#24615;&#12290;<TT class=literal>schema</TT>&#21644;<TT class=literal>catalog</TT>&#23646;&#24615;&#65292; 
&#25351;&#26126;&#20102;&#36825;&#20010;&#26144;&#23556;&#25152;&#36830;&#25509;&#65288;refer&#65289;&#30340;&#34920;&#25152;&#22312;&#30340;schema&#21644;/&#25110;catalog&#21517;&#31216;&#12290; 
&#20551;&#33509;&#25351;&#23450;&#20102;&#36825;&#20010;&#23646;&#24615;&#65292;&#34920;&#21517;&#20250;&#21152;&#19978;&#25152;&#25351;&#23450;&#30340;schema&#21644;catalog&#30340;&#21517;&#23383;&#25193;&#23637;&#20026;&#20840;&#38480;&#23450;&#21517;&#12290;&#20551;&#33509;&#27809;&#26377;&#25351;&#23450;&#65292;&#34920;&#21517;&#23601;&#19981;&#20250;&#20351;&#29992;&#20840;&#38480;&#23450;&#21517;&#12290; <TT 
class=literal>default-cascade</TT>&#25351;&#23450;&#20102;&#26410;&#26126;&#30830;&#27880;&#26126;<TT 
class=literal>cascade</TT>&#23646;&#24615;&#30340;Java&#23646;&#24615;&#21644; &#38598;&#21512;&#31867;Hibernate&#20250;&#37319;&#21462;&#20160;&#20040;&#26679;&#30340;&#40664;&#35748;&#32423;&#32852;&#39118;&#26684;&#12290;<TT 
class=literal>auto-import</TT>&#23646;&#24615;&#40664;&#35748;&#35753;&#25105;&#20204;&#22312;&#26597;&#35810;&#35821;&#35328;&#20013;&#21487;&#20197;&#20351;&#29992; &#38750;&#20840;&#38480;&#23450;&#21517;&#30340;&#31867;&#21517;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;hibernate-mapping
         schema="schemaName"                          <SPAN class=co>(1)</SPAN>
         catalog="catalogName"                        <SPAN class=co>(2)</SPAN>
         default-cascade="cascade_style"              <SPAN class=co>(3)</SPAN>
         default-access="field|property|ClassName"    <SPAN class=co>(4)</SPAN>
         default-lazy="true|false"                    <SPAN class=co>(5)</SPAN>
         auto-import="true|false"                     <SPAN class=co>(6)</SPAN>
         package="package.name"                       <SPAN class=co>(7)</SPAN>
 /&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>schema</TT> (&#21487;&#36873;): &#25968;&#25454;&#24211;schema&#30340;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>catalog</TT> (&#21487;&#36873;): &#25968;&#25454;&#24211;catalog&#30340;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>default-cascade</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>none</TT>): &#40664;&#35748;&#30340;&#32423;&#32852;&#39118;&#26684;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>default-access</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#25152;&#26377;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290;&#21487;&#20197;&#36890;&#36807;&#23454;&#29616;<TT 
      class=literal>PropertyAccessor</TT>&#25509;&#21475; &#33258;&#23450;&#20041;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>default-lazy</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>): &#25351;&#23450;&#20102;&#26410;&#26126;&#30830;&#27880;&#26126;<TT 
      class=literal>lazy</TT>&#23646;&#24615;&#30340;Java&#23646;&#24615;&#21644;&#38598;&#21512;&#31867;&#65292; Hibernate&#20250;&#37319;&#21462;&#20160;&#20040;&#26679;&#30340;&#40664;&#35748;&#21152;&#36733;&#39118;&#26684;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>auto-import</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>): &#25351;&#23450;&#25105;&#20204;&#26159;&#21542;&#21487;&#20197;&#22312;&#26597;&#35810;&#35821;&#35328;&#20013;&#20351;&#29992;&#38750;&#20840;&#38480;&#23450;&#30340;&#31867;&#21517;&#65288;&#20165;&#38480;&#20110;&#26412;&#26144;&#23556;&#25991;&#20214;&#20013;&#30340;&#31867;&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>package</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#21253;&#21069;&#32512;&#65292;&#22914;&#26524;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#27809;&#26377;&#25351;&#23450;&#20840;&#38480;&#23450;&#30340;&#31867;&#21517;&#65292; 
      &#23601;&#20351;&#29992;&#36825;&#20010;&#20316;&#20026;&#21253;&#21517;&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20551;&#33509;&#20320;&#26377;&#20004;&#20010;&#25345;&#20037;&#21270;&#31867;&#65292;&#23427;&#20204;&#30340;&#38750;&#20840;&#38480;&#23450;&#21517;&#26159;&#19968;&#26679;&#30340;&#65288;&#23601;&#26159;&#20004;&#20010;&#31867;&#30340;&#21517;&#23383;&#19968;&#26679;&#65292;&#25152;&#22312;&#30340;&#21253;&#19981;&#19968;&#26679;--&#35793;&#32773;&#27880;&#65289;&#65292; &#20320;&#24212;&#35813;&#35774;&#32622;<TT 
class=literal>auto-import="false"</TT>&#12290;&#22914;&#26524;&#20320;&#25226;&#19968;&#20010;“import&#36807;”&#30340;&#21517;&#23383;&#21516;&#26102;&#23545;&#24212;&#20004;&#20010;&#31867;&#65292; 
Hibernate&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290; </P>
<P>&#27880;&#24847;<TT class=literal>hibernate-mapping</TT> &#20803;&#32032;&#20801;&#35768;&#20320;&#23884;&#22871;&#22810;&#20010;&#22914;&#19978;&#25152;&#31034;&#30340; <TT 
class=literal>&lt;class&gt;</TT>&#26144;&#23556;&#12290;&#20294;&#26159;&#26368;&#22909;&#30340;&#20570;&#27861;&#65288;&#20063;&#35768;&#19968;&#20123;&#24037;&#20855;&#38656;&#35201;&#30340;&#65289;&#26159;&#19968;&#20010; 
&#25345;&#20037;&#21270;&#31867;&#65288;&#25110;&#19968;&#20010;&#31867;&#30340;&#32487;&#25215;&#23618;&#27425;&#65289;&#23545;&#24212;&#19968;&#20010;&#26144;&#23556;&#25991;&#20214;&#65292;&#24182;&#20197;&#25345;&#20037;&#21270;&#30340;&#36229;&#31867;&#21517;&#31216;&#21629;&#21517;&#65292;&#20363;&#22914;&#65306; <TT class=literal>Cat.hbm.xml</TT>&#65292; <TT 
class=literal>Dog.hbm.xml</TT>&#65292;&#25110;&#32773;&#22914;&#26524;&#20351;&#29992;&#32487;&#25215;&#65292;<TT class=literal>Animal.hbm.xml</TT>&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-class></A>5.1.3.&nbsp;class</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>class</TT>&#20803;&#32032;&#26469;&#23450;&#20041;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#65306; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;class
        name="ClassName"                              <SPAN class=co>(1)</SPAN>
        table="tableName"                             <SPAN class=co>(2)</SPAN>
        discriminator-value="discriminator_value"     <SPAN class=co>(3)</SPAN>
        mutable="true|false"                          <SPAN class=co>(4)</SPAN>
        schema="owner"                                <SPAN class=co>(5)</SPAN>
        catalog="catalog"                             <SPAN class=co>(6)</SPAN>
        proxy="ProxyInterface"                        <SPAN class=co>(7)</SPAN>
        dynamic-update="true|false"                   <SPAN class=co>(8)</SPAN>
        dynamic-insert="true|false"                   <SPAN class=co>(9)</SPAN>
        select-before-update="true|false"             <SPAN class=co>(10)</SPAN>
        polymorphism="implicit|explicit"              <SPAN class=co>(11)</SPAN>
        where="arbitrary sql where condition"         <SPAN class=co>(12)</SPAN>
        persister="PersisterClass"                    <SPAN class=co>(13)</SPAN>
        batch-size="N"                                <SPAN class=co>(14)</SPAN>
        optimistic-lock="none|version|dirty|all"      <SPAN class=co>(15)</SPAN>
        lazy="true|false"                             <SPAN class=co>(16)</SPAN>
        entity-name="EntityName"                      <SPAN class=co>(17)</SPAN>
        check="arbitrary sql check condition"         <SPAN class=co>(18)</SPAN>
        rowid="rowid"                                 <SPAN class=co>(19)</SPAN>
        subselect="SQL expression"                    <SPAN class=co>(20)</SPAN>
        abstract="true|false"                         <SPAN class=co>(21)</SPAN>
        node="element-name"
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT> (&#21487;&#36873;): &#25345;&#20037;&#21270;&#31867;&#65288;&#25110;&#32773;&#25509;&#21475;&#65289;&#30340;Java&#20840;&#38480;&#23450;&#21517;&#12290; 
      &#22914;&#26524;&#36825;&#20010;&#23646;&#24615;&#19981;&#23384;&#22312;&#65292;Hibernate&#23558;&#20551;&#23450;&#36825;&#26159;&#19968;&#20010;&#38750;POJO&#30340;&#23454;&#20307;&#26144;&#23556;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>table</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159;&#31867;&#30340;&#38750;&#20840;&#38480;&#23450;&#21517;): &#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>discriminator-value</TT> (&#21487;&#36873; - &#40664;&#35748;&#21644;&#31867;&#21517;&#19968;&#26679;): 
      &#19968;&#20010;&#29992;&#20110;&#21306;&#20998;&#19981;&#21516;&#30340;&#23376;&#31867;&#30340;&#20540;&#65292;&#22312;&#22810;&#24577;&#34892;&#20026;&#26102;&#20351;&#29992;&#12290;&#23427;&#21487;&#20197;&#25509;&#21463;&#30340;&#20540;&#21253;&#25324; <TT class=literal>null</TT> &#21644; <TT 
      class=literal>not null</TT>&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>mutable</TT> (&#21487;&#36873;&#65292;&#40664;&#35748;&#20540;&#20026;<TT class=literal>true</TT>): 
      &#34920;&#26126;&#35813;&#31867;&#30340;&#23454;&#20363;&#26159;&#21487;&#21464;&#30340;&#25110;&#32773;&#19981;&#21487;&#21464;&#30340;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>schema</TT> (&#21487;&#36873;): &#35206;&#30422;&#22312;&#26681;<TT 
      class=literal>&lt;hibernate-mapping&gt;</TT>&#20803;&#32032;&#20013;&#25351;&#23450;&#30340;schema&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>catalog</TT> (&#21487;&#36873;): &#35206;&#30422;&#22312;&#26681;<TT 
      class=literal>&lt;hibernate-mapping&gt;</TT>&#20803;&#32032;&#20013;&#25351;&#23450;&#30340;catalog&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>proxy</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290; 
      &#20320;&#21487;&#20197;&#22312;&#36825;&#37324;&#20351;&#29992;&#35813;&#31867;&#33258;&#24049;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>dynamic-update</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026; <TT 
      class=literal>false</TT>): &#25351;&#23450;&#29992;&#20110;<TT class=literal>UPDATE</TT> 
      &#30340;SQL&#23558;&#20250;&#22312;&#36816;&#34892;&#26102;&#21160;&#24577;&#29983;&#25104;&#65292;&#24182;&#19988;&#21482;&#26356;&#26032;&#37027;&#20123;&#25913;&#21464;&#36807;&#30340;&#23383;&#27573;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(9)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>dynamic-insert</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026; <TT 
      class=literal>false</TT>): &#25351;&#23450;&#29992;&#20110;<TT class=literal>INSERT</TT>&#30340; SQL 
      &#23558;&#20250;&#22312;&#36816;&#34892;&#26102;&#21160;&#24577;&#29983;&#25104;&#65292;&#24182;&#19988;&#21482;&#21253;&#21547;&#37027;&#20123;&#38750;&#31354;&#20540;&#23383;&#27573;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(10)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>select-before-update</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026; <TT 
      class=literal>false</TT>): &#25351;&#23450;Hibernate&#38500;&#38750;&#30830;&#23450;&#23545;&#35937;&#30495;&#27491;&#34987;&#20462;&#25913;&#20102;&#65288;&#22914;&#26524;&#35813;&#20540;&#20026;true&#65293;&#35793;&#27880;&#65289;&#65292;&#21542;&#21017;<SPAN 
      class=emphasis><EM>&#19981;&#20250;</EM></SPAN>&#25191;&#34892;SQL <TT 
      class=literal>UPDATE</TT>&#25805;&#20316;&#12290;&#22312;&#29305;&#23450;&#22330;&#21512;&#65288;&#23454;&#38469;&#19978;&#65292;&#23427;&#21482;&#22312;&#19968;&#20010;&#30636;&#26102;&#23545;&#35937;&#65288;transient object&#65289;&#20851;&#32852;&#21040;&#19968;&#20010; 
      &#26032;&#30340;session&#20013;&#26102;&#25191;&#34892;&#30340;update()&#20013;&#29983;&#25928;&#65289;&#65292;&#36825;&#35828;&#26126;Hibernate&#20250;&#22312;<TT class=literal>UPDATE</TT> 
      &#20043;&#21069;&#25191;&#34892;&#19968;&#27425;&#39069;&#22806;&#30340;SQL <TT class=literal>SELECT</TT>&#25805;&#20316;&#65292;&#26469;&#20915;&#23450;&#26159;&#21542;&#24212;&#35813;&#25191;&#34892; <TT 
      class=literal>UPDATE</TT>&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(11)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>polymorphism&#65288;&#22810;&#24577;&#65289;</TT> (&#21487;&#36873;, &#40664;&#35748;&#20540;&#20026; <TT 
      class=literal>implicit (&#38544;&#24335;) </TT>): 
      &#30028;&#23450;&#26159;&#38544;&#24335;&#36824;&#26159;&#26174;&#24335;&#30340;&#20351;&#29992;&#22810;&#24577;&#26597;&#35810;&#65288;&#36825;&#21482;&#22312;Hibernate&#30340;&#20855;&#20307;&#34920;&#32487;&#25215;&#31574;&#30053;&#20013;&#29992;&#21040;&#65293;&#35793;&#27880;&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(12)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>where</TT> (&#21487;&#36873;) &#25351;&#23450;&#19968;&#20010;&#38468;&#21152;&#30340;SQL<TT 
      class=literal>WHERE</TT> &#26465;&#20214;&#65292; &#22312;&#25235;&#21462;&#36825;&#20010;&#31867;&#30340;&#23545;&#35937;&#26102;&#20250;&#19968;&#30452;&#22686;&#21152;&#36825;&#20010;&#26465;&#20214;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(13)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>persister</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#23450;&#21046;&#30340;<TT 
      class=literal>ClassPersister</TT>&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(14)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>batch-size</TT> (&#21487;&#36873;,&#40664;&#35748;&#26159;<TT class=literal>1</TT>) 
      &#25351;&#23450;&#19968;&#20010;&#29992;&#20110; &#26681;&#25454;&#26631;&#35782;&#31526;&#65288;identifier&#65289;&#25235;&#21462;&#23454;&#20363;&#26102;&#20351;&#29992;&#30340;"batch size"&#65288;&#25209;&#27425;&#25235;&#21462;&#25968;&#37327;&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(15)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock&#65288;&#20048;&#35266;&#38145;&#23450;&#65289;</TT> (&#21487;&#36873;&#65292;&#40664;&#35748;&#26159;<TT 
      class=literal>version</TT>): &#20915;&#23450;&#20048;&#35266;&#38145;&#23450;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(16)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873;): &#36890;&#36807;&#35774;&#32622;<TT 
      class=literal>lazy="false"</TT>&#65292; &#25152;&#26377;&#30340;&#24310;&#36831;&#21152;&#36733;&#65288;Lazy fetching&#65289;&#21151;&#33021;&#23558;&#34987;&#20840;&#37096;&#31105;&#29992;&#65288;disabled&#65289;&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(17)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>entity-name</TT> (&#21487;&#36873;&#65292;&#40664;&#35748;&#20026;&#31867;&#21517;): Hibernate3&#20801;&#35768;&#19968;&#20010;&#31867;&#36827;&#34892;&#22810;&#27425;&#26144;&#23556;&#65288; 
      &#21069;&#25552;&#26159;&#26144;&#23556;&#21040;&#19981;&#21516;&#30340;&#34920;&#65289;&#65292;&#24182;&#19988;&#20801;&#35768;&#20351;&#29992;Maps&#25110;XML&#20195;&#26367;Java&#23618;&#27425;&#30340;&#23454;&#20307;&#26144;&#23556; &#65288;&#20063;&#23601;&#26159;&#23454;&#29616;&#21160;&#24577;&#39046;&#22495;&#27169;&#22411;&#65292;&#19981;&#29992;&#20889;&#25345;&#20037;&#21270;&#31867;&#65293;&#35793;&#27880;&#65289;&#12290; &#26356;&#22810;&#20449;&#24687;&#35831;&#30475;<A 
      title="4.4.&nbsp;&#21160;&#24577;&#27169;&#22411;(Dynamic models)" 
      href="#persistent-classes-dynamicmodels">&#31532;&nbsp;4.4&nbsp;&#33410; “&#21160;&#24577;&#27169;&#22411;(Dynamic 
      models)”</A> and <A title=&#31532;&nbsp;18&nbsp;&#31456;&nbsp;XML&#26144;&#23556; 
      href="#xml">&#31532;&nbsp;18&nbsp;&#31456; <I>XML&#26144;&#23556;</I></A>&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(18)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>check</TT> (&#21487;&#36873;): &#36825;&#26159;&#19968;&#20010;SQL&#34920;&#36798;&#24335;&#65292; 
      &#29992;&#20110;&#20026;&#33258;&#21160;&#29983;&#25104;&#30340;schema&#28155;&#21152;&#22810;&#34892;&#65288;multi-row&#65289;&#32422;&#26463;<SPAN class=emphasis><EM>&#26816;&#26597;</EM></SPAN>&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(19)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>rowid</TT> (&#21487;&#36873;): Hibernate&#21487;&#20197;&#20351;&#29992;&#25968;&#25454;&#24211;&#25903;&#25345;&#30340;&#25152;&#35859;&#30340;ROWIDs&#65292;&#20363;&#22914;&#65306; 
      Oracle&#25968;&#25454;&#24211;&#65292;&#22914;&#26524;&#20320;&#35774;&#32622;&#36825;&#20010;&#21487;&#36873;&#30340;<TT class=literal>rowid</TT>&#65292; Hibernate&#21487;&#20197;&#20351;&#29992;&#39069;&#22806;&#30340;&#23383;&#27573;<TT 
      class=literal>rowid</TT>&#23454;&#29616;&#24555;&#36895;&#26356;&#26032;&#12290;ROWID&#26159;&#36825;&#20010;&#21151;&#33021;&#23454;&#29616;&#30340;&#37325;&#28857;&#65292; &#23427;&#20195;&#34920;&#20102;&#19968;&#20010;&#23384;&#20648;&#20803;&#32452;&#65288;tuple&#65289;&#30340;&#29289;&#29702;&#20301;&#32622;&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(20)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>subselect</TT> (&#21487;&#36873;): 
      &#23427;&#23558;&#19968;&#20010;&#19981;&#21487;&#21464;&#65288;immutable&#65289;&#24182;&#19988;&#21482;&#35835;&#30340;&#23454;&#20307;&#26144;&#23556;&#21040;&#19968;&#20010;&#25968;&#25454;&#24211;&#30340; 
      &#23376;&#26597;&#35810;&#20013;&#12290;&#24403;&#20320;&#24819;&#29992;&#35270;&#22270;&#20195;&#26367;&#19968;&#24352;&#22522;&#26412;&#34920;&#30340;&#26102;&#20505;&#65292;&#36825;&#26159;&#26377;&#29992;&#30340;&#65292;&#20294;&#26368;&#22909;&#19981;&#35201;&#36825;&#26679;&#20570;&#12290;&#26356;&#22810;&#30340;&#20171;&#32461;&#35831;&#30475;&#19979;&#38754;&#20869;&#23481;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(21)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>abstract</TT> (&#21487;&#36873;): &#29992;&#20110;&#22312;<TT 
      class=literal>&lt;union-subclass&gt;</TT>&#30340;&#32487;&#25215;&#32467;&#26500; &#65288;hierarchies&#65289;&#20013;&#26631;&#35782;&#25277;&#35937;&#36229;&#31867;&#12290; 
    </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#33509;&#25351;&#26126;&#30340;&#25345;&#20037;&#21270;&#31867;&#23454;&#38469;&#19978;&#26159;&#19968;&#20010;&#25509;&#21475;&#65292;&#36825;&#20063;&#26159;&#23436;&#20840;&#21487;&#20197;&#25509;&#21463;&#30340;&#12290; &#20043;&#21518;&#20320;&#21487;&#20197;&#29992;&#20803;&#32032;<TT 
class=literal>&lt;subclass&gt;</TT>&#26469;&#25351;&#23450;&#35813;&#25509;&#21475;&#30340;&#23454;&#38469;&#23454;&#29616;&#31867;&#12290; &#20320;&#21487;&#20197;&#25345;&#20037;&#21270;&#20219;&#20309;<SPAN 
class=emphasis><EM>static</EM></SPAN>&#65288;&#38745;&#24577;&#30340;&#65289;&#20869;&#37096;&#31867;&#12290; &#20320;&#24212;&#35813;&#20351;&#29992;&#26631;&#20934;&#30340;&#31867;&#21517;&#26684;&#24335;&#26469;&#25351;&#23450;&#31867;&#21517;&#65292;<TT 
class=literal>&#27604;&#22914;&#65306;Foo$Bar</TT>&#12290; </P>
<P>&#19981;&#21487;&#21464;&#31867;&#65292;<TT class=literal>mutable="false"</TT>&#19981;&#21487;&#20197;&#34987;&#24212;&#29992;&#31243;&#24207;&#26356;&#26032;&#25110;&#32773;&#21024;&#38500;&#12290; 
&#36825;&#21487;&#20197;&#35753;Hibernate&#20570;&#19968;&#20123;&#23567;&#23567;&#30340;&#24615;&#33021;&#20248;&#21270;&#12290; </P>
<P>&#21487;&#36873;&#30340;<TT class=literal>proxy</TT>&#23646;&#24615;&#20801;&#35768;&#24310;&#36831;&#21152;&#36733;&#31867;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#12290; 
Hibernate&#24320;&#22987;&#20250;&#36820;&#22238;&#23454;&#29616;&#20102;&#36825;&#20010;&#21629;&#21517;&#25509;&#21475;&#30340;CGLIB&#20195;&#29702;&#12290;&#24403;&#20195;&#29702;&#30340;&#26576;&#20010;&#26041;&#27861;&#34987;&#23454;&#38469;&#35843;&#29992;&#30340;&#26102;&#20505;&#65292; 
&#30495;&#23454;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#25165;&#20250;&#34987;&#35013;&#36733;&#12290;&#21442;&#35265;&#19979;&#38754;&#30340;“&#29992;&#20110;&#24310;&#36831;&#35013;&#36733;&#30340;&#20195;&#29702;”&#12290; </P>
<P><SPAN class=emphasis><EM>Implicit</EM></SPAN> 
(&#38544;&#24335;)&#30340;&#22810;&#24577;&#26159;&#25351;&#65292;&#22914;&#26524;&#26597;&#35810;&#26102;&#32473;&#20986;&#30340;&#26159;&#20219;&#20309;&#36229;&#31867;&#12289;&#35813;&#31867;&#23454;&#29616;&#30340;&#25509;&#21475;&#25110;&#32773;&#35813;&#31867;&#30340; &#21517;&#23383;&#65292;&#37117;&#20250;&#36820;&#22238;&#36825;&#20010;&#31867;&#30340;&#23454;&#20363;&#65307;&#22914;&#26524;&#26597;&#35810;&#20013;&#32473;&#20986;&#30340;&#26159;&#23376;&#31867;&#30340;&#21517;&#23383;&#65292;&#21017;&#20250;&#36820;&#22238;&#23376;&#31867;&#30340;&#23454;&#20363;&#12290; 
<SPAN class=emphasis><EM>Explicit</EM></SPAN> 
&#65288;&#26174;&#24335;&#65289;&#30340;&#22810;&#24577;&#26159;&#25351;&#65292;&#21482;&#26377;&#22312;&#26597;&#35810;&#26102;&#32473;&#20986;&#26126;&#30830;&#30340;&#35813;&#31867;&#21517;&#23383;&#26102;&#25165;&#20250;&#36820;&#22238;&#36825;&#20010;&#31867;&#30340;&#23454;&#20363;&#65307; &#21516;&#26102;&#21482;&#26377;&#22312;&#36825;&#20010;<TT 
class=literal>&lt;class&gt;</TT>&#30340;&#23450;&#20041;&#20013;&#20316;&#20026;<TT class=literal>&lt;subclass&gt;</TT> 
&#25110;&#32773;<TT class=literal>&lt;joined-subclass&gt;</TT>&#20986;&#29616;&#30340;&#23376;&#31867;&#65292;&#25165;&#20250;&#21487;&#33021;&#36820;&#22238;&#12290; &#22312;&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#65292;&#40664;&#35748;&#30340;<TT 
class=literal>polymorphism="implicit"</TT>&#37117;&#26159;&#21512;&#36866;&#30340;&#12290; 
&#26174;&#24335;&#30340;&#22810;&#24577;&#22312;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#31867;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#34920;&#30340;&#26102;&#20505;&#24456;&#26377;&#29992;&#12290;&#65288;&#20801;&#35768;&#19968;&#20010;“&#36731;&#22411;”&#30340;&#31867;&#65292;&#21482;&#21253;&#21547;&#37096;&#20998;&#34920;&#23383;&#27573;&#65289;&#12290; </P>
<P><TT class=literal>persister</TT>&#23646;&#24615;&#21487;&#20197;&#35753;&#20320;&#23450;&#21046;&#36825;&#20010;&#31867;&#20351;&#29992;&#30340;&#25345;&#20037;&#21270;&#31574;&#30053;&#12290; &#20320;&#21487;&#20197;&#25351;&#23450;&#20320;&#33258;&#24049;&#23454;&#29616; <TT 
class=literal>org.hibernate.persister.EntityPersister</TT>&#30340;&#23376;&#31867;&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#23436;&#20840;&#20174;&#22836;&#24320;&#22987;&#32534;&#20889;&#19968;&#20010; 
<TT class=literal>org.hibernate.persister.ClassPersister</TT>&#25509;&#21475;&#30340;&#23454;&#29616;&#65292; 
&#27604;&#22914;&#26159;&#29992;&#20648;&#23384;&#36807;&#31243;&#35843;&#29992;&#12289;&#24207;&#21015;&#21270;&#21040;&#25991;&#20214;&#25110;&#32773;LDAP&#25968;&#25454;&#24211;&#26469;&#23454;&#29616;&#12290; &#21442;&#38405;<TT 
class=literal>org.hibernate.test.CustomPersister</TT>&#65292;&#36825;&#26159;&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376; &#65288;“&#25345;&#20037;&#21270;”&#21040;&#19968;&#20010;<TT 
class=literal>Hashtable</TT>&#65289;&#12290; </P>
<P>&#35831;&#27880;&#24847;<TT class=literal>dynamic-update</TT>&#21644;<TT 
class=literal>dynamic-insert</TT>&#30340;&#35774;&#32622;&#24182;&#19981;&#20250;&#32487;&#25215;&#21040;&#23376;&#31867;&#65292; &#25152;&#20197;&#22312;<TT 
class=literal>&lt;subclass&gt;</TT>&#25110;&#32773;<TT 
class=literal>&lt;joined-subclass&gt;</TT>&#20803;&#32032;&#20013;&#21487;&#33021; 
&#38656;&#35201;&#20877;&#27425;&#35774;&#32622;&#12290;&#36825;&#20123;&#35774;&#32622;&#26159;&#21542;&#33021;&#22815;&#25552;&#39640;&#25928;&#29575;&#35201;&#35270;&#24773;&#24418;&#32780;&#23450;&#12290;&#35831;&#29992;&#20320;&#30340;&#26234;&#24935;&#20915;&#23450;&#26159;&#21542;&#20351;&#29992;&#12290; </P>
<P>&#20351;&#29992;<TT class=literal>select-before-update</TT>&#36890;&#24120;&#20250;&#38477;&#20302;&#24615;&#33021;&#12290;&#22914;&#26524;&#20320;&#37325;&#26032;&#36830;&#25509;&#19968;&#20010;&#33073;&#31649;&#65288;detache&#65289;&#23545;&#35937;&#23454;&#20363; 
&#21040;&#19968;&#20010;<TT class=literal>Session</TT>&#20013;&#26102;&#65292;&#23427;&#21487;&#20197;&#38450;&#27490;&#25968;&#25454;&#24211;&#19981;&#24517;&#35201;&#30340;&#35302;&#21457;update&#12290; &#36825;&#23601;&#24456;&#26377;&#29992;&#20102;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#25171;&#24320;&#20102;<TT class=literal>dynamic-update</TT>&#65292;&#20320;&#21487;&#20197;&#36873;&#25321;&#20960;&#31181;&#20048;&#35266;&#38145;&#23450;&#30340;&#31574;&#30053;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><TT class=literal>version&#65288;&#29256;&#26412;&#26816;&#26597;&#65289;</TT> &#26816;&#26597;version/timestamp&#23383;&#27573; </P>
  <LI>
  <P><TT class=literal>all&#65288;&#20840;&#37096;&#65289;</TT> &#26816;&#26597;&#20840;&#37096;&#23383;&#27573; </P>
  <LI>
  <P><TT class=literal>dirty&#65288;&#33039;&#26816;&#26597;&#65289;</TT>&#21482;&#26816;&#23519;&#20462;&#25913;&#36807;&#30340;&#23383;&#27573; </P>
  <LI>
  <P><TT class=literal>none&#65288;&#19981;&#26816;&#26597;&#65289;</TT>&#19981;&#20351;&#29992;&#20048;&#35266;&#38145;&#23450; </P></LI></UL></DIV>
<P>&#25105;&#20204;<SPAN 
class=emphasis><EM>&#38750;&#24120;</EM></SPAN>&#24378;&#28872;&#24314;&#35758;&#20320;&#22312;Hibernate&#20013;&#20351;&#29992;version/timestamp&#23383;&#27573;&#26469;&#36827;&#34892;&#20048;&#35266;&#38145;&#23450;&#12290; 
&#23545;&#24615;&#33021;&#26469;&#35828;&#65292;&#36825;&#26159;&#26368;&#22909;&#30340;&#36873;&#25321;&#65292;&#24182;&#19988;&#36825;&#20063;&#26159;&#21807;&#19968;&#33021;&#22815;&#22788;&#29702;&#22312;session&#22806;&#36827;&#34892;&#25805;&#20316;&#30340;&#31574;&#30053;&#65288;&#20363;&#22914;&#65306; &#22312;&#20351;&#29992;<TT 
class=literal>Session.merge()</TT>&#30340;&#26102;&#20505;&#65289;&#12290; </P>
<P>&#23545;Hibernate&#26144;&#23556;&#26469;&#35828;&#35270;&#22270;&#21644;&#34920;&#26159;&#27809;&#26377;&#21306;&#21035;&#30340;&#65292;&#36825;&#26159;&#22240;&#20026;&#23427;&#20204;&#22312;&#25968;&#25454;&#23618;&#37117;&#26159;&#36879;&#26126;&#30340;&#65288; 
&#27880;&#24847;&#65306;&#19968;&#20123;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#35270;&#22270;&#23646;&#24615;&#65292;&#29305;&#21035;&#26159;&#26356;&#26032;&#30340;&#26102;&#20505;&#65289;&#12290;&#26377;&#26102;&#20320;&#24819;&#20351;&#29992;&#35270;&#22270;&#65292;&#20294;&#21364;&#19981;&#33021;&#22312;&#25968;&#25454;&#24211; 
&#20013;&#21019;&#24314;&#23427;&#65288;&#20363;&#22914;&#65306;&#22312;&#36951;&#30041;&#30340;schema&#20013;&#65289;&#12290;&#36825;&#26679;&#30340;&#35805;&#65292;&#20320;&#21487;&#20197;&#26144;&#23556;&#19968;&#20010;&#19981;&#21487;&#21464;&#30340;&#65288;immutable&#65289;&#24182;&#19988;&#26159; &#21482;&#35835;&#30340;&#23454;&#20307;&#21040;&#19968;&#20010;&#32473;&#23450;&#30340;SQL&#23376;&#26597;&#35810;&#34920;&#36798;&#24335;&#65306; </P><PRE class=programlisting>&lt;class name="Summary"&gt;
    &lt;subselect&gt;
        select item.name, max(bid.amount), count(*)
        from item
        join bid on bid.item_id = item.id
        group by item.name
    &lt;/subselect&gt;
    &lt;synchronize table="item"/&gt;
    &lt;synchronize table="bid"/&gt;
    &lt;id name="name"/&gt;
    ...
&lt;/class&gt;</PRE>
<P>&#23450;&#20041;&#36825;&#20010;&#23454;&#20307;&#29992;&#21040;&#30340;&#34920;&#20026;&#21516;&#27493;&#65288;synchronize&#65289;&#65292;&#30830;&#20445;&#33258;&#21160;&#21047;&#26032;&#65288;auto-flush&#65289;&#27491;&#30830;&#25191;&#34892;&#65292; &#24182;&#19988;&#20381;&#36182;&#21407;&#23454;&#20307;&#30340;&#26597;&#35810;&#19981;&#20250;&#36820;&#22238;&#36807;&#26399;&#25968;&#25454;&#12290;<TT 
class=literal>&lt;subselect&gt;</TT>&#22312;&#23646;&#24615;&#20803;&#32032; &#21644;&#19968;&#20010;&#23884;&#22871;&#26144;&#23556;&#20803;&#32032;&#20013;&#37117;&#21487;&#35265;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-id></A>5.1.4.&nbsp;id</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#34987;&#26144;&#23556;&#30340;&#31867;<SPAN 
class=emphasis><EM>&#24517;&#39035;</EM></SPAN>&#23450;&#20041;&#23545;&#24212;&#25968;&#25454;&#24211;&#34920;&#20027;&#38190;&#23383;&#27573;&#12290;&#22823;&#22810;&#25968;&#31867;&#26377;&#19968;&#20010;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#65292; 
&#20026;&#27599;&#19968;&#20010;&#23454;&#20363;&#21253;&#21547;&#21807;&#19968;&#30340;&#26631;&#35782;&#12290;<TT class=literal>&lt;id&gt;</TT> &#20803;&#32032;&#23450;&#20041;&#20102;&#35813;&#23646;&#24615;&#21040;&#25968;&#25454;&#24211;&#34920;&#20027;&#38190;&#23383;&#27573;&#30340;&#26144;&#23556;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;id
        name="propertyName"                                          <SPAN class=co>(1)</SPAN>
        type="typename"                                              <SPAN class=co>(2)</SPAN>
        column="column_name"                                         <SPAN class=co>(3)</SPAN>
        unsaved-value="null|any|none|undefined|id_value"             <SPAN class=co>(4)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(5)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."&gt;

        &lt;generator class="generatorClass"/&gt;
&lt;/id&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT> (&#21487;&#36873;): &#26631;&#35782;&#23646;&#24615;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#21487;&#36873;): &#26631;&#35782;Hibernate&#31867;&#22411;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#20027;&#38190;&#23383;&#27573;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unsaved-value</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#19968;&#20010;&#20999;&#21512;&#23454;&#38469;&#65288;sensible&#65289;&#30340;&#20540;): 
      &#19968;&#20010;&#29305;&#23450;&#30340;&#26631;&#35782;&#23646;&#24615;&#20540;&#65292;&#29992;&#26469;&#26631;&#24535;&#35813;&#23454;&#20363;&#26159;&#21018;&#21018;&#21019;&#24314;&#30340;&#65292;&#23578;&#26410;&#20445;&#23384;&#12290; &#36825;&#21487;&#20197;&#25226;&#36825;&#31181;&#23454;&#20363;&#21644;&#20174;&#20197;&#21069;&#30340;session&#20013;&#35013;&#36733;&#36807;&#65288;&#21487;&#33021;&#21448;&#20570;&#36807;&#20462;&#25913;--&#35793;&#32773;&#27880;&#65289; 
      &#20294;&#26410;&#20877;&#27425;&#25345;&#20037;&#21270;&#30340;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#22914;&#26524; <TT class=literal>name</TT>&#23646;&#24615;&#19981;&#23384;&#22312;&#65292;&#20250;&#35748;&#20026;&#36825;&#20010;&#31867;&#27809;&#26377;&#26631;&#35782;&#23646;&#24615;&#12290; </P>
<P><TT class=literal>unsaved-value</TT> &#23646;&#24615;&#22312;Hibernate3&#20013;&#20960;&#20046;&#19981;&#20877;&#38656;&#35201;&#12290; </P>
<P>&#36824;&#26377;&#19968;&#20010;&#21478;&#22806;&#30340;<TT class=literal>&lt;composite-id&gt;</TT>&#23450;&#20041;&#21487;&#20197;&#35775;&#38382;&#26087;&#24335;&#30340;&#22810;&#20027;&#38190;&#25968;&#25454;&#12290; 
&#25105;&#20204;&#24378;&#28872;&#19981;&#24314;&#35758;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#12290; </P>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-generator></A>5.1.4.1.&nbsp;Generator</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#36873;&#30340;<TT class=literal>&lt;generator&gt;</TT>&#23376;&#20803;&#32032;&#26159;&#19968;&#20010;Java&#31867;&#30340;&#21517;&#23383;&#65292; 
&#29992;&#26469;&#20026;&#35813;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#29983;&#25104;&#21807;&#19968;&#30340;&#26631;&#35782;&#12290;&#22914;&#26524;&#36825;&#20010;&#29983;&#25104;&#22120;&#23454;&#20363;&#38656;&#35201;&#26576;&#20123;&#37197;&#32622;&#20540;&#25110;&#32773;&#21021;&#22987;&#21270;&#21442;&#25968;&#65292; &#29992;<TT 
class=literal>&lt;param&gt;</TT>&#20803;&#32032;&#26469;&#20256;&#36882;&#12290; </P><PRE class=programlisting>&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="org.hibernate.id.TableHiLoGenerator"&gt;
                &lt;param name="table"&gt;uid_table&lt;/param&gt;
                &lt;param name="column"&gt;next_hi_value_column&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</PRE>
<P>&#25152;&#26377;&#30340;&#29983;&#25104;&#22120;&#37117;&#23454;&#29616;<TT class=literal>org.hibernate.id.IdentifierGenerator</TT>&#25509;&#21475;&#12290; 
&#36825;&#26159;&#19968;&#20010;&#38750;&#24120;&#31616;&#21333;&#30340;&#25509;&#21475;&#65307;&#26576;&#20123;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#36873;&#25321;&#25552;&#20379;&#20182;&#20204;&#33258;&#24049;&#29305;&#23450;&#30340;&#23454;&#29616;&#12290;&#24403;&#28982;&#65292; Hibernate&#25552;&#20379;&#20102;&#24456;&#22810;&#20869;&#32622;&#30340;&#23454;&#29616;&#12290;&#19979;&#38754;&#26159;&#19968;&#20123;&#20869;&#32622;&#29983;&#25104;&#22120;&#30340;&#24555;&#25463;&#21517;&#23383;&#65306; </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term><TT class=literal>increment</TT></SPAN>
  <DD>
  <P>&#29992;&#20110;&#20026;<TT class=literal>long</TT>, <TT class=literal>short</TT>&#25110;&#32773;<TT 
  class=literal>int</TT>&#31867;&#22411;&#29983;&#25104; &#21807;&#19968;&#26631;&#35782;&#12290;&#21482;&#26377;&#22312;&#27809;&#26377;&#20854;&#20182;&#36827;&#31243;&#24448;&#21516;&#19968;&#24352;&#34920;&#20013;&#25554;&#20837;&#25968;&#25454;&#26102;&#25165;&#33021;&#20351;&#29992;&#12290; <SPAN 
  class=emphasis><EM>&#22312;&#38598;&#32676;&#19979;&#19981;&#35201;&#20351;&#29992;&#12290;</EM></SPAN> </P>
  <DT><SPAN class=term><TT class=literal>identity</TT></SPAN>
  <DD>
  <P>&#23545;DB2,MySQL, MS SQL Server, Sybase&#21644;HypersonicSQL&#30340;&#20869;&#32622;&#26631;&#35782;&#23383;&#27573;&#25552;&#20379;&#25903;&#25345;&#12290; &#36820;&#22238;&#30340;&#26631;&#35782;&#31526;&#26159;<TT 
  class=literal>long</TT>, <TT class=literal>short</TT> &#25110;&#32773;<TT 
  class=literal>int</TT>&#31867;&#22411;&#30340;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>sequence</TT></SPAN>
  <DD>
  <P>&#22312;DB2,PostgreSQL, Oracle, SAP DB, McKoi&#20013;&#20351;&#29992;&#24207;&#21015;&#65288;sequence)&#65292; 
  &#32780;&#22312;Interbase&#20013;&#20351;&#29992;&#29983;&#25104;&#22120;(generator)&#12290;&#36820;&#22238;&#30340;&#26631;&#35782;&#31526;&#26159;<TT class=literal>long</TT>, <TT 
  class=literal>short</TT>&#25110;&#32773; <TT class=literal>int</TT>&#31867;&#22411;&#30340;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>hilo</TT></SPAN>
  <DD>
  <P><A name=mapping-declaration-id-hilodescription></A>&#20351;&#29992;&#19968;&#20010;&#39640;/&#20302;&#20301;&#31639;&#27861;&#39640;&#25928;&#30340;&#29983;&#25104;<TT 
  class=literal>long</TT>, <TT class=literal>short</TT> &#25110;&#32773; <TT 
  class=literal>int</TT>&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#12290;&#32473;&#23450;&#19968;&#20010;&#34920;&#21644;&#23383;&#27573;&#65288;&#40664;&#35748;&#20998;&#21035;&#26159; <TT 
  class=literal>hibernate_unique_key</TT> &#21644;<TT 
  class=literal>next_hi</TT>&#65289;&#20316;&#20026;&#39640;&#20301;&#20540;&#30340;&#26469;&#28304;&#12290; &#39640;/&#20302;&#20301;&#31639;&#27861;&#29983;&#25104;&#30340;&#26631;&#35782;&#31526;&#21482;&#22312;&#19968;&#20010;&#29305;&#23450;&#30340;&#25968;&#25454;&#24211;&#20013;&#26159;&#21807;&#19968;&#30340;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>seqhilo</TT></SPAN>
  <DD>
  <P>&#20351;&#29992;&#19968;&#20010;&#39640;/&#20302;&#20301;&#31639;&#27861;&#26469;&#39640;&#25928;&#30340;&#29983;&#25104;<TT class=literal>long</TT>, <TT class=literal>short</TT> 
  &#25110;&#32773; <TT class=literal>int</TT>&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#65292;&#32473;&#23450;&#19968;&#20010;&#25968;&#25454;&#24211;&#24207;&#21015;&#65288;sequence)&#30340;&#21517;&#23383;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>uuid</TT></SPAN>
  <DD>
  <P>&#29992;&#19968;&#20010;128-bit&#30340;UUID&#31639;&#27861;&#29983;&#25104;&#23383;&#31526;&#20018;&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#65292; &#36825;&#22312;&#19968;&#20010;&#32593;&#32476;&#20013;&#26159;&#21807;&#19968;&#30340;&#65288;&#20351;&#29992;&#20102;IP&#22320;&#22336;&#65289;&#12290;UUID&#34987;&#32534;&#30721;&#20026;&#19968;&#20010;32&#20301;16&#36827;&#21046;&#25968;&#23383;&#30340;&#23383;&#31526;&#20018;&#12290; 
  </P>
  <DT><SPAN class=term><TT class=literal>guid</TT></SPAN>
  <DD>
  <P>&#22312;MS SQL Server &#21644; MySQL &#20013;&#20351;&#29992;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;GUID&#23383;&#31526;&#20018;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>native</TT></SPAN>
  <DD>
  <P>&#26681;&#25454;&#24213;&#23618;&#25968;&#25454;&#24211;&#30340;&#33021;&#21147;&#36873;&#25321;<TT class=literal>identity</TT>, <TT 
  class=literal>sequence</TT> &#25110;&#32773;<TT class=literal>hilo</TT>&#20013;&#30340;&#19968;&#20010;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>assigned</TT></SPAN>
  <DD>
  <P>&#35753;&#24212;&#29992;&#31243;&#24207;&#22312;<TT class=literal>save()</TT>&#20043;&#21069;&#20026;&#23545;&#35937;&#20998;&#37197;&#19968;&#20010;&#26631;&#31034;&#31526;&#12290;&#36825;&#26159; <TT 
  class=literal>&lt;generator&gt;</TT>&#20803;&#32032;&#27809;&#26377;&#25351;&#23450;&#26102;&#30340;&#40664;&#35748;&#29983;&#25104;&#31574;&#30053;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>select</TT></SPAN>
  <DD>
  <P>&#36890;&#36807;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#36873;&#25321;&#19968;&#20123;&#21807;&#19968;&#20027;&#38190;&#30340;&#34892;&#24182;&#36820;&#22238;&#20027;&#38190;&#20540;&#26469;&#20998;&#37197;&#19968;&#20010;&#20027;&#38190;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>foreign</TT></SPAN>
  <DD>
  <P>&#20351;&#29992;&#21478;&#22806;&#19968;&#20010;&#30456;&#20851;&#32852;&#30340;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#12290;&#36890;&#24120;&#21644;<TT class=literal>&lt;one-to-one&gt;</TT>&#32852;&#21512;&#36215;&#26469;&#20351;&#29992;&#12290; 
  </P></DD></DL></DIV>
<P></P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-hilo></A>5.1.4.2.&nbsp;&#39640;/&#20302;&#20301;&#31639;&#27861;&#65288;Hi/Lo 
Algorithm&#65289;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>hilo</TT> &#21644; <TT 
class=literal>seqhilo</TT>&#29983;&#25104;&#22120;&#32473;&#20986;&#20102;&#20004;&#31181;hi/lo&#31639;&#27861;&#30340;&#23454;&#29616;&#65292; 
&#36825;&#26159;&#19968;&#31181;&#24456;&#20196;&#20154;&#28385;&#24847;&#30340;&#26631;&#35782;&#31526;&#29983;&#25104;&#31639;&#27861;&#12290;&#31532;&#19968;&#31181;&#23454;&#29616;&#38656;&#35201;&#19968;&#20010;“&#29305;&#27530;”&#30340;&#25968;&#25454;&#24211;&#34920;&#26469;&#20445;&#23384;&#19979;&#19968;&#20010;&#21487;&#29992;&#30340;“hi”&#20540;&#12290; 
&#31532;&#20108;&#31181;&#23454;&#29616;&#20351;&#29992;&#19968;&#20010;Oracle&#39118;&#26684;&#30340;&#24207;&#21015;&#65288;&#22312;&#34987;&#25903;&#25345;&#30340;&#24773;&#20917;&#19979;&#65289;&#12290; </P><PRE class=programlisting>&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="hilo"&gt;
                &lt;param name="table"&gt;hi_value&lt;/param&gt;
                &lt;param name="column"&gt;next_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</PRE><PRE class=programlisting>&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="seqhilo"&gt;
                &lt;param name="sequence"&gt;hi_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</PRE>
<P>&#24456;&#19981;&#24184;&#65292;&#20320;&#22312;&#20026;Hibernate&#33258;&#34892;&#25552;&#20379;<TT class=literal>Connection</TT>&#26102;&#26080;&#27861;&#20351;&#29992;<TT 
class=literal>hilo</TT>&#12290; &#24403;Hibernate&#20351;&#29992;JTA&#33719;&#21462;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;&#25968;&#25454;&#28304;&#36830;&#25509;&#26102;,&#20320;&#24517;&#39035;&#27491;&#30830;&#22320;&#37197;&#32622; <TT 
class=literal>hibernate.transaction.manager_lookup_class</TT>&#12290; </P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-uuid></A>5.1.4.3.&nbsp;UUID&#31639;&#27861;&#65288;UUID Algorithm 
&#65289;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>UUID&#21253;&#21547;&#65306;IP&#22320;&#22336;&#65292;JVM&#30340;&#21551;&#21160;&#26102;&#38388;&#65288;&#31934;&#30830;&#21040;1/4&#31186;&#65289;&#65292;&#31995;&#32479;&#26102;&#38388;&#21644;&#19968;&#20010;&#35745;&#25968;&#22120;&#20540;&#65288;&#22312;JVM&#20013;&#21807;&#19968;&#65289;&#12290; 
&#22312;Java&#20195;&#30721;&#20013;&#19981;&#21487;&#33021;&#33719;&#24471;MAC&#22320;&#22336;&#25110;&#32773;&#20869;&#23384;&#22320;&#22336;&#65292;&#25152;&#20197;&#36825;&#24050;&#32463;&#26159;&#25105;&#20204;&#22312;&#19981;&#20351;&#29992;JNI&#30340;&#21069;&#25552;&#19979;&#30340;&#33021;&#20570;&#30340;&#26368;&#22909;&#23454;&#29616;&#20102;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-sequences></A>5.1.4.4.&nbsp;&#26631;&#35782;&#23383;&#27573;&#21644;&#24207;&#21015;&#65288;Identity columns 
and Sequences&#65289;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;&#20869;&#37096;&#25903;&#25345;&#26631;&#35782;&#23383;&#27573;&#30340;&#25968;&#25454;&#24211;(DB2,MySQL,Sybase,MS SQL)&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>identity</TT>&#20851;&#38190;&#23383;&#29983;&#25104;&#12290; &#23545;&#20110;&#20869;&#37096;&#25903;&#25345;&#24207;&#21015;&#30340;&#25968;&#25454;&#24211;&#65288;DB2,Oracle, PostgreSQL, 
Interbase, McKoi,SAP DB), &#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>sequence</TT>&#39118;&#26684;&#30340;&#20851;&#38190;&#23383;&#29983;&#25104;&#12290; 
&#36825;&#20004;&#31181;&#26041;&#24335;&#23545;&#20110;&#25554;&#20837;&#19968;&#20010;&#26032;&#30340;&#23545;&#35937;&#37117;&#38656;&#35201;&#20004;&#27425;SQL&#26597;&#35810;&#12290; </P><PRE class=programlisting>&lt;id name="id" type="long" column="person_id"&gt;
        &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;person_id_sequence&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</PRE><PRE class=programlisting>&lt;id name="id" type="long" column="person_id" unsaved-value="0"&gt;
        &lt;generator class="identity"/&gt;
&lt;/id&gt;</PRE>
<P>&#23545;&#20110;&#36328;&#24179;&#21488;&#24320;&#21457;&#65292;<TT class=literal>native</TT>&#31574;&#30053;&#20250;&#20174;<TT class=literal>identity</TT>, <TT 
class=literal>sequence</TT> &#21644;<TT 
class=literal>hilo</TT>&#20013;&#36827;&#34892;&#36873;&#25321;&#65292;&#36873;&#25321;&#21738;&#19968;&#20010;&#65292;&#36825;&#21462;&#20915;&#20110;&#24213;&#23618;&#25968;&#25454;&#24211;&#30340;&#25903;&#25345;&#33021;&#21147;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-assigned></A>5.1.4.5.&nbsp;&#31243;&#24207;&#20998;&#37197;&#30340;&#26631;&#35782;&#31526;&#65288;Assigned 
Identifiers&#65289;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#38656;&#35201;&#24212;&#29992;&#31243;&#24207;&#20998;&#37197;&#19968;&#20010;&#26631;&#31034;&#31526;&#65288;&#32780;&#38750;Hibernate&#26469;&#29983;&#25104;&#65289;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>assigned</TT> 
&#29983;&#25104;&#22120;&#12290;&#36825;&#31181;&#29305;&#27530;&#30340;&#29983;&#25104;&#22120;&#20250;&#20351;&#29992;&#24050;&#32463;&#20998;&#37197;&#32473;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#26631;&#35782;&#31526;&#20540;&#12290; &#36825;&#20010;&#29983;&#25104;&#22120;&#20351;&#29992;&#19968;&#20010;&#33258;&#28982;&#38190;&#65288;natural 
key&#65292;&#26377;&#21830;&#19994;&#24847;&#20041;&#30340;&#21015;&#65293;&#35793;&#27880;&#65289;&#20316;&#20026;&#20027;&#38190;&#65292;&#32780;&#19981;&#26159;&#20351;&#29992;&#19968;&#20010;&#20195;&#29702;&#38190;&#65288; surrogate key&#65292;&#27809;&#26377;&#21830;&#19994;&#24847;&#20041;&#30340;&#21015;&#65293;&#35793;&#27880;&#65289;&#12290;&#36825;&#26159;&#27809;&#26377;&#25351;&#23450;<TT 
class=literal>&lt;generator&gt;</TT>&#20803;&#32032;&#26102;&#30340;&#40664;&#35748;&#34892;&#20026; </P>
<P>&#24403;&#36873;&#25321;<TT class=literal>assigned</TT>&#29983;&#25104;&#22120;&#26102;&#65292;&#38500;&#38750;&#26377;&#19968;&#20010;version&#25110;timestamp&#23646;&#24615;&#65292;&#25110;&#32773;&#20320;&#23450;&#20041;&#20102; <TT 
class=literal>Interceptor.isUnsaved()</TT>&#65292;&#21542;&#21017;&#38656;&#35201;&#35753;Hiberante&#20351;&#29992; <TT 
class=literal>unsaved-value="undefined"</TT>&#65292;&#24378;&#21046;Hibernatet&#26597;&#35810;&#25968;&#25454;&#24211;&#26469;&#30830;&#23450;&#19968;&#20010;&#23454;&#20363;&#26159;&#30636;&#26102;&#30340;&#65288;transient&#65289; 
&#36824;&#26159;&#33073;&#31649;&#30340;&#65288;detached&#65289;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=mapping-declaration-id-select></A>5.1.4.6.&nbsp;&#35302;&#21457;&#22120;&#23454;&#29616;&#30340;&#20027;&#38190;&#29983;&#25104;&#22120;&#65288;Primary keys 
assigned by triggers&#65289;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20165;&#20165;&#29992;&#20110;&#36951;&#30041;&#30340;schema&#20013; (Hibernate&#19981;&#33021;&#20351;&#29992;&#35302;&#21457;&#22120;&#29983;&#25104;DDL)&#12290; </P><PRE class=programlisting>&lt;id name="id" type="long" column="person_id"&gt;
        &lt;generator class="select"&gt;
                &lt;param name="key"&gt;socialSecurityNumber&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</PRE>
<P>&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#31867;&#23450;&#20041;&#20102;&#19968;&#20010;&#21629;&#21517;&#20026;<TT class=literal>socialSecurityNumber</TT>&#30340;&#21807;&#19968;&#20540;&#23646;&#24615;&#65292; 
&#23427;&#26159;&#19968;&#20010;&#33258;&#28982;&#38190;&#65288;natural key&#65289;&#65292;&#21629;&#21517;&#20026;<TT class=literal>person_id</TT>&#30340;&#20195;&#29702;&#38190;&#65288;surrogate key&#65289; 
&#30340;&#20540;&#30001;&#35302;&#21457;&#22120;&#29983;&#25104;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-compositeid></A>5.1.5.&nbsp;composite-id</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;composite-id
        name="propertyName"
        class="ClassName"
        mapped="true|false"
        access="field|property|ClassName"
        node="element-name|."
        &gt;

        &lt;key-property name="propertyName" type="typename" column="column_name"/&gt;
        &lt;key-many-to-one name="propertyName class="ClassName" column="column_name"/&gt;
        ......
&lt;/composite-id&gt;</PRE>
<P>&#22914;&#26524;&#34920;&#20351;&#29992;&#32852;&#21512;&#20027;&#38190;&#65292;&#20320;&#21487;&#20197;&#26144;&#23556;&#31867;&#30340;&#22810;&#20010;&#23646;&#24615;&#20026;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290; <TT 
class=literal>&lt;composite-id&gt;</TT>&#20803;&#32032;&#25509;&#21463;<TT 
class=literal>&lt;key-property&gt;</TT> &#23646;&#24615;&#26144;&#23556;&#21644;<TT 
class=literal>&lt;key-many-to-one&gt;</TT>&#23646;&#24615;&#26144;&#23556;&#20316;&#20026;&#23376;&#20803;&#32032;&#12290; </P><PRE class=programlisting>&lt;composite-id&gt;
        &lt;key-property name="medicareNumber"/&gt;
        &lt;key-property name="dependent"/&gt;
&lt;/composite-id&gt;</PRE>
<P>&#20320;&#30340;&#25345;&#20037;&#21270;&#31867;<SPAN class=emphasis><EM>&#24517;&#39035;</EM></SPAN>&#37325;&#36733;<TT 
class=literal>equals()</TT>&#21644; <TT class=literal>hashCode()</TT>&#26041;&#27861;&#65292;&#26469;&#23454;&#29616;&#32452;&#21512;&#30340;&#26631;&#35782;&#31526;&#30340;&#30456;&#31561;&#21028;&#26029;&#12290; 
&#23454;&#29616;<TT class=literal>Serializable</TT>&#25509;&#21475;&#20063;&#26159;&#24517;&#39035;&#30340;&#12290; </P>
<P>&#19981;&#24184;&#30340;&#26159;&#65292;&#36825;&#31181;&#32452;&#21512;&#20851;&#38190;&#23383;&#30340;&#26041;&#27861;&#24847;&#21619;&#30528;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#26159;&#23427;&#33258;&#24049;&#30340;&#26631;&#35782;&#12290;&#38500;&#20102;&#23545;&#35937;&#33258;&#24049;&#20043;&#22806;&#65292; 
&#27809;&#26377;&#20160;&#20040;&#26041;&#20415;&#30340;“&#25226;&#25163;”&#21487;&#29992;&#12290;&#20320;&#24517;&#39035;&#21021;&#22987;&#21270;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#65292;&#22635;&#20805;&#23427;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#65292;&#20877;<TT class=literal>load()</TT> 
&#32452;&#21512;&#20851;&#38190;&#23383;&#20851;&#32852;&#30340;&#25345;&#20037;&#29366;&#24577;&#12290;&#25105;&#20204;&#25226;&#36825;&#31181;&#26041;&#27861;&#31216;&#20026;<SPAN 
class=emphasis><EM>embedded&#65288;&#23884;&#20837;&#24335;&#65289;</EM></SPAN>&#30340;&#32452;&#21512;&#26631;&#35782;&#31526;&#65292;&#22312;&#37325;&#35201;&#30340;&#24212;&#29992;&#20013;&#19981;&#40723;&#21169;&#20351;&#29992;&#36825;&#31181;&#29992;&#27861;&#12290; </P>
<P>&#31532;&#20108;&#31181;&#26041;&#27861;&#25105;&#20204;&#31216;&#20026;<SPAN class=emphasis><EM>mapped(&#26144;&#23556;&#24335;)</EM></SPAN>&#32452;&#21512;&#26631;&#35782;&#31526; (mapped 
composite identifier),<TT 
class=literal>&lt;composite-id&gt;</TT>&#20803;&#32032;&#20013;&#21015;&#20986;&#30340;&#26631;&#35782;&#23646;&#24615;&#19981;&#20294;&#22312;&#25345;&#20037;&#21270;&#31867;&#20986;&#29616;&#65292;&#36824;&#24418;&#25104;&#19968;&#20010;&#29420;&#31435;&#30340;&#26631;&#35782;&#31526;&#31867;&#12290; </P><PRE class=programlisting>&lt;composite-id class="MedicareId" mapped="true"&gt;
        &lt;key-property name="medicareNumber"/&gt;
        &lt;key-property name="dependent"/&gt;
&lt;/composite-id&gt;</PRE>
<P>&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#32452;&#21512;&#26631;&#35782;&#31526;&#31867;<TT class=literal>MedicareId</TT>&#21644;&#23454;&#20307;&#31867;&#37117;&#21547;&#26377;<TT 
class=literal>medicareNumber</TT>&#21644;<TT class=literal>dependent</TT>&#23646;&#24615;&#12290;&#26631;&#35782;&#31526;&#31867;&#24517;&#39035;&#37325;&#36733;<TT 
class=literal>equals()</TT>&#21644;<TT class=literal>hashCode()</TT>&#24182;&#19988;&#23454;&#29616;<TT 
class=literal>Serializable</TT>&#25509;&#21475;&#12290;&#36825;&#31181;&#26041;&#27861;&#30340;&#32570;&#28857;&#26159;&#20986;&#29616;&#20102;&#26126;&#26174;&#30340;&#20195;&#30721;&#37325;&#22797;&#12290; </P>
<P>&#19979;&#38754;&#21015;&#20986;&#30340;&#23646;&#24615;&#26159;&#29992;&#26469;&#25351;&#23450;&#19968;&#20010;&#26144;&#23556;&#24335;&#32452;&#21512;&#26631;&#35782;&#31526;&#30340;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>mapped</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026;<TT class=literal>false</TT>): 
  &#25351;&#26126;&#20351;&#29992;&#19968;&#20010;&#26144;&#23556;&#24335;&#32452;&#21512;&#26631;&#35782;&#31526;&#65292;&#20854;&#21253;&#21547;&#30340;&#23646;&#24615;&#26144;&#23556;&#21516;&#26102;&#22312;&#23454;&#20307;&#31867;&#21644;&#32452;&#21512;&#26631;&#35782;&#31526;&#31867;&#20013;&#20986;&#29616;&#12290; </P>
  <LI>
  <P><TT class=literal>class</TT> (&#21487;&#36873;,&#20294;&#23545;&#26144;&#23556;&#24335;&#32452;&#21512;&#26631;&#35782;&#31526;&#24517;&#39035;&#25351;&#23450;): &#20316;&#20026;&#32452;&#21512;&#26631;&#35782;&#31526;&#31867;&#20351;&#29992;&#30340;&#31867;&#21517;. 
</P></LI></UL></DIV>
<P>&#22312;<A title="8.4.&nbsp;&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)" 
href="#components-compositeid">&#31532;&nbsp;8.4&nbsp;&#33410; “&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as 
composite 
identifiers)”</A>&#19968;&#33410;&#20013;,&#25105;&#20204;&#20250;&#25551;&#36848;&#31532;&#19977;&#31181;&#26041;&#24335;,&#37027;&#23601;&#26159;&#25226;&#32452;&#21512;&#26631;&#35782;&#31526;&#23454;&#29616;&#20026;&#19968;&#20010;&#32452;&#20214;(component)&#31867;,&#36825;&#26159;&#26356;&#26041;&#20415;&#30340;&#26041;&#27861;&#12290;&#19979;&#38754;&#30340;&#23646;&#24615;&#20165;&#23545;&#31532;&#19977;&#31181;&#26041;&#27861;&#26377;&#25928;&#65306; 
</P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>name</TT> (&#21487;&#36873;,&#20294;&#23545;&#36825;&#31181;&#26041;&#27861;&#32780;&#35328;&#24517;&#39035;): &#21253;&#21547;&#27492;&#32452;&#20214;&#26631;&#35782;&#31526;&#30340;&#32452;&#20214;&#31867;&#22411;&#30340;&#21517;&#23383; (&#21442;&#38405;&#31532;9&#31456;). </P>
  <LI>
  <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT class=literal>property</TT>): 
  Hibernate&#24212;&#35813;&#20351;&#29992;&#30340;&#35775;&#38382;&#27492;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053; </P>
  <LI>
  <P><TT class=literal>class</TT> (&#21487;&#36873; - &#40664;&#35748;&#20250;&#29992;&#21453;&#23556;&#26469;&#33258;&#21160;&#21028;&#23450;&#23646;&#24615;&#31867;&#22411; ): 
  &#29992;&#26469;&#20316;&#20026;&#32452;&#21512;&#26631;&#35782;&#31526;&#30340;&#32452;&#20214;&#31867;&#30340;&#31867;&#21517;&#65288;&#21442;&#38405;&#19979;&#19968;&#33410;&#65289; </P></LI></UL></DIV>
<P>&#31532;&#19977;&#31181;&#26041;&#24335;&#65292;&#34987;&#31216;&#20026;<SPAN class=emphasis><EM>identifier 
component(&#26631;&#35782;&#31526;&#32452;&#20214;)</EM></SPAN>&#26159;&#25105;&#20204;&#23545;&#20960;&#20046;&#25152;&#26377;&#24212;&#29992;&#37117;&#25512;&#33616;&#20351;&#29992;&#30340;&#26041;&#24335;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-discriminator></A>5.1.6.&nbsp;&#37492;&#21035;&#22120;&#65288;discriminator&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;"&#19968;&#26869;&#23545;&#35937;&#32487;&#25215;&#26641;&#23545;&#24212;&#19968;&#20010;&#34920;"&#30340;&#31574;&#30053;&#20013;,<TT class=literal>&lt;discriminator&gt;</TT>&#20803;&#32032;&#26159;&#24517;&#38656;&#30340;, 
&#23427;&#23450;&#20041;&#20102;&#34920;&#30340;&#37492;&#21035;&#22120;&#23383;&#27573;&#12290;&#37492;&#21035;&#22120;&#23383;&#27573;&#21253;&#21547;&#26631;&#24535;&#20540;&#65292;&#29992;&#20110;&#21578;&#30693;&#25345;&#20037;&#21270;&#23618;&#24212;&#35813;&#20026;&#26576;&#20010;&#29305;&#23450;&#30340;&#34892;&#21019;&#24314;&#21738;&#19968;&#20010;&#23376;&#31867;&#30340;&#23454;&#20363;&#12290; &#22914;&#19979;&#36825;&#20123;&#21463;&#21040;&#38480;&#21046;&#30340;&#31867;&#22411;&#21487;&#20197;&#20351;&#29992;&#65306; <TT 
class=literal>string</TT>, <TT class=literal>character</TT>, <TT 
class=literal>integer</TT>, <TT class=literal>byte</TT>, <TT 
class=literal>short</TT>, <TT class=literal>boolean</TT>, <TT 
class=literal>yes_no</TT>, <TT class=literal>true_false</TT>. </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;discriminator
        column="discriminator_column"                      <SPAN class=co>(1)</SPAN>
        type="discriminator_type"                          <SPAN class=co>(2)</SPAN>
        force="true|false"                                 <SPAN class=co>(3)</SPAN>
        insert="true|false"                                <SPAN class=co>(4)</SPAN>
        formula="arbitrary sql expression"                 <SPAN class=co>(5)</SPAN>
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>class</TT>) 
      &#37492;&#21035;&#22120;&#23383;&#27573;&#30340;&#21517;&#23383; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>string</TT>) 
      &#19968;&#20010;Hibernate&#23383;&#27573;&#31867;&#22411;&#30340;&#21517;&#23383; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>force(&#24378;&#21046;)</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>false</TT>) "&#24378;&#21046;"Hibernate&#25351;&#23450;&#20801;&#35768;&#30340;&#37492;&#21035;&#22120;&#20540;,&#21363;&#20351;&#24403;&#21462;&#24471;&#30340;&#25152;&#26377;&#23454;&#20363;&#37117;&#26159;&#26681;&#31867;&#30340;&#12290; 
  </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>insert</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT class=literal>true</TT>) 
      &#22914;&#26524;&#20320;&#30340;&#37492;&#21035;&#22120;&#23383;&#27573;&#20063;&#26159;&#26144;&#23556;&#20026;&#22797;&#21512;&#26631;&#35782;&#65288;composite identifier&#65289;&#30340;&#19968;&#37096;&#20998;&#65292;&#21017;&#38656;&#23558; &#36825;&#20010;&#20540;&#35774;&#20026;<TT 
      class=literal>false</TT>&#12290;&#65288;&#21578;&#35785;Hibernate&#22312;&#20570;SQL <TT class=literal>INSERT</TT> 
      &#26102;&#19981;&#21253;&#21547;&#35813;&#21015;&#65289; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;) 
      &#19968;&#20010;SQL&#34920;&#36798;&#24335;&#65292;&#22312;&#31867;&#22411;&#21028;&#26029;&#65288;&#21028;&#26029;&#26159;&#29238;&#31867;&#36824;&#26159;&#20855;&#20307;&#23376;&#31867;&#65293;&#35793;&#27880;&#65289;&#26102;&#25191;&#34892;&#12290;&#21487;&#29992;&#20110;&#22522;&#20110;&#20869;&#23481;&#30340;&#37492;&#21035;&#22120;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#37492;&#21035;&#22120;&#23383;&#27573;&#30340;&#23454;&#38469;&#20540;&#26159;&#26681;&#25454;<TT class=literal>&lt;class&gt;</TT>&#21644;<TT 
class=literal>&lt;subclass&gt;</TT>&#20803;&#32032;&#20013; &#30340;<TT 
class=literal>discriminator-value</TT>&#23646;&#24615;&#24471;&#26469;&#30340;&#12290; </P>
<P><TT class=literal>force</TT>&#23646;&#24615;&#20165;&#20165;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#26377;&#29992;&#30340;&#65306;&#34920;&#20013;&#21253;&#21547;&#27809;&#26377;&#34987;&#26144;&#23556;&#21040;&#25345;&#20037;&#21270;&#31867;&#30340;&#38468;&#21152;&#36776;&#21035;&#22120;&#20540;&#12290; &#36825;&#31181;&#24773;&#20917;&#19981;&#20250;&#32463;&#24120;&#36935;&#21040;&#12290; 
</P>
<P>&#20351;&#29992;<TT class=literal>formula</TT>&#23646;&#24615;&#20320;&#21487;&#20197;&#23450;&#20041;&#19968;&#20010;SQL&#34920;&#36798;&#24335;&#65292;&#29992;&#26469;&#21028;&#26029;&#19968;&#20010;&#34892;&#25968;&#25454;&#30340;&#31867;&#22411;&#12290; </P><PRE class=programlisting>&lt;discriminator
    formula="case when CLASS_TYPE in ('a', 'b', 'c') then 0 else 1 end"
    type="integer"/&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-version></A>5.1.7.&nbsp;&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>&lt;version&gt;</TT>&#20803;&#32032;&#26159;&#21487;&#36873;&#30340;&#65292;&#34920;&#26126;&#34920;&#20013;&#21253;&#21547;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#25968;&#25454;&#12290; &#36825;&#22312;&#20320;&#20934;&#22791;&#20351;&#29992;<SPAN 
class=emphasis><EM> &#38271;&#20107;&#21153;&#65288;long transactions&#65289;</EM></SPAN>&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#12290;&#65288;&#35265;&#21518;&#65289; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;version
        column="version_column"                                      <SPAN class=co>(1)</SPAN>
        name="propertyName"                                          <SPAN class=co>(2)</SPAN>
        type="typename"                                              <SPAN class=co>(3)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(4)</SPAN>
        unsaved-value="null|negative|undefined"                      <SPAN class=co>(5)</SPAN>
        generated="never|always"                                     <SPAN class=co>(6)</SPAN>
        insert="true|false"                                          <SPAN class=co>(7)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#25351;&#23450;&#25345;&#26377;&#29256;&#26412;&#21495;&#30340;&#23383;&#27573;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#25345;&#20037;&#21270;&#31867;&#30340;&#23646;&#24615;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>integer</TT>): 
      &#29256;&#26412;&#21495;&#30340;&#31867;&#22411;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#20110;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unsaved-value</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159;<TT 
      class=literal>undefined</TT>): &#29992;&#20110;&#26631;&#26126;&#26576;&#20010;&#23454;&#20363;&#26102;&#21018;&#21018;&#34987;&#23454;&#20363;&#21270;&#30340;&#65288;&#23578;&#26410;&#20445;&#23384;&#65289;&#29256;&#26412;&#23646;&#24615;&#20540;&#65292;&#20381;&#38752;&#36825;&#20010;&#20540;&#23601;&#21487;&#20197;&#25226;&#36825;&#31181;&#24773;&#20917; 
      &#21644;&#24050;&#32463;&#22312;&#20808;&#21069;&#30340;session&#20013;&#20445;&#23384;&#25110;&#35013;&#36733;&#30340;&#33073;&#31649;&#65288;detached&#65289;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290; &#65288;<TT 
      class=literal>undefined</TT>&#25351;&#26126;&#24212;&#34987;&#20351;&#29992;&#30340;&#26631;&#35782;&#23646;&#24615;&#20540;&#12290;&#65289; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>generated</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>never</TT>): &#34920;&#26126;&#27492;&#29256;&#26412;&#23646;&#24615;&#20540;&#26159;&#21542;&#23454;&#38469;&#19978;&#26159;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;&#12290;&#35831;&#21442;&#38405;<A 
      title="5.6.&nbsp;&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated Properties&#65289;" 
      href="#mapping-generated">&#31532;&nbsp;5.6&nbsp;&#33410; “&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated 
      Properties&#65289;”</A>&#37096;&#20998;&#30340;&#35752;&#35770;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>insert</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>true</TT>): 
      &#34920;&#26126;&#27492;&#29256;&#26412;&#21015;&#24212;&#35813;&#21253;&#21547;&#22312;SQL&#25554;&#20837;&#35821;&#21477;&#20013;&#12290;&#21482;&#26377;&#24403;&#25968;&#25454;&#24211;&#23383;&#27573;&#26377;&#40664;&#35748;&#20540;<TT class=literal>0</TT>&#30340;&#26102;&#20505;&#65292;&#25165;&#21487;&#20197;&#35774;&#32622;&#20026;<TT 
      class=literal>false</TT>&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#29256;&#26412;&#21495;&#24517;&#39035;&#26159;&#20197;&#19979;&#31867;&#22411;&#65306;<TT class=literal>long</TT>, <TT class=literal>integer</TT>, <TT 
class=literal>short</TT>, <TT class=literal>timestamp</TT>&#25110;&#32773;<TT 
class=literal>calendar</TT>&#12290; </P>
<P>&#19968;&#20010;&#33073;&#31649;&#65288;detached&#65289;&#23454;&#20363;&#30340;version&#25110;timestamp&#23646;&#24615;&#19981;&#33021;&#20026;&#31354;&#65288;null&#65289;&#65292;&#22240;&#20026;Hibernate&#19981;&#31649; <TT 
class=literal>unsaved-value</TT>&#34987;&#25351;&#23450;&#20026;&#20309;&#31181;&#31574;&#30053;&#65292;&#23427;&#23558;&#20219;&#20309;&#23646;&#24615;&#20026;&#31354;&#30340;version&#25110;timestamp 
&#23454;&#20363;&#30475;&#20316;&#20026;&#30636;&#26102;&#65288;transient&#65289;&#23454;&#20363;&#12290; <SPAN class=emphasis><EM>&#36991;&#20813;Hibernate&#20013;&#30340;&#20256;&#36882;&#37325;&#38468;&#65288;transitive 
reattachment&#65289;&#38382;&#39064;&#30340;&#19968;&#20010;&#31616;&#21333;&#26041;&#27861;&#26159; &#23450;&#20041;&#19968;&#20010;&#19981;&#33021;&#20026;&#31354;&#30340;version&#25110;timestamp&#23646;&#24615;&#65292;&#29305;&#21035;&#26159;&#22312;&#20154;&#20204;&#20351;&#29992;&#31243;&#24207;&#20998;&#37197;&#30340;&#26631;&#35782;&#31526;&#65288;assigned 
identifiers&#65289; &#25110;&#22797;&#21512;&#20027;&#38190;&#26102;&#38750;&#24120;&#26377;&#29992;&#65281;</EM></SPAN> </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=mapping-declaration-timestamp></A>5.1.8.&nbsp;timestamp 
(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#36873;&#30340;<TT class=literal>&lt;timestamp&gt;</TT>&#20803;&#32032;&#25351;&#26126;&#20102;&#34920;&#20013;&#21253;&#21547;&#26102;&#38388;&#25139;&#25968;&#25454;&#12290; 
&#36825;&#29992;&#26469;&#20316;&#20026;&#29256;&#26412;&#30340;&#26367;&#20195;&#12290;&#26102;&#38388;&#25139;&#26412;&#36136;&#19978;&#26159;&#19968;&#31181;&#23545;&#20048;&#35266;&#38145;&#23450;&#30340;&#19968;&#31181;&#19981;&#26159;&#29305;&#21035;&#23433;&#20840;&#30340;&#23454;&#29616;&#12290;&#24403;&#28982;&#65292; &#26377;&#26102;&#20505;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#22312;&#20854;&#20182;&#26041;&#38754;&#20351;&#29992;&#26102;&#38388;&#25139;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;timestamp
        column="timestamp_column"                                    <SPAN class=co>(1)</SPAN>
        name="propertyName"                                          <SPAN class=co>(2)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(3)</SPAN>
        unsaved-value="null|undefined"                               <SPAN class=co>(4)</SPAN>
        source="vm|db"                                               <SPAN class=co>(5)</SPAN>
        generated="never|always"                                     <SPAN class=co>(6)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#25345;&#26377;&#26102;&#38388;&#25139;&#30340;&#23383;&#27573;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#22312;&#25345;&#20037;&#21270;&#31867;&#20013;&#30340;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#21517;&#65292; &#20854;Java&#31867;&#22411;&#26159; <TT 
      class=literal>Date</TT> &#25110;&#32773; <TT class=literal>Timestamp</TT>&#30340;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#20110;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unsaved-value</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159;<TT 
      class=literal>null</TT>): &#29992;&#20110;&#26631;&#26126;&#26576;&#20010;&#23454;&#20363;&#26102;&#21018;&#21018;&#34987;&#23454;&#20363;&#21270;&#30340;&#65288;&#23578;&#26410;&#20445;&#23384;&#65289;&#29256;&#26412;&#23646;&#24615;&#20540;&#65292;&#20381;&#38752;&#36825;&#20010;&#20540;&#23601;&#21487;&#20197;&#25226;&#36825;&#31181;&#24773;&#20917;&#21644; 
      &#24050;&#32463;&#22312;&#20808;&#21069;&#30340;session&#20013;&#20445;&#23384;&#25110;&#35013;&#36733;&#30340;&#33073;&#31649;&#65288;detached&#65289;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290;&#65288;<TT class=literal>undefined</TT> 
      &#25351;&#26126;&#20351;&#29992;&#26631;&#35782;&#23646;&#24615;&#20540;&#36827;&#34892;&#36825;&#31181;&#21028;&#26029;&#12290;&#65289; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>source</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>vm</TT>): 
      Hibernate&#22914;&#20309;&#25165;&#33021;&#33719;&#21462;&#21040;&#26102;&#38388;&#25139;&#30340;&#20540;&#21602;&#65311;&#20174;&#25968;&#25454;&#24211;&#65292;&#36824;&#26159;&#24403;&#21069;JVM&#65311;&#20174;&#25968;&#25454;&#24211;&#33719;&#21462;&#20250;&#24102;&#26469;&#19968;&#20123;&#36127;&#25285;&#65292;&#22240;&#20026;Hibernate&#24517;&#39035;&#35775;&#38382;&#25968;&#25454;&#24211;&#26469;&#33719;&#24471;“&#19979;&#19968;&#20010;&#20540;”&#65292;&#20294;&#26159;&#22312;&#38598;&#32676;&#29615;&#22659;&#20013;&#20250;&#26356;&#23433;&#20840;&#20123;&#12290;&#36824;&#35201;&#27880;&#24847;&#65292;&#24182;&#19981;&#26159;&#25152;&#26377;&#30340;<TT 
      class=literal>Dialect&#65288;&#26041;&#35328;&#65289;</TT>&#37117;&#25903;&#25345;&#33719;&#24471;&#25968;&#25454;&#24211;&#30340;&#24403;&#21069;&#26102;&#38388;&#25139;&#30340;&#65292;&#32780;&#25903;&#25345;&#30340;&#25968;&#25454;&#24211;&#20013;&#21448;&#26377;&#19968;&#37096;&#20998;&#22240;&#20026;&#31934;&#24230;&#19981;&#36275;,&#29992;&#20110;&#38145;&#23450;&#26159;&#19981;&#23433;&#20840;&#30340;&#65288;&#20363;&#22914;Oracle 
      8&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>generated</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>never</TT>): &#25351;&#20986;&#26102;&#38388;&#25139;&#20540;&#26159;&#21542;&#23454;&#38469;&#19978;&#26159;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;.&#35831;&#21442;&#38405;<A 
      title="5.6.&nbsp;&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated Properties&#65289;" 
      href="#mapping-generated">&#31532;&nbsp;5.6&nbsp;&#33410; “&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated 
      Properties&#65289;”</A>&#30340;&#35752;&#35770;&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#27880;&#24847;&#65292;<TT class=literal>&lt;timestamp&gt;</TT> &#21644;<TT class=literal>&lt;version 
type="timestamp"&gt;</TT>&#26159;&#31561;&#20215;&#30340;&#12290;&#24182;&#19988;<TT class=literal>&lt;timestamp 
source="db"&gt;</TT>&#21644;<TT class=literal>&lt;version 
type="dbtimestamp"&gt;</TT>&#26159;&#31561;&#20215;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-property></A>5.1.9.&nbsp;property</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>&lt;property&gt;</TT>&#20803;&#32032;&#20026;&#31867;&#23450;&#20041;&#20102;&#19968;&#20010;&#25345;&#20037;&#21270;&#30340;,JavaBean&#39118;&#26684;&#30340;&#23646;&#24615;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;property
        name="propertyName"                                          <SPAN class=co>(1)</SPAN>
        column="column_name"                                         <SPAN class=co>(2)</SPAN>
        type="typename"                                              <SPAN class=co>(3)</SPAN>
        update="true|false"                                          <SPAN class=co>(4)</SPAN>
        insert="true|false"                                          <SPAN class=co>(4)</SPAN>
        formula="arbitrary SQL expression"                           <SPAN class=co>(5)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(6)</SPAN>
        lazy="true|false"                                            <SPAN class=co>(7)</SPAN>
        unique="true|false"                                          <SPAN class=co>(8)</SPAN>
        not-null="true|false"                                        <SPAN class=co>(9)</SPAN>
        optimistic-lock="true|false"                                 <SPAN class=co>(10)</SPAN>
        generated="never|insert|always"                              <SPAN class=co>(11)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."

        index="index_name"
        unique_key="unique_key_id"
        length="L"
        precision="P"
        scale="S"
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23646;&#24615;&#30340;&#21517;&#23383;,&#20197;&#23567;&#20889;&#23383;&#27597;&#24320;&#22836;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;&#23383;): &#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#23383;&#27573;&#21517;&#12290; &#20063;&#21487;&#20197;&#36890;&#36807;&#23884;&#22871;&#30340;<TT 
      class=literal>&lt;column&gt;</TT>&#20803;&#32032;&#25351;&#23450;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#21487;&#36873;): &#19968;&#20010;Hibernate&#31867;&#22411;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>update, insert</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>) : &#34920;&#26126;&#29992;&#20110;<TT class=literal>UPDATE</TT> &#21644;/&#25110; <TT 
      class=literal>INSERT</TT> &#30340;SQL&#35821;&#21477;&#20013;&#26159;&#21542;&#21253;&#21547;&#36825;&#20010;&#34987;&#26144;&#23556;&#20102;&#30340;&#23383;&#27573;&#12290;&#36825;&#20108;&#32773;&#22914;&#26524;&#37117;&#35774;&#32622;&#20026;<TT 
      class=literal>false</TT> &#21017;&#34920;&#26126;&#36825;&#26159;&#19968;&#20010;“&#22806;&#28304;&#24615;&#65288;derived&#65289;”&#30340;&#23646;&#24615;&#65292;&#23427;&#30340;&#20540;&#26469;&#28304;&#20110;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#65288;&#25110;&#22810;&#20010;&#65289; 
      &#23383;&#27573;&#30340;&#26576;&#20123;&#20854;&#20182;&#23646;&#24615;&#65292;&#25110;&#32773;&#36890;&#36807;&#19968;&#20010;trigger(&#35302;&#21457;&#22120;&#65289;&#25110;&#20854;&#20182;&#31243;&#24207;&#29983;&#25104;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): &#19968;&#20010;SQL&#34920;&#36798;&#24335;&#65292;&#23450;&#20041;&#20102;&#36825;&#20010;<SPAN 
      class=emphasis><EM>&#35745;&#31639; &#65288;computed&#65289;</EM></SPAN> &#23646;&#24615;&#30340;&#20540;&#12290;&#35745;&#31639;&#23646;&#24615;&#27809;&#26377;&#21644;&#23427;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#23383;&#27573;&#12290; 
  </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#20540;&#20026; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>false</TT>): &#25351;&#23450; 
      &#25351;&#23450;&#23454;&#20363;&#21464;&#37327;&#31532;&#19968;&#27425;&#34987;&#35775;&#38382;&#26102;&#65292;&#36825;&#20010;&#23646;&#24615;&#26159;&#21542;&#24310;&#36831;&#25235;&#21462;&#65288;fetched lazily&#65289;&#65288; &#38656;&#35201;&#36816;&#34892;&#26102;&#23383;&#33410;&#30721;&#22686;&#24378;&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unique</TT> (&#21487;&#36873;): &#20351;&#29992;DDL&#20026;&#35813;&#23383;&#27573;&#28155;&#21152;&#21807;&#19968;&#30340;&#32422;&#26463;&#12290; &#21516;&#26679;&#65292;&#20801;&#35768;&#23427;&#20316;&#20026;<TT 
      class=literal>property-ref</TT>&#24341;&#29992;&#30340;&#30446;&#26631;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(9)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-null</TT> (&#21487;&#36873;): &#20351;&#29992;DDL&#20026;&#35813;&#23383;&#27573;&#28155;&#21152;&#21487;&#21542;&#20026;&#31354;&#65288;nullability&#65289;&#30340;&#32422;&#26463;&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(10)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>): &#25351;&#23450;&#36825;&#20010;&#23646;&#24615;&#22312;&#20570;&#26356;&#26032;&#26102;&#26159;&#21542;&#38656;&#35201;&#33719;&#24471;&#20048;&#35266;&#38145;&#23450;&#65288;optimistic lock&#65289;&#12290; 
      &#25442;&#21477;&#35805;&#35828;&#65292;&#23427;&#20915;&#23450;&#36825;&#20010;&#23646;&#24615;&#21457;&#29983;&#33039;&#25968;&#25454;&#26102;&#29256;&#26412;&#65288;version&#65289;&#30340;&#20540;&#26159;&#21542;&#22686;&#38271;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(11)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>generated</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>never</TT>): &#34920;&#26126;&#27492;&#23646;&#24615;&#20540;&#26159;&#21542;&#23454;&#38469;&#19978;&#26159;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;&#12290;&#35831;&#21442;&#38405;<A 
      title="5.6.&nbsp;&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated Properties&#65289;" 
      href="#mapping-generated">&#31532;&nbsp;5.6&nbsp;&#33410; “&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated 
      Properties&#65289;”</A>&#30340;&#35752;&#35770;&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P><SPAN class=emphasis><EM>typename</EM></SPAN>&#21487;&#20197;&#26159;&#22914;&#19979;&#20960;&#31181;&#65306; </P>
<DIV class=orderedlist>
<OL type=1 compact>
  <LI>
  <P>Hibernate&#22522;&#26412;&#31867;&#22411;&#21517;&#65288;&#27604;&#22914;&#65306;<TT class=literal>integer, string, character,date, 
  timestamp, float, binary, serializable, object, blob</TT>&#65289;&#12290; </P>
  <LI>
  <P>&#19968;&#20010;Java&#31867;&#30340;&#21517;&#23383;&#65292;&#36825;&#20010;&#31867;&#23646;&#20110;&#19968;&#31181;&#40664;&#35748;&#22522;&#30784;&#31867;&#22411; (&#27604;&#22914;&#65306; <TT class=literal>int, float,char, 
  java.lang.String, java.util.Date, java.lang.Integer, java.sql.Clob</TT>)&#12290; </P>
  <LI>
  <P>&#19968;&#20010;&#21487;&#20197;&#24207;&#21015;&#21270;&#30340;Java&#31867;&#30340;&#21517;&#23383;&#12290; </P>
  <LI>
  <P>&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290;&#65288;&#27604;&#22914;&#65306; <TT class=literal>com.illflow.type.MyCustomType</TT>)&#12290; 
  </P></LI></OL></DIV>
<P>&#22914;&#26524;&#20320;&#27809;&#26377;&#25351;&#23450;&#31867;&#22411;&#65292;Hibernarte&#20250;&#20351;&#29992;&#21453;&#23556;&#26469;&#24471;&#21040;&#36825;&#20010;&#21517;&#23383;&#30340;&#23646;&#24615;&#65292;&#20197;&#27492;&#26469;&#29468;&#27979;&#27491;&#30830;&#30340;Hibernate&#31867;&#22411;&#12290; 
Hibernate&#20250;&#25353;&#29031;&#35268;&#21017;2,3,4&#30340;&#39034;&#24207;&#23545;&#23646;&#24615;&#35835;&#21462;&#22120;(getter&#26041;&#27861;&#65289;&#30340;&#36820;&#22238;&#31867;&#36827;&#34892;&#35299;&#37322;&#12290;&#28982;&#32780;&#65292;&#36825;&#36824;&#19981;&#22815;&#12290; &#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#20320;&#20173;&#28982;&#38656;&#35201;<TT 
class=literal>type</TT>&#23646;&#24615;&#12290;&#65288;&#27604;&#22914;&#65292;&#20026;&#20102;&#21306;&#21035;<TT class=literal>Hibernate.DATE</TT> &#21644;<TT 
class=literal>Hibernate.TIMESTAMP</TT>,&#25110;&#32773;&#20026;&#20102;&#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#12290;&#65289; </P>
<P><TT class=literal>access</TT>&#23646;&#24615;&#29992;&#26469;&#35753;&#20320;&#25511;&#21046;Hibernate&#22914;&#20309;&#22312;&#36816;&#34892;&#26102;&#35775;&#38382;&#23646;&#24615;&#12290;&#22312;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292; 
Hibernate&#20250;&#20351;&#29992;&#23646;&#24615;&#30340;get/set&#26041;&#27861;&#23545;&#65288;pair&#65289;&#12290;&#22914;&#26524;&#20320;&#25351;&#26126;<TT class=literal>access="field"</TT>, 
Hibernate&#20250;&#24573;&#30053;get/set&#26041;&#27861;&#23545;&#65292;&#30452;&#25509;&#20351;&#29992;&#21453;&#23556;&#26469;&#35775;&#38382;&#25104;&#21592;&#21464;&#37327;&#12290;&#20320;&#20063;&#21487;&#20197;&#25351;&#23450;&#20320;&#33258;&#24049;&#30340;&#31574;&#30053;&#65292; &#36825;&#23601;&#38656;&#35201;&#20320;&#33258;&#24049;&#23454;&#29616;<TT 
class=literal>org.hibernate.property.PropertyAccessor</TT>&#25509;&#21475;&#65292; 
&#20877;&#22312;access&#20013;&#35774;&#32622;&#20320;&#33258;&#23450;&#20041;&#31574;&#30053;&#31867;&#30340;&#21517;&#23383;&#12290; </P>
<P>&#34893;&#29983;&#23646;&#24615;&#65288;derive propertie&#65289;&#26159;&#19968;&#20010;&#29305;&#21035;&#24378;&#22823;&#30340;&#29305;&#24449;&#12290;&#36825;&#20123;&#23646;&#24615;&#24212;&#35813;&#23450;&#20041;&#20026;&#21482;&#35835;&#65292;&#23646;&#24615;&#20540;&#22312;&#35013;&#36733;&#26102;&#35745;&#31639;&#29983;&#25104;&#12290; 
&#20320;&#29992;&#19968;&#20010;SQL&#34920;&#36798;&#24335;&#29983;&#25104;&#35745;&#31639;&#30340;&#32467;&#26524;&#65292;&#23427;&#20250;&#22312;&#36825;&#20010;&#23454;&#20363;&#36716;&#36733;&#26102;&#32763;&#35793;&#25104;&#19968;&#20010;SQL&#26597;&#35810;&#30340;<TT class=literal>SELECT</TT> &#23376;&#26597;&#35810;&#35821;&#21477;&#12290; </P><PRE class=programlisting>&lt;property name="totalPrice"
    formula="( SELECT SUM (li.quantity*p.price) FROM LineItem li, Product p
                WHERE li.productId = p.productId
                AND li.customerId = customerId
                AND li.orderNumber = orderNumber )"/&gt;</PRE>
<P>&#27880;&#24847;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#23454;&#20307;&#33258;&#24049;&#30340;&#34920;&#65292;&#32780;&#19981;&#29992;&#20026;&#36825;&#20010;&#29305;&#21035;&#30340;&#21015;&#23450;&#20041;&#21035;&#21517;&#65288; &#19978;&#38754;&#20363;&#23376;&#20013;&#30340;<TT 
class=literal>customerId</TT>&#65289;&#12290;&#21516;&#26102;&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#19981;&#21916;&#27426;&#20351;&#29992;&#23646;&#24615;&#65292; &#20320;&#21487;&#20197;&#20351;&#29992;&#23884;&#22871;&#30340;<TT 
class=literal>&lt;formula&gt;</TT>&#26144;&#23556;&#20803;&#32032;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-manytoone></A>5.1.10.&nbsp;&#22810;&#23545;&#19968;&#65288;many-to-one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36890;&#36807;<TT class=literal>many-to-one</TT>&#20803;&#32032;,&#21487;&#20197;&#23450;&#20041;&#19968;&#31181;&#24120;&#35265;&#30340;&#19982;&#21478;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#20851;&#32852;&#12290; 
&#36825;&#31181;&#20851;&#31995;&#27169;&#22411;&#26159;&#22810;&#23545;&#19968;&#20851;&#32852;&#65288;&#23454;&#38469;&#19978;&#26159;&#19968;&#20010;&#23545;&#35937;&#24341;&#29992;&#65293;&#35793;&#27880;&#65289;&#65306;&#36825;&#20010;&#34920;&#30340;&#19968;&#20010;&#22806;&#38190;&#24341;&#29992;&#30446;&#26631;&#34920;&#30340; &#20027;&#38190;&#23383;&#27573;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;many-to-one
        name="propertyName"                                          <SPAN class=co>(1)</SPAN>
        column="column_name"                                         <SPAN class=co>(2)</SPAN>
        class="ClassName"                                            <SPAN class=co>(3)</SPAN>
        cascade="cascade_style"                                      <SPAN class=co>(4)</SPAN>
        fetch="join|select"                                          <SPAN class=co>(5)</SPAN>
        update="true|false"                                          <SPAN class=co>(6)</SPAN>
        insert="true|false"                                          <SPAN class=co>(6)</SPAN>
        property-ref="propertyNameFromAssociatedClass"               <SPAN class=co>(7)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(8)</SPAN>
        unique="true|false"                                          <SPAN class=co>(9)</SPAN>
        not-null="true|false"                                        <SPAN class=co>(10)</SPAN>
        optimistic-lock="true|false"                                 <SPAN class=co>(11)</SPAN>
        lazy="proxy|no-proxy|false"                                  <SPAN class=co>(12)</SPAN>
        not-found="ignore|exception"                                 <SPAN class=co>(13)</SPAN>
        entity-name="EntityName"                                     <SPAN class=co>(14)</SPAN>
        formula="arbitrary SQL expression"                           <SPAN class=co>(15)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."

        embed-xml="true|false"
        index="index_name"
        unique_key="unique_key_id"
        foreign-key="foreign_key_name"
        
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23646;&#24615;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873;): &#22806;&#38388;&#23383;&#27573;&#21517;&#12290;&#23427;&#20063;&#21487;&#20197;&#36890;&#36807;&#23884;&#22871;&#30340; <TT 
      class=literal>&lt;column&gt;</TT>&#20803;&#32032;&#25351;&#23450;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#23646;&#24615;&#31867;&#22411;): &#20851;&#32852;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>cascade&#65288;&#32423;&#32852;&#65289;</TT> (&#21487;&#36873;): &#25351;&#26126;&#21738;&#20123;&#25805;&#20316;&#20250;&#20174;&#29238;&#23545;&#35937;&#32423;&#32852;&#21040;&#20851;&#32852;&#30340;&#23545;&#35937;&#12290; 
</P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>fetch</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>select</TT>): 
      &#22312;&#22806;&#36830;&#25509;&#25235;&#21462;&#65288;outer-join fetching&#65289;&#21644;&#24207;&#21015;&#36873;&#25321;&#25235;&#21462;&#65288;sequential select fetching&#65289;&#20004;&#32773;&#20013;&#36873;&#25321;&#20854;&#19968;&#12290; 
    </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>update, insert</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>) &#25351;&#23450;&#23545;&#24212;&#30340;&#23383;&#27573;&#26159;&#21542;&#21253;&#21547;&#22312;&#29992;&#20110;<TT class=literal>UPDATE</TT> &#21644;/&#25110; 
      <TT class=literal>INSERT</TT> &#30340;SQL&#35821;&#21477;&#20013;&#12290;&#22914;&#26524;&#20108;&#32773;&#37117;&#26159;<TT 
      class=literal>false</TT>,&#21017;&#36825;&#26159;&#19968;&#20010;&#32431;&#31929;&#30340; 
      “&#22806;&#28304;&#24615;&#65288;derived&#65289;”&#20851;&#32852;&#65292;&#23427;&#30340;&#20540;&#26159;&#36890;&#36807;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#65288;&#25110;&#22810;&#20010;&#65289;&#23383;&#27573;&#30340;&#26576;&#20123;&#20854;&#20182;&#23646;&#24615;&#24471;&#21040; &#25110;&#32773;&#36890;&#36807;trigger(&#35302;&#21457;&#22120;&#65289;&#12289;&#25110;&#20854;&#20182;&#31243;&#24207;&#29983;&#25104;&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>property-ref</TT>: (&#21487;&#36873;) &#25351;&#23450;&#20851;&#32852;&#31867;&#30340;&#19968;&#20010;&#23646;&#24615;&#65292;&#36825;&#20010;&#23646;&#24615;&#23558;&#20250;&#21644;&#26412;&#22806;&#38190;&#30456;&#23545;&#24212;&#12290; 
      &#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#20250;&#20351;&#29992;&#23545;&#26041;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unique</TT> (&#21487;&#36873;): &#20351;&#29992;DDL&#20026;&#22806;&#38190;&#23383;&#27573;&#29983;&#25104;&#19968;&#20010;&#21807;&#19968;&#32422;&#26463;&#12290;&#27492;&#22806;&#65292; &#36825;&#20063;&#21487;&#20197;&#29992;&#20316;<TT 
      class=literal>property-ref</TT>&#30340;&#30446;&#26631;&#23646;&#24615;&#12290;&#36825;&#20351;&#20851;&#32852;&#21516;&#26102;&#20855;&#26377; &#19968;&#23545;&#19968;&#30340;&#25928;&#26524;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(9)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-null</TT> (&#21487;&#36873;): &#20351;&#29992;DDL&#20026;&#22806;&#38190;&#23383;&#27573;&#29983;&#25104;&#19968;&#20010;&#38750;&#31354;&#32422;&#26463;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(10)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>true</TT>): &#25351;&#23450;&#36825;&#20010;&#23646;&#24615;&#22312;&#20570;&#26356;&#26032;&#26102;&#26159;&#21542;&#38656;&#35201;&#33719;&#24471;&#20048;&#35266;&#38145;&#23450;&#65288;optimistic lock&#65289;&#12290; 
      &#25442;&#21477;&#35805;&#35828;&#65292;&#23427;&#20915;&#23450;&#36825;&#20010;&#23646;&#24615;&#21457;&#29983;&#33039;&#25968;&#25454;&#26102;&#29256;&#26412;&#65288;version&#65289;&#30340;&#20540;&#26159;&#21542;&#22686;&#38271;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(11)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>proxy</TT>): 
      &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#21333;&#28857;&#20851;&#32852;&#26159;&#32463;&#36807;&#20195;&#29702;&#30340;&#12290;<TT 
      class=literal>lazy="no-proxy"</TT>&#25351;&#23450;&#27492;&#23646;&#24615;&#24212;&#35813;&#22312;&#23454;&#20363;&#21464;&#37327;&#31532;&#19968;&#27425;&#34987;&#35775;&#38382;&#26102;&#24212;&#35813;&#24310;&#36831;&#25235;&#21462;&#65288;fetche 
      lazily&#65289;&#65288;&#38656;&#35201;&#36816;&#34892;&#26102;&#23383;&#33410;&#30721;&#30340;&#22686;&#24378;&#65289;&#12290; <TT class=literal>lazy="false"</TT>&#25351;&#23450;&#27492;&#20851;&#32852;&#24635;&#26159;&#34987;&#39044;&#20808;&#25235;&#21462;&#12290; 
    </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(12)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-found</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>exception</TT>): &#25351;&#23450;&#22806;&#38190;&#24341;&#29992;&#30340;&#25968;&#25454;&#19981;&#23384;&#22312;&#26102;&#22914;&#20309;&#22788;&#29702;&#65306; <TT 
      class=literal>ignore</TT>&#20250;&#23558;&#34892;&#25968;&#25454;&#19981;&#23384;&#22312;&#35270;&#20026;&#19968;&#20010;&#31354;&#65288;null&#65289;&#20851;&#32852;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(13)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>entity-name</TT> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(14)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): SQL&#34920;&#36798;&#24335;&#65292;&#29992;&#20110;&#23450;&#20041;<SPAN 
      class=emphasis><EM>computed&#65288;&#35745;&#31639;&#20986;&#30340;&#65289;</EM></SPAN>&#22806;&#38190;&#20540;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P><TT class=literal>cascade</TT>&#23646;&#24615;&#35774;&#32622;&#20026;&#38500;&#20102;<TT class=literal>none</TT>&#20197;&#22806;&#20219;&#20309;&#26377;&#24847;&#20041;&#30340;&#20540;&#65292; 
&#23427;&#23558;&#25226;&#29305;&#23450;&#30340;&#25805;&#20316;&#20256;&#36882;&#21040;&#20851;&#32852;&#23545;&#35937;&#20013;&#12290;&#36825;&#20010;&#20540;&#23601;&#20195;&#34920;&#30528;Hibernate&#22522;&#26412;&#25805;&#20316;&#30340;&#21517;&#31216;&#65292; <TT class=literal>persist, merge, 
delete, save-update, evict, replicate, lock, refresh</TT>&#65292; &#20197;&#21450;&#29305;&#21035;&#30340;&#20540;<TT 
class=literal>delete-orphan</TT>&#21644;<TT class=literal>all</TT>&#65292;&#24182;&#19988;&#21487;&#20197;&#29992;&#36887;&#21495;&#20998;&#38548;&#31526; 
&#26469;&#32452;&#21512;&#36825;&#20123;&#25805;&#20316;&#65292;&#20363;&#22914;&#65292;<TT class=literal>cascade="persist,merge,evict"</TT>&#25110; <TT 
class=literal>cascade="all,delete-orphan"</TT>&#12290;&#26356;&#20840;&#38754;&#30340;&#35299;&#37322;&#35831;&#21442;&#32771;<A 
title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)" 
href="#objectstate-transitive">&#31532;&nbsp;10.11&nbsp;&#33410; “&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
persistence)”</A>. &#27880;&#24847;&#65292;&#21333;&#20540;&#20851;&#32852; (many-to-one &#21644; one-to-one &#20851;&#32852;) &#19981;&#25903;&#25345;&#21024;&#38500;&#23396;&#20799;&#65288;orphan 
delete&#65292;&#21024;&#38500;&#19981;&#20877;&#34987;&#24341;&#29992;&#30340;&#20540;&#65289;. </P>
<P>&#19968;&#20010;&#20856;&#22411;&#30340;&#31616;&#21333;<TT class=literal>many-to-one</TT>&#23450;&#20041;&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;many-to-one name="product" class="Product" column="PRODUCT_ID"/&gt;</PRE>
<P><TT class=literal>property-ref</TT>&#23646;&#24615;&#21482;&#24212;&#35813;&#29992;&#26469;&#23545;&#20184;&#36951;&#30041;&#19979;&#26469;&#30340;&#25968;&#25454;&#24211;&#31995;&#32479;&#65292; 
&#21487;&#33021;&#26377;&#22806;&#38190;&#25351;&#21521;&#23545;&#26041;&#20851;&#32852;&#34920;&#30340;&#26159;&#20010;&#38750;&#20027;&#38190;&#23383;&#27573;&#65288;&#20294;&#26159;&#24212;&#35813;&#26159;&#19968;&#20010;&#24799;&#19968;&#20851;&#38190;&#23383;&#65289;&#30340;&#24773;&#20917;&#19979;&#12290; &#36825;&#26159;&#19968;&#31181;&#21313;&#20998;&#19985;&#38475;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;&#27604;&#22914;&#35828;&#65292;&#20551;&#35774;<TT 
class=literal>Product</TT>&#31867;&#26377;&#19968;&#20010;&#24799;&#19968;&#30340;&#24207;&#21015;&#21495;&#65292; &#23427;&#24182;&#19981;&#26159;&#20027;&#38190;&#12290;&#65288;<TT 
class=literal>unique</TT>&#23646;&#24615;&#25511;&#21046;Hibernate&#36890;&#36807;SchemaExport&#24037;&#20855;&#36827;&#34892;&#30340;DDL&#29983;&#25104;&#12290;&#65289; </P><PRE class=programlisting>&lt;property name="serialNumber" unique="true" type="string" column="SERIAL_NUMBER"/&gt;</PRE>
<P>&#37027;&#20040;&#20851;&#20110;<TT class=literal>OrderItem</TT> &#30340;&#26144;&#23556;&#21487;&#33021;&#26159;&#65306; </P><PRE class=programlisting>&lt;many-to-one name="product" property-ref="serialNumber" column="PRODUCT_SERIAL_NUMBER"/&gt;</PRE>
<P>&#24403;&#28982;&#65292;&#25105;&#20204;&#20915;&#19981;&#40723;&#21169;&#36825;&#31181;&#29992;&#27861;&#12290; </P>
<P>&#22914;&#26524;&#34987;&#24341;&#29992;&#30340;&#21807;&#19968;&#20027;&#38190;&#30001;&#20851;&#32852;&#23454;&#20307;&#30340;&#22810;&#20010;&#23646;&#24615;&#32452;&#25104;&#65292;&#20320;&#24212;&#35813;&#22312;&#21517;&#31216;&#20026;<TT class=literal>&lt;properties&gt;</TT>&#30340;&#20803;&#32032; 
&#37324;&#38754;&#26144;&#23556;&#25152;&#26377;&#20851;&#32852;&#30340;&#23646;&#24615;&#12290; </P>
<P>&#20551;&#33509;&#34987;&#24341;&#29992;&#30340;&#21807;&#19968;&#20027;&#38190;&#26159;&#32452;&#20214;&#30340;&#23646;&#24615;&#65292;&#20320;&#21487;&#20197;&#25351;&#23450;&#23646;&#24615;&#36335;&#24452;&#65306; </P><PRE class=programlisting>&lt;many-to-one name="owner" property-ref="identity.ssn" column="OWNER_SSN"/&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-onetoone></A>5.1.11.&nbsp;&#19968;&#23545;&#19968;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25345;&#20037;&#21270;&#23545;&#35937;&#20043;&#38388;&#19968;&#23545;&#19968;&#30340;&#20851;&#32852;&#20851;&#31995;&#26159;&#36890;&#36807;<TT class=literal>one-to-one</TT>&#20803;&#32032;&#23450;&#20041;&#30340;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;one-to-one
        name="propertyName"                                          <SPAN class=co>(1)</SPAN>
        class="ClassName"                                            <SPAN class=co>(2)</SPAN>
        cascade="cascade_style"                                      <SPAN class=co>(3)</SPAN>
        constrained="true|false"                                     <SPAN class=co>(4)</SPAN>
        fetch="join|select"                                          <SPAN class=co>(5)</SPAN>
        property-ref="propertyNameFromAssociatedClass"               <SPAN class=co>(6)</SPAN>
        access="field|property|ClassName"                            <SPAN class=co>(7)</SPAN>
        formula="any SQL expression"                                 <SPAN class=co>(8)</SPAN>
        lazy="proxy|no-proxy|false"                                  <SPAN class=co>(9)</SPAN>
        entity-name="EntityName"                                     <SPAN class=co>(10)</SPAN>
        node="element-name|@attribute-name|element/@attribute|."

        embed-xml="true|false"
        foreign-key="foreign_key_name"
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23646;&#24615;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#30340;&#23646;&#24615;&#31867;&#22411;)&#65306;&#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>cascade(&#32423;&#32852;)</TT> (&#21487;&#36873;) &#34920;&#26126;&#25805;&#20316;&#26159;&#21542;&#20174;&#29238;&#23545;&#35937;&#32423;&#32852;&#21040;&#34987;&#20851;&#32852;&#30340;&#23545;&#35937;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>constrained(&#32422;&#26463;)</TT> (&#21487;&#36873;) 
      &#34920;&#26126;&#35813;&#31867;&#23545;&#24212;&#30340;&#34920;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#65292;&#21644;&#34987;&#20851;&#32852;&#30340;&#23545;&#35937;&#25152;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#20043;&#38388;&#65292;&#36890;&#36807;&#19968;&#20010;&#22806;&#38190;&#24341;&#29992;&#23545;&#20027;&#38190;&#36827;&#34892;&#32422;&#26463;&#12290; &#36825;&#20010;&#36873;&#39033;&#24433;&#21709;<TT 
      class=literal>save()</TT>&#21644;<TT class=literal>delete()</TT>&#22312;&#32423;&#32852;&#25191;&#34892;&#26102;&#30340;&#20808;&#21518;&#39034;&#24207;&#20197;&#21450; 
      &#20915;&#23450;&#35813;&#20851;&#32852;&#33021;&#21542;&#34987;&#22996;&#25176;(&#20063;&#22312;schema export tool&#20013;&#34987;&#20351;&#29992;). </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>fetch</TT> (&#21487;&#36873; - &#40664;&#35748;&#35774;&#32622;&#20026;<TT class=literal>&#36873;&#25321;</TT>): 
      &#22312;&#22806;&#36830;&#25509;&#25235;&#21462;&#25110;&#32773;&#24207;&#21015;&#36873;&#25321;&#25235;&#21462;&#36873;&#25321;&#20854;&#19968;. </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>property-ref</TT>: (&#21487;&#36873;) 
      &#25351;&#23450;&#20851;&#32852;&#31867;&#30340;&#23646;&#24615;&#21517;&#65292;&#36825;&#20010;&#23646;&#24615;&#23558;&#20250;&#21644;&#26412;&#31867;&#30340;&#20027;&#38190;&#30456;&#23545;&#24212;&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#20250;&#20351;&#29992;&#23545;&#26041;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula </TT>(&#21487;&#36873;):&#32477;&#22823;&#22810;&#25968;&#19968;&#23545;&#19968;&#30340;&#20851;&#32852;&#37117;&#25351;&#21521;&#20854;&#23454;&#20307;&#30340;&#20027;&#38190;&#12290;&#22312;&#19968;&#20123;&#23569;&#35265;&#30340;&#24773;&#20917;&#20013;&#65292; 
      &#20320;&#21487;&#33021;&#20250;&#25351;&#21521;&#20854;&#20182;&#30340;&#19968;&#20010;&#25110;&#22810;&#20010;&#23383;&#27573;&#65292;&#25110;&#32773;&#26159;&#19968;&#20010;&#34920;&#36798;&#24335;&#65292;&#36825;&#20123;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#29992;&#19968;&#20010;SQL&#20844;&#24335;&#26469;&#34920;&#31034;&#12290; 
      &#65288;&#21487;&#20197;&#22312;org.hibernate.test.onetooneformula&#25214;&#21040;&#20363;&#23376;&#65289; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(9)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>proxy</TT>): 
      &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#21333;&#28857;&#20851;&#32852;&#26159;&#32463;&#36807;&#20195;&#29702;&#30340;&#12290;<TT 
      class=literal>lazy="no-proxy"</TT>&#25351;&#23450;&#27492;&#23646;&#24615;&#24212;&#35813;&#22312;&#23454;&#20363;&#21464;&#37327;&#31532;&#19968;&#27425;&#34987;&#35775;&#38382;&#26102;&#24212;&#35813;&#24310;&#36831;&#25235;&#21462;&#65288;fetche 
      lazily&#65289;&#65288;&#38656;&#35201;&#36816;&#34892;&#26102;&#23383;&#33410;&#30721;&#30340;&#22686;&#24378;&#65289;&#12290; <TT 
      class=literal>lazy="false"</TT>&#25351;&#23450;&#27492;&#20851;&#32852;&#24635;&#26159;&#34987;&#39044;&#20808;&#25235;&#21462;&#12290;<SPAN 
      class=emphasis><EM>&#27880;&#24847;&#65292;&#22914;&#26524;<TT class=literal>constrained="false"</TT>, 
      &#19981;&#21487;&#33021;&#20351;&#29992;&#20195;&#29702;&#65292;Hibernate&#20250;&#37319;&#21462;&#39044;&#20808;&#25235;&#21462;&#65281;</EM></SPAN> </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(10)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>entity-name</TT> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#19968;&#23545;&#19968;&#20851;&#32852;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#20027;&#38190;&#20851;&#32852; </P>
  <LI>
  <P>&#24799;&#19968;&#22806;&#38190;&#20851;&#32852; </P></LI></UL></DIV>
<P>&#20027;&#38190;&#20851;&#32852;&#19981;&#38656;&#35201;&#39069;&#22806;&#30340;&#34920;&#23383;&#27573;&#65307;&#22914;&#26524;&#20004;&#34892;&#26159;&#36890;&#36807;&#36825;&#31181;&#19968;&#23545;&#19968;&#20851;&#31995;&#30456;&#20851;&#32852;&#30340;&#65292;&#37027;&#20040;&#36825;&#20004;&#34892;&#23601;&#20849;&#20139;&#21516;&#26679;&#30340;&#20027;&#20851;&#38190;&#23383;&#20540;&#12290;&#25152;&#20197;&#22914;&#26524;&#20320;&#24076;&#26395;&#20004;&#20010;&#23545;&#35937;&#36890;&#36807;&#20027;&#38190;&#19968;&#23545;&#19968;&#20851;&#32852;&#65292;&#20320;&#24517;&#39035;&#30830;&#35748;&#23427;&#20204;&#34987;&#36171;&#20104;&#21516;&#26679;&#30340;&#26631;&#35782;&#20540;&#65281; 
</P>
<P>&#27604;&#22914;&#35828;&#65292;&#23545;&#19979;&#38754;&#30340;<TT class=literal>Employee</TT>&#21644;<TT 
class=literal>Person</TT>&#36827;&#34892;&#20027;&#38190;&#19968;&#23545;&#19968;&#20851;&#32852;: </P><PRE class=programlisting>&lt;one-to-one name="person" class="Person"/&gt;</PRE><PRE class=programlisting>&lt;one-to-one name="employee" class="Employee" constrained="true"/&gt;</PRE>
<P>&#29616;&#22312;&#25105;&#20204;&#24517;&#39035;&#30830;&#20445;PERSON&#21644;EMPLOYEE&#20013;&#30456;&#20851;&#30340;&#23383;&#27573;&#26159;&#30456;&#31561;&#30340;&#12290;&#25105;&#20204;&#20351;&#29992;&#19968;&#20010;&#34987;&#25104;&#20026;<TT 
class=literal>foreign</TT>&#30340;&#29305;&#27530;&#30340;hibernate&#26631;&#35782;&#31526;&#29983;&#25104;&#31574;&#30053;&#65306; </P><PRE class=programlisting>&lt;class name="person" table="PERSON"&gt;
    &lt;id name="id" column="PERSON_ID"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;employee&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    ...
    &lt;one-to-one name="employee"
        class="Employee"
        constrained="true"/&gt;
&lt;/class&gt;</PRE>
<P>&#19968;&#20010;&#21018;&#21018;&#20445;&#23384;&#30340;<TT class=literal>Person</TT>&#23454;&#20363;&#34987;&#36171;&#20104;&#21644;&#35813;<TT class=literal>Person</TT>&#30340;<TT 
class=literal>employee</TT>&#23646;&#24615;&#25152;&#25351;&#21521;&#30340;<TT class=literal>Employee</TT>&#23454;&#20363;&#21516;&#26679;&#30340;&#20851;&#38190;&#23383;&#20540;&#12290; </P>
<P>&#21478;&#19968;&#31181;&#26041;&#24335;&#26159;&#19968;&#20010;&#22806;&#38190;&#21644;&#19968;&#20010;&#24799;&#19968;&#20851;&#38190;&#23383;&#23545;&#24212;&#65292;&#19978;&#38754;&#30340;<TT class=literal>Employee</TT>&#21644;<TT 
class=literal>Person</TT>&#30340;&#20363;&#23376;&#65292;&#22914;&#26524;&#20351;&#29992;&#36825;&#31181;&#20851;&#32852;&#26041;&#24335;&#65292;&#21487;&#20197;&#34920;&#36798;&#25104;&#65306; </P><PRE class=programlisting>&lt;many-to-one name="person" class="Person" column="PERSON_ID" unique="true"/&gt;</PRE>
<P>&#22914;&#26524;&#22312;<TT class=literal>Person</TT>&#30340;&#26144;&#23556;&#21152;&#20837;&#19979;&#38754;&#20960;&#21477;&#65292;&#36825;&#31181;&#20851;&#32852;&#23601;&#26159;&#21452;&#21521;&#30340;&#65306; </P><PRE class=programlisting>&lt;one-to-one name"employee" class="Employee" property-ref="person"/&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-naturalid></A>5.1.12.&nbsp;&#33258;&#28982;ID(natural-id)</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;natural-id mutable="true|false"/&gt;
        &lt;property ... /&gt;
        &lt;many-to-one ... /&gt;
        ......
&lt;/natural-id&gt;</PRE>
<P>&#25105;&#20204;&#24314;&#35758;&#20351;&#29992;&#20195;&#29992;&#38190;&#65288;&#38190;&#20540;&#19981;&#20855;&#22791;&#23454;&#38469;&#24847;&#20041;&#65289;&#20316;&#20026;&#20027;&#38190;&#65292;&#25105;&#20204;&#20173;&#28982;&#24212;&#35813;&#23581;&#35797;&#20026;&#25152;&#26377;&#30340;&#23454;&#20307;&#37319;&#29992;&#33258;&#28982;&#30340;&#38190;&#20540;&#20316;&#20026;&#65288;&#38468;&#21152;——&#35793;&#32773;&#27880;&#65289;&#26631;&#31034;&#12290;&#33258;&#28982;&#38190;&#65288;natural 
key&#65289;&#26159;&#21333;&#20010;&#25110;&#32452;&#21512;&#23646;&#24615;&#65292;&#20182;&#20204;&#24517;&#39035;&#21807;&#19968;&#19988;&#38750;&#31354;&#12290;&#22914;&#26524;&#23427;&#36824;&#26159;&#19981;&#21487;&#21464;&#30340;&#37027;&#23601;&#26356;&#29702;&#24819;&#20102;&#12290;&#22312;<TT 
class=literal>&lt;natural-id&gt;</TT>&#20803;&#32032;&#20013;&#21015;&#20986;&#33258;&#28982;&#38190;&#30340;&#23646;&#24615;&#12290;Hibernate&#20250;&#24110;&#20320;&#29983;&#25104;&#24517;&#39035;&#30340;&#21807;&#19968;&#38190;&#20540;&#21644;&#38750;&#31354;&#32422;&#26463;&#65292;&#20320;&#30340;&#26144;&#23556;&#20250;&#26356;&#21152;&#30340;&#26126;&#26174;&#26131;&#25026;&#65288;&#21407;&#25991;&#26159;self-documenting&#65292;&#33258;&#25105;&#27880;&#35299;&#65289;&#12290; 
</P>
<P>&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#20320;&#23454;&#29616;<TT class=literal>equals()</TT> &#21644;<TT 
class=literal>hashCode()</TT>&#26041;&#27861;,&#26469;&#27604;&#36739;&#23454;&#20307;&#30340;&#33258;&#28982;&#38190;&#23646;&#24615;&#12290; </P>
<P>&#36825;&#19968;&#26144;&#23556;&#19981;&#26159;&#20026;&#20102;&#25226;&#33258;&#28982;&#38190;&#20316;&#20026;&#20027;&#38190;&#32780;&#20934;&#22791;&#30340;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>mutable</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026;<TT class=literal>false</TT>): 
  &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#33258;&#28982;&#26631;&#35782;&#23646;&#24615;&#34987;&#20551;&#23450;&#20026;&#19981;&#21487;&#21464;&#30340;&#65288;&#24120;&#37327;&#65289;&#12290; </P></LI></UL></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-component></A>5.1.13.&nbsp;&#32452;&#20214;(component), 
&#21160;&#24577;&#32452;&#20214;(dynamic-component)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>&lt;component&gt;</TT>&#20803;&#32032;&#25226;&#23376;&#23545;&#35937;&#30340;&#19968;&#20123;&#20803;&#32032;&#19982;&#29238;&#31867;&#23545;&#24212;&#30340;&#34920;&#30340;&#19968;&#20123;&#23383;&#27573;&#26144;&#23556;&#36215;&#26469;&#12290; 
&#28982;&#21518;&#32452;&#20214;&#21487;&#20197;&#23450;&#20041;&#23427;&#20204;&#33258;&#24049;&#30340;&#23646;&#24615;&#12289;&#32452;&#20214;&#25110;&#32773;&#38598;&#21512;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;“Components”&#19968;&#31456;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;component 
        name="propertyName"                 <SPAN class=co>(1)</SPAN>
        class="className"                   <SPAN class=co>(2)</SPAN>
        insert="true|false"                 <SPAN class=co>(3)</SPAN>
        update="true|false"                 <SPAN class=co>(4)</SPAN>
        access="field|property|ClassName"   <SPAN class=co>(5)</SPAN>
        lazy="true|false"                   <SPAN class=co>(6)</SPAN>
        optimistic-lock="true|false"        <SPAN class=co>(7)</SPAN>
        unique="true|false"                 <SPAN class=co>(8)</SPAN>
        node="element-name|."
&gt;
        
        &lt;property ...../&gt;
        &lt;many-to-one .... /&gt;
        ........
&lt;/component&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23646;&#24615;&#21517; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#30340;&#23646;&#24615;&#31867;&#22411;):&#32452;&#20214;(&#23376;)&#31867;&#30340;&#21517;&#23383;&#12290; 
</P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>insert</TT>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340;<TT 
      class=literal>INSERT</TT>&#35821;&#21477;&#20013;? </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>update</TT>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340;<TT 
      class=literal>UPDATE</TT>&#35821;&#21477;&#20013;? </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>false</TT>): 
      &#34920;&#26126;&#27492;&#32452;&#20214;&#24212;&#22312;&#23454;&#20363;&#21464;&#37327;&#31532;&#19968;&#27425;&#34987;&#35775;&#38382;&#30340;&#26102;&#20505;&#24310;&#36831;&#21152;&#36733;(&#38656;&#35201;&#32534;&#35793;&#26102;&#23383;&#33410;&#30721;&#35013;&#32622;&#22120;) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>true</TT>):&#34920;&#26126;&#26356;&#26032;&#27492;&#32452;&#20214;&#26159;&#21542;&#38656;&#35201;&#33719;&#21462;&#20048;&#35266;&#38145;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#24403;&#36825;&#20010;&#23646;&#24615;&#21464;&#33039;&#26102;&#65292;&#26159;&#21542;&#22686;&#21152;&#29256;&#26412;&#21495;(Version) 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unique</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>false</TT>):&#34920;&#26126;&#32452;&#20214;&#26144;&#23556;&#30340;&#25152;&#26377;&#23383;&#27573;&#19978;&#37117;&#26377;&#21807;&#19968;&#24615;&#32422;&#26463; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20854;<TT class=literal>&lt;property&gt;</TT>&#23376;&#26631;&#31614;&#20026;&#23376;&#31867;&#30340;&#19968;&#20123;&#23646;&#24615;&#19982;&#34920;&#23383;&#27573;&#20043;&#38388;&#24314;&#31435;&#26144;&#23556;&#12290; </P>
<P><TT class=literal>&lt;component&gt;</TT>&#20803;&#32032;&#20801;&#35768;&#21152;&#20837;&#19968;&#20010;<TT 
class=literal>&lt;parent&gt;</TT>&#23376;&#20803;&#32032;&#65292;&#22312;&#32452;&#20214;&#31867;&#20869;&#37096;&#23601;&#21487;&#20197;&#26377;&#19968;&#20010;&#25351;&#21521;&#20854;&#23481;&#22120;&#30340;&#23454;&#20307;&#30340;&#21453;&#21521;&#24341;&#29992;&#12290; </P>
<P><TT class=literal>&lt;dynamic-component&gt;</TT>&#20803;&#32032;&#20801;&#35768;&#25226;&#19968;&#20010;<TT 
class=literal>Map</TT>&#26144;&#23556;&#20026;&#32452;&#20214;&#65292;&#20854;&#23646;&#24615;&#21517;&#23545;&#24212;map&#30340;&#38190;&#20540;&#12290; &#21442;&#35265;<A 
title="8.5.&nbsp;&#21160;&#24577;&#32452;&#20214; &#65288;Dynamic components&#65289;" 
href="#components-dynamic">&#31532;&nbsp;8.5&nbsp;&#33410; “&#21160;&#24577;&#32452;&#20214; &#65288;Dynamic components&#65289;”</A>. 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-properties></A>5.1.14.&nbsp;properties</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>&lt;properties&gt;</TT> 
&#20803;&#32032;&#20801;&#35768;&#23450;&#20041;&#19968;&#20010;&#21629;&#21517;&#30340;&#36923;&#36753;&#20998;&#32452;(grouping)&#21253;&#21547;&#19968;&#20010;&#31867;&#20013;&#30340;&#22810;&#20010;&#23646;&#24615;&#12290; &#36825;&#20010;&#20803;&#32032;&#26368;&#37325;&#35201;&#30340;&#29992;&#22788;&#26159;&#20801;&#35768;&#22810;&#20010;&#23646;&#24615;&#30340;&#32452;&#21512;&#20316;&#20026;<TT 
class=literal>property-ref</TT>&#30340;&#30446;&#26631;(target)&#12290; &#36825;&#20063;&#26159;&#23450;&#20041;&#22810;&#23383;&#27573;&#21807;&#19968;&#32422;&#26463;&#30340;&#19968;&#31181;&#26041;&#20415;&#36884;&#24452;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;properties 
        name="logicalName"                  <SPAN class=co>(1)</SPAN>
        insert="true|false"                 <SPAN class=co>(2)</SPAN>
        update="true|false"                 <SPAN class=co>(3)</SPAN>
        optimistic-lock="true|false"        <SPAN class=co>(4)</SPAN>
        unique="true|false"                 <SPAN class=co>(5)</SPAN>
&gt;
        
        &lt;property ...../&gt;
        &lt;many-to-one .... /&gt;
        ........
&lt;/properties&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#20998;&#32452;&#30340;&#36923;&#36753;&#21517;&#31216; - <SPAN 
      class=emphasis><EM>&#19981;&#26159;</EM></SPAN> &#23454;&#38469;&#23646;&#24615;&#30340;&#21517;&#31216;. </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>insert</TT>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340; <TT 
      class=literal>INSERT</TT>&#35821;&#21477;&#20013;? </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>update</TT>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340; <TT 
      class=literal>UPDATE</TT>&#35821;&#21477;&#20013;? </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>true</TT>):&#34920;&#26126;&#26356;&#26032;&#27492;&#32452;&#20214;&#26159;&#21542;&#38656;&#35201;&#33719;&#21462;&#20048;&#35266;&#38145;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#24403;&#36825;&#20010;&#23646;&#24615;&#21464;&#33039;&#26102;&#65292;&#26159;&#21542;&#22686;&#21152;&#29256;&#26412;&#21495;(Version) 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unique</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>false</TT>):&#34920;&#26126;&#32452;&#20214;&#26144;&#23556;&#30340;&#25152;&#26377;&#23383;&#27573;&#19978;&#37117;&#26377;&#21807;&#19968;&#24615;&#32422;&#26463; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20363;&#22914;&#65292;&#22914;&#26524;&#25105;&#20204;&#26377;&#22914;&#19979;&#30340;<TT class=literal>&lt;properties&gt;</TT>&#26144;&#23556;: </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="personNumber"/&gt;
    ...
    &lt;properties name="name" 
            unique="true" update="false"&gt;
        &lt;property name="firstName"/&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="lastName"/&gt;
    &lt;/properties&gt;
&lt;/class&gt;</PRE>
<P>&#28982;&#21518;&#65292;&#25105;&#20204;&#21487;&#33021;&#26377;&#19968;&#20123;&#36951;&#30041;&#30340;&#25968;&#25454;&#20851;&#32852;&#65292;&#24341;&#29992; <TT class=literal>Person</TT>&#34920;&#30340;&#36825;&#20010;&#21807;&#19968;&#38190;&#65292;&#32780;&#19981;&#26159;&#20027;&#38190;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="person" 
         class="Person" property-ref="name"&gt;
    &lt;column name="firstName"/&gt;
    &lt;column name="initial"/&gt;
    &lt;column name="lastName"/&gt;
&lt;/many-to-one&gt;</PRE>
<P>&#25105;&#20204;&#24182;&#19981;&#25512;&#33616;&#36825;&#26679;&#20351;&#29992;&#65292;&#38500;&#38750;&#22312;&#26144;&#23556;&#36951;&#30041;&#25968;&#25454;&#30340;&#24773;&#20917;&#19979;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-subclass></A>5.1.15.&nbsp;&#23376;&#31867;(subclass)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26368;&#21518;&#65292;&#22810;&#24577;&#25345;&#20037;&#21270;&#38656;&#35201;&#20026;&#29238;&#31867;&#30340;&#27599;&#20010;&#23376;&#31867;&#37117;&#36827;&#34892;&#23450;&#20041;&#12290;&#23545;&#20110;“&#27599;&#19968;&#26869;&#31867;&#32487;&#25215;&#26641;&#23545;&#24212;&#19968;&#20010;&#34920;”&#30340;&#31574;&#30053;&#26469;&#35828;&#65292;&#23601;&#38656;&#35201;&#20351;&#29992;<TT 
class=literal>&lt;subclass&gt;</TT>&#23450;&#20041;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;subclass
        name="ClassName"                              <SPAN class=co>(1)</SPAN>
        discriminator-value="discriminator_value"     <SPAN class=co>(2)</SPAN>
        proxy="ProxyInterface"                        <SPAN class=co>(3)</SPAN>
        lazy="true|false"                             <SPAN class=co>(4)</SPAN>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        entity-name="EntityName"
        node="element-name"
        extends="SuperclassName"&gt;

        &lt;property .... /&gt;
        .....
&lt;/subclass&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23376;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>discriminator-value(&#36776;&#21035;&#26631;&#24535;)</TT> (&#21487;&#36873; - 
      &#40664;&#35748;&#20026;&#31867;&#21517;):&#19968;&#20010;&#29992;&#20110;&#21306;&#20998;&#27599;&#20010;&#29420;&#31435;&#30340;&#23376;&#31867;&#30340;&#20540;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>proxy(&#20195;&#29702;)</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290; 
  </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873;, &#40664;&#35748;&#26159;<TT class=literal>true</TT>): &#35774;&#32622;&#20026; 
      <TT class=literal>lazy="false"</TT> &#31105;&#27490;&#20351;&#29992;&#24310;&#36831;&#25235;&#21462; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#27599;&#20010;&#23376;&#31867;&#37117;&#24212;&#35813;&#23450;&#20041;&#23427;&#33258;&#24049;&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;&#21644;&#23376;&#31867;&#12290; <TT class=literal>&lt;version&gt;</TT> &#21644;<TT 
class=literal>&lt;id&gt;</TT> &#23646;&#24615;&#21487;&#20197;&#20174;&#26681;&#29238;&#31867;&#32487;&#25215;&#19979;&#26469;&#12290;&#22312;&#19968;&#26869;&#32487;&#25215;&#26641;&#19978;&#30340;&#27599;&#20010;&#23376;&#31867;&#37117;&#24517;&#39035;&#23450;&#20041;&#19968;&#20010;&#21807;&#19968;&#30340;<TT 
class=literal>discriminator-value</TT>&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#23601;&#20250;&#20351;&#29992;Java&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P>
<P>&#26356;&#22810;&#20851;&#20110;&#32487;&#25215;&#26144;&#23556;&#30340;&#20449;&#24687;, &#21442;&#32771; <A title="&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)" 
href="#inheritance">&#31532;&nbsp;9&nbsp;&#31456; <I>&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)</I></A>&#31456;&#33410;. 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-joinedsubclass></A>5.1.16.&nbsp;&#36830;&#25509;&#30340;&#23376;&#31867;(joined-subclass)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#27492;&#22806;&#65292;&#27599;&#20010;&#23376;&#31867;&#21487;&#33021;&#34987;&#26144;&#23556;&#21040;&#20182;&#33258;&#24049;&#30340;&#34920;&#20013;(&#27599;&#20010;&#23376;&#31867;&#19968;&#20010;&#34920;&#30340;&#31574;&#30053;)&#12290;&#34987;&#32487;&#25215;&#30340;&#29366;&#24577;&#36890;&#36807;&#21644;&#36229;&#31867;&#30340;&#34920;&#20851;&#32852;&#24471;&#21040;&#12290;&#25105;&#20204;&#20351;&#29992;<TT 
class=literal>&lt;joined-subclass&gt;</TT>&#20803;&#32032;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;joined-subclass
        name="ClassName"                    <SPAN class=co>(1)</SPAN>
        table="tablename"                   <SPAN class=co>(2)</SPAN>
        proxy="ProxyInterface"              <SPAN class=co>(3)</SPAN>
        lazy="true|false"                   <SPAN class=co>(4)</SPAN>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        schema="schema"
        catalog="catalog"
        extends="SuperclassName"
        persister="ClassName"
        subselect="SQL expression"
        entity-name="EntityName"
        node="element-name"&gt;

        &lt;key .... &gt;

        &lt;property .... /&gt;
        .....
&lt;/joined-subclass&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23376;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>table</TT>: &#23376;&#31867;&#30340;&#34920;&#21517;. </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>proxy</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873;, &#40664;&#35748;&#26159; <TT class=literal>true</TT>): &#35774;&#32622;&#20026; 
      <TT class=literal>lazy="false"</TT> &#31105;&#27490;&#20351;&#29992;&#24310;&#36831;&#35013;&#36733;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#36825;&#31181;&#26144;&#23556;&#31574;&#30053;&#19981;&#38656;&#35201;&#25351;&#23450;&#36776;&#21035;&#26631;&#24535;(discriminator)&#23383;&#27573;&#12290;&#20294;&#26159;&#65292;&#27599;&#19968;&#20010;&#23376;&#31867;&#37117;&#24517;&#39035;&#20351;&#29992;<TT 
class=literal>&lt;key&gt;</TT>&#20803;&#32032;&#25351;&#23450;&#19968;&#20010;&#34920;&#23383;&#27573;&#26469;&#25345;&#26377;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#12290;&#26412;&#31456;&#24320;&#22987;&#30340;&#26144;&#23556;&#21487;&#20197;&#34987;&#29992;&#22914;&#19979;&#26041;&#24335;&#37325;&#20889;&#65306; </P><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;

        &lt;class name="Cat" table="CATS"&gt;
                &lt;id name="id" column="uid" type="long"&gt;
                        &lt;generator class="hilo"/&gt;
                &lt;/id&gt;
                &lt;property name="birthdate" type="date"/&gt;
                &lt;property name="color" not-null="true"/&gt;
                &lt;property name="sex" not-null="true"/&gt;
                &lt;property name="weight"/&gt;
                &lt;many-to-one name="mate"/&gt;
                &lt;set name="kittens"&gt;
                        &lt;key column="MOTHER"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;
                &lt;joined-subclass name="DomesticCat" table="DOMESTIC_CATS"&gt;
                    &lt;key column="CAT"/&gt;
                    &lt;property name="name" type="string"/&gt;
                &lt;/joined-subclass&gt;
        &lt;/class&gt;

        &lt;class name="eg.Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#26356;&#22810;&#20851;&#20110;&#32487;&#25215;&#26144;&#23556;&#30340;&#20449;&#24687;&#65292;&#21442;&#32771;<A title="&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)" 
href="#inheritance">&#31532;&nbsp;9&nbsp;&#31456; <I>&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)</I></A>&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-unionsubclass></A>5.1.17.&nbsp;&#32852;&#21512;&#23376;&#31867;(union-subclass)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#31532;&#19977;&#31181;&#36873;&#25321;&#26159;&#20165;&#20165;&#26144;&#23556;&#31867;&#32487;&#25215;&#26641;&#20013;&#20855;&#20307;&#31867;&#37096;&#20998;&#21040;&#34920;&#20013;(&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;&#30340;&#31574;&#30053;)&#12290;&#20854;&#20013;&#65292;&#27599;&#24352;&#34920;&#23450;&#20041;&#20102;&#31867;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#29366;&#24577;&#65292;&#21253;&#25324;&#32487;&#25215;&#30340;&#29366;&#24577;&#12290;&#22312; Hibernate 
&#20013;&#65292;&#24182;&#19981;&#38656;&#35201;&#23436;&#20840;&#26174;&#24335;&#22320;&#26144;&#23556;&#36825;&#26679;&#30340;&#32487;&#25215;&#26641;&#12290;&#20320;&#21487;&#20197;&#31616;&#21333;&#22320;&#20351;&#29992;&#21333;&#29420;&#30340;<TT 
class=literal>&lt;class&gt;</TT>&#23450;&#20041;&#26144;&#23556;&#27599;&#20010;&#31867;&#12290;&#28982;&#32780;&#65292;&#22914;&#26524;&#20320;&#24819;&#20351;&#29992;&#22810;&#24577;&#20851;&#32852;(&#20363;&#22914;&#65292;&#19968;&#20010;&#23545;&#31867;&#32487;&#25215;&#26641;&#20013;&#36229;&#31867;&#30340;&#20851;&#32852;)&#65292;&#20320;&#38656;&#35201;&#20351;&#29992;<TT 
class=literal>&lt;union-subclass&gt;</TT>&#26144;&#23556;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;union-subclass
        name="ClassName"                    <SPAN class=co>(1)</SPAN>
        table="tablename"                   <SPAN class=co>(2)</SPAN>
        proxy="ProxyInterface"              <SPAN class=co>(3)</SPAN>
        lazy="true|false"                   <SPAN class=co>(4)</SPAN>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        schema="schema"
        catalog="catalog"
        extends="SuperclassName"
        abstract="true|false"
        persister="ClassName"
        subselect="SQL expression"
        entity-name="EntityName"
        node="element-name"&gt;

        &lt;property .... /&gt;
        .....
&lt;/union-subclass&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23376;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>table</TT>: &#23376;&#31867;&#30340;&#34920;&#21517; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>proxy</TT> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873;, &#40664;&#35748;&#26159; <TT class=literal>true</TT>): &#35774;&#32622;&#20026; 
      <TT class=literal>lazy="false"</TT> &#31105;&#27490;&#20351;&#29992;&#24310;&#36831;&#35013;&#36733;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#36825;&#31181;&#26144;&#23556;&#31574;&#30053;&#19981;&#38656;&#35201;&#25351;&#23450;&#36776;&#21035;&#26631;&#24535;(discriminator)&#23383;&#27573;&#12290; </P>
<P>&#26356;&#22810;&#20851;&#20110;&#32487;&#25215;&#26144;&#23556;&#30340;&#20449;&#24687;&#65292;&#21442;&#32771;<A title="&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)" 
href="#inheritance">&#31532;&nbsp;9&nbsp;&#31456; <I>&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)</I></A>&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-join></A>5.1.18.&nbsp;&#36830;&#25509;(join)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20351;&#29992; <TT class=literal>&lt;join&gt;</TT> &#20803;&#32032;&#65292;&#21487;&#20197;&#23558;&#19968;&#20010;&#31867;&#30340;&#23646;&#24615;&#26144;&#23556;&#21040;&#22810;&#24352;&#34920;&#20013;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;join
        table="tablename"                        <SPAN class=co>(1)</SPAN>
        schema="owner"                           <SPAN class=co>(2)</SPAN>
        catalog="catalog"                        <SPAN class=co>(3)</SPAN>
        fetch="join|select"                      <SPAN class=co>(4)</SPAN>
        inverse="true|false"                     <SPAN class=co>(5)</SPAN>
        optional="true|false"&gt;                   <SPAN class=co>(6)</SPAN>
        
        &lt;key ... /&gt;
        
        &lt;property ... /&gt;
        ...
&lt;/join&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>table</TT>: &#34987;&#36830;&#25509;&#34920;&#30340;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>schema</TT> (&#21487;&#36873;):&#35206;&#30422;&#30001;&#26681;<TT 
      class=literal>&lt;hibernate-mapping&gt;</TT>&#20803;&#32032;&#25351;&#23450;&#30340;&#27169;&#24335;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>catalog</TT> (&#21487;&#36873;): &#35206;&#30422;&#30001;&#26681; <TT 
      class=literal>&lt;hibernate-mapping&gt;</TT>&#20803;&#32032;&#25351;&#23450;&#30340;&#30446;&#24405;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>fetch</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>join</TT>): 
      &#22914;&#26524;&#35774;&#32622;&#20026;&#40664;&#35748;&#20540;<TT class=literal>join</TT>&#65292; Hibernate &#23558;&#20351;&#29992;&#19968;&#20010;&#20869;&#36830;&#25509;&#26469;&#24471;&#21040;&#36825;&#20010;&#31867;&#25110;&#20854;&#36229;&#31867;&#23450;&#20041;&#30340;<TT 
      class=literal>&lt;join&gt;</TT>&#65292;&#32780;&#20351;&#29992;&#19968;&#20010;&#22806;&#36830;&#25509;&#26469;&#24471;&#21040;&#20854;&#23376;&#31867;&#23450;&#20041;&#30340;<TT 
      class=literal>&lt;join&gt;</TT>&#12290;&#22914;&#26524;&#35774;&#32622;&#20026;<TT class=literal>select</TT>&#65292;&#21017; 
      Hibernate &#23558;&#20026;&#23376;&#31867;&#23450;&#20041;&#30340; <TT 
      class=literal>&lt;join&gt;</TT>&#20351;&#29992;&#39034;&#24207;&#36873;&#25321;&#12290;&#36825;&#20165;&#22312;&#19968;&#34892;&#25968;&#25454;&#34920;&#31034;&#19968;&#20010;&#23376;&#31867;&#30340;&#23545;&#35937;&#30340;&#26102;&#20505;&#25165;&#20250;&#21457;&#29983;&#12290;&#23545;&#36825;&#20010;&#31867;&#21644;&#20854;&#36229;&#31867;&#23450;&#20041;&#30340;<TT 
      class=literal>&lt;join&gt;</TT>&#65292;&#20381;&#28982;&#20250;&#20351;&#29992;&#20869;&#36830;&#25509;&#24471;&#21040;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>inverse</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT class=literal>false</TT>): 
      &#22914;&#26524;&#25171;&#24320;&#65292;Hibernate &#19981;&#20250;&#25554;&#20837;&#25110;&#32773;&#26356;&#26032;&#27492;&#36830;&#25509;&#23450;&#20041;&#30340;&#23646;&#24615;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optional</TT> (&#21487;&#36873; - &#40664;&#35748;&#26159; <TT 
      class=literal>false</TT>): &#22914;&#26524;&#25171;&#24320;&#65292;Hibernate 
      &#21482;&#20250;&#22312;&#27492;&#36830;&#25509;&#23450;&#20041;&#30340;&#23646;&#24615;&#38750;&#31354;&#26102;&#25554;&#20837;&#19968;&#34892;&#25968;&#25454;&#65292;&#24182;&#19988;&#24635;&#26159;&#20351;&#29992;&#19968;&#20010;&#22806;&#36830;&#25509;&#26469;&#24471;&#21040;&#36825;&#20123;&#23646;&#24615;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20363;&#22914;&#65292;&#19968;&#20010;&#20154;(person)&#30340;&#22320;&#22336;(address)&#20449;&#24687;&#21487;&#20197;&#34987;&#26144;&#23556;&#21040;&#21333;&#29420;&#30340;&#34920;&#20013;(&#24182;&#20445;&#30041;&#25152;&#26377;&#23646;&#24615;&#30340;&#20540;&#31867;&#22411;&#35821;&#20041;)&#65306; </P><PRE class=programlisting>&lt;class name="Person"
    table="PERSON"&gt;

    &lt;id name="id" column="PERSON_ID"&gt;...&lt;/id&gt;

    &lt;join table="ADDRESS"&gt;
        &lt;key column="ADDRESS_ID"/&gt;
        &lt;property name="address"/&gt;
        &lt;property name="zip"/&gt;
        &lt;property name="country"/&gt;
    &lt;/join&gt;
    ...</PRE>
<P>&#27492;&#29305;&#24615;&#24120;&#24120;&#23545;&#36951;&#30041;&#25968;&#25454;&#27169;&#22411;&#26377;&#29992;&#65292;&#25105;&#20204;&#25512;&#33616;&#34920;&#20010;&#25968;&#27604;&#31867;&#20010;&#25968;&#23569;&#65292;&#20197;&#21450;&#32454;&#31890;&#24230;&#30340;&#39046;&#22495;&#27169;&#22411;&#12290;&#28982;&#32780;&#65292;&#22312;&#21333;&#29420;&#30340;&#32487;&#25215;&#26641;&#19978;&#20999;&#25442;&#32487;&#25215;&#26144;&#23556;&#31574;&#30053;&#26159;&#26377;&#29992;&#30340;&#65292;&#21518;&#38754;&#20250;&#35299;&#37322;&#36825;&#28857;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-key></A>5.1.19.&nbsp;&#38190;(key)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#30446;&#21069;&#24050;&#32463;&#35265;&#21040;&#36807;<TT class=literal>&lt;key&gt;</TT>&#20803;&#32032;&#22810;&#27425;&#20102;&#12290; 
&#36825;&#20010;&#20803;&#32032;&#22312;&#29238;&#26144;&#23556;&#20803;&#32032;&#23450;&#20041;&#20102;&#23545;&#26032;&#34920;&#30340;&#36830;&#25509;&#65292;&#24182;&#19988;&#22312;&#34987;&#36830;&#25509;&#34920;&#20013;&#23450;&#20041;&#20102;&#19968;&#20010;&#22806;&#38190;&#24341;&#29992;&#21407;&#34920;&#30340;&#20027;&#38190;&#30340;&#24773;&#20917;&#19979;&#32463;&#24120;&#20351;&#29992;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;key
        column="columnname"                      <SPAN class=co>(1)</SPAN>
        on-delete="noaction|cascade"             <SPAN class=co>(2)</SPAN>
        property-ref="propertyName"              <SPAN class=co>(3)</SPAN>
        not-null="true|false"                    <SPAN class=co>(4)</SPAN>
        update="true|false"                      <SPAN class=co>(5)</SPAN>
        unique="true|false"                      <SPAN class=co>(6)</SPAN>
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT> (&#21487;&#36873;): &#22806;&#38190;&#23383;&#27573;&#30340;&#21517;&#31216;&#12290;&#20063;&#21487;&#20197;&#36890;&#36807;&#23884;&#22871;&#30340; <TT 
      class=literal>&lt;column&gt;</TT>&#25351;&#23450;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>on-delete</TT> (&#21487;&#36873;, &#40664;&#35748;&#26159; <TT 
      class=literal>noaction</TT>): &#34920;&#26126;&#22806;&#38190;&#20851;&#32852;&#26159;&#21542;&#25171;&#24320;&#25968;&#25454;&#24211;&#32423;&#21035;&#30340;&#32423;&#32852;&#21024;&#38500;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>property-ref</TT> (&#21487;&#36873;): &#34920;&#26126;&#22806;&#38190;&#24341;&#29992;&#30340;&#23383;&#27573;&#19981;&#26159;&#21407;&#34920;&#30340;&#20027;&#38190;(&#25552;&#20379;&#32473;&#36951;&#30041;&#25968;&#25454;)&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-null</TT> (&#21487;&#36873;): &#34920;&#26126;&#22806;&#38190;&#30340;&#23383;&#27573;&#19981;&#21487;&#20026;&#31354;(&#36825;&#24847;&#21619;&#30528;&#26080;&#35770;&#20309;&#26102;&#22806;&#38190;&#37117;&#26159;&#20027;&#38190;&#30340;&#19968;&#37096;&#20998;)&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>update</TT> (&#21487;&#36873;): &#34920;&#26126;&#22806;&#38190;&#20915;&#19981;&#24212;&#35813;&#34987;&#26356;&#26032;(&#36825;&#24847;&#21619;&#30528;&#26080;&#35770;&#20309;&#26102;&#22806;&#38190;&#37117;&#26159;&#20027;&#38190;&#30340;&#19968;&#37096;&#20998;)&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>unique</TT> (&#21487;&#36873;): &#34920;&#26126;&#22806;&#38190;&#24212;&#26377;&#21807;&#19968;&#24615;&#32422;&#26463; (&#36825;&#24847;&#21619;&#30528;&#26080;&#35770;&#20309;&#26102;&#22806;&#38190;&#37117;&#26159;&#20027;&#38190;&#30340;&#19968;&#37096;&#20998;)&#12290; 
      </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#23545;&#37027;&#20123;&#30475;&#37325;&#21024;&#38500;&#24615;&#33021;&#30340;&#31995;&#32479;&#65292;&#25105;&#20204;&#25512;&#33616;&#25152;&#26377;&#30340;&#38190;&#37117;&#24212;&#35813;&#23450;&#20041;&#20026;<TT class=literal>on-delete="cascade"</TT>&#65292;&#36825;&#26679; 
Hibernate &#23558;&#20351;&#29992;&#25968;&#25454;&#24211;&#32423;&#30340;<TT class=literal>ON CASCADE DELETE</TT>&#32422;&#26463;&#65292;&#32780;&#19981;&#26159;&#22810;&#20010;<TT 
class=literal>DELETE</TT>&#35821;&#21477;&#12290; &#27880;&#24847;&#65292;&#36825;&#20010;&#29305;&#24615;&#20250;&#32469;&#36807; Hibernate &#36890;&#24120;&#23545;&#29256;&#26412;&#25968;&#25454;(versioned 
data)&#37319;&#29992;&#30340;&#20048;&#35266;&#38145;&#31574;&#30053;&#12290; </P>
<P><TT class=literal>not-null</TT> &#21644; <TT class=literal>update</TT> 
&#23646;&#24615;&#22312;&#26144;&#23556;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#30340;&#26102;&#20505;&#26377;&#29992;&#12290;&#22914;&#26524;&#20320;&#26144;&#23556;&#19968;&#20010;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#21040;&#38750;&#31354;&#30340;(non-nullable)&#22806;&#38190;&#65292;&#20320;<SPAN 
class=emphasis><EM>&#24517;&#39035;</EM></SPAN> &#29992;<TT class=literal>&lt;key 
not-null="true"&gt;</TT>&#23450;&#20041;&#27492;&#38190;&#23383;&#27573;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=mapping-column></A>5.1.20.&nbsp;&#23383;&#27573;&#21644;&#35268;&#21017;&#20803;&#32032;&#65288;column and 
formula elements&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20219;&#20309;&#25509;&#21463;<TT class=literal>column</TT>&#23646;&#24615;&#30340;&#26144;&#23556;&#20803;&#32032;&#37117;&#21487;&#20197;&#36873;&#25321;&#25509;&#21463;<TT 
class=literal>&lt;column&gt;</TT> &#23376;&#20803;&#32032;&#12290;&#21516;&#26679;&#30340;&#65292;<TT 
class=literal>formula</TT>&#23376;&#20803;&#32032;&#20063;&#21487;&#20197;&#26367;&#25442;<TT class=literal>&lt;formula&gt;</TT>&#23646;&#24615;&#12290; </P><PRE class=programlisting>&lt;column
        name="column_name"
        length="N"
        precision="N"
        scale="N"
        not-null="true|false"
        unique="true|false"
        unique-key="multicolumn_unique_key_name"
        index="index_name"
        sql-type="sql_type_name"
        check="SQL expression"
        default="SQL expression"/&gt;</PRE><PRE class=programlisting>&lt;formula&gt;SQL expression&lt;/formula&gt;</PRE>
<P><TT class=literal>column</TT> &#21644; <TT class=literal>formula</TT> 
&#23646;&#24615;&#29978;&#33267;&#21487;&#20197;&#22312;&#21516;&#19968;&#20010;&#23646;&#24615;&#25110;&#20851;&#32852;&#26144;&#23556;&#20013;&#34987;&#21512;&#24182;&#26469;&#34920;&#36798;&#65292;&#20363;&#22914;&#65292;&#19968;&#20123;&#22855;&#24322;&#30340;&#36830;&#25509;&#26465;&#20214;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="homeAddress" class="Address"
        insert="false" update="false"&gt;
    &lt;column name="person_id" not-null="true" length="10"/&gt;
    &lt;formula&gt;'MAILING'&lt;/formula&gt;
&lt;/many-to-one&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-declaration-import></A>5.1.21.&nbsp;&#24341;&#29992;(import)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20551;&#35774;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#26377;&#20004;&#20010;&#21516;&#26679;&#21517;&#23383;&#30340;&#25345;&#20037;&#21270;&#31867;&#65292;&#20294;&#26159;&#20320;&#19981;&#24819;&#22312;Hibernate&#26597;&#35810;&#20013;&#20351;&#29992;&#20182;&#20204;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;&#38500;&#20102;&#20381;&#36182;<TT 
class=literal>auto-import="true"</TT>&#20197;&#22806;&#65292;&#31867;&#20063;&#21487;&#20197;&#34987;&#26174;&#24335;&#22320;“import(&#24341;&#29992;)”&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#24341;&#29992;&#27809;&#26377;&#34987;&#26126;&#30830;&#26144;&#23556;&#30340;&#31867;&#21644;&#25509;&#21475;&#12290; 
</P><PRE class=programlisting>&lt;import class="java.lang.Object" rename="Universe"/&gt;</PRE>
<DIV class=programlistingco><PRE class=programlisting>&lt;import
        class="ClassName"              <SPAN class=co>(1)</SPAN>
        rename="ShortName"             <SPAN class=co>(2)</SPAN>
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT>: &#20219;&#20309;Java&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>rename</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;): &#22312;&#26597;&#35810;&#35821;&#21477;&#20013;&#21487;&#20197;&#20351;&#29992;&#30340;&#21517;&#23383;&#12290; 
  </P></TD></TR></TBODY></TABLE></DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-types-anymapping></A>5.1.22.&nbsp;any</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#26159;&#23646;&#24615;&#26144;&#23556;&#30340;&#21448;&#19968;&#31181;&#31867;&#22411;&#12290;<TT class=literal>&lt;any&gt;</TT> 
&#26144;&#23556;&#20803;&#32032;&#23450;&#20041;&#20102;&#19968;&#31181;&#20174;&#22810;&#20010;&#34920;&#21040;&#31867;&#30340;&#22810;&#24577;&#20851;&#32852;&#12290;&#36825;&#31181;&#31867;&#22411;&#30340;&#26144;&#23556;&#24120;&#24120;&#38656;&#35201;&#22810;&#20110;&#19968;&#20010;&#23383;&#27573;&#12290;&#31532;&#19968;&#20010;&#23383;&#27573;&#25345;&#26377;&#34987;&#20851;&#32852;&#23454;&#20307;&#30340;&#31867;&#22411;&#65292;&#20854;&#20182;&#30340;&#23383;&#27573;&#25345;&#26377;&#26631;&#35782;&#31526;&#12290;&#23545;&#36825;&#31181;&#31867;&#22411;&#30340;&#20851;&#32852;&#26469;&#35828;&#65292;&#19981;&#21487;&#33021;&#25351;&#23450;&#19968;&#20010;&#22806;&#38190;&#32422;&#26463;&#65292;&#25152;&#20197;&#36825;&#24403;&#28982;&#19981;&#26159;&#26144;&#23556;(&#22810;&#24577;)&#20851;&#32852;&#30340;&#36890;&#24120;&#30340;&#26041;&#24335;&#12290;&#20320;&#21482;&#24212;&#35813;&#22312;&#38750;&#24120;&#29305;&#27530;&#30340;&#24773;&#20917;&#19979;&#20351;&#29992;&#23427;(&#27604;&#22914;&#65292;&#23457;&#35745;log&#65292;&#29992;&#25143;&#20250;&#35805;&#25968;&#25454;&#31561;&#31561;)&#12290; 
</P>
<P><TT class=literal>meta-type</TT> 
&#23646;&#24615;&#20351;&#24471;&#24212;&#29992;&#31243;&#24207;&#33021;&#25351;&#23450;&#19968;&#20010;&#23558;&#25968;&#25454;&#24211;&#23383;&#27573;&#30340;&#20540;&#26144;&#23556;&#21040;&#25345;&#20037;&#21270;&#31867;&#30340;&#33258;&#23450;&#20041;&#31867;&#22411;&#12290;&#36825;&#20010;&#25345;&#20037;&#21270;&#31867;&#21253;&#21547;&#26377;&#29992;<TT 
class=literal>id-type</TT>&#25351;&#23450;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290; &#20320;&#24517;&#39035;&#25351;&#23450;&#20174;meta-type&#30340;&#20540;&#21040;&#31867;&#21517;&#30340;&#26144;&#23556;&#12290; </P><PRE class=programlisting>&lt;any name="being" id-type="long" meta-type="string"&gt;
    &lt;meta-value value="TBL_ANIMAL" class="Animal"/&gt;
    &lt;meta-value value="TBL_HUMAN" class="Human"/&gt;
    &lt;meta-value value="TBL_ALIEN" class="Alien"/&gt;
    &lt;column name="table_name"/&gt;
    &lt;column name="id"/&gt;
&lt;/any&gt;</PRE>
<DIV class=programlistingco><PRE class=programlisting>&lt;any
        name="propertyName"                      <SPAN class=co>(1)</SPAN>
        id-type="idtypename"                     <SPAN class=co>(2)</SPAN>
        meta-type="metatypename"                 <SPAN class=co>(3)</SPAN>
        cascade="cascade_style"                  <SPAN class=co>(4)</SPAN>
        access="field|property|ClassName"        <SPAN class=co>(5)</SPAN>
        optimistic-lock="true|false"             <SPAN class=co>(6)</SPAN>
&gt;
        &lt;meta-value ... /&gt;
        &lt;meta-value ... /&gt;
        .....
        &lt;column .... /&gt;
        &lt;column .... /&gt;
        .....
&lt;/any&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT>: &#23646;&#24615;&#21517; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>id-type</TT>: &#26631;&#35782;&#31526;&#31867;&#22411; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>meta-type</TT> (&#21487;&#36873; -&#40664;&#35748;&#26159; <TT 
      class=literal>string</TT>): &#20801;&#35768;&#36776;&#21035;&#26631;&#24535;(discriminator)&#26144;&#23556;&#30340;&#20219;&#20309;&#31867;&#22411; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>cascade</TT> (&#21487;&#36873; -&#40664;&#35748;&#26159;<TT class=literal>none</TT>): 
      &#32423;&#32852;&#30340;&#31867;&#22411; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT> (&#21487;&#36873; -&#40664;&#35748;&#26159; <TT 
      class=literal>property</TT>): Hibernate &#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>optimistic-lock</TT> (&#21487;&#36873; -&#40664;&#35748;&#26159; <TT 
      class=literal>true</TT>): &#34920;&#26126;&#26356;&#26032;&#27492;&#32452;&#20214;&#26159;&#21542;&#38656;&#35201;&#33719;&#21462;&#20048;&#35266;&#38145;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#24403;&#36825;&#20010;&#23646;&#24615;&#21464;&#33039;&#26102;&#65292;&#26159;&#21542;&#22686;&#21152;&#29256;&#26412;&#21495;(Version) 
      </P></TD></TR></TBODY></TABLE></DIV></DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-types></A>5.2.&nbsp;Hibernate &#30340;&#31867;&#22411;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-types-entitiesvalues></A>5.2.1.&nbsp;&#23454;&#20307;(Entities)&#21644;&#20540;(values)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20026;&#20102;&#29702;&#35299;&#24456;&#22810;&#19982;&#25345;&#20037;&#21270;&#26381;&#21153;&#30456;&#20851;&#30340;Java&#35821;&#35328;&#32423;&#23545;&#35937;&#30340;&#34892;&#20026;&#65292;&#25105;&#20204;&#38656;&#35201;&#25226;&#23427;&#20204;&#20998;&#20026;&#20004;&#31867;&#65306; </P>
<P><SPAN class=emphasis><EM>&#23454;&#20307;entity</EM></SPAN> 
&#29420;&#31435;&#20110;&#20219;&#20309;&#25345;&#26377;&#23454;&#20307;&#24341;&#29992;&#30340;&#23545;&#35937;&#12290;&#19982;&#36890;&#24120;&#30340;Java&#27169;&#22411;&#30456;&#27604;&#65292;&#19981;&#20877;&#34987;&#24341;&#29992;&#30340;&#23545;&#35937;&#20250;&#34987;&#24403;&#20316;&#22403;&#22334;&#25910;&#38598;&#25481;&#12290;&#23454;&#20307;&#24517;&#39035;&#34987;&#26174;&#24335;&#30340;&#20445;&#23384;&#21644;&#21024;&#38500;(&#38500;&#38750;&#20445;&#23384;&#21644;&#21024;&#38500;&#26159;&#20174;&#29238;&#23454;&#20307;&#21521;&#23376;&#23454;&#20307;&#24341;&#21457;&#30340;<SPAN 
class=emphasis><EM>&#32423;&#32852;</EM></SPAN>)&#12290;&#36825;&#21644;ODMG&#27169;&#22411;&#20013;&#20851;&#20110;&#23545;&#35937;&#36890;&#36807;&#21487;&#35302;&#21450;&#20445;&#25345;&#25345;&#20037;&#24615;&#26377;&#19968;&#20123;&#19981;&#21516;——&#27604;&#36739;&#36215;&#26469;&#26356;&#21152;&#25509;&#36817;&#24212;&#29992;&#31243;&#24207;&#23545;&#35937;&#36890;&#24120;&#22312;&#19968;&#20010;&#22823;&#31995;&#32479;&#20013;&#30340;&#20351;&#29992;&#26041;&#27861;&#12290;&#23454;&#20307;&#25903;&#25345;&#24490;&#29615;&#24341;&#29992;&#21644;&#20132;&#21449;&#24341;&#29992;&#65292;&#23427;&#20204;&#20063;&#21487;&#20197;&#21152;&#19978;&#29256;&#26412;&#20449;&#24687;&#12290; 
</P>
<P>&#19968;&#20010;&#23454;&#20307;&#30340;&#25345;&#20037;&#29366;&#24577;&#21253;&#21547;&#25351;&#21521;&#20854;&#20182;&#23454;&#20307;&#21644;<SPAN 
class=emphasis><EM>&#20540;</EM></SPAN>&#31867;&#22411;&#23454;&#20363;&#30340;&#24341;&#29992;&#12290;&#20540;&#21487;&#20197;&#26159;&#21407;&#22987;&#31867;&#22411;&#65292;&#38598;&#21512;(&#19981;&#26159;&#38598;&#21512;&#20013;&#30340;&#23545;&#35937;)&#65292;&#32452;&#20214;&#25110;&#32773;&#29305;&#23450;&#30340;&#19981;&#21487;&#21464;&#23545;&#35937;&#12290;&#19982;&#23454;&#20307;&#19981;&#21516;&#65292;&#20540;(&#29305;&#21035;&#26159;&#38598;&#21512;&#21644;&#32452;&#20214;)&#26159;&#36890;&#36807;&#21487;&#35302;&#21450;&#24615;&#26469;&#36827;&#34892;&#25345;&#20037;&#21270;&#21644;&#21024;&#38500;&#30340;&#12290;&#22240;&#20026;&#20540;&#23545;&#35937;(&#21644;&#21407;&#22987;&#31867;&#22411;&#25968;&#25454;)&#26159;&#38543;&#30528;&#21253;&#21547;&#20182;&#20204;&#30340;&#23454;&#20307;&#32780;&#34987;&#25345;&#20037;&#21270;&#21644;&#21024;&#38500;&#30340;&#65292;&#20182;&#20204;&#19981;&#33021;&#34987;&#29420;&#31435;&#30340;&#21152;&#19978;&#29256;&#26412;&#20449;&#24687;&#12290;&#20540;&#27809;&#26377;&#29420;&#31435;&#30340;&#26631;&#35782;&#65292;&#25152;&#20197;&#20182;&#20204;&#19981;&#33021;&#34987;&#20004;&#20010;&#23454;&#20307;&#25110;&#32773;&#38598;&#21512;&#20849;&#20139;&#12290; 
</P>
<P>&#30452;&#21040;&#29616;&#22312;&#65292;&#25105;&#20204;&#37117;&#19968;&#30452;&#20351;&#29992;&#26415;&#35821;“&#25345;&#20037;&#31867;”(persistent class)&#26469;&#20195;&#34920;&#23454;&#20307;&#12290;&#25105;&#20204;&#20173;&#28982;&#20250;&#36825;&#20040;&#20570;&#12290; 
&#28982;&#32780;&#20005;&#26684;&#35828;&#26469;&#65292;&#19981;&#26159;&#25152;&#26377;&#30340;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#65292;&#24102;&#26377;&#25345;&#20037;&#21270;&#29366;&#24577;&#30340;&#31867;&#37117;&#26159;&#23454;&#20307;&#12290;<SPAN 
class=emphasis><EM>&#32452;&#20214;</EM></SPAN>&#23601;&#26159;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#65292;&#21364;&#26159;&#20540;&#35821;&#20041;&#30340;&#12290;<TT 
class=literal>java.lang.String</TT>&#31867;&#22411;&#30340;java&#23646;&#24615;&#20063;&#26159;&#20540;&#35821;&#20041;&#30340;&#12290;&#32473;&#20102;&#36825;&#20010;&#23450;&#20041;&#20197;&#21518;&#65292;&#25105;&#20204;&#21487;&#20197;&#35828;&#25152;&#26377;JDK&#25552;&#20379;&#30340;&#31867;&#22411;(&#31867;)&#37117;&#26159;&#20540;&#31867;&#22411;&#30340;&#35821;&#20041;&#65292;&#32780;&#29992;&#20110;&#33258;&#23450;&#20041;&#31867;&#22411;&#21487;&#33021;&#34987;&#26144;&#23556;&#20026;&#23454;&#20307;&#31867;&#22411;&#25110;&#20540;&#31867;&#22411;&#35821;&#20041;&#12290;&#37319;&#29992;&#21738;&#31181;&#31867;&#22411;&#30340;&#35821;&#20041;&#21462;&#20915;&#20110;&#24320;&#21457;&#20154;&#21592;&#12290;&#22312;&#39046;&#22495;&#27169;&#22411;&#20013;&#65292;&#23547;&#25214;&#23454;&#20307;&#31867;&#30340;&#19968;&#20010;&#22909;&#32447;&#32034;&#26159;&#20849;&#20139;&#24341;&#29992;&#25351;&#21521;&#36825;&#20010;&#31867;&#30340;&#21333;&#19968;&#23454;&#20363;&#65292;&#32780;&#32452;&#21512;&#25110;&#32858;&#21512;&#36890;&#24120;&#34987;&#36716;&#21270;&#20026;&#20540;&#31867;&#22411;&#12290; 
</P>
<P>&#25105;&#20204;&#20250;&#22312;&#26412;&#25991;&#26723;&#20013;&#37325;&#22797;&#30896;&#21040;&#36825;&#20004;&#20010;&#27010;&#24565;&#12290; </P>
<P>&#25361;&#25112;&#22312;&#20110;&#23558;java&#31867;&#22411;&#31995;&#32479;(&#21644;&#24320;&#21457;&#32773;&#23450;&#20041;&#30340;&#23454;&#20307;&#21644;&#20540;&#31867;&#22411;)&#26144;&#23556;&#21040; 
SQL/&#25968;&#25454;&#24211;&#31867;&#22411;&#31995;&#32479;&#12290;Hibernate&#25552;&#20379;&#20102;&#36830;&#25509;&#20004;&#20010;&#31995;&#32479;&#20043;&#38388;&#30340;&#26725;&#26753;&#65306;&#23545;&#20110;&#23454;&#20307;&#31867;&#22411;&#65292;&#25105;&#20204;&#20351;&#29992;<TT 
class=literal>&lt;class&gt;</TT>, <TT class=literal>&lt;subclass&gt;</TT> 
&#31561;&#31561;&#12290;&#23545;&#20110;&#20540;&#31867;&#22411;&#65292;&#25105;&#20204;&#20351;&#29992; <TT class=literal>&lt;property&gt;</TT>, <TT 
class=literal>&lt;component&gt;</TT> &#21450;&#20854;&#20182;&#65292;&#36890;&#24120;&#36319;&#38543;&#30528;<TT 
class=literal>type</TT>&#23646;&#24615;&#12290;&#36825;&#20010;&#23646;&#24615;&#30340;&#20540;&#26159;Hibernate &#30340;<SPAN 
class=emphasis><EM>&#26144;&#23556;&#31867;&#22411;</EM></SPAN>&#30340;&#21517;&#23383;&#12290;Hibernate&#25552;&#20379;&#20102;&#35768;&#22810;&#29616;&#25104;&#30340;&#26144;&#23556;(&#26631;&#20934;&#30340;JDK&#20540;&#31867;&#22411;)&#12290;&#20320;&#20063;&#21487;&#20197;&#32534;&#20889;&#33258;&#24049;&#30340;&#26144;&#23556;&#31867;&#22411;&#24182;&#23454;&#29616;&#33258;&#23450;&#20041;&#30340;&#21464;&#25442;&#31574;&#30053;&#65292;&#38543;&#21518;&#25105;&#20204;&#20250;&#30475;&#21040;&#36825;&#28857;&#12290; 
</P>
<P>&#25152;&#26377;&#30340;Hibernate&#20869;&#24314;&#31867;&#22411;&#65292;&#38500;&#20102;collections&#20197;&#22806;&#65292;&#37117;&#25903;&#25345;&#31354;(null)&#35821;&#20041;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-types-basictypes></A>5.2.2.&nbsp;&#22522;&#26412;&#20540;&#31867;&#22411;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20869;&#24314;&#30340; <SPAN class=emphasis><EM>&#22522;&#26412;&#26144;&#23556;&#31867;&#22411;</EM></SPAN>&#21487;&#20197;&#22823;&#33268;&#20998;&#20026; </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term><TT class=literal>integer, long, short, float, double, 
  character, byte, boolean, yes_no, true_false</TT></SPAN>
  <DD>
  <P>&#36825;&#20123;&#31867;&#22411;&#37117;&#23545;&#24212;Java&#30340;&#21407;&#22987;&#31867;&#22411;&#25110;&#32773;&#20854;&#23553;&#35013;&#31867;&#65292;&#26469;&#31526;&#21512;(&#29305;&#23450;&#21378;&#21830;&#30340;)SQL &#23383;&#27573;&#31867;&#22411;&#12290;<TT class=literal>boolean, 
  yes_no</TT> &#21644; <TT class=literal>true_false</TT>&#37117;&#26159;Java &#20013;<TT 
  class=literal>boolean</TT> &#25110;&#32773;<TT class=literal>java.lang.Boolean</TT>&#30340;&#21478;&#22806;&#35828;&#27861;&#12290; 
  </P>
  <DT><SPAN class=term><TT class=literal>string</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.lang.String</TT> &#21040; <TT class=literal>VARCHAR</TT> 
  (&#25110;&#32773; Oracle&#30340; <TT class=literal>VARCHAR2</TT>)&#30340;&#26144;&#23556;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>date, time, timestamp</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.util.Date</TT>&#21644;&#20854;&#23376;&#31867;&#21040;SQL&#31867;&#22411;<TT 
  class=literal>DATE</TT>, <TT class=literal>TIME</TT> &#21644;<TT 
  class=literal>TIMESTAMP</TT> (&#25110;&#31561;&#20215;&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>calendar, calendar_date</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.util.Calendar</TT> &#21040;SQL &#31867;&#22411;<TT 
  class=literal>TIMESTAMP</TT>&#21644; <TT class=literal>DATE</TT>(&#25110;&#31561;&#20215;&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>big_decimal, big_integer</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.math.BigDecimal</TT>&#21644;<TT 
  class=literal>java.math.BigInteger</TT>&#21040;<TT class=literal>NUMERIC</TT> (&#25110;&#32773; 
  Oracle &#30340;<TT class=literal>NUMBER</TT>&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>locale, timezone, currency</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.util.Locale</TT>, <TT 
  class=literal>java.util.TimeZone</TT> &#21644;<TT 
  class=literal>java.util.Currency</TT> &#21040;<TT class=literal>VARCHAR</TT> (&#25110;&#32773; 
  Oracle &#30340;<TT class=literal>VARCHAR2</TT>&#31867;&#22411;)&#30340;&#26144;&#23556;. <TT class=literal>Locale</TT>&#21644; 
  <TT class=literal>Currency</TT> &#30340;&#23454;&#20363;&#34987;&#26144;&#23556;&#20026;&#23427;&#20204;&#30340;ISO&#20195;&#30721;&#12290;<TT 
  class=literal>TimeZone</TT>&#30340;&#23454;&#20363;&#34987;&#24433;&#23556;&#20026;&#23427;&#30340;<TT class=literal>ID</TT>&#12290; </P>
  <DT><SPAN class=term><TT class=literal>class</TT></SPAN>
  <DD>
  <P>&#20174;<TT class=literal>java.lang.Class</TT> &#21040; <TT class=literal>VARCHAR</TT> 
  (&#25110;&#32773; Oracle &#30340;<TT class=literal>VARCHAR2</TT>&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290;<TT 
  class=literal>Class</TT>&#34987;&#26144;&#23556;&#20026;&#23427;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>binary</TT></SPAN>
  <DD>
  <P>&#25226;&#23383;&#33410;&#25968;&#32452;(byte arrays)&#26144;&#23556;&#20026;&#23545;&#24212;&#30340; SQL&#20108;&#36827;&#21046;&#31867;&#22411;&#12290; </P>
  <DT><SPAN class=term><TT class=literal>text</TT></SPAN>
  <DD>
  <P>&#25226;&#38271;Java&#23383;&#31526;&#20018;&#26144;&#23556;&#20026;SQL&#30340;<TT class=literal>CLOB</TT>&#25110;&#32773;<TT class=literal>TEXT</TT>&#31867;&#22411;&#12290; 
  </P>
  <DT><SPAN class=term><TT class=literal>serializable</TT></SPAN>
  <DD>
  <P>&#25226;&#21487;&#24207;&#21015;&#21270;&#30340;Java&#31867;&#22411;&#26144;&#23556;&#21040;&#23545;&#24212;&#30340;SQL&#20108;&#36827;&#21046;&#31867;&#22411;&#12290;&#20320;&#20063;&#21487;&#20197;&#20026;&#19968;&#20010;&#24182;&#38750;&#40664;&#35748;&#20026;&#22522;&#26412;&#31867;&#22411;&#30340;&#21487;&#24207;&#21015;&#21270;Java&#31867;&#25110;&#32773;&#25509;&#21475;&#25351;&#23450;Hibernate&#31867;&#22411;<TT 
  class=literal>serializable</TT>&#12290; </P>
  <DT><SPAN class=term><TT class=literal>clob, blob</TT></SPAN>
  <DD>
  <P>JDBC &#31867; <TT class=literal>java.sql.Clob</TT> &#21644; <TT 
  class=literal>java.sql.Blob</TT>&#30340;&#26144;&#23556;&#12290;&#26576;&#20123;&#31243;&#24207;&#21487;&#33021;&#19981;&#36866;&#21512;&#20351;&#29992;&#36825;&#20010;&#31867;&#22411;&#65292;&#22240;&#20026;blob&#21644;clob&#23545;&#35937;&#21487;&#33021;&#22312;&#19968;&#20010;&#20107;&#21153;&#20043;&#22806;&#26159;&#26080;&#27861;&#37325;&#29992;&#30340;&#12290;(&#32780;&#19988;, 
  &#39537;&#21160;&#31243;&#24207;&#23545;&#36825;&#31181;&#31867;&#22411;&#30340;&#25903;&#25345;&#20805;&#28385;&#30528;&#34917;&#19969;&#21644;&#21069;&#21518;&#30683;&#30462;&#12290;) </P>
  <DT><SPAN class=term><TT class=literal>imm_date, imm_time, imm_timestamp, 
  imm_calendar, imm_calendar_date, imm_serializable, imm_binary</TT> </SPAN>
  <DD>
  <P>&#19968;&#33324;&#26469;&#35828;&#65292;&#26144;&#23556;&#31867;&#22411;&#34987;&#20551;&#23450;&#20026;&#26159;&#21487;&#21464;&#30340;Java&#31867;&#22411;&#65292;&#21482;&#26377;&#23545;&#19981;&#21487;&#21464;Java&#31867;&#22411;&#65292;Hibernate&#20250;&#37319;&#21462;&#29305;&#23450;&#30340;&#20248;&#21270;&#25514;&#26045;&#65292;&#24212;&#29992;&#31243;&#24207;&#20250;&#25226;&#36825;&#20123;&#23545;&#35937;&#20316;&#20026;&#19981;&#21487;&#21464;&#23545;&#35937;&#22788;&#29702;&#12290;&#27604;&#22914;&#65292;&#20320;&#19981;&#24212;&#35813;&#23545;&#20316;&#20026;<TT 
  class=literal>imm_timestamp</TT>&#26144;&#23556;&#30340;Date&#25191;&#34892;<TT 
  class=literal>Date.setTime()</TT>&#12290;&#35201;&#25913;&#21464;&#23646;&#24615;&#30340;&#20540;&#65292;&#24182;&#19988;&#20445;&#23384;&#36825;&#19968;&#25913;&#21464;&#65292;&#24212;&#29992;&#31243;&#24207;&#24517;&#39035;&#23545;&#36825;&#19968;&#23646;&#24615;&#37325;&#26032;&#35774;&#32622;&#19968;&#20010;&#26032;&#30340;&#65288;&#19981;&#19968;&#26679;&#30340;&#65289;&#23545;&#35937;&#12290; 
  </P></DD></DL></DIV>
<P></P>
<P>&#23454;&#20307;&#21450;&#20854;&#38598;&#21512;&#30340;&#21807;&#19968;&#26631;&#35782;&#21487;&#20197;&#26159;&#38500;&#20102;<TT class=literal>binary</TT>&#12289; <TT class=literal>blob</TT> &#21644; 
<TT class=literal>clob</TT>&#20043;&#22806;&#30340;&#20219;&#20309;&#22522;&#30784;&#31867;&#22411;&#12290;(&#32852;&#21512;&#26631;&#35782;&#20063;&#26159;&#20801;&#35768;&#30340;&#65292;&#21518;&#38754;&#20250;&#35828;&#21040;&#12290;) </P>
<P>&#22312;<TT class=literal>org.hibernate.Hibernate</TT>&#20013;&#65292;&#23450;&#20041;&#20102;&#22522;&#30784;&#31867;&#22411;&#23545;&#24212;&#30340;<TT 
class=literal>Type</TT>&#24120;&#37327;&#12290;&#27604;&#22914;&#65292;<TT class=literal>Hibernate.STRING</TT>&#20195;&#34920;<TT 
class=literal>string</TT> &#31867;&#22411;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=mapping-types-custom></A>5.2.3.&nbsp;&#33258;&#23450;&#20041;&#20540;&#31867;&#22411;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24320;&#21457;&#32773;&#21019;&#24314;&#23646;&#20110;&#20182;&#20204;&#33258;&#24049;&#30340;&#20540;&#31867;&#22411;&#20063;&#26159;&#24456;&#23481;&#26131;&#30340;&#12290;&#27604;&#22914;&#35828;&#65292;&#20320;&#21487;&#33021;&#24076;&#26395;&#25345;&#20037;&#21270;<TT 
class=literal>java.lang.BigInteger</TT>&#31867;&#22411;&#30340;&#23646;&#24615;&#65292;&#25345;&#20037;&#21270;&#25104;&#20026;<TT 
class=literal>VARCHAR</TT>&#23383;&#27573;&#12290;Hibernate&#27809;&#26377;&#20869;&#32622;&#36825;&#26679;&#19968;&#31181;&#31867;&#22411;&#12290;&#33258;&#23450;&#20041;&#31867;&#22411;&#33021;&#22815;&#26144;&#23556;&#19968;&#20010;&#23646;&#24615;(&#25110;&#38598;&#21512;&#20803;&#32032;)&#21040;&#19981;&#27490;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#23383;&#27573;&#12290;&#27604;&#22914;&#35828;&#65292;&#20320;&#21487;&#33021;&#26377;&#36825;&#26679;&#30340;Java&#23646;&#24615;&#65306;<TT 
class=literal>getName()</TT>/<TT class=literal>setName()</TT>&#65292;&#36825;&#26159;<TT 
class=literal>java.lang.String</TT>&#31867;&#22411;&#30340;&#65292;&#23545;&#24212;&#30340;&#25345;&#20037;&#21270;&#21040;&#19977;&#20010;&#23383;&#27573;&#65306;<TT 
class=literal>FIRST_NAME</TT>, <TT class=literal>INITIAL</TT>, <TT 
class=literal>SURNAME</TT>&#12290; </P>
<P>&#35201;&#23454;&#29616;&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#21487;&#20197;&#23454;&#29616;<TT class=literal>org.hibernate.UserType</TT>&#25110;<TT 
class=literal>org.hibernate.CompositeUserType</TT>&#20013;&#30340;&#20219;&#19968;&#20010;&#65292;&#24182;&#19988;&#20351;&#29992;&#31867;&#22411;&#30340;Java&#20840;&#38480;&#23450;&#31867;&#21517;&#26469;&#23450;&#20041;&#23646;&#24615;&#12290;&#35831;&#26597;&#30475;<TT 
class=literal>org.hibernate.test.DoubleStringType</TT>&#36825;&#20010;&#20363;&#23376;&#65292;&#30475;&#30475;&#23427;&#26159;&#24590;&#20040;&#20570;&#30340;&#12290; </P><PRE class=programlisting>&lt;property name="twoStrings" type="org.hibernate.test.DoubleStringType"&gt;
    &lt;column name="first_string"/&gt;
    &lt;column name="second_string"/&gt;
&lt;/property&gt;</PRE>
<P>&#27880;&#24847;&#20351;&#29992;<TT class=literal>&lt;column&gt;</TT>&#26631;&#31614;&#26469;&#25226;&#19968;&#20010;&#23646;&#24615;&#26144;&#23556;&#21040;&#22810;&#20010;&#23383;&#27573;&#30340;&#20570;&#27861;&#12290; </P>
<P><TT class=literal>CompositeUserType</TT>, <TT 
class=literal>EnhancedUserType</TT>, <TT class=literal>UserCollectionType</TT>, 
&#21644; <TT class=literal>UserVersionType</TT> &#25509;&#21475;&#20026;&#26356;&#29305;&#27530;&#30340;&#20351;&#29992;&#26041;&#24335;&#25552;&#20379;&#25903;&#25345;&#12290; </P>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#22312;&#19968;&#20010;&#26144;&#23556;&#25991;&#20214;&#20013;&#25552;&#20379;&#21442;&#25968;&#32473;&#19968;&#20010;<TT class=literal>UserType</TT>&#12290; &#20026;&#20102;&#36825;&#26679;&#20570;&#65292;&#20320;&#30340;<TT 
class=literal>UserType</TT>&#24517;&#39035;&#23454;&#29616;<TT 
class=literal>org.hibernate.usertype.ParameterizedType</TT>&#25509;&#21475;&#12290;&#20026;&#20102;&#32473;&#33258;&#23450;&#20041;&#31867;&#22411;&#25552;&#20379;&#21442;&#25968;&#65292;&#20320;&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#20351;&#29992;<TT 
class=literal>&lt;type&gt;</TT>&#20803;&#32032;&#12290; </P><PRE class=programlisting>&lt;property name="priority"&gt;
    &lt;type name="com.mycompany.usertypes.DefaultValueIntegerType"&gt;
        &lt;param name="default"&gt;0&lt;/param&gt;
    &lt;/type&gt;
&lt;/property&gt;</PRE>
<P>&#29616;&#22312;&#65292;<TT class=literal>UserType</TT> &#21487;&#20197;&#20174;&#20256;&#20837;&#30340;<TT 
class=literal>Properties</TT>&#23545;&#35937;&#20013;&#24471;&#21040;<TT class=literal>default</TT> &#21442;&#25968;&#30340;&#20540;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#38750;&#24120;&#39057;&#32321;&#22320;&#20351;&#29992;&#26576;&#19968;<TT class=literal>UserType</TT>&#65292;&#21487;&#20197;&#20026;&#20182;&#23450;&#20041;&#19968;&#20010;&#31616;&#31216;&#12290;&#36825;&#21487;&#20197;&#36890;&#36807;&#20351;&#29992; <TT 
class=literal>&lt;typedef&gt;</TT>&#20803;&#32032;&#26469;&#23454;&#29616;&#12290;Typedefs&#20026;&#19968;&#33258;&#23450;&#20041;&#31867;&#22411;&#36171;&#20104;&#19968;&#20010;&#21517;&#31216;&#65292;&#24182;&#19988;&#22914;&#26524;&#27492;&#31867;&#22411;&#26159;&#21442;&#25968;&#21270;&#30340;&#65292;&#36824;&#21487;&#20197;&#21253;&#21547;&#19968;&#31995;&#21015;&#40664;&#35748;&#30340;&#21442;&#25968;&#20540;&#12290; 
</P><PRE class=programlisting>&lt;typedef class="com.mycompany.usertypes.DefaultValueIntegerType" name="default_zero"&gt;
    &lt;param name="default"&gt;0&lt;/param&gt;
&lt;/typedef&gt;</PRE><PRE class=programlisting>&lt;property name="priority" type="default_zero"/&gt;</PRE>
<P>&#20063;&#21487;&#20197;&#26681;&#25454;&#20855;&#20307;&#26696;&#20363;&#36890;&#36807;&#23646;&#24615;&#26144;&#23556;&#20013;&#30340;&#31867;&#22411;&#21442;&#25968;&#35206;&#30422;&#22312;typedef&#20013;&#25552;&#20379;&#30340;&#21442;&#25968;&#12290; </P>
<P>&#23613;&#31649; Hibernate &#20869;&#24314;&#30340;&#20016;&#23500;&#30340;&#31867;&#22411;&#21644;&#23545;&#32452;&#20214;&#30340;&#25903;&#25345;&#24847;&#21619;&#30528;&#20320;&#21487;&#33021;&#24456;&#23569; <SPAN 
class=emphasis><EM>&#38656;&#35201;</EM></SPAN>&#20351;&#29992;&#33258;&#23450;&#20041;&#31867;&#22411;&#12290;&#19981;&#36807;&#65292;&#20026;&#37027;&#20123;&#22312;&#20320;&#30340;&#24212;&#29992;&#20013;&#32463;&#24120;&#20986;&#29616;&#30340;(&#38750;&#23454;&#20307;)&#31867;&#20351;&#29992;&#33258;&#23450;&#20041;&#31867;&#22411;&#20063;&#26159;&#19968;&#20010;&#22909;&#26041;&#27861;&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;<TT 
class=literal>MonetaryAmount</TT>&#31867;&#20351;&#29992;<TT 
class=literal>CompositeUserType</TT>&#26469;&#26144;&#23556;&#26159;&#19981;&#38169;&#30340;&#36873;&#25321;&#65292;&#34429;&#28982;&#20182;&#21487;&#20197;&#24456;&#23481;&#26131;&#22320;&#34987;&#26144;&#23556;&#25104;&#32452;&#20214;&#12290;&#36825;&#26679;&#20570;&#30340;&#21160;&#26426;&#20043;&#19968;&#26159;&#25277;&#35937;&#12290;&#20351;&#29992;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#20197;&#21518;&#20551;&#33509;&#20320;&#25913;&#21464;&#34920;&#31034;&#37329;&#39069;&#30340;&#26041;&#27861;&#26102;&#65292;&#23427;&#21487;&#20197;&#20445;&#35777;&#26144;&#23556;&#25991;&#20214;&#19981;&#38656;&#35201;&#20462;&#25913;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-entityname></A>5.3.&nbsp;&#22810;&#27425;&#26144;&#23556;&#21516;&#19968;&#20010;&#31867;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#29305;&#23450;&#30340;&#25345;&#20037;&#21270;&#31867;&#65292;&#26144;&#23556;&#22810;&#27425;&#26159;&#20801;&#35768;&#30340;&#12290;&#36825;&#31181;&#24773;&#24418;&#19979;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<SPAN class=emphasis><EM>entity 
name</EM></SPAN>&#26469;&#21306;&#21035;&#19981;&#21516;&#26144;&#23556;&#23454;&#20307;&#30340;&#23545;&#35937;&#23454;&#20363;&#12290;&#65288;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#23454;&#20307;&#21517;&#23383;&#21644;&#31867;&#21517;&#26159;&#30456;&#21516;&#30340;&#12290;&#65289; 
Hibernate&#22312;&#25805;&#20316;&#25345;&#20037;&#21270;&#23545;&#35937;&#12289;&#32534;&#20889;&#26597;&#35810;&#26465;&#20214;&#65292;&#25110;&#32773;&#25226;&#20851;&#32852;&#26144;&#23556;&#21040;&#25351;&#23450;&#23454;&#20307;&#26102;&#65292;&#20801;&#35768;&#20320;&#25351;&#23450;&#36825;&#20010;entity name&#65288;&#23454;&#20307;&#21517;&#23383;&#65289;&#12290; </P><PRE class=programlisting>&lt;class name="Contract" table="Contracts" 
        entity-name="CurrentContract"&gt;
    ...
    &lt;set name="history" inverse="true" 
            order-by="effectiveEndDate desc"&gt;
        &lt;key column="currentContractId"/&gt;
        &lt;one-to-many entity-name="HistoricalContract"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Contract" table="ContractHistory" 
        entity-name="HistoricalContract"&gt;
    ...
    &lt;many-to-one name="currentContract" 
            column="currentContractId" 
            entity-name="CurrentContract"/&gt;
&lt;/class&gt;</PRE>
<P>&#27880;&#24847;&#36825;&#37324;&#20851;&#32852;&#26159;&#22914;&#20309;&#29992;<TT class=literal>entity-name</TT>&#26469;&#20195;&#26367;<TT class=literal>class</TT>&#30340;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-quotedidentifiers></A>5.4.&nbsp;SQL&#20013;&#24341;&#21495;&#21253;&#22260;&#30340;&#26631;&#35782;&#31526;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#36890;&#36807;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#20351;&#29992;&#21453;&#21521;&#24341;&#21495;(`)&#25226;&#34920;&#21517;&#25110;&#32773;&#23383;&#27573;&#21517;&#21253;&#22260;&#36215;&#26469;&#65292;&#20197;&#24378;&#21046;Hibernate&#22312;&#29983;&#25104;&#30340;SQL&#20013;&#25226;&#26631;&#35782;&#31526;&#29992;&#24341;&#21495;&#21253;&#22260;&#36215;&#26469;&#12290;Hibernate&#20250;&#20351;&#29992;&#30456;&#24212;&#30340;SQL<TT 
class=literal>Dialect</TT>(&#26041;&#35328;)&#26469;&#20351;&#29992;&#27491;&#30830;&#30340;&#24341;&#21495;&#39118;&#26684;(&#36890;&#24120;&#26159;&#21452;&#24341;&#21495;&#65292;&#20294;&#26159;&#22312;SQL Server&#20013;&#26159;&#25324;&#21495;&#65292;MySQL&#20013;&#26159;&#21453;&#21521;&#24341;&#21495;)&#12290; 
</P><PRE class=programlisting>&lt;class name="LineItem" table="`Line Item`"&gt;
    &lt;id name="id" column="`Item Id`"/&gt;&lt;generator class="assigned"/&gt;&lt;/id&gt;
    &lt;property name="itemNumber" column="`Item #`"/&gt;
    ...
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-alternatives></A>5.5.&nbsp;&#20854;&#20182;&#20803;&#25968;&#25454;(Metadata)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>XML &#24182;&#19981;&#36866;&#29992;&#20110;&#25152;&#26377;&#20154;, &#22240;&#27492;&#26377;&#20854;&#20182;&#23450;&#20041;Hibernate O/R &#26144;&#23556;&#20803;&#25968;&#25454;(metadata)&#30340;&#26041;&#27861;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=mapping-xdoclet></A>5.5.1.&nbsp;&#20351;&#29992; XDoclet 
&#26631;&#35760;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24456;&#22810;Hibernate&#20351;&#29992;&#32773;&#26356;&#21916;&#27426;&#20351;&#29992;XDoclet<TT 
class=literal>@hibernate.tags</TT>&#23558;&#26144;&#23556;&#20449;&#24687;&#30452;&#25509;&#23884;&#20837;&#21040;&#28304;&#20195;&#30721;&#20013;&#12290;&#25105;&#20204;&#19981;&#20250;&#22312;&#26412;&#25991;&#26723;&#20013;&#28041;&#21450;&#36825;&#20010;&#26041;&#27861;&#65292;&#22240;&#20026;&#20005;&#26684;&#35828;&#26469;&#65292;&#36825;&#23646;&#20110;XDoclet&#30340;&#19968;&#37096;&#20998;&#12290;&#28982;&#32780;&#65292;&#25105;&#20204;&#21253;&#21547;&#20102;&#22914;&#19979;&#20351;&#29992;XDoclet&#26144;&#23556;&#30340;<TT 
class=literal>Cat</TT>&#31867;&#30340;&#20363;&#23376;&#12290; </P><PRE class=programlisting>package eg;
import java.util.Set;
import java.util.Date;

/**
 * @hibernate.class
 *  table="CATS"
 */
public class Cat {
    private Long id; // identifier
    private Date birthdate;
    private Cat mother;
    private Set kittens
    private Color color;
    private char sex;
    private float weight;

    /*
     * @hibernate.id
     *  generator-class="native"
     *  column="CAT_ID"
     */
    public Long getId() {
        return id;
    }
    private void setId(Long id) {
        this.id=id;
    }

    /**
     * @hibernate.many-to-one
     *  column="PARENT_ID"
     */
    public Cat getMother() {
        return mother;
    }
    void setMother(Cat mother) {
        this.mother = mother;
    }

    /**
     * @hibernate.property
     *  column="BIRTH_DATE"
     */
    public Date getBirthdate() {
        return birthdate;
    }
    void setBirthdate(Date date) {
        birthdate = date;
    }
    /**
     * @hibernate.property
     *  column="WEIGHT"
     */
    public float getWeight() {
        return weight;
    }
    void setWeight(float weight) {
        this.weight = weight;
    }

    /**
     * @hibernate.property
     *  column="COLOR"
     *  not-null="true"
     */
    public Color getColor() {
        return color;
    }
    void setColor(Color color) {
        this.color = color;
    }
    /**
     * @hibernate.set
     *  inverse="true"
     *  order-by="BIRTH_DATE"
     * @hibernate.collection-key
     *  column="PARENT_ID"
     * @hibernate.collection-one-to-many
     */
    public Set getKittens() {
        return kittens;
    }
    void setKittens(Set kittens) {
        this.kittens = kittens;
    }
    // addKitten not needed by Hibernate
    public void addKitten(Cat kitten) {
        kittens.add(kitten);
    }

    /**
     * @hibernate.property
     *  column="SEX"
     *  not-null="true"
     *  update="false"
     */
    public char getSex() {
        return sex;
    }
    void setSex(char sex) {
        this.sex=sex;
    }
}</PRE>
<P>&#21442;&#32771;Hibernate&#32593;&#31449;&#26356;&#22810;&#30340;Xdoclet&#21644;Hibernate&#30340;&#20363;&#23376; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=mapping-annotations></A>5.5.2.&nbsp;&#20351;&#29992; JDK 5.0 
&#30340;&#27880;&#35299;(Annotation)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>JDK 5.0 &#22312;&#35821;&#35328;&#32423;&#21035;&#24341;&#20837;&#20102; XDoclet 
&#39118;&#26684;&#30340;&#26631;&#27880;&#65292;&#24182;&#19988;&#26159;&#31867;&#22411;&#23433;&#20840;&#30340;&#65292;&#22312;&#32534;&#35793;&#26399;&#36827;&#34892;&#26816;&#26597;&#12290;&#36825;&#19968;&#26426;&#21046;&#27604;XDoclet&#30340;&#27880;&#35299;&#26356;&#20026;&#24378;&#22823;&#65292;&#26377;&#26356;&#22909;&#30340;&#24037;&#20855;&#21644;IDE&#25903;&#25345;&#12290;&#20363;&#22914;&#65292; IntelliJ IDEA&#65292;&#25903;&#25345;JDK 
5.0&#27880;&#35299;&#30340;&#33258;&#21160;&#23436;&#25104;&#21644;&#35821;&#27861;&#39640;&#20142; &#12290;EJB&#35268;&#33539;&#30340;&#26032;&#20462;&#35746;&#29256;(JSR-220)&#20351;&#29992; JDK 5.0&#30340;&#27880;&#35299;&#20316;&#20026;entity 
beans&#30340;&#20027;&#35201;&#20803;&#25968;&#25454;(metadata)&#26426;&#21046;&#12290;Hibernate 3 &#23454;&#29616;&#20102;JSR-220 (the persistence API)&#30340;<TT 
class=literal>EntityManager</TT>&#65292;&#25903;&#25345;&#36890;&#36807;<SPAN class=emphasis><EM>Hibernate 
Annotations</EM></SPAN>&#21253;&#23450;&#20041;&#26144;&#23556;&#20803;&#25968;&#25454;&#12290;&#36825;&#20010;&#21253;&#20316;&#20026;&#21333;&#29420;&#30340;&#37096;&#20998;&#19979;&#36733;&#65292;&#25903;&#25345;EJB3 (JSR-220)&#21644;Hibernate3&#30340;&#20803;&#25968;&#25454;&#12290; 
</P>
<P>&#36825;&#26159;&#19968;&#20010;&#34987;&#27880;&#35299;&#20026;EJB entity bean &#30340;POJO&#31867;&#30340;&#20363;&#23376; </P><PRE class=programlisting>@Entity(access = AccessType.FIELD)
public class Customer implements Serializable {

    @Id;
    Long id;

    String firstName;
    String lastName;
    Date birthday;

    @Transient
    Integer age;

    @Embedded
    private Address homeAddress;

    @OneToMany(cascade=CascadeType.ALL)
    @JoinColumn(name="CUSTOMER_ID")
    Set&lt;Order&gt; orders;

    // Getter/setter and business methods
}</PRE>
<P>&#27880;&#24847;&#65306;&#23545; JDK 5.0 &#27880;&#35299; (&#21644; JSR-220)&#25903;&#25345;&#30340;&#24037;&#20316;&#20173;&#28982;&#22312;&#36827;&#34892;&#20013;,&#24182;&#26410;&#23436;&#25104;&#12290;&#26356;&#22810;&#32454;&#33410;&#35831;&#21442;&#38405;Hibernate Annotations &#27169;&#22359;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-generated></A>5.6.&nbsp;&#25968;&#25454;&#24211;&#29983;&#25104;&#23646;&#24615;&#65288;Generated 
Properties&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Generated properties&#25351;&#30340;&#26159;&#20854;&#20540;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#30340;&#23646;&#24615;&#12290;&#19968;&#33324;&#26469;&#35828;&#65292;&#22914;&#26524;&#23545;&#35937;&#26377;&#20219;&#20309;&#23646;&#24615;&#30001;&#25968;&#25454;&#24211;&#29983;&#25104;&#20540;&#65292;Hibernate&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#36827;&#34892;<TT 
class=literal>&#21047;&#26032;(refresh)</TT>&#12290;&#20294;&#22914;&#26524;&#25226;&#23646;&#24615;&#26631;&#26126;&#20026;generated&#65292;&#23601;&#21487;&#20197;&#36716;&#30001;Hibernate&#26469;&#36127;&#36131;&#36825;&#20010;&#21160;&#20316;&#12290;&#23454;&#38469;&#19978;&#12290;&#23545;&#23450;&#20041;&#20102;generated 
properties&#30340;&#23454;&#20307;,&#27599;&#24403;Hibernate&#25191;&#34892;&#19968;&#26465;SQL INSERT&#25110;&#32773;UPDATE&#35821;&#21477;&#65292;&#20250;&#31435;&#21051;&#25191;&#34892;&#19968;&#26465;select&#26469;&#33719;&#24471;&#29983;&#25104;&#30340;&#20540;&#12290; </P>
<P>&#34987;&#26631;&#26126;&#20026;generated&#30340;&#23646;&#24615;&#36824;&#24517;&#39035;&#26159; non-insertable&#21644; non-updateable&#30340;&#12290;&#21482;&#26377;<A 
title=5.1.7.&nbsp;&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;) 
href="#mapping-declaration-version">&#31532;&nbsp;5.1.7&nbsp;&#33410; “&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)”</A>&#65292;<A 
title="5.1.8.&nbsp;timestamp (&#21487;&#36873;)" 
href="#mapping-declaration-timestamp">&#31532;&nbsp;5.1.8&nbsp;&#33410; “timestamp 
(&#21487;&#36873;)”</A>&#21644;<A title=5.1.9.&nbsp;property 
href="#mapping-declaration-property">&#31532;&nbsp;5.1.9&nbsp;&#33410; 
“property”</A>&#21487;&#20197;&#34987;&#26631;&#26126;&#20026;generated&#12290; </P>
<P><TT class=literal>never</TT> (&#40664;&#35748;) &#26631;&#26126;&#27492;&#23646;&#24615;&#20540;&#19981;&#26159;&#20174;&#25968;&#25454;&#24211;&#20013;&#29983;&#25104;&#12290; </P>
<P><TT class=literal>insert</TT> - 
&#26631;&#26126;&#27492;&#23646;&#24615;&#20540;&#22312;insert&#30340;&#26102;&#20505;&#29983;&#25104;&#65292;&#20294;&#26159;&#19981;&#20250;&#22312;&#38543;&#21518;&#30340;update&#26102;&#37325;&#26032;&#29983;&#25104;&#12290;&#27604;&#22914;&#35828;&#21019;&#24314;&#26085;&#26399;&#23601;&#24402;&#23646;&#20110;&#36825;&#31867;&#12290;&#27880;&#24847;&#34429;&#28982;<A 
title=5.1.7.&nbsp;&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;) 
href="#mapping-declaration-version">&#31532;&nbsp;5.1.7&nbsp;&#33410; “&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)”</A>&#21644;<A 
title="5.1.8.&nbsp;timestamp (&#21487;&#36873;)" 
href="#mapping-declaration-timestamp">&#31532;&nbsp;5.1.8&nbsp;&#33410; “timestamp 
(&#21487;&#36873;)”</A>&#23646;&#24615;&#21487;&#20197;&#34987;&#26631;&#27880;&#20026;generated&#65292;&#20294;&#26159;&#19981;&#36866;&#29992;&#36825;&#20010;&#36873;&#39033;... </P>
<P><TT class=literal>always</TT> - &#26631;&#26126;&#27492;&#23646;&#24615;&#20540;&#22312;insert&#21644;update&#26102;&#37117;&#20250;&#34987;&#29983;&#25104;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=mapping-database-object></A>5.7.&nbsp;&#36741;&#21161;&#25968;&#25454;&#24211;&#23545;&#35937;(Auxiliary Database 
Objects)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Allows CREATE and DROP of arbitrary database objects, in conjunction with 
Hibernate's schema evolution tools, to provide the ability to fully define a 
user schema within the Hibernate mapping files. Although designed specifically 
for creating and dropping things like triggers or stored procedures, really any 
SQL command that can be run via a <TT 
class=literal>java.sql.Statement.execute()</TT> method is valid here (ALTERs, 
INSERTS, etc). There are essentially two modes for defining auxiliary database 
objects... 
&#24110;&#21161;CREATE&#21644;DROP&#20219;&#24847;&#25968;&#25454;&#24211;&#23545;&#35937;&#65292;&#19982;Hibernate&#30340;schema&#20132;&#20114;&#24037;&#20855;&#32452;&#21512;&#36215;&#26469;&#65292;&#21487;&#20197;&#25552;&#20379;&#22312;Hibernate&#26144;&#23556;&#25991;&#20214;&#20013;&#23436;&#20840;&#23450;&#20041;&#29992;&#25143;schema&#30340;&#33021;&#21147;&#12290;&#34429;&#28982;&#36825;&#26159;&#20026;&#21019;&#24314;&#21644;&#38144;&#27585;trigger(&#35302;&#21457;&#22120;&#65289;&#25110;stored 
procedure(&#23384;&#20648;&#36807;&#31243;&#65289;&#31561;&#29305;&#21035;&#35774;&#35745;&#30340;&#65292;&#23454;&#38469;&#19978;&#20219;&#20309;&#21487;&#20197;&#22312;<TT 
class=literal>java.sql.Statement.execute()</TT>&#26041;&#27861;&#20013;&#25191;&#34892;&#30340;SQL&#21629;&#20196;&#37117;&#21487;&#20197;&#22312;&#27492;&#20351;&#29992;&#65288;&#27604;&#22914;ALTER, 
INSERT&#65292;&#31561;&#31561;&#65289;&#12290;&#26412;&#36136;&#19978;&#26377;&#20004;&#31181;&#27169;&#24335;&#26469;&#23450;&#20041;&#36741;&#21161;&#25968;&#25454;&#24211;&#23545;&#35937;... </P>
<P>&#31532;&#19968;&#31181;&#27169;&#24335;&#26159;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#26174;&#24335;&#22768;&#26126;CREATE&#21644;DROP&#21629;&#20196;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;create&gt;CREATE TRIGGER my_trigger ...&lt;/create&gt;
        &lt;drop&gt;DROP TRIGGER my_trigger&lt;/drop&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</PRE>
<P>&#31532;&#20108;&#31181;&#27169;&#24335;&#26159;&#25552;&#20379;&#19968;&#20010;&#31867;&#65292;&#36825;&#20010;&#31867;&#30693;&#36947;&#22914;&#20309;&#32452;&#32455;CREATE&#21644;DROP&#21629;&#20196;&#12290;&#36825;&#20010;&#29305;&#21035;&#31867;&#24517;&#39035;&#23454;&#29616;<TT 
class=literal>org.hibernate.mapping.AuxiliaryDatabaseObject</TT>&#25509;&#21475;&#12290; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;definition class="MyTriggerDefinition"/&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</PRE>
<P>&#36824;&#26377;&#65292;&#36825;&#20123;&#25968;&#25454;&#24211;&#23545;&#35937;&#21487;&#20197;&#29305;&#21035;&#25351;&#23450;&#20026;&#20165;&#22312;&#29305;&#23450;&#30340;&#26041;&#35328;&#20013;&#25165;&#20351;&#29992;&#12290; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;definition class="MyTriggerDefinition"/&gt;
        &lt;dialect-scope name="org.hibernate.dialect.Oracle9Dialect"/&gt;
        &lt;dialect-scope name="org.hibernate.dialect.OracleDialect"/&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=collections></A>&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=collections-persistent></A>6.1.&nbsp;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;(Persistent 
collections)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><A 
name=collections-persistent-translate-comment></A>(&#35793;&#32773;&#27880;&#65306;&#22312;&#38405;&#35835;&#26412;&#31456;&#30340;&#26102;&#20505;&#65292;&#20197;&#21518;&#25972;&#20010;&#25163;&#20876;&#30340;&#38405;&#35835;&#36807;&#31243;&#20013;&#65292;&#25105;&#20204;&#37117;&#20250;&#38754;&#20020;&#19968;&#20010;&#21517;&#35789;&#26041;&#38754;&#30340;&#38382;&#39064;&#65292;&#37027;&#23601;&#26159;“&#38598;&#21512;”&#12290;"Collections"&#21644;"Set"&#22312;&#20013;&#25991;&#37324;&#23545;&#24212;&#37117;&#34987;&#32763;&#35793;&#20026;“&#38598;&#21512;”&#65292;&#20294;&#26159;&#20182;&#20204;&#30340;&#21547;&#20041;&#24456;&#19981;&#19968;&#26679;&#12290;Collections&#26159;&#19968;&#20010;&#36229;&#38598;&#65292;Set&#26159;&#20854;&#20013;&#30340;&#19968;&#31181;&#12290;&#22823;&#37096;&#20998;&#24773;&#20917;&#19979;&#65292;&#26412;&#35793;&#31295;&#20013;&#27867;&#25351;&#30340;&#26410;&#21152;&#33521;&#25991;&#27880;&#26126;&#30340;“&#38598;&#21512;”&#65292;&#37117;&#24212;&#24403;&#29702;&#35299;&#20026;“Collections”&#12290;&#22312;&#26377;&#20123;&#20108;&#32773;&#21516;&#26102;&#20986;&#29616;&#65292;&#21487;&#33021;&#36896;&#25104;&#28151;&#28102;&#30340;&#22320;&#26041;&#65292;&#25105;&#20204;&#29992;“&#38598;&#21512;&#31867;”&#26469;&#29305;&#25351;“Collecions”,“&#38598;&#21512;(Set)”&#26469;&#25351;"Set"&#65292;&#19968;&#33324;&#37117;&#20250;&#22312;&#21518;&#38754;&#30340;&#25324;&#21495;&#20013;&#32473;&#20986;&#33521;&#25991;&#12290;&#24076;&#26395;&#22823;&#23478;&#22312;&#38405;&#35835;&#26102;&#32852;&#31995;&#19978;&#19979;&#25991;&#29702;&#35299;&#65292;&#19981;&#35201;&#36896;&#25104;&#35823;&#35299;&#12290; 
&#19982;&#27492;&#21516;&#26102;&#65292;“&#20803;&#32032;”&#19968;&#35789;&#23545;&#24212;&#30340;&#33521;&#25991;“element”&#65292;&#20063;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#21547;&#20041;&#12290;&#20854;&#19968;&#20026;&#38598;&#21512;&#30340;&#20803;&#32032;&#65292;&#26159;&#20869;&#23384;&#20013;&#30340;&#19968;&#20010;&#21464;&#37327;&#65307;&#21478;&#19968;&#21547;&#20041;&#21017;&#26159;XML&#25991;&#26723;&#20013;&#30340;&#19968;&#20010;&#26631;&#31614;&#25152;&#20195;&#34920;&#30340;&#20803;&#32032;&#12290;&#20063;&#35831;&#27880;&#24847;&#21306;&#21035;&#12290; 
&#26412;&#31456;&#20013;,&#29305;&#21035;&#26159;&#21518;&#21322;&#37096;&#20998;&#26159;&#38656;&#35201;&#21453;&#22797;&#38405;&#35835;&#25165;&#33021;&#29702;&#35299;&#28165;&#26970;&#30340;&#12290;&#22914;&#26524;&#36935;&#21040;&#20219;&#20309;&#30097;&#38382;,&#35831;&#35760;&#20303;,&#33521;&#25991;&#29256;&#26412;&#30340;reference&#26159;&#24799;&#19968;&#26631;&#20934;&#30340;&#21442;&#32771;&#36164;&#26009;&#12290;) </P>
<P>Hibernate&#35201;&#27714;&#25345;&#20037;&#21270;&#38598;&#21512;&#20540;&#23383;&#27573;&#24517;&#39035;&#22768;&#26126;&#20026;&#25509;&#21475;&#65292;&#27604;&#22914;&#65306; </P><PRE class=programlisting>public class Product {
    private String serialNumber;
    private Set parts = new HashSet();
    
    public Set getParts() { return parts; }
    void setParts(Set parts) { this.parts = parts; }
    public String getSerialNumber() { return serialNumber; }
    void setSerialNumber(String sn) { serialNumber = sn; }
}</PRE>
<P>&#23454;&#38469;&#30340;&#25509;&#21475;&#21487;&#33021;&#26159;<TT class=literal>java.util.Set</TT>, <TT 
class=literal>java.util.Collection</TT>, <TT class=literal>java.util.List</TT>, 
<TT class=literal>java.util.Map</TT>, <TT 
class=literal>java.util.SortedSet</TT>, <TT 
class=literal>java.util.SortedMap</TT> &#25110;&#32773;...&#20219;&#20309;&#20320;&#21916;&#27426;&#30340;&#31867;&#22411;&#65281;("&#20219;&#20309;&#20320;&#21916;&#27426;&#30340;&#31867;&#22411;" &#20195;&#34920;&#20320;&#38656;&#35201;&#32534;&#20889; <TT 
class=literal>org.hibernate.usertype.UserCollectionType</TT>&#30340;&#23454;&#29616;.) </P>
<P>&#27880;&#24847;&#25105;&#20204;&#26159;&#22914;&#20309;&#29992;&#19968;&#20010;<TT 
class=literal>HashSet</TT>&#23454;&#20363;&#26469;&#21021;&#22987;&#21270;&#23454;&#20363;&#21464;&#37327;&#30340;.&#36825;&#26159;&#29992;&#20110;&#21021;&#22987;&#21270;&#26032;&#21019;&#24314;(&#23578;&#26410;&#25345;&#20037;&#21270;)&#30340;&#31867;&#23454;&#20363;&#20013;&#38598;&#21512;&#20540;&#23646;&#24615;&#30340;&#26368;&#20339;&#26041;&#27861;&#12290;&#24403;&#20320;&#25345;&#20037;&#21270;&#36825;&#20010;&#23454;&#20363;&#26102;——&#27604;&#22914;&#36890;&#36807;&#35843;&#29992;<TT 
class=literal>persist()</TT>——Hibernate &#20250;&#33258;&#21160;&#25226;<TT 
class=literal>HashSet</TT>&#26367;&#25442;&#20026;Hibernate&#33258;&#24049;&#30340;<TT class=literal>Set</TT>&#23454;&#29616;&#12290;&#35266;&#23519;&#19979;&#38754;&#30340;&#38169;&#35823;&#65306; 
</P><PRE class=programlisting>Cat cat = new DomesticCat();
Cat kitten = new DomesticCat();
....
Set kittens = new HashSet();
kittens.add(kitten);
cat.setKittens(kittens);
session.persist(cat);
kittens = cat.getKittens(); //Okay, kittens collection is a Set
(HashSet) cat.getKittens(); //Error!</PRE>
<P>&#26681;&#25454;&#19981;&#21516;&#30340;&#25509;&#21475;&#31867;&#22411;&#65292;&#34987;Hibernate&#27880;&#23556;&#30340;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;&#30340;&#34920;&#29616;&#31867;&#20284;<TT class=literal>HashMap</TT>, <TT 
class=literal>HashSet</TT>, <TT class=literal>TreeMap</TT>, <TT 
class=literal>TreeSet</TT> or <TT class=literal>ArrayList</TT>&#12290; </P>
<P>&#38598;&#21512;&#31867;&#23454;&#20363;&#20855;&#26377;&#20540;&#31867;&#22411;&#30340;&#36890;&#24120;&#34892;&#20026;&#12290;&#24403;&#34987;&#25345;&#20037;&#21270;&#23545;&#35937;&#24341;&#29992;&#21518;&#65292;&#20182;&#20204;&#20250;&#33258;&#21160;&#34987;&#25345;&#20037;&#21270;&#65292;&#24403;&#19981;&#20877;&#34987;&#24341;&#29992;&#21518;&#65292;&#33258;&#21160;&#34987;&#21024;&#38500;&#12290;&#20551;&#33509;&#23454;&#20363;&#34987;&#20174;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;&#20256;&#36882;&#21040;&#21478;&#19968;&#20010;&#65292;&#23427;&#30340;&#20803;&#32032;&#21487;&#33021;&#20174;&#19968;&#20010;&#34920;&#36716;&#31227;&#21040;&#21478;&#19968;&#20010;&#34920;&#12290;&#20004;&#20010;&#23454;&#20307;&#19981;&#33021;&#20849;&#20139;&#21516;&#19968;&#20010;&#38598;&#21512;&#31867;&#23454;&#20363;&#30340;&#24341;&#29992;&#12290;&#22240;&#20026;&#24213;&#23618;&#20851;&#31995;&#25968;&#25454;&#24211;&#27169;&#22411;&#30340;&#21407;&#22240;&#65292;&#38598;&#21512;&#20540;&#23646;&#24615;&#26080;&#27861;&#25903;&#25345;&#31354;&#20540;&#35821;&#20041;&#65307;Hibernate&#23545;&#31354;&#30340;&#38598;&#21512;&#24341;&#29992;&#21644;&#31354;&#38598;&#21512;&#19981;&#21152;&#21306;&#21035;&#12290; 
</P>
<P>&#20320;&#19981;&#38656;&#35201;&#36807;&#22810;&#30340;&#20026;&#27492;&#25285;&#24515;&#12290;&#23601;&#22914;&#21516;&#20320;&#24179;&#26102;&#20351;&#29992;&#26222;&#36890;&#30340;Java&#38598;&#21512;&#31867;&#19968;&#26679;&#26469;&#20351;&#29992;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;&#12290;&#21482;&#26159;&#35201;&#30830;&#35748;&#20320;&#29702;&#35299;&#20102;&#21452;&#21521;&#20851;&#32852;&#30340;&#35821;&#20041;&#65288;&#21518;&#25991;&#35752;&#35770;&#65289;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=collections-mapping></A>6.2.&nbsp;&#38598;&#21512;&#26144;&#23556;&#65288; Collection mappings 
&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#29992;&#20110;&#26144;&#23556;&#38598;&#21512;&#31867;&#30340;Hibernate&#26144;&#23556;&#20803;&#32032;&#21462;&#20915;&#20110;&#25509;&#21475;&#30340;&#31867;&#22411;&#12290;&#27604;&#22914;&#65292; <TT class=literal>&lt;set&gt;</TT> 
&#20803;&#32032;&#29992;&#26469;&#26144;&#23556;<TT class=literal>Set</TT>&#31867;&#22411;&#30340;&#23646;&#24615;&#12290; </P><PRE class=programlisting>&lt;class name="Product"&gt;
    &lt;id name="serialNumber" column="productSerialNumber"/&gt;
    &lt;set name="parts"&gt;
        &lt;key column="productSerialNumber" not-null="true"/&gt;
        &lt;one-to-many class="Part"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE>
<P>&#38500;&#20102;<TT class=literal>&lt;set&gt;</TT>,&#36824;&#26377;<TT class=literal>&lt;list&gt;</TT>, 
<TT class=literal>&lt;map&gt;</TT>, <TT class=literal>&lt;bag&gt;</TT>, <TT 
class=literal>&lt;array&gt;</TT> &#21644; <TT 
class=literal>&lt;primitive-array&gt;</TT> &#26144;&#23556;&#20803;&#32032;&#12290;<TT 
class=literal>&lt;map&gt;</TT>&#20855;&#26377;&#20195;&#34920;&#24615;&#65306; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;map
    name="propertyName"                                         <SPAN class=co>(1)</SPAN>
    table="table_name"                                          <SPAN class=co>(2)</SPAN>
    schema="schema_name"                                        <SPAN class=co>(3)</SPAN>
    lazy="true|extra|false"                                     <SPAN class=co>(4)</SPAN>
    inverse="true|false"                                        <SPAN class=co>(5)</SPAN>
    cascade="all|none|save-update|delete|all-delete-orphan|delet<SPAN class=co>(6)</SPAN>e-orphan"
    sort="unsorted|natural|comparatorClass"                     <SPAN class=co>(7)</SPAN>
    order-by="column_name asc|desc"                             <SPAN class=co>(8)</SPAN>
    where="arbitrary sql where condition"                       <SPAN class=co>(9)</SPAN>
    fetch="join|select|subselect"                               <SPAN class=co>(10)</SPAN>
    batch-size="N"                                              <SPAN class=co>(11)</SPAN>
    access="field|property|ClassName"                           <SPAN class=co>(12)</SPAN>
    optimistic-lock="true|false"                                <SPAN class=co>(13)</SPAN>
    mutable="true|false"                                        <SPAN class=co>(14)</SPAN>
    node="element-name|."
    embed-xml="true|false"
&gt;

    &lt;key .... /&gt;
    &lt;map-key .... /&gt;
    &lt;element .... /&gt;
&lt;/map&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>name</TT> &#38598;&#21512;&#23646;&#24615;&#30340;&#21517;&#31216; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>table</TT> &#65288;&#21487;&#36873;——&#40664;&#35748;&#20026;&#23646;&#24615;&#30340;&#21517;&#31216;&#65289;&#36825;&#20010;&#38598;&#21512;&#34920;&#30340;&#21517;&#31216;(&#19981;&#33021;&#22312;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#20851;&#31995;&#20013;&#20351;&#29992;) 
    </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>schema</TT> (&#21487;&#36873;) &#34920;&#30340;schema&#30340;&#21517;&#31216;, &#20182;&#23558;&#35206;&#30422;&#22312;&#26681;&#20803;&#32032;&#20013;&#23450;&#20041;&#30340;schema 
    </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>lazy</TT> (&#21487;&#36873;--&#40664;&#35748;&#20026;true) 
      &#21487;&#20197;&#29992;&#26469;&#20851;&#38381;&#24310;&#36831;&#21152;&#36733;(false)&#65292;&#25351;&#23450;&#19968;&#30452;&#20351;&#29992;&#39044;&#20808;&#25235;&#21462;,&#25110;&#32773;&#25171;&#24320;"extra-lazy" 
      &#25235;&#21462;&#65292;&#27492;&#26102;&#22823;&#22810;&#25968;&#25805;&#20316;&#19981;&#20250;&#21021;&#22987;&#21270;&#38598;&#21512;&#31867;(&#36866;&#29992;&#20110;&#38750;&#24120;&#22823;&#30340;&#38598;&#21512;) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>inverse</TT> (&#21487;&#36873;——&#40664;&#35748;&#20026;<TT class=literal>false</TT>) 
      &#26631;&#35760;&#36825;&#20010;&#38598;&#21512;&#20316;&#20026;&#21452;&#21521;&#20851;&#32852;&#20851;&#31995;&#20013;&#30340;&#26041;&#21521;&#19968;&#31471;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>cascade</TT> (&#21487;&#36873;——&#40664;&#35748;&#20026;<TT class=literal>none</TT>) 
      &#35753;&#25805;&#20316;&#32423;&#32852;&#21040;&#23376;&#23454;&#20307; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>sort</TT>(&#21487;&#36873;)&#25351;&#23450;&#38598;&#21512;&#30340;&#25490;&#24207;&#39034;&#24207;, &#20854;&#21487;&#20197;&#20026;&#33258;&#28982;&#30340;(<TT 
      class=literal>natural</TT>)&#25110;&#32773;&#32473;&#23450;&#19968;&#20010;&#29992;&#26469;&#27604;&#36739;&#30340;&#31867;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>order-by</TT> (&#21487;&#36873;, &#20165;&#29992;&#20110;jdk1.4) 
      &#25351;&#23450;&#34920;&#30340;&#23383;&#27573;(&#19968;&#20010;&#25110;&#20960;&#20010;)&#20877;&#21152;&#19978;asc&#25110;&#32773;desc(&#21487;&#36873;), &#23450;&#20041;Map,Set&#21644;Bag&#30340;&#36845;&#20195;&#39034;&#24207; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(9)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>where</TT> (&#21487;&#36873;) &#25351;&#23450;&#20219;&#24847;&#30340;SQL where&#26465;&#20214;, 
      &#35813;&#26465;&#20214;&#23558;&#22312;&#37325;&#26032;&#36733;&#20837;&#25110;&#32773;&#21024;&#38500;&#36825;&#20010;&#38598;&#21512;&#26102;&#20351;&#29992;(&#24403;&#38598;&#21512;&#20013;&#30340;&#25968;&#25454;&#20165;&#20165;&#26159;&#25152;&#26377;&#21487;&#29992;&#25968;&#25454;&#30340;&#19968;&#20010;&#23376;&#38598;&#26102;&#36825;&#20010;&#26465;&#20214;&#38750;&#24120;&#26377;&#29992;) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(10)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>fetch</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026;<TT class=literal>select</TT>) 
      &#29992;&#20110;&#22312;&#22806;&#36830;&#25509;&#25235;&#21462;&#12289;&#36890;&#36807;&#21518;&#32493;select&#25235;&#21462;&#21644;&#36890;&#36807;&#21518;&#32493;subselect&#25235;&#21462;&#20043;&#38388;&#36873;&#25321;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(11)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>batch-size</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026;<TT class=literal>1</TT>) 
      &#25351;&#23450;&#36890;&#36807;&#24310;&#36831;&#21152;&#36733;&#21462;&#24471;&#38598;&#21512;&#23454;&#20363;&#30340;&#25209;&#22788;&#29702;&#22359;&#22823;&#23567;&#65288;"batch size"&#65289;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(12)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>access</TT>(&#21487;&#36873;-&#40664;&#35748;&#20026;&#23646;&#24615;property):Hibernate&#21462;&#24471;&#38598;&#21512;&#23646;&#24615;&#20540;&#26102;&#20351;&#29992;&#30340;&#31574;&#30053; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(13)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>&#20048;&#35266;&#38145;</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT class=literal>true</TT>): 
      &#23545;&#38598;&#21512;&#30340;&#29366;&#24577;&#30340;&#25913;&#21464;&#20250;&#26159;&#21542;&#23548;&#33268;&#20854;&#25152;&#23646;&#30340;&#23454;&#20307;&#30340;&#29256;&#26412;&#22686;&#38271;&#12290; (&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#20851;&#38381;&#36825;&#20010;&#23646;&#24615;&#24120;&#24120;&#26159;&#26377;&#29702;&#30340;) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(14)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>mutable(&#21487;&#21464;&#65289;</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT 
      class=literal>true</TT>): &#33509;&#20540;&#20026;<TT 
      class=literal>false</TT>,&#34920;&#26126;&#38598;&#21512;&#20013;&#30340;&#20803;&#32032;&#19981;&#20250;&#25913;&#21464;&#65288;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#21487;&#20197;&#36827;&#34892;&#19968;&#20123;&#23567;&#30340;&#24615;&#33021;&#20248;&#21270;&#65289;&#12290; 
  </P></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-foreignkeys></A>6.2.1.&nbsp;&#38598;&#21512;&#22806;&#38190;(Collection 
foreign keys)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38598;&#21512;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#20381;&#38752;&#25345;&#26377;&#38598;&#21512;&#30340;&#23454;&#20307;&#30340;&#22806;&#38190;&#21152;&#20197;&#36776;&#21035;&#12290;&#27492;&#22806;&#38190;&#20316;&#20026;<SPAN class=emphasis><EM>&#38598;&#21512;&#20851;&#38190;&#23383;&#27573;&#65288;collection key 
column&#65289;</EM></SPAN>&#65288;&#25110;&#22810;&#20010;&#23383;&#27573;&#65289;&#21152;&#20197;&#24341;&#29992;&#12290;&#38598;&#21512;&#20851;&#38190;&#23383;&#27573;&#36890;&#36807;<TT class=literal>&lt;key&gt;</TT> &#20803;&#32032;&#26144;&#23556;&#12290; 
</P>
<P>&#22312;&#22806;&#38190;&#23383;&#27573;&#19978;&#21487;&#33021;&#20855;&#26377;&#38750;&#31354;&#32422;&#26463;&#12290;&#23545;&#20110;&#22823;&#22810;&#25968;&#38598;&#21512;&#26469;&#35828;&#65292;&#36825;&#26159;&#38544;&#21547;&#30340;&#12290;&#23545;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#22806;&#38190;&#23383;&#27573;&#40664;&#35748;&#26159;&#21487;&#20197;&#20026;&#31354;&#30340;&#65292;&#22240;&#27492;&#20320;&#21487;&#33021;&#38656;&#35201;&#25351;&#26126; <TT 
class=literal>not-null="true"</TT>&#12290; </P><PRE class=programlisting>&lt;key column="productSerialNumber" not-null="true"/&gt;</PRE>
<P>&#22806;&#38190;&#32422;&#26463;&#21487;&#20197;&#20351;&#29992;<TT class=literal>ON DELETE CASCADE</TT>&#12290; </P><PRE class=programlisting>&lt;key column="productSerialNumber" on-delete="cascade"/&gt;</PRE>
<P>&#23545;<TT class=literal>&lt;key&gt;</TT> &#20803;&#32032;&#30340;&#23436;&#25972;&#23450;&#20041;&#65292;&#35831;&#21442;&#38405;&#21069;&#38754;&#30340;&#31456;&#33410;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-elements></A>6.2.2.&nbsp;&#38598;&#21512;&#20803;&#32032;&#65288;Collection 
elements&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38598;&#21512;&#20960;&#20046;&#21487;&#20197;&#21253;&#21547;&#20219;&#20309;&#20854;&#20182;&#30340;Hibernate&#31867;&#22411;&#65292;&#21253;&#25324;&#25152;&#26377;&#30340;&#22522;&#26412;&#31867;&#22411;&#12289;&#33258;&#23450;&#20041;&#31867;&#22411;&#12289;&#32452;&#20214;&#65292;&#24403;&#28982;&#36824;&#26377;&#23545;&#20854;&#20182;&#23454;&#20307;&#30340;&#24341;&#29992;&#12290;&#23384;&#22312;&#19968;&#20010;&#37325;&#35201;&#30340;&#21306;&#21035;&#65306;&#20301;&#20110;&#38598;&#21512;&#20013;&#30340;&#23545;&#35937;&#21487;&#33021;&#26159;&#26681;&#25454;“&#20540;”&#35821;&#20041;&#26469;&#25805;&#20316;&#65288;&#20854;&#22768;&#26126;&#21608;&#26399;&#23436;&#20840;&#20381;&#36182;&#20110;&#38598;&#21512;&#25345;&#26377;&#32773;&#65289;&#65292;&#25110;&#32773;&#23427;&#21487;&#33021;&#26159;&#25351;&#21521;&#21478;&#19968;&#20010;&#23454;&#20307;&#30340;&#24341;&#29992;&#65292;&#20855;&#26377;&#20854;&#33258;&#24049;&#30340;&#29983;&#21629;&#21608;&#26399;&#12290;&#22312;&#21518;&#32773;&#30340;&#24773;&#20917;&#19979;&#65292;&#34987;&#20316;&#20026;&#38598;&#21512;&#25345;&#26377;&#30340;&#29366;&#24577;&#32771;&#34385;&#30340;&#65292;&#21482;&#26377;&#20004;&#20010;&#23545;&#35937;&#20043;&#38388;&#30340;“&#36830;&#25509;”&#12290; 
</P>
<P>&#34987;&#21253;&#23481;&#30340;&#31867;&#22411;&#34987;&#31216;&#20026;<SPAN class=emphasis><EM>&#38598;&#21512;&#20803;&#32032;&#31867;&#22411;&#65288;collection element 
type&#65289;</EM></SPAN>&#12290;&#38598;&#21512;&#20803;&#32032;&#36890;&#36807;<TT class=literal>&lt;element&gt;</TT>&#25110;<TT 
class=literal>&lt;composite-element&gt;</TT>&#26144;&#23556;&#65292;&#25110;&#22312;&#20854;&#26159;&#23454;&#20307;&#24341;&#29992;&#30340;&#26102;&#20505;&#65292;&#36890;&#36807;<TT 
class=literal>&lt;one-to-many&gt;</TT> &#25110;<TT 
class=literal>&lt;many-to-many&gt;</TT>&#26144;&#23556;&#12290;&#21069;&#20004;&#31181;&#29992;&#20110;&#20351;&#29992;&#20540;&#35821;&#20041;&#26144;&#23556;&#20803;&#32032;&#65292;&#21518;&#20004;&#31181;&#29992;&#20110;&#26144;&#23556;&#23454;&#20307;&#20851;&#32852;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-indexed></A>6.2.3.&nbsp;&#32034;&#24341;&#38598;&#21512;&#31867;(Indexed 
collections)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25152;&#26377;&#30340;&#38598;&#21512;&#26144;&#23556;&#65292;&#38500;&#20102;set&#21644;bag&#35821;&#20041;&#30340;&#20197;&#22806;&#65292;&#37117;&#38656;&#35201;&#25351;&#23450;&#19968;&#20010;&#38598;&#21512;&#34920;&#30340;<SPAN class=emphasis><EM>&#32034;&#24341;&#23383;&#27573;(index 
column)</EM></SPAN>——&#29992;&#20110;&#23545;&#24212;&#21040;&#25968;&#32452;&#32034;&#24341;&#65292;&#25110;&#32773;<TT class=literal>List</TT>&#30340;&#32034;&#24341;&#65292;&#25110;&#32773;<TT 
class=literal>Map</TT>&#30340;&#20851;&#38190;&#23383;&#12290;&#36890;&#36807;<TT class=literal>&lt;map-key&gt;</TT>,<TT 
class=literal>Map</TT> &#30340;&#32034;&#24341;&#21487;&#20197;&#26159;&#20219;&#20309;&#22522;&#30784;&#31867;&#22411;&#65307;&#33509;&#36890;&#36807;<TT 
class=literal>&lt;map-key-many-to-many&gt;</TT>&#65292;&#23427;&#20063;&#21487;&#20197;&#26159;&#19968;&#20010;&#23454;&#20307;&#24341;&#29992;&#65307;&#33509;&#36890;&#36807;<TT 
class=literal>&lt;composite-map-key&gt;</TT>&#65292;&#23427;&#36824;&#21487;&#20197;&#26159;&#19968;&#20010;&#32452;&#21512;&#31867;&#22411;&#12290;&#25968;&#32452;&#25110;&#21015;&#34920;&#30340;&#32034;&#24341;&#24517;&#39035;&#26159;<TT 
class=literal>integer</TT>&#31867;&#22411;&#65292;&#24182;&#19988;&#20351;&#29992; <TT 
class=literal>&lt;list-index&gt;</TT>&#20803;&#32032;&#23450;&#20041;&#26144;&#23556;&#12290;&#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#21253;&#21547;&#26377;&#39034;&#24207;&#25490;&#21015;&#30340;&#25972;&#25968;&#65288;&#40664;&#35748;&#20174;0&#24320;&#22987;&#65289;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;map-key 
        column="column_name"                <SPAN class=co>(1)</SPAN>
        formula="any SQL expression"        <SPAN class=co>(2)</SPAN>
        type="type_name"                    <SPAN class=co>(3)</SPAN>
        node="@attribute-name"
        length="N"/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT>(&#21487;&#36873;):&#20445;&#23384;&#38598;&#21512;&#32034;&#24341;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;map&#20851;&#38190;&#23383;&#30340;SQL&#20844;&#24335; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#24517;&#39035;):&#26144;&#23556;&#38190;(map key)&#30340;&#31867;&#22411;&#12290; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV class=programlistingco><PRE class=programlisting>&lt;map-key-many-to-many
        column="column_name"                <SPAN class=co>(1)</SPAN>
        formula="any SQL expression"        <SPAN class=co>(2)</SPAN><SPAN class=co>(3)</SPAN>
        class="ClassName"
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT>(&#21487;&#36873;):&#38598;&#21512;&#32034;&#24341;&#20540;&#20013;&#22806;&#38190;&#23383;&#27573;&#30340;&#21517;&#31216; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;map&#20851;&#38190;&#23383;&#30340;&#22806;&#38190;&#30340;SQL&#20844;&#24335; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT> (&#24517;&#38656;):&#26144;&#23556;&#30340;&#38190;(map key)&#20351;&#29992;&#30340;&#23454;&#20307;&#31867;&#12290; 
  </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20551;&#33509;&#20320;&#30340;&#34920;&#27809;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;,&#24403;&#20320;&#20173;&#28982;&#24076;&#26395;&#20351;&#29992;<TT class=literal>List</TT>&#20316;&#20026;&#23646;&#24615;&#31867;&#22411;,&#20320;&#24212;&#35813;&#25226;&#27492;&#23646;&#24615;&#26144;&#23556;&#20026;Hibernate 
<SPAN 
class=emphasis><EM>&lt;bag&gt;</EM></SPAN>&#12290;&#20174;&#25968;&#25454;&#24211;&#20013;&#33719;&#21462;&#30340;&#26102;&#20505;&#65292;bag&#19981;&#32500;&#25252;&#20854;&#39034;&#24207;&#65292;&#20294;&#20063;&#21487;&#36873;&#25321;&#24615;&#30340;&#36827;&#34892;&#25490;&#24207;&#12290; 
</P></DIV>
<P>&#20174;&#38598;&#21512;&#31867;&#21487;&#20197;&#20135;&#29983;&#24456;&#22823;&#19968;&#37096;&#20998;&#26144;&#23556;&#65292;&#35206;&#30422;&#20102;&#24456;&#22810;&#24120;&#35265;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;&#25105;&#20204;&#24314;&#35758;&#20320;&#35797;&#39564;schema&#29983;&#25104;&#24037;&#20855;&#65292;&#26469;&#20307;&#20250;&#19968;&#19979;&#19981;&#21516;&#30340;&#26144;&#23556;&#22768;&#26126;&#26159;&#22914;&#20309;&#34987;&#32763;&#35793;&#20026;&#25968;&#25454;&#24211;&#34920;&#30340;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=collections-ofvalues></A>6.2.4.&nbsp;&#20540;&#38598;&#21512;&#20110;&#22810;&#23545;&#22810;&#20851;&#32852;(Collections of values and 
many-to-many associations)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20219;&#20309;&#20540;&#38598;&#21512;&#25110;&#32773;&#22810;&#23545;&#22810;&#20851;&#32852;&#38656;&#35201;&#19987;&#29992;&#30340;&#20855;&#26377;&#19968;&#20010;&#25110;&#22810;&#20010;&#22806;&#38190;&#23383;&#27573;&#30340;<SPAN class=emphasis><EM>collection 
table</EM></SPAN>&#12289;&#19968;&#20010;&#25110;&#22810;&#20010;<SPAN class=emphasis><EM>collection element 
column</EM></SPAN>&#65292;&#20197;&#21450;&#36824;&#21487;&#33021;&#26377;&#19968;&#20010;&#25110;&#22810;&#20010;&#32034;&#24341;&#23383;&#27573;&#12290; </P>
<P>&#23545;&#20110;&#19968;&#20010;&#20540;&#38598;&#21512;, &#25105;&#20204;&#20351;&#29992;<TT class=literal>&lt;element&gt;</TT>&#26631;&#31614;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;element
        column="column_name"                     <SPAN class=co>(1)</SPAN>
        formula="any SQL expression"             <SPAN class=co>(2)</SPAN>
        type="typename"                          <SPAN class=co>(3)</SPAN>
        length="L"
        precision="P"
        scale="S"
        not-null="true|false"
        unique="true|false"
        node="element-name"
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT>(&#21487;&#36873;):&#20445;&#23384;&#38598;&#21512;&#20803;&#32032;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;&#20803;&#32032;&#30340;SQL&#20844;&#24335; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>type</TT> (&#24517;&#38656;):&#38598;&#21512;&#20803;&#32032;&#30340;&#31867;&#22411; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22810;&#23545;&#22810;&#20851;&#32852;(many-to-many association)</EM></SPAN> &#20351;&#29992; <TT 
class=literal>&lt;many-to-many&gt;</TT>&#20803;&#32032;&#23450;&#20041;. </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;many-to-many
        column="column_name"                               <SPAN class=co>(1)</SPAN>
        formula="any SQL expression"                       <SPAN class=co>(2)</SPAN>
        class="ClassName"                                  <SPAN class=co>(3)</SPAN>
        fetch="select|join"                                <SPAN class=co>(4)</SPAN>
        unique="true|false"                                <SPAN class=co>(5)</SPAN>
        not-found="ignore|exception"                       <SPAN class=co>(6)</SPAN>
        entity-name="EntityName"                           <SPAN class=co>(7)</SPAN>
        property-ref="propertyNameFromAssociatedClass"     <SPAN class=co>(8)</SPAN>
        node="element-name"
        embed-xml="true|false"
    /&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>column</TT>(&#21487;&#36873;): &#36825;&#20010;&#20803;&#32032;&#30340;&#22806;&#38190;&#20851;&#38190;&#23383;&#27573;&#21517; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>formula</TT> (&#21487;&#36873;): &#29992;&#20110;&#35745;&#31639;&#20803;&#32032;&#22806;&#38190;&#20540;&#30340;SQL&#20844;&#24335;. </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT> (&#24517;&#38656;): &#20851;&#32852;&#31867;&#30340;&#21517;&#31216; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>outer-join</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT 
      class=literal>auto</TT>): &#22312;Hibernate&#31995;&#32479;&#21442;&#25968;&#20013;<TT 
      class=literal>hibernate.use_outer_join</TT>&#34987;&#25171;&#24320;&#30340;&#24773;&#20917;&#19979;,&#35813;&#21442;&#25968;&#29992;&#26469;&#20801;&#35768;&#20351;&#29992;outer 
      join&#26469;&#36733;&#20837;&#27492;&#38598;&#21512;&#30340;&#25968;&#25454;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(4)</TD>
    <TD vAlign=top align=left>
      <P>&#20026;&#27492;&#20851;&#32852;&#25171;&#24320;&#22806;&#36830;&#25509;&#25235;&#21462;&#25110;&#32773;&#21518;&#32493;select&#25235;&#21462;&#12290;&#36825;&#26159;&#29305;&#27530;&#24773;&#20917;&#65307;&#23545;&#20110;&#19968;&#20010;&#23454;&#20307;&#21450;&#20854;&#25351;&#21521;&#20854;&#20182;&#23454;&#20307;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#36827;&#20840;&#39044;&#20808;&#25235;&#21462;&#65288;&#20351;&#29992;&#19968;&#26465;&#21333;&#29420;&#30340;<TT 
      class=literal>SELECT</TT>)&#65292;&#20320;&#19981;&#20165;&#38656;&#35201;&#23545;&#38598;&#21512;&#33258;&#36523;&#25171;&#24320;<TT class=literal>join</TT>&#65292;&#20063;&#38656;&#35201;&#23545;<TT 
      class=literal>&lt;many-to-many&gt;</TT>&#36825;&#20010;&#20869;&#23884;&#20803;&#32032;&#25171;&#24320;&#27492;&#23646;&#24615;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(5)</TD>
    <TD vAlign=top align=left>
      <P>&#23545;&#22806;&#38190;&#23383;&#27573;&#20801;&#35768;DDL&#29983;&#25104;&#30340;&#26102;&#20505;&#29983;&#25104;&#19968;&#20010;&#24799;&#19968;&#32422;&#26463;&#12290;&#36825;&#20351;&#20851;&#32852;&#21464;&#25104;&#20102;&#19968;&#20010;&#39640;&#25928;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;&#12290;&#65288;&#27492;&#21477;&#23384;&#30097;&#65306;&#21407;&#25991;&#20026;This makes the 
      association multiplicity effectively one to many.) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(6)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-found</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026; <TT 
      class=literal>exception</TT>): &#25351;&#26126;&#24341;&#29992;&#30340;&#22806;&#38190;&#20013;&#32570;&#23569;&#26576;&#20123;&#34892;&#35813;&#22914;&#20309;&#22788;&#29702;&#65306; <TT 
      class=literal>ignore</TT> &#20250;&#25226;&#32570;&#22833;&#30340;&#34892;&#20316;&#20026;&#19968;&#20010;&#31354;&#24341;&#29992;&#22788;&#29702;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(7)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>entity-name</TT> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#65292;&#20316;&#20026;<TT 
      class=literal>class</TT>&#30340;&#26367;&#20195;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(8)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>property-ref</TT>: (&#21487;&#36873;) &#34987;&#20851;&#32852;&#21040;&#27492;&#22806;&#38190;(foreign 
      key)&#30340;&#31867;&#20013;&#30340;&#23545;&#24212;&#23646;&#24615;&#30340;&#21517;&#23383;&#12290;&#33509;&#26410;&#25351;&#23450;&#65292;&#20351;&#29992;&#34987;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20363;&#23376;&#65306;&#39318;&#20808;, &#19968;&#32452;&#23383;&#31526;&#20018;&#65306; </P><PRE class=programlisting>&lt;set name="names" table="NAMES"&gt;
    &lt;key column="GROUPID"/&gt;
    &lt;element column="NAME" type="string"/&gt;
&lt;/set&gt;</PRE>
<P>&#21253;&#21547;&#19968;&#32452;&#25972;&#25968;&#30340;bag(&#36824;&#35774;&#32622;&#20102;<TT class=literal>order-by</TT>&#21442;&#25968;&#25351;&#23450;&#20102;&#36845;&#20195;&#30340;&#39034;&#24207;)&#65306; </P><PRE class=programlisting>&lt;bag name="sizes" 
        table="item_sizes" 
        order-by="size asc"&gt;
    &lt;key column="item_id"/&gt;
    &lt;element column="size" type="integer"/&gt;
&lt;/bag&gt;</PRE>
<P>&#19968;&#20010;&#23454;&#20307;&#25968;&#32452;,&#22312;&#36825;&#20010;&#26696;&#20363;&#20013;&#26159;&#19968;&#20010;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;(&#27880;&#24847;&#36825;&#37324;&#30340;&#23454;&#20307;&#26159;&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65288;lifecycle objects&#65289;,<TT 
class=literal>cascade="all"</TT>): </P><PRE class=programlisting>&lt;array name="addresses" 
        table="PersonAddress" 
        cascade="persist"&gt;
    &lt;key column="personId"/&gt;
    &lt;list-index column="sortOrder"/&gt;
    &lt;many-to-many column="addressId" class="Address"/&gt;
&lt;/array&gt;</PRE>
<P>&#19968;&#20010;map,&#36890;&#36807;&#23383;&#31526;&#20018;&#30340;&#32034;&#24341;&#26469;&#25351;&#26126;&#26085;&#26399;&#65306; </P><PRE class=programlisting>&lt;map name="holidays" 
        table="holidays" 
        schema="dbo" 
        order-by="hol_name asc"&gt;
    &lt;key column="id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</PRE>
<P>&#19968;&#20010;&#32452;&#20214;&#30340;&#21015;&#34920;&#65306;&#65288;&#19979;&#19968;&#31456;&#35752;&#35770;&#65289; </P><PRE class=programlisting>&lt;list name="carComponents" 
        table="CarComponents"&gt;
    &lt;key column="carId"/&gt;
    &lt;list-index column="sortOrder"/&gt;
    &lt;composite-element class="CarComponent"&gt;
        &lt;property name="price"/&gt;
        &lt;property name="type"/&gt;
        &lt;property name="serialNumber" column="serialNum"/&gt;
    &lt;/composite-element&gt;
&lt;/list&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-onetomany></A>6.2.5.&nbsp;&#19968;&#23545;&#22810;&#20851;&#32852;&#65288;One-to-many 
Associations&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#19968;&#23545;&#22810;&#20851;&#32852;</EM></SPAN><SPAN 
class=emphasis><EM>&#36890;&#36807;&#22806;&#38190;</EM></SPAN>&#36830;&#25509;&#20004;&#20010;&#31867;&#23545;&#24212;&#30340;&#34920;,&#32780;&#27809;&#26377;&#20013;&#38388;&#38598;&#21512;&#34920;&#12290; &#36825;&#20010;&#20851;&#31995;&#27169;&#22411;&#22833;&#21435;&#20102;&#19968;&#20123;Java&#38598;&#21512;&#30340;&#35821;&#20041;: 
</P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#34987;&#21253;&#21547;&#22312;&#19968;&#20010;&#38598;&#21512;&#30340;&#23454;&#20363;&#20013; </P>
  <LI>
  <P>&#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#23545;&#24212;&#20110;&#38598;&#21512;&#32034;&#24341;&#30340;&#19968;&#20010;&#20540;&#20013; </P></LI></UL></DIV>
<P>&#19968;&#20010;&#20174;<TT class=literal>Product</TT>&#21040;<TT 
class=literal>Part</TT>&#30340;&#20851;&#32852;&#38656;&#35201;&#20851;&#38190;&#23383;&#23383;&#27573;,&#21487;&#33021;&#36824;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;&#25351;&#21521;<TT class=literal>Part</TT>&#25152;&#23545;&#24212;&#30340;&#34920;&#12290; 
<TT class=literal>&lt;one-to-many&gt;</TT>&#26631;&#35760;&#25351;&#26126;&#20102;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#12290; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;one-to-many 
        class="ClassName"                                  <SPAN class=co>(1)</SPAN>
        not-found="ignore|exception"                       <SPAN class=co>(2)</SPAN>
        entity-name="EntityName"                           <SPAN class=co>(3)</SPAN>
        node="element-name"
        embed-xml="true|false"
    /&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>class</TT>(&#24517;&#39035;):&#34987;&#20851;&#32852;&#31867;&#30340;&#21517;&#31216;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>not-found</TT> (&#21487;&#36873; - &#40664;&#35748;&#20026;<TT 
      class=literal>exception</TT>): &#25351;&#26126;&#33509;&#32531;&#23384;&#30340;&#26631;&#31034;&#20540;&#20851;&#32852;&#30340;&#34892;&#32570;&#22833;,&#35813;&#22914;&#20309;&#22788;&#29702;: <TT 
      class=literal>ignore</TT> &#20250;&#25226;&#32570;&#22833;&#30340;&#34892;&#20316;&#20026;&#19968;&#20010;&#31354;&#20851;&#32852;&#22788;&#29702;&#12290; </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>entity-name</TT> (&#21487;&#36873;): &#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#23454;&#20307;&#21517;&#65292;&#20316;&#20026;<TT 
      class=literal>class</TT>&#30340;&#26367;&#20195;&#12290; </P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#20363;&#23376; </P><PRE class=programlisting>&lt;set name="bars"&gt;
    &lt;key column="foo_id"/&gt;
    &lt;one-to-many class="org.hibernate.Bar"/&gt;
&lt;/set&gt;</PRE>
<P>&#27880;&#24847;:<TT class=literal>&lt;one-to-many&gt;</TT>&#20803;&#32032;&#19981;&#38656;&#35201;&#23450;&#20041;&#20219;&#20309;&#23383;&#27573;&#12290; &#20063;&#19981;&#38656;&#35201;&#25351;&#23450;&#34920;&#21517;&#12290; </P>
<P><SPAN class=emphasis><EM>&#37325;&#35201;&#25552;&#31034;</EM></SPAN>:&#22914;&#26524;<TT 
class=literal>&#19968;&#23545;&#22810;</TT>&#20851;&#32852;&#20013;&#30340;&#22806;&#38190;&#23383;&#27573;&#23450;&#20041;&#25104;<TT class=literal>NOT NULL</TT>,&#20320;&#24517;&#39035;&#25226;<TT 
class=literal>&lt;key&gt;</TT>&#26144;&#23556;&#22768;&#26126;&#20026;<TT 
class=literal>not-null="true"</TT>,&#25110;&#32773;&#20351;&#29992;<SPAN 
class=emphasis><EM>&#21452;&#21521;&#20851;&#32852;</EM></SPAN>&#65292;&#24182;&#19988;&#26631;&#26126;<TT 
class=literal>inverse="true"</TT>&#12290;&#21442;&#38405;&#26412;&#31456;&#21518;&#38754;&#20851;&#20110;&#21452;&#21521;&#20851;&#32852;&#30340;&#35752;&#35770;&#12290; </P>
<P>&#19979;&#38754;&#30340;&#20363;&#23376;&#23637;&#31034;&#19968;&#20010;<TT class=literal>Part</TT>&#23454;&#20307;&#30340;map,&#25226;name&#20316;&#20026;&#20851;&#38190;&#23383;&#12290;( <TT 
class=literal>partName</TT> &#26159;<TT class=literal>Part</TT>&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;)&#12290;&#27880;&#24847;&#20854;&#20013;&#30340;&#22522;&#20110;&#20844;&#24335;&#30340;&#32034;&#24341;&#30340;&#29992;&#27861;&#12290; 
</P><PRE class=programlisting>&lt;map name="parts"
        cascade="all"&gt;
    &lt;key column="productId" not-null="true"/&gt;
    &lt;map-key formula="partName"/&gt;
    &lt;one-to-many class="Part"/&gt;
&lt;/map&gt;</PRE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=collections-advancedmappings></A>6.3.&nbsp;&#39640;&#32423;&#38598;&#21512;&#26144;&#23556;&#65288;Advanced collection 
mappings&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-sorted></A>6.3.1.&nbsp;&#26377;&#24207;&#38598;&#21512;&#65288;Sorted 
collections&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#25903;&#25345;&#23454;&#29616;<TT class=literal>java.util.SortedMap</TT>&#21644;<TT 
class=literal>java.util.SortedSet</TT>&#30340;&#38598;&#21512;&#12290;&#20320;&#24517;&#39035;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#23450;&#19968;&#20010;&#27604;&#36739;&#22120;&#65306; </P><PRE class=programlisting>&lt;set name="aliases" 
            table="person_aliases" 
            sort="natural"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" sort="my.custom.HolidayComparator"&gt;
    &lt;key column="year_id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</PRE>
<P><TT class=literal>sort</TT>&#23646;&#24615;&#20013;&#20801;&#35768;&#30340;&#20540;&#21253;&#25324;<TT class=literal>unsorted</TT>,<TT 
class=literal>natural</TT>&#21644;&#26576;&#20010;&#23454;&#29616;&#20102;<TT 
class=literal>java.util.Comparator</TT>&#30340;&#31867;&#30340;&#21517;&#31216;&#12290; </P>
<P>&#20998;&#31867;&#38598;&#21512;&#30340;&#34892;&#20026;&#20107;&#23454;&#19978;&#35937;<TT class=literal>java.util.TreeSet</TT>&#25110;&#32773;<TT 
class=literal>java.util.TreeMap</TT>&#12290; </P>
<P>&#22914;&#26524;&#20320;&#24076;&#26395;&#25968;&#25454;&#24211;&#33258;&#24049;&#23545;&#38598;&#21512;&#20803;&#32032;&#25490;&#24207;&#65292;&#21487;&#20197;&#21033;&#29992;<TT class=literal>set</TT>,<TT 
class=literal>bag</TT>&#25110;&#32773;<TT class=literal>map</TT>&#26144;&#23556;&#20013;&#30340;<TT 
class=literal>order-by</TT>&#23646;&#24615;&#12290;&#36825;&#20010;&#35299;&#20915;&#26041;&#26696;&#21482;&#33021;&#22312;jdk1.4&#25110;&#32773;&#26356;&#39640;&#30340;jdk&#29256;&#26412;&#20013;&#25165;&#21487;&#20197;&#23454;&#29616;(&#36890;&#36807;LinkedHashSet&#25110;&#32773; 
LinkedHashMap&#23454;&#29616;)&#12290; &#23427;&#26159;&#22312;SQL&#26597;&#35810;&#20013;&#23436;&#25104;&#25490;&#24207;&#65292;&#32780;&#19981;&#26159;&#22312;&#20869;&#23384;&#20013;&#12290; </P><PRE class=programlisting>&lt;set name="aliases" table="person_aliases" order-by="lower(name) asc"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" order-by="hol_date, hol_name"&gt;
    &lt;key column="year_id"/&gt;
    &lt;map-key column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</PRE>
<P>&#27880;&#24847;: &#36825;&#20010;<TT class=literal>order-by</TT>&#23646;&#24615;&#30340;&#20540;&#26159;&#19968;&#20010;SQL&#25490;&#24207;&#23376;&#21477;&#32780;&#19981;&#26159;HQL&#30340;&#65281; </P>
<P>&#20851;&#32852;&#36824;&#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#20351;&#29992;&#38598;&#21512;<TT class=literal>filter()</TT>&#26681;&#25454;&#20219;&#24847;&#30340;&#26465;&#20214;&#26469;&#25490;&#24207;&#12290; </P><PRE class=programlisting>sortedUsers = s.createFilter( group.getUsers(), "order by this.name" ).list();</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=collections-bidirectional></A>6.3.2.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional 
associations&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#21452;&#21521;&#20851;&#32852;</EM></SPAN>&#20801;&#35768;&#36890;&#36807;&#20851;&#32852;&#30340;&#20219;&#19968;&#31471;&#35775;&#38382;&#21478;&#22806;&#19968;&#31471;&#12290;&#22312;Hibernate&#20013;, 
&#25903;&#25345;&#20004;&#31181;&#31867;&#22411;&#30340;&#21452;&#21521;&#20851;&#32852;: </P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>&#19968;&#23545;&#22810;&#65288;one-to-many&#65289;</SPAN>
  <DD>
  <P>Set&#25110;&#32773;bag&#20540;&#22312;&#19968;&#31471;, &#21333;&#29420;&#20540;(&#38750;&#38598;&#21512;)&#22312;&#21478;&#22806;&#19968;&#31471; </P>
  <DT><SPAN class=term>&#22810;&#23545;&#22810;&#65288;many-to-many&#65289;</SPAN>
  <DD>
  <P>&#20004;&#31471;&#37117;&#26159;set&#25110;bag&#20540; </P></DD></DL></DIV>
<P></P>
<P>&#35201;&#24314;&#31435;&#19968;&#20010;&#21452;&#21521;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#21482;&#38656;&#35201;&#26144;&#23556;&#20004;&#20010;many-to-many&#20851;&#32852;&#21040;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#20013;&#65292;&#24182;&#20877;&#23450;&#20041;&#20854;&#20013;&#30340;&#19968;&#31471;&#20026;<SPAN 
class=emphasis><EM>inverse</EM></SPAN>(&#20351;&#29992;&#21738;&#19968;&#31471;&#35201;&#26681;&#25454;&#20320;&#30340;&#36873;&#25321;&#65292;&#20294;&#23427;&#19981;&#33021;&#26159;&#19968;&#20010;&#32034;&#24341;&#38598;&#21512;)&#12290; </P>
<P>&#36825;&#37324;&#26377;&#19968;&#20010;many-to-many&#30340;&#21452;&#21521;&#20851;&#32852;&#30340;&#20363;&#23376;;&#27599;&#19968;&#20010;category&#37117;&#21487;&#20197;&#26377;&#24456;&#22810;items,&#27599;&#19968;&#20010;items&#21487;&#20197;&#23646;&#20110;&#24456;&#22810;categories&#65306; 
</P><PRE class=programlisting>&lt;class name="Category"&gt;
    &lt;id name="id" column="CATEGORY_ID"/&gt;
    ...
    &lt;bag name="items" table="CATEGORY_ITEM"&gt;
        &lt;key column="CATEGORY_ID"/&gt;
        &lt;many-to-many class="Item" column="ITEM_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;

&lt;class name="Item"&gt;
    &lt;id name="id" column="CATEGORY_ID"/&gt;
    ...

    &lt;!-- inverse end --&gt;
    &lt;bag name="categories" table="CATEGORY_ITEM" inverse="true"&gt;
        &lt;key column="ITEM_ID"/&gt;
        &lt;many-to-many class="Category" column="CATEGORY_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;</PRE>
<P>&#22914;&#26524;&#21482;&#23545;&#20851;&#32852;&#30340;&#21453;&#21521;&#31471;&#36827;&#34892;&#20102;&#25913;&#21464;&#65292;&#36825;&#20010;&#25913;&#21464;<SPAN class=emphasis><EM>&#19981;&#20250;</EM></SPAN>&#34987;&#25345;&#20037;&#21270;&#12290; 
&#36825;&#34920;&#31034;Hibernate&#20026;&#27599;&#20010;&#21452;&#21521;&#20851;&#32852;&#22312;&#20869;&#23384;&#20013;&#23384;&#22312;&#20004;&#27425;&#34920;&#29616;,&#19968;&#20010;&#20174;A&#36830;&#25509;&#21040;B,&#21478;&#19968;&#20010;&#20174;B&#36830;&#25509;&#21040;A&#12290;&#22914;&#26524;&#20320;&#22238;&#24819;&#19968;&#19979;Java&#23545;&#35937;&#27169;&#22411;&#65292;&#25105;&#20204;&#26159;&#22914;&#20309;&#22312;Java&#20013;&#21019;&#24314;&#22810;&#23545;&#22810;&#20851;&#31995;&#30340;&#65292;&#36825;&#21487;&#20197;&#35753;&#20320;&#26356;&#23481;&#26131;&#29702;&#35299;&#65306; 
</P><PRE class=programlisting>category.getItems().add(item);          // The category now "knows" about the relationship
item.getCategories().add(category);     // The item now "knows" about the relationship

session.persist(item);                   // The relationship won''t be saved!
session.persist(category);               // The relationship will be saved</PRE>
<P>&#38750;&#21453;&#21521;&#31471;&#29992;&#20110;&#25226;&#20869;&#23384;&#20013;&#30340;&#34920;&#31034;&#20445;&#23384;&#21040;&#25968;&#25454;&#24211;&#20013;&#12290; </P>
<P>&#35201;&#24314;&#31435;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#21452;&#21521;&#20851;&#32852;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#25226;&#19968;&#20010;&#19968;&#23545;&#22810;&#20851;&#32852;&#65292;&#20316;&#20026;&#19968;&#20010;&#22810;&#23545;&#19968;&#20851;&#32852;&#26144;&#23556;&#21040;&#21040;&#21516;&#19968;&#24352;&#34920;&#30340;&#23383;&#27573;&#19978;&#65292;&#24182;&#19988;&#22312;"&#22810;"&#30340;&#37027;&#19968;&#31471;&#23450;&#20041;<TT 
class=literal>inverse="true"</TT>&#12290; </P><PRE class=programlisting>&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;set name="children" inverse="true"&gt;
        &lt;key column="parent_id"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        not-null="true"/&gt;
&lt;/class&gt;</PRE>
<P>&#22312;“&#19968;”&#36825;&#19968;&#31471;&#23450;&#20041;<TT class=literal>inverse="true"</TT>&#19981;&#20250;&#24433;&#21709;&#32423;&#32852;&#25805;&#20316;&#65292;&#20108;&#32773;&#26159;&#27491;&#20132;&#30340;&#27010;&#24565;&#65281; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=collections-indexedbidirectional></A>6.3.3.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65292;&#28041;&#21450;&#26377;&#24207;&#38598;&#21512;&#31867;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;&#26377;&#19968;&#31471;&#26159;<TT class=literal>&lt;list&gt;</TT>&#25110;&#32773;<TT 
class=literal>&lt;map&gt;</TT>&#30340;&#21452;&#21521;&#20851;&#32852;&#65292;&#38656;&#35201;&#21152;&#20197;&#29305;&#21035;&#32771;&#34385;&#12290;&#20551;&#33509;&#23376;&#31867;&#20013;&#30340;&#19968;&#20010;&#23646;&#24615;&#26144;&#23556;&#21040;&#32034;&#24341;&#23383;&#27573;&#65292;&#27809;&#38382;&#39064;&#65292;&#25105;&#20204;&#20173;&#28982;&#21487;&#20197;&#22312;&#38598;&#21512;&#31867;&#26144;&#23556;&#19978;&#20351;&#29992;<TT 
class=literal>inverse="true"</TT>&#65306; </P><PRE class=programlisting>&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;map name="children" inverse="true"&gt;
        &lt;key column="parent_id"/&gt;
        &lt;map-key column="name" 
            type="string"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/map&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;property name="name" 
        not-null="true"/&gt;
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        not-null="true"/&gt;
&lt;/class&gt;</PRE>
<P>&#20294;&#26159;&#65292;&#20551;&#33509;&#23376;&#31867;&#20013;&#27809;&#26377;&#36825;&#26679;&#30340;&#23646;&#24615;&#23384;&#22312;&#65292;&#25105;&#20204;&#19981;&#33021;&#35748;&#20026;&#36825;&#20010;&#20851;&#32852;&#26159;&#30495;&#27491;&#30340;&#21452;&#21521;&#20851;&#32852;&#65288;&#20449;&#24687;&#19981;&#23545;&#31216;&#65292;&#22312;&#20851;&#32852;&#30340;&#19968;&#31471;&#26377;&#19968;&#20123;&#21478;&#22806;&#19968;&#31471;&#27809;&#26377;&#30340;&#20449;&#24687;&#65289;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#19981;&#33021;&#20351;&#29992;<TT 
class=literal>inverse="true"</TT>&#12290;&#25105;&#20204;&#38656;&#35201;&#36825;&#26679;&#29992;&#65306; </P><PRE class=programlisting>&lt;class name="Parent"&gt;
    &lt;id name="id" column="parent_id"/&gt;
    ....
    &lt;map name="children"&gt;
        &lt;key column="parent_id"
            not-null="true"/&gt;
        &lt;map-key column="name" 
            type="string"/&gt;
        &lt;one-to-many class="Child"/&gt;
    &lt;/map&gt;
&lt;/class&gt;

&lt;class name="Child"&gt;
    &lt;id name="id" column="child_id"/&gt;
    ....
    &lt;many-to-one name="parent" 
        class="Parent" 
        column="parent_id"
        insert="false"
        update="false"
        not-null="true"/&gt;
&lt;/class&gt;</PRE>
<P>&#27880;&#24847;&#22312;&#36825;&#20010;&#26144;&#23556;&#20013;&#65292;&#20851;&#32852;&#20013;&#38598;&#21512;&#31867;"&#20540;"&#19968;&#31471;&#36127;&#36131;&#26469;&#26356;&#26032;&#22806;&#38190;.TODO: Does this really result in some unnecessary 
update statements? </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-ternary></A>6.3.4.&nbsp;&#19977;&#37325;&#20851;&#32852;&#65288;Ternary 
associations&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26377;&#19977;&#31181;&#21487;&#33021;&#30340;&#36884;&#24452;&#26469;&#26144;&#23556;&#19968;&#20010;&#19977;&#37325;&#20851;&#32852;&#12290;&#31532;&#19968;&#31181;&#26159;&#20351;&#29992;&#19968;&#20010;<TT class=literal>Map</TT>&#65292;&#25226;&#19968;&#20010;&#20851;&#32852;&#20316;&#20026;&#20854;&#32034;&#24341;&#65306; </P><PRE class=programlisting>&lt;map name="contracts"&gt;
    &lt;key column="employer_id" not-null="true"/&gt;
    &lt;map-key-many-to-many column="employee_id" class="Employee"/&gt;
    &lt;one-to-many class="Contract"/&gt;
&lt;/map&gt;</PRE><PRE class=programlisting>&lt;map name="connections"&gt;
    &lt;key column="incoming_node_id"/&gt;
    &lt;map-key-many-to-many column="outgoing_node_id" class="Node"/&gt;
    &lt;many-to-many column="connection_id" class="Connection"/&gt;
&lt;/map&gt;</PRE>
<P>&#31532;&#20108;&#31181;&#26041;&#27861;&#26159;&#31616;&#21333;&#30340;&#25226;&#20851;&#32852;&#37325;&#26032;&#24314;&#27169;&#20026;&#19968;&#20010;&#23454;&#20307;&#31867;&#12290;&#36825;&#20351;&#25105;&#20204;&#26368;&#32463;&#24120;&#20351;&#29992;&#30340;&#26041;&#27861;&#12290; </P>
<P>&#26368;&#21518;&#19968;&#31181;&#36873;&#25321;&#26159;&#20351;&#29992;&#22797;&#21512;&#20803;&#32032;&#65292;&#25105;&#20204;&#20250;&#22312;&#21518;&#38754;&#35752;&#35770; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=collections-idbag></A>6.3.5.&nbsp;<TT 
class=literal>&#20351;&#29992;&lt;idbag&gt;</TT></H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#23436;&#20840;&#20449;&#22857;&#25105;&#20204;&#23545;&#20110;“&#32852;&#21512;&#20027;&#38190;&#65288;composite keys&#65289;&#26159;&#20010;&#22351;&#19996;&#35199;”&#65292;&#21644;“&#23454;&#20307;&#24212;&#35813;&#20351;&#29992;&#65288;&#26080;&#26426;&#30340;&#65289;&#33258;&#24049;&#29983;&#25104;&#30340;&#20195;&#29992;&#26631;&#35782;&#31526;&#65288;surrogate 
keys&#65289;”&#30340;&#35266;&#28857;&#65292;&#20063;&#35768;&#20320;&#20250;&#24863;&#21040;&#26377;&#19968;&#20123;&#22855;&#24618;&#65292;&#25105;&#20204;&#30446;&#21069;&#20026;&#27490;&#23637;&#31034;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#37117;&#26159;&#26144;&#23556;&#25104;&#20026;&#24102;&#26377;&#32852;&#21512;&#20027;&#38190;&#30340;&#34920;&#30340;&#65281;&#29616;&#22312;&#65292;&#36825;&#19968;&#28857;&#38750;&#24120;&#20540;&#24471;&#20105;&#36777;&#65307;&#30475;&#19978;&#21435;&#19968;&#20010;&#21333;&#32431;&#30340;&#20851;&#32852;&#34920;&#24182;&#19981;&#33021;&#20174;&#20195;&#29992;&#26631;&#35782;&#31526;&#20013;&#33719;&#24471;&#20160;&#20040;&#22909;&#22788;&#65288;&#34429;&#28982;&#20351;&#29992;&#32452;&#21512;&#20540;&#30340;&#38598;&#21512;<SPAN 
class=emphasis><EM>&#21487;&#33021;</EM></SPAN>&#20250;&#33719;&#24471;&#19968;&#28857;&#22909;&#22788;&#65289;&#12290;&#19981;&#36807;&#65292;Hibernate&#25552;&#20379;&#20102;&#19968;&#20010;&#65288;&#19968;&#28857;&#28857;&#35797;&#39564;&#24615;&#36136;&#30340;&#65289;&#21151;&#33021;&#65292;&#35753;&#20320;&#25226;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#24212;&#24471;&#21040;&#19968;&#20010;&#20351;&#29992;&#20195;&#29992;&#26631;&#35782;&#31526;&#30340;&#34920;&#21435;&#12290; 
</P>
<P><TT class=literal>&lt;idbag&gt;</TT> &#23646;&#24615;&#35753;&#20320;&#20351;&#29992;bag&#35821;&#20041;&#26469;&#26144;&#23556;&#19968;&#20010;<TT 
class=literal>List</TT> (&#25110;<TT class=literal>Collection</TT>)&#12290; </P><PRE class=programlisting>&lt;idbag name="lovers" table="LOVERS"&gt;
    &lt;collection-id column="ID" type="long"&gt;
        &lt;generator class="sequence"/&gt;
    &lt;/collection-id&gt;
    &lt;key column="PERSON1"/&gt;
    &lt;many-to-many column="PERSON2" class="Person" fetch="join"/&gt;
&lt;/idbag&gt;</PRE>
<P>&#20320;&#21487;&#20197;&#29702;&#35299;&#65292;<TT 
class=literal>&lt;idbag&gt;</TT>&#20154;&#24037;&#30340;id&#29983;&#25104;&#22120;&#65292;&#23601;&#22909;&#20687;&#26159;&#23454;&#20307;&#31867;&#19968;&#26679;&#65281;&#38598;&#21512;&#30340;&#27599;&#19968;&#34892;&#37117;&#26377;&#19968;&#20010;&#19981;&#21516;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290;&#20294;&#26159;&#65292;Hibernate&#27809;&#26377;&#25552;&#20379;&#20219;&#20309;&#26426;&#21046;&#26469;&#35753;&#20320;&#21462;&#24471;&#26576;&#20010;&#29305;&#23450;&#34892;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290; 
</P>
<P>&#27880;&#24847;<TT class=literal>&lt;idbag&gt;</TT>&#30340;&#26356;&#26032;&#24615;&#33021;&#35201;&#27604;&#26222;&#36890;&#30340;<TT 
class=literal>&lt;bag&gt;</TT>&#39640;&#24471;&#22810;&#65281;Hibernate&#21487;&#20197;&#26377;&#25928;&#30340;&#23450;&#20301;&#21040;&#19981;&#21516;&#30340;&#34892;&#65292;&#20998;&#21035;&#36827;&#34892;&#26356;&#26032;&#25110;&#21024;&#38500;&#24037;&#20316;&#65292;&#23601;&#22914;&#21516;&#22788;&#29702;&#19968;&#20010;list, 
map&#25110;&#32773;set&#19968;&#26679;&#12290; </P>
<P>&#22312;&#30446;&#21069;&#30340;&#23454;&#29616;&#20013;&#65292;&#36824;&#19981;&#25903;&#25345;&#20351;&#29992;<TT class=literal>identity</TT>&#26631;&#35782;&#31526;&#29983;&#25104;&#22120;&#31574;&#30053;&#26469;&#29983;&#25104;<TT 
class=literal>&lt;idbag&gt;</TT>&#38598;&#21512;&#30340;&#26631;&#35782;&#31526;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=collections-example></A>6.4.&nbsp;&#38598;&#21512;&#20363;&#23376;&#65288;Collection example&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#21069;&#38754;&#30340;&#20960;&#20010;&#31456;&#33410;&#30340;&#30830;&#38750;&#24120;&#20196;&#20154;&#36855;&#24785;&#12290; &#22240;&#27492;&#35753;&#25105;&#20204;&#26469;&#30475;&#19968;&#20010;&#20363;&#23376;&#12290;&#36825;&#20010;&#31867;&#65306; </P><PRE class=programlisting>package eg;
import java.util.Set;

public class Parent {
    private long id;
    private Set children;

    public long getId() { return id; }
    private void setId(long id) { this.id=id; }

    private Set getChildren() { return children; }
    private void setChildren(Set children) { this.children=children; }

    ....
    ....
}</PRE>
<P>&#36825;&#20010;&#31867;&#26377;&#19968;&#20010;<TT class=literal>Child</TT>&#30340;&#23454;&#20363;&#38598;&#21512;&#12290;&#22914;&#26524;&#27599;&#19968;&#20010;&#23376;&#23454;&#20363;&#33267;&#22810;&#26377;&#19968;&#20010;&#29238;&#23454;&#20363;, 
&#37027;&#20040;&#26368;&#33258;&#28982;&#30340;&#26144;&#23556;&#26159;&#19968;&#20010;one-to-many&#30340;&#20851;&#32852;&#20851;&#31995;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#22312;&#20197;&#19979;&#30340;&#34920;&#23450;&#20041;&#20013;&#21453;&#24212;&#20102;&#36825;&#20010;&#26144;&#23556;&#20851;&#31995;&#65306; </P><PRE class=programlisting>create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255), parent_id bigint )
alter table child add constraint childfk0 (parent_id) references parent</PRE>
<P>&#22914;&#26524;&#29238;&#20146;&#26159;<SPAN class=emphasis><EM>&#24517;&#39035;</EM></SPAN>&#30340;, &#37027;&#20040;&#23601;&#21487;&#20197;&#20351;&#29992;&#21452;&#21521;one-to-many&#30340;&#20851;&#32852;&#20102;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" inverse="true"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
        &lt;many-to-one name="parent" class="Parent" column="parent_id" not-null="true"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#35831;&#27880;&#24847;<TT class=literal>NOT NULL</TT>&#30340;&#32422;&#26463;: </P><PRE class=programlisting>create table parent ( id bigint not null primary key )
create table child ( id bigint not null
                     primary key,
                     name varchar(255),
                     parent_id bigint not null )
alter table child add constraint childfk0 (parent_id) references parent</PRE>
<P>&#21478;&#22806;&#65292;&#22914;&#26524;&#20320;&#32477;&#23545;&#22362;&#25345;&#36825;&#20010;&#20851;&#32852;&#24212;&#35813;&#26159;&#21333;&#21521;&#30340;&#65292;&#20320;&#21487;&#20197;&#23545;<TT class=literal>&lt;key&gt;</TT>&#26144;&#23556;&#22768;&#26126;<TT 
class=literal>NOT NULL</TT>&#32422;&#26463;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children"&gt;
            &lt;key column="parent_id" not-null="true"/&gt;
            &lt;one-to-many class="Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#21478;&#22806;&#19968;&#26041;&#38754;,&#22914;&#26524;&#19968;&#20010;&#23376;&#23454;&#20363;&#21487;&#33021;&#26377;&#22810;&#20010;&#29238;&#23454;&#20363;, &#37027;&#20040;&#23601;&#24212;&#35813;&#20351;&#29992;many-to-many&#20851;&#32852;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" table="childset"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;many-to-many class="Child" column="child_id"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#34920;&#23450;&#20041;&#65306; </P><PRE class=programlisting>create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255) )
create table childset ( parent_id bigint not null,
                        child_id bigint not null,
                        primary key ( parent_id, child_id ) )
alter table childset add constraint childsetfk0 (parent_id) references parent
alter table childset add constraint childsetfk1 (child_id) references child</PRE>
<P>&#26356;&#22810;&#30340;&#20363;&#23376;,&#20197;&#21450;&#19968;&#20010;&#23436;&#25972;&#30340;&#29238;/&#23376;&#20851;&#31995;&#26144;&#23556;&#30340;&#25490;&#32451;,&#35831;&#21442;&#38405;<A 
title="&#31532;&nbsp;21&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child Relationships)" 
href="#example-parentchild">&#31532;&nbsp;21&nbsp;&#31456; <I>&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child 
Relationships)</I></A>. </P>
<P>&#29978;&#33267;&#21487;&#33021;&#20986;&#29616;&#26356;&#21152;&#22797;&#26434;&#30340;&#20851;&#32852;&#26144;&#23556;,&#25105;&#20204;&#20250;&#22312;&#19979;&#19968;&#31456;&#20013;&#21015;&#20986;&#25152;&#26377;&#21487;&#33021;&#24615;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=associations></A>&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#20851;&#32852;&#20851;&#31995;&#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-intro></A>7.1.&nbsp;&#20171;&#32461;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20851;&#32852;&#20851;&#31995;&#26144;&#23556;&#36890;&#24120;&#24773;&#20917;&#26159;&#26368;&#38590;&#37197;&#32622;&#27491;&#30830;&#30340;&#12290;&#22312;&#36825;&#20010;&#37096;&#20998;&#20013;&#65292;&#25105;&#20204;&#20174;&#21333;&#21521;&#20851;&#31995;&#26144;&#23556;&#24320;&#22987;&#65292;&#28982;&#21518;&#32771;&#34385;&#21452;&#21521;&#20851;&#31995;&#26144;&#23556;&#65292;&#30001;&#27973;&#33267;&#28145;&#35762;&#36848;&#19968;&#36941;&#20856;&#22411;&#30340;&#26696;&#20363;&#12290;&#22312;&#25152;&#26377;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#37117;&#20351;&#29992; 
<TT class=literal>Person</TT>&#21644;<TT class=literal>Address</TT>&#12290; </P>
<P>&#25105;&#20204;&#26681;&#25454;&#26144;&#23556;&#20851;&#31995;&#26159;&#21542;&#28041;&#21450;&#36830;&#25509;&#34920;&#20197;&#21450;&#22810;&#26679;&#24615;&#26469;&#21010;&#20998;&#20851;&#32852;&#31867;&#22411;&#12290; </P>
<P>&#22312;&#20256;&#32479;&#30340;&#25968;&#25454;&#24314;&#27169;&#20013;&#65292;&#20801;&#35768;&#20026;Null&#20540;&#30340;&#22806;&#38190;&#34987;&#35748;&#20026;&#26159;&#19968;&#31181;&#19981;&#22909;&#30340;&#23454;&#36341;&#65292;&#22240;&#27492;&#25105;&#20204;&#25152;&#26377;&#30340;&#20363;&#23376;&#20013;&#37117;&#20351;&#29992;&#19981;&#20801;&#35768;&#20026;Null&#30340;&#22806;&#38190;&#12290;&#36825;&#24182;&#19981;&#26159;Hibernate&#30340;&#35201;&#27714;&#65292;&#21363;&#20351;&#20320;&#21024;&#38500;&#25481;&#19981;&#20801;&#35768;&#20026;Null&#30340;&#32422;&#26463;&#65292;Hibernate&#26144;&#23556;&#19968;&#26679;&#21487;&#20197;&#24037;&#20316;&#30340;&#24456;&#22909;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-unidirectional></A>7.2.&nbsp;&#21333;&#21521;&#20851;&#32852;&#65288;Unidirectional 
associations&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-m21></A>7.2.1.&nbsp;&#22810;&#23545;&#19968;(many to 
one)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#21333;&#21521;many-to-one&#20851;&#32852;</EM></SPAN>&#26159;&#26368;&#24120;&#35265;&#30340;&#21333;&#21521;&#20851;&#32852;&#20851;&#31995;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key, addressId bigint not null )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-121></A>7.2.2.&nbsp;&#19968;&#23545;&#19968;&#65288;one to 
one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#22806;&#38190;&#20851;&#32852;&#30340;&#21333;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#21644;<SPAN 
class=emphasis><EM>&#21333;&#21521;&#22810;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#20960;&#20046;&#26159;&#19968;&#26679;&#30340;&#12290;&#21807;&#19968;&#30340;&#19981;&#21516;&#23601;&#26159;&#21333;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;&#20013;&#30340;&#22806;&#38190;&#23383;&#27573;&#20855;&#26377;&#21807;&#19968;&#24615;&#32422;&#26463;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId" 
        unique="true"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key, addressId bigint not null unique )
create table Address ( addressId bigint not null primary key )
        </PRE>
<P><SPAN 
class=emphasis><EM>&#22522;&#20110;&#20027;&#38190;&#20851;&#32852;&#30340;&#21333;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#36890;&#24120;&#20351;&#29992;&#19968;&#20010;&#29305;&#23450;&#30340;id&#29983;&#25104;&#22120;&#12290;&#65288;&#35831;&#27880;&#24847;&#65292;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#25105;&#20204;&#25481;&#25442;&#20102;&#20851;&#32852;&#30340;&#26041;&#21521;&#12290;&#65289; 
</P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;person&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    &lt;one-to-one name="person" constrained="true"/&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table Address ( personId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-12m></A>7.2.3.&nbsp;&#19968;&#23545;&#22810;&#65288;one to 
many&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#22806;&#38190;&#20851;&#32852;&#30340;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;</EM></SPAN>&#26159;&#19968;&#31181;&#24456;&#23569;&#35265;&#30340;&#24773;&#20917;&#65292;&#24182;&#19981;&#25512;&#33616;&#20351;&#29992;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses"&gt;
        &lt;key column="personId" 
            not-null="true"/&gt;
        &lt;one-to-many class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table Address ( addressId bigint not null primary key, personId bigint not null )
        </PRE>
<P>&#25105;&#20204;&#35748;&#20026;&#23545;&#20110;&#36825;&#31181;&#20851;&#32852;&#20851;&#31995;&#26368;&#22909;&#20351;&#29992;&#36830;&#25509;&#34920;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-unidirectional-join></A>7.3.&nbsp;&#20351;&#29992;&#36830;&#25509;&#34920;&#30340;&#21333;&#21521;&#20851;&#32852;&#65288;Unidirectional 
associations with join tables&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-join-12m></A>7.3.1.&nbsp;&#19968;&#23545;&#22810;(one to 
many)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#36830;&#25509;&#34920;&#30340;&#21333;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;</EM></SPAN> &#24212;&#35813;&#20248;&#20808;&#34987;&#37319;&#29992;&#12290;&#35831;&#27880;&#24847;&#65292;&#36890;&#36807;&#25351;&#23450;<TT 
class=literal>unique="true"</TT>&#65292;&#25105;&#20204;&#21487;&#20197;&#25226;&#22810;&#26679;&#24615;&#20174;&#22810;&#23545;&#22810;&#25913;&#21464;&#20026;&#19968;&#23545;&#22810;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses" table="PersonAddress"&gt;
        &lt;key column="personId"/&gt;
        &lt;many-to-many column="addressId"
            unique="true"
            class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId not null, addressId bigint not null primary key )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-join-m21></A>7.3.2.&nbsp;&#22810;&#23545;&#19968;&#65288;many 
to one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#36830;&#25509;&#34920;&#30340;&#21333;&#21521;&#22810;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#22312;&#20851;&#32852;&#20851;&#31995;&#21487;&#36873;&#30340;&#24773;&#20917;&#19979;&#24212;&#29992;&#20063;&#24456;&#26222;&#36941;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;join table="PersonAddress" 
        optional="true"&gt;
        &lt;key column="personId" unique="true"/&gt;
        &lt;many-to-one name="address"
            column="addressId" 
            not-null="true"/&gt;
    &lt;/join&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null primary key, addressId bigint not null )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-join-121></A>7.3.3.&nbsp;&#19968;&#23545;&#19968;&#65288;one to 
one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#36830;&#25509;&#34920;&#30340;&#21333;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#38750;&#24120;&#23569;&#35265;&#65292;&#20294;&#20063;&#26159;&#21487;&#34892;&#30340;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;join table="PersonAddress" 
        optional="true"&gt;
        &lt;key column="personId" 
            unique="true"/&gt;
        &lt;many-to-one name="address"
            column="addressId" 
            not-null="true"
            unique="true"/&gt;
    &lt;/join&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null primary key, addressId bigint not null unique )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-unidirectional-join-m2m></A>7.3.4.&nbsp;&#22810;&#23545;&#22810;&#65288;many 
to many&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26368;&#21518;&#65292;&#36824;&#26377; <SPAN class=emphasis><EM>&#21333;&#21521;&#22810;&#23545;&#22810;&#20851;&#32852;</EM></SPAN>. </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses" table="PersonAddress"&gt;
        &lt;key column="personId"/&gt;
        &lt;many-to-many column="addressId"
            class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null, addressId bigint not null, primary key (personId, addressId) )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-bidirectional></A>7.4.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional 
associations&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-bidirectional-m21></A>7.4.1.&nbsp;&#19968;&#23545;&#22810;&#65288;one to many) 
/ &#22810;&#23545;&#19968;&#65288;many to one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#21452;&#21521;&#22810;&#23545;&#19968;&#20851;&#32852;</EM></SPAN> &#26159;&#26368;&#24120;&#35265;&#30340;&#20851;&#32852;&#20851;&#31995;&#12290;&#65288;&#36825;&#20063;&#26159;&#26631;&#20934;&#30340;&#29238;/&#23376;&#20851;&#32852;&#20851;&#31995;&#12290;&#65289; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="people" inverse="true"&gt;
        &lt;key column="addressId"/&gt;
        &lt;one-to-many class="Person"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key, addressId bigint not null )
create table Address ( addressId bigint not null primary key )
        </PRE>
<P>&#22914;&#26524;&#20320;&#20351;&#29992;<TT class=literal>List</TT>(&#25110;&#32773;&#20854;&#20182;&#26377;&#24207;&#38598;&#21512;&#31867;)&#65292;&#20320;&#38656;&#35201;&#35774;&#32622;&#22806;&#38190;&#23545;&#24212;&#30340;<TT 
class=literal>key</TT>&#21015;&#20026; <TT class=literal>not 
null</TT>,&#35753;Hibernate&#26469;&#20174;&#38598;&#21512;&#31471;&#31649;&#29702;&#20851;&#32852;&#65292;&#32500;&#25252;&#27599;&#20010;&#20803;&#32032;&#30340;&#32034;&#24341;&#65288;&#36890;&#36807;&#35774;&#32622;<TT 
class=literal>update="false"</TT> and <TT 
class=literal>insert="false"</TT>&#26469;&#23545;&#21478;&#19968;&#31471;&#21453;&#21521;&#25805;&#20316;&#65289;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
   &lt;id name="id"/&gt;
   ...
   &lt;many-to-one name="address"
      column="addressId"
      not-null="true"
      insert="false"
      update="false"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
   &lt;id name="id"/&gt;
   ...
   &lt;list name="people"&gt;
      &lt;key column="addressId" not-null="true"/&gt;
      &lt;list-index column="peopleIdx"/&gt;
      &lt;one-to-many class="Person"/&gt;
   &lt;/list&gt;
&lt;/class&gt;</PRE>
<P>&#20551;&#33509;&#38598;&#21512;&#26144;&#23556;&#30340;<TT class=literal>&lt;key&gt;</TT>&#20803;&#32032;&#23545;&#24212;&#30340;&#24213;&#23618;&#22806;&#38190;&#23383;&#27573;&#26159;<TT class=literal>NOT 
NULL</TT>&#30340;&#65292;&#37027;&#20040;&#20026;&#36825;&#19968;key&#20803;&#32032;&#23450;&#20041;<TT class=literal>not-null="true"</TT>&#26159;&#24456;&#37325;&#35201;&#30340;&#12290;&#19981;&#35201;&#20165;&#20165;&#20026;&#21487;&#33021;&#30340;&#23884;&#22871;<TT 
class=literal>&lt;column&gt;</TT>&#20803;&#32032;&#23450;&#20041;<TT class=literal>not-null="true"</TT>&#65292;<TT 
class=literal>&lt;key&gt;</TT>&#20803;&#32032;&#20063;&#26159;&#38656;&#35201;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-bidirectional-121></A>7.4.2.&nbsp;&#19968;&#23545;&#19968;&#65288;one to 
one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#22806;&#38190;&#20851;&#32852;&#30340;&#21452;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#20063;&#24456;&#24120;&#35265;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;many-to-one name="address" 
        column="addressId" 
        unique="true"
        not-null="true"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
   &lt;one-to-one name="person" 
        property-ref="address"/&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key, addressId bigint not null unique )
create table Address ( addressId bigint not null primary key )
        </PRE>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#20027;&#38190;&#20851;&#32852;&#30340;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#38656;&#35201;&#20351;&#29992;&#29305;&#23450;&#30340;id&#29983;&#25104;&#22120;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;one-to-one name="address"/&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;person&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    &lt;one-to-one name="person" 
        constrained="true"/&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table Address ( personId bigint not null primary key )
        </PRE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-bidirectional-join></A>7.5.&nbsp;&#20351;&#29992;&#36830;&#25509;&#34920;&#30340;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional 
associations with join tables&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-bidirectional-join-12m></A>7.5.1.&nbsp;&#19968;&#23545;&#22810;&#65288;one to 
many&#65289; /&#22810;&#23545;&#19968;&#65288; many to one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#36830;&#25509;&#34920;&#30340;&#21452;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;</EM></SPAN>&#12290;&#27880;&#24847;<TT 
class=literal>inverse="true"</TT>&#21487;&#20197;&#20986;&#29616;&#22312;&#20851;&#32852;&#30340;&#20219;&#24847;&#19968;&#31471;&#65292;&#21363;collection&#31471;&#25110;&#32773;join&#31471;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses" 
        table="PersonAddress"&gt;
        &lt;key column="personId"/&gt;
        &lt;many-to-many column="addressId"
            unique="true"
            class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;join table="PersonAddress" 
        inverse="true" 
        optional="true"&gt;
        &lt;key column="addressId"/&gt;
        &lt;many-to-one name="person"
            column="personId"
            not-null="true"/&gt;
    &lt;/join&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null, addressId bigint not null primary key )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-bidirectional-join-121></A>7.5.2.&nbsp;&#19968;&#23545;&#19968;&#65288;one to 
one&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#22522;&#20110;&#36830;&#25509;&#34920;&#30340;&#21452;&#21521;&#19968;&#23545;&#19968;&#20851;&#32852;</EM></SPAN>&#26497;&#20026;&#32597;&#35265;&#65292;&#20294;&#20063;&#26159;&#21487;&#34892;&#30340;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;join table="PersonAddress" 
        optional="true"&gt;
        &lt;key column="personId" 
            unique="true"/&gt;
        &lt;many-to-one name="address"
            column="addressId" 
            not-null="true"
            unique="true"/&gt;
    &lt;/join&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;join table="PersonAddress" 
        optional="true"
        inverse="true"&gt;
        &lt;key column="addressId" 
            unique="true"/&gt;
        &lt;many-to-one name="person"
            column="personId" 
            not-null="true"
            unique="true"/&gt;
    &lt;/join&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null primary key, addressId bigint not null unique )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=assoc-bidirectional-join-m2m></A>7.5.3.&nbsp;&#22810;&#23545;&#22810;&#65288;many to 
many&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26368;&#21518;&#65292;&#36824;&#26377; <SPAN class=emphasis><EM>&#21452;&#21521;&#22810;&#23545;&#22810;&#20851;&#32852;</EM></SPAN>. </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id" column="personId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="addresses"  table="PersonAddress"&gt;
        &lt;key column="personId"/&gt;
        &lt;many-to-many column="addressId"
            class="Address"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Address"&gt;
    &lt;id name="id" column="addressId"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;set name="people" inverse="true"  table="PersonAddress"&gt;
        &lt;key column="addressId"/&gt;
        &lt;many-to-many column="personId"
            class="Person"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE><PRE class=programlisting>create table Person ( personId bigint not null primary key )
create table PersonAddress ( personId bigint not null, addressId bigint not null, primary key (personId, addressId) )
create table Address ( addressId bigint not null primary key )
        </PRE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=assoc-complex></A>7.6.&nbsp;&#26356;&#22797;&#26434;&#30340;&#20851;&#32852;&#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26356;&#22797;&#26434;&#30340;&#20851;&#32852;&#36830;&#25509;<SPAN class=emphasis><EM>&#26497;&#20026;</EM></SPAN>&#32597;&#35265;&#12290; 
&#36890;&#36807;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23884;&#20837;SQL&#29255;&#26029;&#65292;Hibernate&#20063;&#21487;&#20197;&#22788;&#29702;&#26356;&#20026;&#22797;&#26434;&#30340;&#24773;&#20917;&#12290;&#27604;&#22914;&#65292;&#20551;&#33509;&#21253;&#21547;&#21382;&#21490;&#24080;&#25143;&#25968;&#25454;&#30340;&#34920;&#23450;&#20041;&#20102;<TT 
class=literal>accountNumber</TT>, <TT class=literal>effectiveEndDate</TT> &#21644;<TT 
class=literal>effectiveStartDate</TT>&#23383;&#27573;&#65292;&#25353;&#29031;&#19979;&#38754;&#26144;&#23556;&#65306; </P><PRE class=programlisting>&lt;properties name="currentAccountKey"&gt;
    &lt;property name="accountNumber" type="string" not-null="true"/&gt;
    &lt;property name="currentAccount" type="boolean"&gt;
        &lt;formula&gt;case when effectiveEndDate is null then 1 else 0 end&lt;/formula&gt;
    &lt;/property&gt;
&lt;/properties&gt;
&lt;property name="effectiveEndDate" type="date"/&gt;
&lt;property name="effectiveStateDate" type="date" not-null="true"/&gt;</PRE>
<P>&#37027;&#20040;&#25105;&#20204;&#21487;&#20197;&#23545;<SPAN class=emphasis><EM>&#30446;&#21069;(current)</EM></SPAN>&#23454;&#20363;(&#20854;<TT 
class=literal>effectiveEndDate</TT>&#20026;null)&#20351;&#29992;&#36825;&#26679;&#30340;&#20851;&#32852;&#26144;&#23556;: </P><PRE class=programlisting>&lt;many-to-one name="currentAccountInfo" 
        property-ref="currentAccountKey"
        class="AccountInfo"&gt;
    &lt;column name="accountNumber"/&gt;
    &lt;formula&gt;'1'&lt;/formula&gt;
&lt;/many-to-one&gt;</PRE>
<P>&#26356;&#22797;&#26434;&#30340;&#20363;&#23376;,&#20551;&#24819;<TT class=literal>Employee</TT>&#21644;<TT 
class=literal>Organization</TT>&#20043;&#38388;&#30340;&#20851;&#32852;&#26159;&#36890;&#36807;&#19968;&#20010;<TT 
class=literal>Employment</TT>&#20013;&#38388;&#34920;&#32500;&#25252;&#30340;,&#32780;&#20013;&#38388;&#34920;&#20013;&#22635;&#20805;&#20102;&#24456;&#22810;&#21382;&#21490;&#38599;&#21592;&#25968;&#25454;&#12290;&#37027;“&#38599;&#21592;&#30340;<SPAN 
class=emphasis><EM>&#26368;&#26032;</EM></SPAN>&#38599;&#20027;”&#36825;&#20010;&#20851;&#32852;&#65288;&#26368;&#26032;&#38599;&#20027;&#23601;&#26159;<TT 
class=literal>startDate</TT>&#26368;&#21518;&#30340;&#37027;&#20010;&#65289;&#21487;&#20197;&#36825;&#26679;&#26144;&#23556;&#65306; </P><PRE class=programlisting>&lt;join&gt;
    &lt;key column="employeeId"/&gt;
    &lt;subselect&gt;
        select employeeId, orgId 
        from Employments 
        group by orgId 
        having startDate = max(startDate)
    &lt;/subselect&gt;
    &lt;many-to-one name="mostRecentEmployer" 
            class="Organization" 
            column="orgId"/&gt;
&lt;/join&gt;</PRE>
<P>&#20351;&#29992;&#36825;&#19968;&#21151;&#33021;&#26102;&#21487;&#20197;&#20805;&#28385;&#21019;&#24847;&#65292;&#20294;&#36890;&#24120;&#26356;&#21152;&#23454;&#29992;&#30340;&#26159;&#29992;HQL&#25110;&#26465;&#20214;&#26597;&#35810;&#26469;&#22788;&#29702;&#36825;&#20123;&#24773;&#24418;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=components></A>&#31532;&nbsp;8&nbsp;&#31456;&nbsp;&#32452;&#20214;&#65288;Component&#65289;&#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN 
class=emphasis><EM>&#32452;&#20214;</EM></SPAN>(Component)&#36825;&#20010;&#27010;&#24565;&#22312;Hibernate&#20013;&#20960;&#22788;&#19981;&#21516;&#30340;&#22320;&#26041;&#20026;&#20102;&#19981;&#21516;&#30340;&#30446;&#30340;&#34987;&#37325;&#22797;&#20351;&#29992;. 
</P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=components-dependentobjects></A>8.1.&nbsp;&#20381;&#36182;&#23545;&#35937;&#65288;Dependent 
objects&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#32452;&#20214;(Component)&#26159;&#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23545;&#35937;&#65292;&#22312;&#25345;&#20037;&#21270;&#30340;&#36807;&#31243;&#20013;&#65292;&#23427;&#34987;&#24403;&#20316;&#20540;&#31867;&#22411;&#65292;&#32780;&#24182;&#38750;&#19968;&#20010;&#23454;&#20307;&#30340;&#24341;&#29992;&#12290;&#22312;&#36825;&#31687;&#25991;&#26723;&#20013;&#65292;&#32452;&#20214;&#36825;&#19968;&#26415;&#35821;&#25351;&#30340;&#26159;&#38754;&#21521;&#23545;&#35937;&#30340;&#21512;&#25104;&#27010;&#24565;&#65288;&#32780;&#24182;&#19981;&#26159;&#31995;&#32479;&#26500;&#26550;&#23618;&#27425;&#19978;&#30340;&#32452;&#20214;&#30340;&#27010;&#24565;&#65289;&#12290;&#20030;&#20010;&#20363;&#23376;, 
&#20320;&#23545;&#20154;(Person)&#36825;&#20010;&#27010;&#24565;&#21487;&#20197;&#20687;&#19979;&#38754;&#36825;&#26679;&#26469;&#24314;&#27169;&#65306; </P><PRE class=programlisting>public class Person {
    private java.util.Date birthday;
    private Name name;
    private String key;
    public String getKey() {
        return key;
    }
    private void setKey(String key) {
        this.key=key;
    }
    public java.util.Date getBirthday() {
        return birthday;
    }
    public void setBirthday(java.util.Date birthday) {
        this.birthday = birthday;
    }
    public Name getName() {
        return name;
    }
    public void setName(Name name) {
        this.name = name;
    }
    ......
    ......
}</PRE><PRE class=programlisting>public class Name {
    char initial;
    String first;
    String last;
    public String getFirst() {
        return first;
    }
    void setFirst(String first) {
        this.first = first;
    }
    public String getLast() {
        return last;
    }
    void setLast(String last) {
        this.last = last;
    }
    public char getInitial() {
        return initial;
    }
    void setInitial(char initial) {
        this.initial = initial;
    }
}</PRE>
<P>&#22312;&#25345;&#20037;&#21270;&#30340;&#36807;&#31243;&#20013;,<TT class=literal>&#22995;&#21517;(Name)</TT>&#21487;&#20197;&#20316;&#20026;<TT 
class=literal>&#20154;(Person)</TT>&#30340;&#19968;&#20010;&#32452;&#20214;&#12290;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;:&#20320;&#24212;&#35813;&#20026;<TT 
class=literal>&#22995;&#21517;</TT>&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;&#23450;&#20041;getter&#21644;setter&#26041;&#27861;,&#20294;&#26159;&#20320;&#19981;&#38656;&#35201;&#23454;&#29616;&#20219;&#20309;&#30340;&#25509;&#21475;&#25110;&#30003;&#26126;&#26631;&#35782;&#31526;&#23383;&#27573;&#12290; </P>
<P>&#20197;&#19979;&#26159;&#36825;&#20010;&#20363;&#23376;&#30340;Hibernate&#26144;&#23556;&#25991;&#20214;: </P><PRE class=programlisting>&lt;class name="eg.Person" table="person"&gt;
    &lt;id name="Key" column="pid" type="string"&gt;
        &lt;generator class="uuid"/&gt;
    &lt;/id&gt;
    &lt;property name="birthday" type="date"/&gt;
    &lt;component name="Name" class="eg.Name"&gt; &lt;!-- class attribute optional --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;
    &lt;/component&gt;
&lt;/class&gt;</PRE>
<P>&#20154;&#21592;(Person)&#34920;&#20013;&#23558;&#21253;&#25324;<TT class=literal>pid</TT>, <TT class=literal>birthday</TT>, 
<TT class=literal>initial</TT>, <TT class=literal>first</TT>&#21644; <TT 
class=literal>last</TT>&#31561;&#23383;&#27573;&#12290;</P>
<P>&#23601;&#20687;&#25152;&#26377;&#30340;&#20540;&#31867;&#22411;&#19968;&#26679;, &#32452;&#20214;&#19981;&#25903;&#25345;&#20849;&#20139;&#24341;&#29992;&#12290; 
&#25442;&#21477;&#35805;&#35828;&#65292;&#20004;&#20010;&#20154;&#21487;&#33021;&#37325;&#21517;&#65292;&#20294;&#26159;&#20004;&#20010;Person&#23545;&#35937;&#24212;&#35813;&#21253;&#21547;&#20004;&#20010;&#29420;&#31435;&#30340;Name&#23545;&#35937;&#65292;&#21482;&#19981;&#36807;&#36825;&#20004;&#20010;Name&#23545;&#35937;&#20855;&#26377;“&#21516;&#26679;”&#30340;&#20540;&#12290; &#32452;&#20214;&#30340;&#20540;&#21487;&#20197;&#20026;&#31354;&#65292;&#20854;&#23450;&#20041;&#22914;&#19979;&#12290; 
&#27599;&#24403;Hibernate&#37325;&#26032;&#21152;&#36733;&#19968;&#20010;&#21253;&#21547;&#32452;&#20214;&#30340;&#23545;&#35937;,&#22914;&#26524;&#35813;&#32452;&#20214;&#30340;&#25152;&#26377;&#23383;&#27573;&#20026;&#31354;&#65292;Hibernate&#23558;&#20551;&#23450;&#25972;&#20010;&#32452;&#20214;&#20026;&#31354;&#12290; &#22312;&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;,&#36825;&#26679;&#20551;&#23450;&#24212;&#35813;&#26159;&#27809;&#26377;&#38382;&#39064;&#30340;&#12290; 
</P>
<P>&#32452;&#20214;&#30340;&#23646;&#24615;&#21487;&#20197;&#26159;&#20219;&#24847;&#19968;&#31181;Hibernate&#31867;&#22411;&#65288;&#21253;&#25324;&#38598;&#21512;, &#22810;&#23545;&#22810;&#20851;&#32852;&#65292; &#20197;&#21450;&#20854;&#23427;&#32452;&#20214;&#31561;&#31561;&#65289;&#12290;&#23884;&#22871;&#32452;&#20214;&#19981;&#24212;&#35813;&#34987;&#24403;&#20316;&#19968;&#31181;&#29305;&#27530;&#30340;&#24212;&#29992;(Nested 
components should not be considered an exotic usage)&#12290; 
Hibernate&#20542;&#21521;&#20110;&#25903;&#25345;&#32454;&#33268;&#30340;(fine-grained)&#23545;&#35937;&#27169;&#22411;&#12290; </P>
<P><TT class=literal>&lt;component&gt;</TT> &#20803;&#32032;&#36824;&#20801;&#35768;&#26377; <TT 
class=literal>&lt;parent&gt;</TT>&#23376;&#20803;&#32032;&#65292;&#29992;&#26469;&#34920;&#26126;component&#31867;&#20013;&#30340;&#19968;&#20010;&#23646;&#24615;&#26159;&#25351;&#21521;&#21253;&#21547;&#23427;&#30340;&#23454;&#20307;&#30340;&#24341;&#29992;&#12290; </P><PRE class=programlisting>&lt;class name="eg.Person" table="person"&gt;
    &lt;id name="Key" column="pid" type="string"&gt;
        &lt;generator class="uuid"/&gt;
    &lt;/id&gt;
    &lt;property name="birthday" type="date"&gt;
    &lt;component name="Name" class="eg.Name" unique="true"&gt;
        &lt;parent name="namedPerson"/&gt; &lt;!-- reference back to the Person --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;
    &lt;/component&amp;gt;
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=components-incollections></A>8.2.&nbsp;&#22312;&#38598;&#21512;&#20013;&#20986;&#29616;&#30340;&#20381;&#36182;&#23545;&#35937; (Collections of 
dependent objects)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#25903;&#25345;&#32452;&#20214;&#30340;&#38598;&#21512;(&#20363;&#22914;: &#19968;&#20010;&#20803;&#32032;&#26159;&#22995;&#21517;(Name)&#36825;&#31181;&#31867;&#22411;&#30340;&#25968;&#32452;)&#12290; &#20320;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>&lt;composite-element&gt;</TT>&#26631;&#31614;&#26367;&#20195;<TT 
class=literal>&lt;element&gt;</TT>&#26631;&#31614;&#26469;&#23450;&#20041;&#20320;&#30340;&#32452;&#20214;&#38598;&#21512;&#12290; </P><PRE class=programlisting>&lt;set name="someNames" table="some_names" lazy="true"&gt;
    &lt;key column="id"/&amp;gt;
    &lt;composite-element class="eg.Name"&gt; &lt;!-- class attribute required --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;;
    &lt;/composite-element&gt;
&lt;/set&gt;</PRE>
<P>&#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#23450;&#20041;&#30340;Set&#21253;&#21547;&#32452;&#21512;&#20803;&#32032;(composite-element)&#65292;&#27491;&#30830;&#22320;&#23454;&#29616;<TT 
class=literal>equals()</TT>&#21644;<TT class=literal>hashCode()</TT>&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#12290; </P>
<P>&#32452;&#21512;&#20803;&#32032;&#21487;&#20197;&#21253;&#21547;&#32452;&#20214;&#65292;&#20294;&#26159;&#19981;&#33021;&#21253;&#21547;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#30340;&#32452;&#21512;&#20803;&#32032;&#33258;&#36523;&#21253;&#21547;&#32452;&#20214;, &#20320;&#24517;&#39035;&#20351;&#29992;<TT 
class=literal>&lt;nested-composite-element&gt;</TT>&#26631;&#31614;&#12290;&#36825;&#26159;&#19968;&#20010;&#30456;&#24403;&#29305;&#27530;&#30340;&#26696;&#20363; - 
&#22312;&#19968;&#20010;&#32452;&#20214;&#30340;&#38598;&#21512;&#37324;&#65292;&#37027;&#20123;&#32452;&#20214;&#26412;&#36523;&#21448;&#21487;&#20197;&#21253;&#21547;&#20854;&#20182;&#30340;&#32452;&#20214;&#12290;&#36825;&#20010;&#26102;&#20505;&#20320;&#23601;&#24212;&#35813;&#32771;&#34385;&#19968;&#19979;&#20351;&#29992;one-to-many&#20851;&#32852;&#26159;&#21542;&#20250;&#26356;&#24688;&#24403;&#12290; 
&#23581;&#35797;&#23545;&#36825;&#20010;&#32452;&#21512;&#20803;&#32032;&#37325;&#26032;&#24314;&#27169;&#20026;&#19968;&#20010;&#23454;&#20307;&#65293;&#20294;&#26159;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#34429;&#28982;Java&#27169;&#22411;&#21644;&#37325;&#26032;&#24314;&#27169;&#21069;&#26159;&#19968;&#26679;&#30340;&#65292;&#20851;&#31995;&#27169;&#22411;&#21644;&#25345;&#20037;&#24615;&#35821;&#20041;&#20250;&#26377;&#32454;&#24494;&#30340;&#21464;&#21270;&#12290; </P>
<P>&#35831;&#27880;&#24847;&#22914;&#26524;&#20320;&#20351;&#29992;<TT class=literal>&lt;set&gt;</TT>&#26631;&#31614;,&#19968;&#20010;&#32452;&#21512;&#20803;&#32032;&#30340;&#26144;&#23556;&#19981;&#25903;&#25345;&#21487;&#33021;&#20026;&#31354;&#30340;&#23646;&#24615;. &#24403;&#21024;&#38500;&#23545;&#35937;&#26102;&#65292; 
Hibernate&#24517;&#39035;&#20351;&#29992;&#27599;&#19968;&#20010;&#23383;&#27573;&#30340;&#20540;&#26469;&#30830;&#23450;&#19968;&#26465;&#35760;&#24405;(&#22312;&#32452;&#21512;&#20803;&#32032;&#34920;&#20013;&#65292;&#27809;&#26377;&#21333;&#29420;&#30340;&#20851;&#38190;&#23383;&#27573;)&#65292; 
&#22914;&#26524;&#26377;&#20026;null&#30340;&#23383;&#27573;&#65292;&#36825;&#26679;&#20570;&#23601;&#19981;&#21487;&#33021;&#20102;&#12290;&#20320;&#24517;&#39035;&#20316;&#20986;&#19968;&#20010;&#36873;&#25321;&#65292;&#35201;&#20040;&#22312;&#32452;&#21512;&#20803;&#32032;&#20013;&#20351;&#29992;&#19981;&#33021;&#20026;&#31354;&#30340;&#23646;&#24615;&#65292;&#35201;&#20040;&#36873;&#25321;&#20351;&#29992;<TT 
class=literal>&lt;list&gt;</TT>,<TT class=literal>&lt;map&gt;</TT>,<TT 
class=literal>&lt;bag&gt;</TT> &#25110;&#32773; <TT class=literal>&lt;idbag&gt;</TT>&#32780;&#19981;&#26159; <TT 
class=literal>&lt;set&gt;</TT>&#12290; </P>
<P>&#32452;&#21512;&#20803;&#32032;&#26377;&#20010;&#29305;&#21035;&#30340;&#29992;&#27861;&#26159;&#23427;&#21487;&#20197;&#21253;&#21547;&#19968;&#20010;<TT 
class=literal>&lt;many-to-one&gt;</TT>&#20803;&#32032;&#12290;&#31867;&#20284;&#36825;&#26679;&#30340;&#26144;&#23556;&#20801;&#35768;&#20320;&#23558;&#19968;&#20010;many-to-many&#20851;&#32852;&#34920;&#26144;&#23556;&#20026;&#32452;&#21512;&#20803;&#32032;&#30340;&#38598;&#21512;&#12290;(A 
mapping like this allows you to map extra columns of a many-to-many association 
table to the composite element class.) &#25509;&#19979;&#26469;&#30340;&#30340;&#20363;&#23376;&#26159;&#20174;<TT class=literal>Order</TT>&#21040;<TT 
class=literal>Item</TT>&#30340;&#19968;&#20010;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;&#20851;&#31995;, &#20851;&#32852;&#23646;&#24615;&#26159; <TT class=literal>purchaseDate</TT>, 
<TT class=literal>price</TT> &#21644; <TT class=literal>quantity</TT> &#12290; </P><PRE class=programlisting>&lt;class name="eg.Order" .... &gt;
    ....
    &lt;set name="purchasedItems" table="purchase_items" lazy="true"&gt;
        &lt;key column="order_id"&gt;
        &lt;composite-element class="eg.Purchase"&gt;
            &lt;property name="purchaseDate"/&gt;
            &lt;property name="price"/&gt;
            &lt;property name="quantity"/&gt;
            &lt;many-to-one name="item" class="eg.Item"/&gt; &lt;!-- class attribute is optional --&gt;
        &lt;/composite-element&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE>
<P>&#24403;&#28982;&#65292;&#24403;&#20320;&#23450;&#20041;Item&#26102;&#65292;&#20320;&#26080;&#27861;&#24341;&#29992;&#36825;&#20123;purchase&#65292;&#22240;&#27492;&#20320;&#26080;&#27861;&#23454;&#29616;&#21452;&#21521;&#20851;&#32852;&#26597;&#35810;&#12290;&#35760;&#20303;&#32452;&#20214;&#26159;&#20540;&#31867;&#22411;&#65292;&#24182;&#19988;&#19981;&#20801;&#35768;&#20849;&#20139;&#24341;&#29992;&#12290;&#26576;&#19968;&#20010;&#29305;&#23450;&#30340;<TT 
class=literal>Purchase</TT> &#21487;&#20197;&#25918;&#22312;<TT class=literal>Order</TT>&#30340;&#38598;&#21512;&#20013;&#65292;&#20294;&#23427;&#19981;&#33021;&#21516;&#26102;&#34987;<TT 
class=literal>Item</TT>&#25152;&#24341;&#29992;&#12290; </P>
<P>&#20854;&#23454;&#32452;&#21512;&#20803;&#32032;&#30340;&#36825;&#20010;&#29992;&#27861;&#21487;&#20197;&#25193;&#23637;&#21040;&#19977;&#37325;&#25110;&#22810;&#37325;&#20851;&#32852;:</P><PRE class=programlisting>&lt;class name="eg.Order" .... &gt;
    ....
    &lt;set name="purchasedItems" table="purchase_items" lazy="true"&gt;
        &lt;key column="order_id"&gt;
        &lt;composite-element class="eg.OrderLine"&gt;
            &lt;many-to-one name="purchaseDetails" class="eg.Purchase"/&gt;
            &lt;many-to-one name="item" class="eg.Item"/&gt;
        &lt;/composite-element&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE>
<P>&#22312;&#26597;&#35810;&#20013;&#65292;&#34920;&#36798;&#32452;&#21512;&#20803;&#32032;&#30340;&#35821;&#27861;&#21644;&#20851;&#32852;&#21040;&#20854;&#20182;&#23454;&#20307;&#30340;&#35821;&#27861;&#26159;&#19968;&#26679;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=components-asmapindex></A>8.3.&nbsp;&#32452;&#20214;&#20316;&#20026;Map&#30340;&#32034;&#24341;&#65288;Components as Map indices 
&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>&lt;composite-map-key&gt;</TT>&#20803;&#32032;&#20801;&#35768;&#20320;&#26144;&#23556;&#19968;&#20010;&#32452;&#20214;&#31867;&#20316;&#20026;&#19968;&#20010;<TT 
class=literal>Map</TT>&#30340;key&#65292;&#21069;&#25552;&#26159;&#20320;&#24517;&#39035;&#27491;&#30830;&#30340;&#22312;&#36825;&#20010;&#31867;&#20013;&#37325;&#20889;&#20102;<TT class=literal>hashCode()</TT> &#21644; 
<TT class=literal>equals()</TT>&#26041;&#27861;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=components-compositeid></A>8.4.&nbsp;&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite 
identifiers)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#32452;&#20214;&#20316;&#20026;&#19968;&#20010;&#23454;&#20307;&#31867;&#30340;&#26631;&#35782;&#31526;&#12290; &#20320;&#30340;&#32452;&#20214;&#31867;&#24517;&#39035;&#28385;&#36275;&#20197;&#19979;&#35201;&#27714;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#23427;&#24517;&#39035;&#23454;&#29616;<TT class=literal>java.io.Serializable</TT>&#25509;&#21475; </P>
  <LI>
  <P>&#23427;&#24517;&#39035;&#37325;&#26032;&#23454;&#29616;<TT class=literal>equals()</TT>&#21644;<TT class=literal>hashCode()</TT>&#26041;&#27861;, 
  &#22987;&#32456;&#21644;&#32452;&#21512;&#20851;&#38190;&#23383;&#22312;&#25968;&#25454;&#24211;&#20013;&#30340;&#27010;&#24565;&#20445;&#25345;&#19968;&#33268; </P></LI></UL></DIV>
<P><SPAN 
class=emphasis><EM>&#27880;&#24847;&#65306;&#22312;Hibernate3&#20013;&#65292;&#31532;&#20108;&#20010;&#35201;&#27714;&#24182;&#38750;&#26159;Hibernate&#24378;&#21046;&#24517;&#39035;&#30340;&#12290;&#20294;&#26368;&#22909;&#36825;&#26679;&#20570;&#12290;</EM></SPAN> 
</P>
<P>&#20320;&#19981;&#33021;&#20351;&#29992;&#19968;&#20010;<TT class=literal>IdentifierGenerator</TT>&#20135;&#29983;&#32452;&#21512;&#20851;&#38190;&#23383;&#12290;&#19968;&#20010;&#24212;&#29992;&#31243;&#24207;&#24517;&#39035;&#20998;&#37197;&#23427;&#33258;&#24049;&#30340;&#26631;&#35782;&#31526;&#12290; 
</P>
<P>&#20351;&#29992;<TT class=literal>&lt;composite-id&gt;</TT> &#26631;&#31614;(&#24182;&#19988;&#20869;&#23884;<TT 
class=literal>&lt;key-property&gt;</TT>&#20803;&#32032;)&#20195;&#26367;&#36890;&#24120;&#30340;<TT 
class=literal>&lt;id&gt;</TT>&#26631;&#31614;&#12290;&#27604;&#22914;,<TT 
class=literal>OrderLine</TT>&#31867;&#20855;&#26377;&#19968;&#20010;&#20027;&#38190;&#65292;&#36825;&#20010;&#20027;&#38190;&#20381;&#36182;&#20110;<TT class=literal>Order</TT>&#30340;(&#32852;&#21512;)&#20027;&#38190;&#12290; 
</P><PRE class=programlisting>&lt;class name="OrderLine"&gt;
    
    &lt;composite-id name="id" class="OrderLineId"&gt;
        &lt;key-property name="lineId"/&gt;
        &lt;key-property name="orderId"/&gt;
        &lt;key-property name="customerId"/&gt;
    &lt;/composite-id&gt;
    
    &lt;property name="name"/&gt;
    
    &lt;many-to-one name="order" class="Order"
            insert="false" update="false"&gt;
        &lt;column name="orderId"/&gt;
        &lt;column name="customerId"/&gt;
    &lt;/many-to-one&gt;
    ....
    
&lt;/class&gt;</PRE>
<P>&#29616;&#22312;&#65292;&#20219;&#20309;&#25351;&#21521;<TT 
class=literal>OrderLine</TT>&#30340;&#22806;&#38190;&#37117;&#26159;&#22797;&#21512;&#30340;&#12290;&#22312;&#20320;&#30340;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#24517;&#39035;&#20026;&#20854;&#20182;&#31867;&#20063;&#36825;&#26679;&#22768;&#26126;&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;&#25351;&#21521;<TT 
class=literal>OrderLine</TT>&#30340;&#20851;&#32852;&#21487;&#33021;&#34987;&#36825;&#26679;&#26144;&#23556;&#65306; </P><PRE class=programlisting>&lt;many-to-one name="orderLine" class="OrderLine"&gt;
&lt;!-- the "class" attribute is optional, as usual --&gt;
    &lt;column name="lineId"/&gt;
    &lt;column name="orderId"/&gt;
    &lt;column name="customerId"/&gt;
&lt;/many-to-one&gt;</PRE>
<P>&#65288;&#27880;&#24847;&#22312;&#21508;&#20010;&#22320;&#26041;<TT class=literal>&lt;column&gt;</TT>&#26631;&#31614;&#37117;&#26159;<TT 
class=literal>column</TT>&#23646;&#24615;&#30340;&#26367;&#20195;&#20889;&#27861;&#12290;&#65289; </P>
<P>&#25351;&#21521;<TT class=literal>OrderLine</TT>&#30340;<TT class=literal>&#22810;&#23545;&#22810;</TT>&#20851;&#32852;&#20063;&#20351;&#29992;&#32852;&#21512;&#22806;&#38190;: </P><PRE class=programlisting>&lt;set name="undeliveredOrderLines"&gt;
    &lt;key column name="warehouseId"/&gt;
    &lt;many-to-many class="OrderLine"&gt;
        &lt;column name="lineId"/&gt;
        &lt;column name="orderId"/&gt;
        &lt;column name="customerId"/&gt;
    &lt;/many-to-many&gt;
&lt;/set&gt;</PRE>
<P>&#22312;<TT class=literal>Order</TT>&#20013;,<TT class=literal>OrderLine</TT>&#30340;&#38598;&#21512;&#21017;&#26159;&#36825;&#26679;: </P><PRE class=programlisting>&lt;set name="orderLines" inverse="true"&gt;
    &lt;key&gt;
        &lt;column name="orderId"/&gt;
        &lt;column name="customerId"/&gt;
    &lt;/key&gt;
    &lt;one-to-many class="OrderLine"/&gt;
&lt;/set&gt;</PRE>
<P>(&#19982;&#36890;&#24120;&#19968;&#26679;,<TT class=literal>&lt;one-to-many&gt;</TT>&#20803;&#32032;&#19981;&#22768;&#26126;&#20219;&#20309;&#21015;.) </P>
<P>&#20551;&#33509;<TT class=literal>OrderLine</TT>&#26412;&#36523;&#25317;&#26377;&#19968;&#20010;&#38598;&#21512;,&#23427;&#20063;&#20855;&#26377;&#32452;&#21512;&#22806;&#38190;&#12290; </P><PRE class=programlisting>&lt;class name="OrderLine"&gt;
    ....
    ....
    &lt;list name="deliveryAttempts"&gt;
        &lt;key&gt;   &lt;!-- a collection inherits the composite key type --&gt;
            &lt;column name="lineId"/&gt;
            &lt;column name="orderId"/&gt;
            &lt;column name="customerId"/&gt;
        &lt;/key&gt;
        &lt;list-index column="attemptId" base="1"/&gt;
        &lt;composite-element class="DeliveryAttempt"&gt;
            ...
        &lt;/composite-element&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=components-dynamic></A>8.5.&nbsp;&#21160;&#24577;&#32452;&#20214; &#65288;Dynamic components&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#26144;&#23556;<TT class=literal>Map</TT>&#31867;&#22411;&#30340;&#23646;&#24615;&#65306; </P><PRE class=programlisting>&lt;dynamic-component name="userAttributes"&gt;
    &lt;property name="foo" column="FOO" type="string"/&gt;
    &lt;property name="bar" column="BAR" type="integer"/&gt;
    &lt;many-to-one name="baz" class="Baz" column="BAZ_ID"/&gt;
&lt;/dynamic-component&gt;</PRE>
<P>&#20174;<TT class=literal>&lt;dynamic-component&gt;</TT>&#26144;&#23556;&#30340;&#35821;&#20041;&#19978;&#26469;&#35762;&#65292;&#23427;&#21644;<TT 
class=literal>&lt;component&gt;</TT>&#26159;&#30456;&#21516;&#30340;&#12290; 
&#36825;&#31181;&#26144;&#23556;&#31867;&#22411;&#30340;&#20248;&#28857;&#22312;&#20110;&#36890;&#36807;&#20462;&#25913;&#26144;&#23556;&#25991;&#20214;&#65292;&#23601;&#21487;&#20197;&#20855;&#26377;&#22312;&#37096;&#32626;&#26102;&#26816;&#27979;&#30495;&#23454;&#23646;&#24615;&#30340;&#33021;&#21147;&#12290;&#21033;&#29992;&#19968;&#20010;DOM&#35299;&#26512;&#22120;&#65292;&#20063;&#21487;&#20197;&#22312;&#31243;&#24207;&#36816;&#34892;&#26102;&#25805;&#20316;&#26144;&#23556;&#25991;&#20214;&#12290; &#26356;&#22909;&#30340;&#26159;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;<TT 
class=literal>Configuration</TT>&#23545;&#35937;&#26469;&#35775;&#38382;&#65288;&#25110;&#32773;&#20462;&#25913;&#65289;Hibernate&#30340;&#36816;&#34892;&#26102;&#20803;&#27169;&#22411;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=inheritance></A>&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance 
Mappings)</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=inheritance-strategies></A>9.1.&nbsp; &#19977;&#31181;&#31574;&#30053;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#25903;&#25345;&#19977;&#31181;&#22522;&#26412;&#30340;&#32487;&#25215;&#26144;&#23556;&#31574;&#30053;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;(table per class hierarchy) </P>
  <LI>
  <P>&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;(table per subclass) </P>
  <LI>
  <P>&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;(table per concrete class) </P></LI></UL></DIV>
<P>&#27492;&#22806;&#65292;Hibernate&#36824;&#25903;&#25345;&#31532;&#22235;&#31181;&#31245;&#26377;&#19981;&#21516;&#30340;&#22810;&#24577;&#26144;&#23556;&#31574;&#30053;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#38544;&#24335;&#22810;&#24577;(implicit polymorphism) </P></LI></UL></DIV>
<P>&#23545;&#20110;&#21516;&#19968;&#20010;&#32487;&#25215;&#23618;&#27425;&#20869;&#30340;&#19981;&#21516;&#20998;&#25903;&#65292;&#21487;&#20197;&#37319;&#29992;&#19981;&#21516;&#30340;&#26144;&#23556;&#31574;&#30053;&#65292;&#28982;&#21518;&#29992;&#38544;&#24335;&#22810; &#24577;&#26469;&#23436;&#25104;&#36328;&#36234;&#25972;&#20010;&#23618;&#27425;&#30340;&#22810;&#24577;&#12290;&#20294;&#26159;&#22312;&#21516;&#19968;&#20010;<TT 
class=literal>&lt;class&gt;</TT>&#26681;&#20803;&#32032; &#19979;&#65292;Hibernate&#19981;&#25903;&#25345;&#28151;&#21512;&#20102;&#20803;&#32032;<TT 
class=literal>&lt;subclass&gt;</TT>&#12289; <TT 
class=literal>&lt;joined-subclass&gt;</TT>&#21644;<TT 
class=literal>&lt;union-subclass&gt;</TT> &#30340;&#26144;&#23556;&#12290;&#22312;&#21516;&#19968;&#20010;<TT 
class=literal>&lt;class&gt;</TT>&#20803;&#32032;&#19979;&#65292;&#21487;&#20197;&#28151;&#21512;&#20351;&#29992; “&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;”&#65288;table per hierarchy&#65289; 
&#21644;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”&#65288;table per subclass&#65289; &#36825;&#20004;&#31181;&#26144;&#23556;&#31574;&#30053;&#65292;&#36825;&#26159;&#36890;&#36807;&#32467;&#21512;&#20803;&#32032;<TT 
class=literal>&lt;subclass&gt;</TT>&#21644; <TT 
class=literal>&lt;join&gt;</TT>&#26469;&#23454;&#29616;&#30340;&#65288;&#35265;&#21518;&#65289;&#12290; </P>
<P>&#22312;&#22810;&#20010;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#21487;&#20197;&#30452;&#25509;&#22312;<TT class=literal>hibernate-mapping</TT>&#26681;&#19979;&#23450;&#20041;<TT 
class=literal>subclass</TT>&#65292;<TT class=literal>union-subclass</TT>&#21644;<TT 
class=literal>joined-subclass</TT>&#12290;&#20063;&#23601;&#26159;&#35828;&#65292;&#20320;&#21487;&#20197;&#20165;&#21152;&#20837;&#19968;&#20010;&#26032;&#30340;&#26144;&#23556;&#25991;&#20214;&#26469;&#25193;&#23637;&#31867;&#23618;&#27425;&#12290;&#20320;&#24517;&#39035;&#22312;subclass&#30340;&#26144;&#23556;&#20013;&#25351;&#26126;<TT 
class=literal>extends</TT>&#23646;&#24615;&#65292;&#32473;&#20986;&#19968;&#20010;&#20043;&#21069;&#23450;&#20041;&#30340;&#36229;&#31867;&#30340;&#21517;&#23383;&#12290;&#27880;&#24847;&#65292;&#22312;&#20197;&#21069;&#65292;&#36825;&#19968;&#21151;&#33021;&#23545;&#26144;&#23556;&#25991;&#20214;&#30340;&#39034;&#24207;&#26377;&#20005;&#26684;&#30340;&#35201;&#27714;&#65292;&#20174;Hibernate 
3&#24320;&#22987;&#65292;&#20351;&#29992;extends&#20851;&#38190;&#23383;&#30340;&#26102;&#20399;&#65292;&#23545;&#26144;&#23556;&#25991;&#20214;&#30340;&#39034;&#24207;&#19981;&#20877;&#26377;&#35201;&#27714;&#65307;&#20294;&#22312;&#27599;&#20010;&#26144;&#23556;&#25991;&#20214;&#37324;&#65292;&#36229;&#31867;&#24517;&#39035;&#22312;&#23376;&#31867;&#20043;&#21069;&#23450;&#20041;&#12290; </P><PRE class=programlisting> &lt;hibernate-mapping&gt;
     &lt;subclass name="DomesticCat" extends="Cat" discriminator-value="D"&gt;
          &lt;property name="name" type="string"/&gt;
     &lt;/subclass&gt;
 &lt;/hibernate-mapping&gt;</PRE>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tableperclass></A>9.1.1.&nbsp;&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;(Table per class 
hierarchy)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20551;&#35774;&#25105;&#20204;&#26377;&#25509;&#21475;<TT class=literal>Payment</TT>&#21644;&#23427;&#30340;&#20960;&#20010;&#23454;&#29616;&#31867;&#65306; <TT 
class=literal>CreditCardPayment</TT>, <TT class=literal>CashPayment</TT>, &#21644;<TT 
class=literal>ChequePayment</TT>&#12290;&#21017;“&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;”(Table per class 
hierarchy)&#30340;&#26144;&#23556;&#20195;&#30721;&#22914;&#19979;&#25152;&#31034;&#65306; </P><PRE class=programlisting>&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="PAYMENT_TYPE" type="string"/&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;subclass name="CreditCardPayment" discriminator-value="CREDIT"&gt;
        &lt;property name="creditCardType" column="CCTYPE"/&gt;
        ...
    &lt;/subclass&gt;
    &lt;subclass name="CashPayment" discriminator-value="CASH"&gt;
        ...
    &lt;/subclass&gt;
    &lt;subclass name="ChequePayment" discriminator-value="CHEQUE"&gt;
        ...
    &lt;/subclass&gt;
&lt;/class&gt;</PRE>
<P>&#37319;&#29992;&#36825;&#31181;&#31574;&#30053;&#21482;&#38656;&#35201;&#19968;&#24352;&#34920;&#21363;&#21487;&#12290;&#23427;&#26377;&#19968;&#20010;&#24456;&#22823;&#30340;&#38480;&#21046;&#65306;&#35201;&#27714;&#37027;&#20123;&#30001;&#23376;&#31867;&#23450;&#20041;&#30340;&#23383;&#27573;&#65292; &#22914;<TT class=literal>CCTYPE</TT>&#65292;&#19981;&#33021;&#26377;<TT 
class=literal>&#38750;&#31354;(NOT NULL)</TT>&#32422;&#26463;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tablepersubclass></A>9.1.2.&nbsp;&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;(Table per 
subclass)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;&#19978;&#20363;&#20013;&#30340;&#20960;&#20010;&#31867;&#32780;&#35328;&#65292;&#37319;&#29992;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”&#30340;&#26144;&#23556;&#31574;&#30053;&#65292;&#20195;&#30721;&#22914;&#19979;&#25152;&#31034;&#65306; </P><PRE class=programlisting>&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;joined-subclass name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="CashPayment" table="CASH_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        &lt;property name="creditCardType" column="CCTYPE"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        ...
    &lt;/joined-subclass&gt;
&lt;/class&gt;</PRE>
<P>&#38656;&#35201;&#22235;&#24352;&#34920;&#12290;&#19977;&#20010;&#23376;&#31867;&#34920;&#36890;&#36807;&#20027;&#38190;&#20851;&#32852;&#21040;&#36229;&#31867;&#34920;(&#22240;&#32780;&#20851;&#31995;&#27169;&#22411;&#23454;&#38469;&#19978;&#26159;&#19968;&#23545;&#19968;&#20851;&#32852;)&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tablepersubclass-discriminator></A>9.1.3.&nbsp;&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;(Table 
per subclass)&#65292;&#20351;&#29992;&#36776;&#21035;&#26631;&#24535;(Discriminator)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#27880;&#24847;&#65292;&#23545;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”&#30340;&#26144;&#23556;&#31574;&#30053;&#65292;Hibernate&#30340;&#23454;&#29616;&#19981;&#38656;&#35201;&#36776;&#21035;&#23383;&#27573;&#65292;&#32780;&#20854;&#20182; 
&#30340;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#24037;&#20855;&#20351;&#29992;&#20102;&#19968;&#31181;&#19981;&#21516;&#20110;Hibernate&#30340;&#23454;&#29616;&#26041;&#27861;&#65292;&#35813;&#26041;&#27861;&#35201;&#27714;&#22312;&#36229;&#31867; &#34920;&#20013;&#26377;&#19968;&#20010;&#31867;&#22411;&#36776;&#21035;&#23383;&#27573;(type discriminator 
column)&#12290;Hibernate&#37319;&#29992;&#30340;&#26041;&#27861;&#26356; &#38590;&#23454;&#29616;&#65292;&#20294;&#20174;&#20851;&#31995;&#65288;&#25968;&#25454;&#24211;&#65289;&#30340;&#35282;&#24230;&#26469;&#30475;&#65292;&#25353;&#29702;&#35828;&#23427;&#26356;&#27491;&#30830;&#12290;&#33509;&#20320;&#24895;&#24847;&#20351;&#29992;&#24102;&#26377;&#36776;&#21035;&#23383; 
&#27573;&#30340;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”&#30340;&#31574;&#30053;&#65292;&#20320;&#21487;&#20197;&#32467;&#21512;&#20351;&#29992;<TT class=literal>&lt;subclass&gt;</TT> &#19982;<TT 
class=literal>&lt;join&gt;</TT>&#65292;&#22914;&#19979;&#25152;&#31034;&#65306; </P><PRE class=programlisting>&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="PAYMENT_TYPE" type="string"/&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;subclass name="CreditCardPayment" discriminator-value="CREDIT"&gt;
        &lt;join table="CREDIT_PAYMENT"&gt;
            &lt;key column="PAYMENT_ID"/&gt;
            &lt;property name="creditCardType" column="CCTYPE"/&gt;
            ...
        &lt;/join&gt;
    &lt;/subclass&gt;
    &lt;subclass name="CashPayment" discriminator-value="CASH"&gt;
        &lt;join table="CASH_PAYMENT"&gt;
            &lt;key column="PAYMENT_ID"/&gt;
            ...
        &lt;/join&gt;
    &lt;/subclass&gt;
    &lt;subclass name="ChequePayment" discriminator-value="CHEQUE"&gt;
        &lt;join table="CHEQUE_PAYMENT" fetch="select"&gt;
            &lt;key column="PAYMENT_ID"/&gt;
            ...
        &lt;/join&gt;
    &lt;/subclass&gt;
&lt;/class&gt;</PRE>
<P>&#21487;&#36873;&#30340;&#22768;&#26126;<TT class=literal>fetch="select"</TT>&#65292;&#26159;&#29992;&#26469;&#21578;&#35785;Hibernate&#65292;&#22312;&#26597;&#35810;&#36229;&#31867;&#26102;&#65292; 
&#19981;&#35201;&#20351;&#29992;&#22806;&#37096;&#36830;&#25509;(outer join)&#26469;&#25235;&#21462;&#23376;&#31867;<TT class=literal>ChequePayment</TT>&#30340;&#25968;&#25454;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-mixing-tableperclass-tablepersubclass></A>9.1.4.&nbsp;&#28151;&#21512;&#20351;&#29992;“&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;”&#21644;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#37319;&#21462;&#22914;&#19979;&#26041;&#27861;&#28151;&#21644;&#20351;&#29992;“&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;”&#21644;“&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;”&#36825;&#20004;&#31181;&#31574;&#30053;&#65306; </P><PRE class=programlisting>&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="PAYMENT_TYPE" type="string"/&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;subclass name="CreditCardPayment" discriminator-value="CREDIT"&gt;
        &lt;join table="CREDIT_PAYMENT"&gt;
            &lt;property name="creditCardType" column="CCTYPE"/&gt;
            ...
        &lt;/join&gt;
    &lt;/subclass&gt;
    &lt;subclass name="CashPayment" discriminator-value="CASH"&gt;
        ...
    &lt;/subclass&gt;
    &lt;subclass name="ChequePayment" discriminator-value="CHEQUE"&gt;
        ...
    &lt;/subclass&gt;
&lt;/class&gt;</PRE>
<P>&#23545;&#19978;&#36848;&#20219;&#20309;&#19968;&#31181;&#26144;&#23556;&#31574;&#30053;&#32780;&#35328;&#65292;&#25351;&#21521;&#26681;&#31867;<TT class=literal>Payment</TT>&#30340; &#20851;&#32852;&#26159;&#20351;&#29992;<TT 
class=literal>&lt;many-to-one&gt;</TT>&#36827;&#34892;&#26144;&#23556;&#30340;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="payment" column="PAYMENT_ID" class="Payment"/&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tableperconcrete></A>9.1.5.&nbsp;&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;(Table per concrete 
class)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;“&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;”&#30340;&#26144;&#23556;&#31574;&#30053;&#65292;&#21487;&#20197;&#37319;&#29992;&#20004;&#31181;&#26041;&#27861;&#12290;&#31532;&#19968;&#31181;&#26041;&#27861;&#26159;&#20351;&#29992; <TT 
class=literal>&lt;union-subclass&gt;</TT>&#12290; </P><PRE class=programlisting>&lt;class name="Payment"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="sequence"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;union-subclass name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
        &lt;property name="creditCardType" column="CCTYPE"/&gt;
        ...
    &lt;/union-subclass&gt;
    &lt;union-subclass name="CashPayment" table="CASH_PAYMENT"&gt;
        ...
    &lt;/union-subclass&gt;
    &lt;union-subclass name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
        ...
    &lt;/union-subclass&gt;
&lt;/class&gt;</PRE>
<P>&#36825;&#37324;&#28041;&#21450;&#19977;&#24352;&#19982;&#23376;&#31867;&#30456;&#20851;&#30340;&#34920;&#12290;&#27599;&#24352;&#34920;&#20026;&#23545;&#24212;&#31867;&#30340;&#25152;&#26377;&#23646;&#24615;&#65288;&#21253;&#25324;&#20174;&#36229;&#31867;&#32487;&#25215;&#30340;&#23646;&#24615;&#65289;&#23450;&#20041;&#30456;&#24212;&#23383;&#27573;&#12290; </P>
<P>&#36825;&#31181;&#26041;&#24335;&#30340;&#23616;&#38480;&#22312;&#20110;&#65292;&#22914;&#26524;&#19968;&#20010;&#23646;&#24615;&#22312;&#36229;&#31867;&#20013;&#20570;&#20102;&#26144;&#23556;&#65292;&#20854;&#23383;&#27573;&#21517;&#24517;&#39035;&#19982;&#25152;&#26377;&#23376;&#31867; &#34920;&#20013;&#23450;&#20041;&#30340;&#30456;&#21516;&#12290;(&#25105;&#20204;&#21487;&#33021;&#20250;&#22312;Hibernate&#30340;&#21518;&#32493;&#21457;&#24067;&#29256;&#26412;&#20013;&#25918;&#23485;&#27492;&#38480;&#21046;&#12290;) 
&#19981;&#20801;&#35768;&#22312;&#32852;&#21512;&#23376;&#31867;(union subclass)&#30340;&#32487;&#25215;&#23618;&#27425;&#20013;&#20351;&#29992;&#26631;&#35782;&#29983;&#25104;&#22120;&#31574;&#30053;(identity generator strategy), &#23454;&#38469;&#19978;, 
&#20027;&#38190;&#30340;&#31181;&#23376;(primary key seed)&#19981;&#24471;&#19981;&#20026;&#21516;&#19968;&#32487;&#25215;&#23618;&#27425;&#20013;&#30340;&#20840;&#37096;&#34987;&#32852;&#21512;&#23376;&#31867;&#25152;&#20849;&#29992;. </P>
<P>&#20551;&#33509;&#36229;&#31867;&#26159;&#25277;&#35937;&#31867;&#65292;&#35831;&#20351;&#29992;<TT 
class=literal>abstract="true"</TT>&#12290;&#24403;&#28982;&#65292;&#20551;&#33509;&#23427;&#19981;&#26159;&#25277;&#35937;&#30340;&#65292;&#38656;&#35201;&#19968;&#20010;&#39069;&#22806;&#30340;&#34920;&#65288;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#40664;&#35748;&#26159;<TT 
class=literal>PAYMENT</TT>&#65289;&#65292;&#26469;&#20445;&#23384;&#36229;&#31867;&#30340;&#23454;&#20363;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tableperconcreate-polymorphism></A>9.1.6.&nbsp;Table per 
concrete class, using implicit polymorphism</H3></DIV>
<DIV>
<H3 class=title><A 
name=inheritance-tableperconcreate-polymorphism></A>9.1.6.&nbsp;Table per 
concrete class, using implicit polymorphism</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21478;&#19968;&#31181;&#21487;&#20379;&#36873;&#25321;&#30340;&#26041;&#27861;&#26159;&#37319;&#29992;&#38544;&#24335;&#22810;&#24577;&#65306; </P><PRE class=programlisting>&lt;class name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CREDIT_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CREDIT_AMOUNT"/&gt;
    ...
&lt;/class&gt;

&lt;class name="CashPayment" table="CASH_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CASH_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CASH_AMOUNT"/&gt;
    ...
&lt;/class&gt;

&lt;class name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CHEQUE_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CHEQUE_AMOUNT"/&gt;
    ...
&lt;/class&gt;</PRE>
<P>&#27880;&#24847;&#65292;&#25105;&#20204;&#27809;&#26377;&#22312;&#20219;&#20309;&#22320;&#26041;&#26126;&#30830;&#30340;&#25552;&#21450;&#25509;&#21475;<TT class=literal>Payment</TT>&#12290;&#21516;&#26102;&#27880;&#24847; <TT 
class=literal>Payment</TT>&#30340;&#23646;&#24615;&#22312;&#27599;&#20010;&#23376;&#31867;&#20013;&#37117;&#36827;&#34892;&#20102;&#26144;&#23556;&#12290;&#22914;&#26524;&#20320;&#24819;&#36991;&#20813;&#37325;&#22797;&#65292; &#21487;&#20197;&#32771;&#34385;&#20351;&#29992;XML&#23454;&#20307;(&#20363;&#22914;&#65306;&#20301;&#20110;<TT 
class=literal>DOCTYPE</TT>&#22768;&#26126;&#20869;&#30340; <TT class=literal>[ &lt;!ENTITY allproperties 
SYSTEM "allproperties.xml"&gt; ]</TT> &#21644;&#26144;&#23556;&#20013;&#30340;<TT 
class=literal>&amp;allproperties;</TT>)&#12290; </P>
<P>&#36825;&#31181;&#26041;&#27861;&#30340;&#32570;&#38519;&#22312;&#20110;&#65292;&#22312;Hibernate&#25191;&#34892;&#22810;&#24577;&#26597;&#35810;&#26102;(polymorphic queries)&#26080;&#27861;&#29983;&#25104;&#24102; <TT 
class=literal>UNION</TT>&#30340;SQL&#35821;&#21477;&#12290; </P>
<P>&#23545;&#20110;&#36825;&#31181;&#26144;&#23556;&#31574;&#30053;&#32780;&#35328;&#65292;&#36890;&#24120;&#29992;<TT class=literal>&lt;any&gt;</TT>&#26469;&#23454;&#29616;&#21040; <TT 
class=literal>Payment</TT>&#30340;&#22810;&#24577;&#20851;&#32852;&#26144;&#23556;&#12290; </P><PRE class=programlisting>&lt;any name="payment" meta-type="string" id-type="long"&gt;
    &lt;meta-value value="CREDIT" class="CreditCardPayment"/&gt;
    &lt;meta-value value="CASH" class="CashPayment"/&gt;
    &lt;meta-value value="CHEQUE" class="ChequePayment"/&gt;
    &lt;column name="PAYMENT_CLASS"/&gt;
    &lt;column name="PAYMENT_ID"/&gt;
&lt;/any&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=inheritace-mixingpolymorphism></A>9.1.7.&nbsp;&#38544;&#24335;&#22810;&#24577;&#21644;&#20854;&#20182;&#32487;&#25215;&#26144;&#23556;&#28151;&#21512;&#20351;&#29992;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#36825;&#19968;&#26144;&#23556;&#36824;&#26377;&#19968;&#28857;&#38656;&#35201;&#27880;&#24847;&#12290;&#22240;&#20026;&#27599;&#20010;&#23376;&#31867;&#37117;&#22312;&#21508;&#33258;&#29420;&#31435;&#30340;&#20803;&#32032;<TT class=literal>&lt;class&gt;</TT> &#20013;&#26144;&#23556;(&#24182;&#19988;<TT 
class=literal>Payment</TT>&#21482;&#26159;&#19968;&#20010;&#25509;&#21475;)&#65292;&#27599;&#20010;&#23376;&#31867;&#21487;&#20197;&#24456;&#23481;&#26131;&#30340;&#25104;&#20026;&#21478;&#19968; &#20010;&#32487;&#25215;&#20307;&#31995;&#20013;&#30340;&#19968;&#37096;&#20998;&#65281;(&#20320;&#20173;&#28982;&#21487;&#20197;&#23545;&#25509;&#21475;<TT 
class=literal>Payment</TT>&#20351;&#29992;&#22810;&#24577;&#26597;&#35810;&#12290;) </P><PRE class=programlisting>&lt;class name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CREDIT_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="CREDIT_CARD" type="string"/&gt;
    &lt;property name="amount" column="CREDIT_AMOUNT"/&gt;
    ...
    &lt;subclass name="MasterCardPayment" discriminator-value="MDC"/&gt;
    &lt;subclass name="VisaPayment" discriminator-value="VISA"/&gt;
&lt;/class&gt;

&lt;class name="NonelectronicTransaction" table="NONELECTRONIC_TXN"&gt;
    &lt;id name="id" type="long" column="TXN_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    ...
    &lt;joined-subclass name="CashPayment" table="CASH_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        &lt;property name="amount" column="CASH_AMOUNT"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        &lt;property name="amount" column="CHEQUE_AMOUNT"/&gt;
        ...
    &lt;/joined-subclass&gt;
&lt;/class&gt;</PRE>
<P>&#25105;&#20204;&#36824;&#26159;&#27809;&#26377;&#26126;&#30830;&#30340;&#25552;&#21040;<TT class=literal>Payment</TT>&#12290; &#22914;&#26524;&#25105;&#20204;&#38024;&#23545;&#25509;&#21475;<TT 
class=literal>Payment</TT>&#25191;&#34892;&#26597;&#35810; ——&#22914;<TT class=literal>from Payment</TT>—— 
Hibernate &#33258;&#21160;&#36820;&#22238;<TT class=literal>CreditCardPayment</TT>(&#21644;&#23427;&#30340;&#23376;&#31867;&#65292;&#22240;&#20026; &#23427;&#20204;&#20063;&#23454;&#29616;&#20102;&#25509;&#21475;<TT 
class=literal>Payment</TT>)&#12289; <TT class=literal>CashPayment</TT>&#21644;<TT 
class=literal>Chequepayment</TT>&#30340;&#23454;&#20363;&#65292; &#20294;&#19981;&#36820;&#22238;<TT 
class=literal>NonelectronicTransaction</TT>&#30340;&#23454;&#20363;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=inheritance-limitations></A>9.2.&nbsp;&#38480;&#21046;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;“&#27599;&#20010;&#20855;&#20307;&#31867;&#26144;&#23556;&#19968;&#24352;&#34920;”&#65288;table per concrete-class&#65289;&#30340;&#26144;&#23556;&#31574;&#30053;&#32780;&#35328;&#65292;&#38544;&#24335;&#22810;&#24577;&#30340; &#26041;&#24335;&#26377;&#19968;&#23450;&#30340;&#38480;&#21046;&#12290;&#32780;<TT 
class=literal>&lt;union-subclass&gt;</TT>&#26144;&#23556;&#30340;&#38480;&#21046;&#21017;&#27809;&#26377;&#37027; &#20040;&#20005;&#26684;&#12290; </P>
<P>&#19979;&#38754;&#34920;&#26684;&#20013;&#21015;&#20986;&#20102;&#22312;Hibernte&#20013;“&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;”&#30340;&#31574;&#30053;&#21644;&#38544;&#24335;&#22810;&#24577;&#30340;&#38480;&#21046;&#12290; </P>
<DIV class=table><A name=d0e9064></A>
<P class=title><B>&#34920;&nbsp;9.1.&nbsp;&#32487;&#25215;&#26144;&#23556;&#29305;&#24615;(Features of inheritance mappings) 
</B></P>
<TABLE summary="&#32487;&#25215;&#26144;&#23556;&#29305;&#24615;(Features of inheritance mappings)&#9;&#9;&#9;" 
  border=1><COLGROUP>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left></COLGROUP>
  <THEAD>
  <TR>
    <TH align=left>&#32487;&#25215;&#31574;&#30053;(Inheritance strategy)</TH>
    <TH align=left>&#22810;&#24577;&#22810;&#23545;&#19968;</TH>
    <TH align=left>&#22810;&#24577;&#19968;&#23545;&#19968;</TH>
    <TH align=left>&#22810;&#24577;&#19968;&#23545;&#22810;</TH>
    <TH align=left>&#22810;&#24577;&#22810;&#23545;&#22810;</TH>
    <TH align=left>&#22810;&#24577; <TT class=literal>load()/get()</TT></TH>
    <TH align=left>&#22810;&#24577;&#26597;&#35810;</TH>
    <TH align=left>&#22810;&#24577;&#36830;&#25509;(join)</TH>
    <TH align=left>&#22806;&#36830;&#25509;(Outer join)&#35835;&#21462;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD align=left>&#27599;&#20010;&#31867;&#20998;&#23618;&#32467;&#26500;&#19968;&#24352;&#34920;</TD>
    <TD align=left><TT class=literal>&lt;many-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-many&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;many-to-many&gt;</TT></TD>
    <TD align=left><TT class=literal>s.get(Payment.class, id)</TT></TD>
    <TD align=left><TT class=literal>from Payment p</TT></TD>
    <TD align=left><TT class=literal>from Order o join o.payment p</TT></TD>
    <TD align=left><SPAN class=emphasis><EM>&#25903;&#25345;</EM></SPAN></TD></TR>
  <TR>
    <TD align=left>&#27599;&#20010;&#23376;&#31867;&#19968;&#24352;&#34920;</TD>
    <TD align=left><TT class=literal>&lt;many-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-many&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;many-to-many&gt;</TT></TD>
    <TD align=left><TT class=literal>s.get(Payment.class, id)</TT></TD>
    <TD align=left><TT class=literal>from Payment p</TT></TD>
    <TD align=left><TT class=literal>from Order o join o.payment p</TT></TD>
    <TD align=left><SPAN class=emphasis><EM>&#25903;&#25345;</EM></SPAN></TD></TR>
  <TR>
    <TD align=left>&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;(union-subclass)</TD>
    <TD align=left><TT class=literal>&lt;many-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-one&gt;</TT></TD>
    <TD align=left><TT class=literal>&lt;one-to-many&gt;</TT> (&#20165;&#23545;&#20110;<TT 
      class=literal>inverse="true"</TT>&#30340;&#24773;&#20917;)</TD>
    <TD align=left><TT class=literal>&lt;many-to-many&gt;</TT></TD>
    <TD align=left><TT class=literal>s.get(Payment.class, id)</TT></TD>
    <TD align=left><TT class=literal>from Payment p</TT></TD>
    <TD align=left><TT class=literal>from Order o join o.payment p</TT></TD>
    <TD align=left><SPAN class=emphasis><EM>&#25903;&#25345;</EM></SPAN></TD></TR>
  <TR>
    <TD align=left>&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#24352;&#34920;(&#38544;&#24335;&#22810;&#24577;)</TD>
    <TD align=left><TT class=literal>&lt;any&gt;</TT></TD>
    <TD align=left><SPAN class=emphasis><EM>&#19981;&#25903;&#25345;</EM></SPAN></TD>
    <TD align=left><SPAN class=emphasis><EM>&#19981;&#25903;&#25345;</EM></SPAN></TD>
    <TD align=left><TT class=literal>&lt;many-to-any&gt;</TT></TD>
    <TD align=left><TT class=literal>s.createCriteria(Payment.class).add( 
      Restrictions.idEq(id) ).uniqueResult()</TT></TD>
    <TD align=left><TT class=literal>from Payment p</TT></TD>
    <TD align=left><SPAN class=emphasis><EM>&#19981;&#25903;&#25345;</EM></SPAN></TD>
    <TD align=left><SPAN 
class=emphasis><EM>&#19981;&#25903;&#25345;</EM></SPAN></TD></TR></TBODY></TABLE></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=objectstate></A>&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#26159;&#23436;&#25972;&#30340;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#35299;&#20915;&#26041;&#26696;&#65292;&#23427;&#25552;&#20379;&#20102;&#23545;&#35937;<SPAN class=emphasis><EM>&#29366;&#24577;&#31649;&#29702;(state 
management)</EM></SPAN>&#30340;&#21151;&#33021;&#65292;&#20351;&#24320;&#21457;&#32773;&#19981;&#20877;&#38656;&#35201;&#29702;&#20250;&#24213;&#23618;&#25968;&#25454;&#24211;&#31995;&#32479;&#30340;&#32454;&#33410;&#12290; &#20063;&#23601;&#26159;&#35828;&#65292;&#30456;&#23545;&#20110;&#24120;&#35265;&#30340;JDBC/SQL&#25345;&#20037;&#23618;&#26041;&#26696;&#20013;&#38656;&#35201;<TT 
class=literal>&#31649;&#29702;SQL&#35821;&#21477;</TT>&#65292;Hibernate&#37319;&#29992;&#20102;&#26356;&#33258;&#28982;&#30340;&#38754;&#21521;&#23545;&#35937;&#30340;&#35270;&#35282;&#26469;&#25345;&#20037;&#21270;Java&#24212;&#29992;&#20013;&#30340;&#25968;&#25454;&#12290; </P>
<P>&#25442;&#21477;&#35805;&#35828;&#65292;&#20351;&#29992;Hibernate&#30340;&#24320;&#21457;&#32773;&#24212;&#35813;&#24635;&#26159;&#20851;&#27880;&#23545;&#35937;&#30340;<SPAN 
class=emphasis><EM>&#29366;&#24577;(state)</EM></SPAN>&#65292;&#19981;&#24517;&#32771;&#34385;SQL&#35821;&#21477;&#30340;&#25191;&#34892;&#12290; 
&#36825;&#37096;&#20998;&#32454;&#33410;&#24050;&#32463;&#30001;Hibernate&#25484;&#31649;&#22949;&#24403;&#65292;&#21482;&#26377;&#24320;&#21457;&#32773;&#22312;&#36827;&#34892;&#31995;&#32479;&#24615;&#33021;&#35843;&#20248;&#30340;&#26102;&#20505;&#25165;&#38656;&#35201;&#36827;&#34892;&#20102;&#35299;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-overview></A>10.1.&nbsp;Hibernate&#23545;&#35937;&#29366;&#24577;(object 
states)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#23450;&#20041;&#24182;&#25903;&#25345;&#19979;&#21015;&#23545;&#35937;&#29366;&#24577;(state): </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>&#30636;&#26102;(Transient)</EM></SPAN> - &#30001;<TT 
  class=literal>new</TT>&#25805;&#20316;&#31526;&#21019;&#24314;&#65292;&#19988;&#23578;&#26410;&#19982;Hibernate <TT class=literal>Session</TT> 
  &#20851;&#32852;&#30340;&#23545;&#35937;&#34987;&#35748;&#23450;&#20026;&#30636;&#26102;(Transient)&#30340;&#12290;&#30636;&#26102;(Transient)&#23545;&#35937;&#19981;&#20250;&#34987;&#25345;&#20037;&#21270;&#21040;&#25968;&#25454;&#24211;&#20013;&#65292;&#20063;&#19981;&#20250;&#34987;&#36171;&#20104;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#12290; 
  &#22914;&#26524;&#30636;&#26102;(Transient)&#23545;&#35937;&#22312;&#31243;&#24207;&#20013;&#27809;&#26377;&#34987;&#24341;&#29992;&#65292;&#23427;&#20250;&#34987;&#22403;&#22334;&#22238;&#25910;&#22120;(garbage collector)&#38144;&#27585;&#12290; &#20351;&#29992;Hibernate <TT 
  class=literal>Session</TT>&#21487;&#20197;&#23558;&#20854;&#21464;&#20026;&#25345;&#20037;(Persistent)&#29366;&#24577;&#12290;(Hibernate&#20250;&#33258;&#21160;&#25191;&#34892;&#24517;&#35201;&#30340;SQL&#35821;&#21477;) </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#25345;&#20037;(Persistent)</EM></SPAN> - 
  &#25345;&#20037;(Persistent)&#30340;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#26377;&#23545;&#24212;&#30340;&#35760;&#24405;&#65292;&#24182;&#25317;&#26377;&#19968;&#20010;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#12290; 
  &#25345;&#20037;(Persistent)&#30340;&#23454;&#20363;&#21487;&#33021;&#26159;&#21018;&#34987;&#20445;&#23384;&#30340;&#65292;&#25110;&#21018;&#34987;&#21152;&#36733;&#30340;&#65292;&#26080;&#35770;&#21738;&#19968;&#31181;&#65292;&#25353;&#23450;&#20041;&#65292;&#23427;&#23384;&#22312;&#20110;&#30456;&#20851;&#32852;&#30340;<TT 
  class=literal>Session</TT>&#20316;&#29992;&#33539;&#22260;&#20869;&#12290; 
  Hibernate&#20250;&#26816;&#27979;&#21040;&#22788;&#20110;&#25345;&#20037;(Persistent)&#29366;&#24577;&#30340;&#23545;&#35937;&#30340;&#20219;&#20309;&#25913;&#21160;&#65292;&#22312;&#24403;&#21069;&#25805;&#20316;&#21333;&#20803;(unit of 
  work)&#25191;&#34892;&#23436;&#27605;&#26102;&#23558;&#23545;&#35937;&#25968;&#25454;(state)&#19982;&#25968;&#25454;&#24211;&#21516;&#27493;(synchronize)&#12290; &#24320;&#21457;&#32773;&#19981;&#38656;&#35201;&#25163;&#21160;&#25191;&#34892;<TT 
  class=literal>UPDATE</TT>&#12290;&#23558;&#23545;&#35937;&#20174;&#25345;&#20037;(Persistent)&#29366;&#24577;&#21464;&#25104;&#30636;&#26102;(Transient)&#29366;&#24577;&#21516;&#26679;&#20063;&#19981;&#38656;&#35201;&#25163;&#21160;&#25191;&#34892;<TT 
  class=literal>DELETE</TT>&#35821;&#21477;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#33073;&#31649;(Detached)</EM></SPAN> - &#19982;&#25345;&#20037;(Persistent)&#23545;&#35937;&#20851;&#32852;&#30340;<TT 
  class=literal>Session</TT>&#34987;&#20851;&#38381;&#21518;&#65292;&#23545;&#35937;&#23601;&#21464;&#20026;&#33073;&#31649;(Detached)&#30340;&#12290; 
  &#23545;&#33073;&#31649;(Detached)&#23545;&#35937;&#30340;&#24341;&#29992;&#20381;&#28982;&#26377;&#25928;&#65292;&#23545;&#35937;&#21487;&#32487;&#32493;&#34987;&#20462;&#25913;&#12290;&#33073;&#31649;(Detached)&#23545;&#35937;&#22914;&#26524;&#37325;&#26032;&#20851;&#32852;&#21040;&#26576;&#20010;&#26032;&#30340;<TT 
  class=literal>Session</TT>&#19978;&#65292; &#20250;&#20877;&#27425;&#36716;&#21464;&#20026;&#25345;&#20037;(Persistent)&#30340;(&#22312;Detached&#20854;&#38388;&#30340;&#25913;&#21160;&#23558;&#34987;&#25345;&#20037;&#21270;&#21040;&#25968;&#25454;&#24211;)&#12290; 
  &#36825;&#20010;&#21151;&#33021;&#20351;&#24471;&#19968;&#31181;&#32534;&#31243;&#27169;&#22411;&#65292;&#21363;&#20013;&#38388;&#20250;&#32473;&#29992;&#25143;&#24605;&#32771;&#26102;&#38388;(user think-time)&#30340;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#25805;&#20316;&#21333;&#20803;(unit of work)&#30340;&#32534;&#31243;&#27169;&#22411;&#25104;&#20026;&#21487;&#33021;&#12290; 
  &#25105;&#20204;&#31216;&#20043;&#20026;<SPAN class=emphasis><EM>&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;</EM></SPAN>&#65292;&#21363;&#20174;&#29992;&#25143;&#35266;&#28857;&#30475;&#26159;&#19968;&#20010;&#25805;&#20316;&#21333;&#20803;(unit of work)&#12290; 
  </P></LI></UL></DIV>
<P>&#25509;&#19979;&#26469;&#25105;&#20204;&#26469;&#32454;&#33268;&#30340;&#35752;&#35770;&#19979;&#29366;&#24577;(states)&#21450;&#29366;&#24577;&#38388;&#30340;&#36716;&#25442;(state transitions)&#65288;&#20197;&#21450;&#35302;&#21457;&#29366;&#24577;&#36716;&#25442;&#30340;Hibernate&#26041;&#27861;&#65289;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-makingpersistent></A>10.2.&nbsp;&#20351;&#23545;&#35937;&#25345;&#20037;&#21270;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#35748;&#20026;&#25345;&#20037;&#21270;&#31867;(persistent class)&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#26159;<SPAN 
class=emphasis><EM>&#30636;&#26102;(Transient)</EM></SPAN>&#30340;&#12290; 
&#25105;&#20204;&#21487;&#36890;&#36807;&#23558;&#30636;&#26102;(Transient)&#23545;&#35937;&#19982;session&#20851;&#32852;&#32780;&#25226;&#23427;&#21464;&#20026;<SPAN 
class=emphasis><EM>&#25345;&#20037;(Persistent)</EM></SPAN>&#30340;&#12290; </P><PRE class=programlisting>DomesticCat fritz = new DomesticCat();
fritz.setColor(Color.GINGER);
fritz.setSex('M');
fritz.setName("Fritz");
Long generatedId = (Long) sess.save(fritz);</PRE>
<P>&#22914;&#26524;<TT class=literal>Cat</TT>&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#26159;<TT 
class=literal>generated</TT>&#31867;&#22411;&#30340;&#65292; &#37027;&#20040;&#35813;&#26631;&#35782;(identifier)&#20250;&#33258;&#21160;&#22312;<TT 
class=literal>save()</TT>&#34987;&#35843;&#29992;&#26102;&#20135;&#29983;&#24182;&#20998;&#37197;&#32473;<TT class=literal>cat</TT>&#12290; &#22914;&#26524;<TT 
class=literal>Cat</TT>&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#26159;<TT 
class=literal>assigned</TT>&#31867;&#22411;&#30340;&#65292;&#25110;&#26159;&#19968;&#20010;&#22797;&#21512;&#20027;&#38190;(composite key)&#65292; 
&#37027;&#20040;&#35813;&#26631;&#35782;(identifier)&#24212;&#24403;&#22312;&#35843;&#29992;<TT class=literal>save()</TT>&#20043;&#21069;&#25163;&#21160;&#36171;&#20104;&#32473;<TT 
class=literal>cat</TT>&#12290; &#20320;&#20063;&#21487;&#20197;&#25353;&#29031;EJB3 early draft&#20013;&#23450;&#20041;&#30340;&#35821;&#20041;&#65292;&#20351;&#29992;<TT 
class=literal>persist()</TT>&#26367;&#20195;<TT class=literal>save()</TT>&#12290; </P>
<P>&#27492;&#22806;&#65292;&#20320;&#21487;&#20197;&#29992;&#19968;&#20010;&#37325;&#36733;&#29256;&#26412;&#30340;<TT class=literal>save()</TT>&#26041;&#27861;&#12290; </P><PRE class=programlisting>DomesticCat pk = new DomesticCat();
pk.setColor(Color.TABBY);
pk.setSex('F');
pk.setName("PK");
pk.setKittens( new HashSet() );
pk.addKitten(fritz);
sess.save( pk, new Long(1234) );</PRE>
<P>&#22914;&#26524;&#20320;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#26377;&#20851;&#32852;&#30340;&#23545;&#35937;(associated objects)&#65288;&#20363;&#22914;&#19978;&#20363;&#20013;&#30340;<TT class=literal>kittens</TT>&#38598;&#21512;&#65289; 
&#37027;&#20040;&#23545;&#36825;&#20123;&#23545;&#35937;&#65288;&#35793;&#27880;&#65306;pk&#21644;kittens&#65289;&#36827;&#34892;&#25345;&#20037;&#21270;&#30340;&#39034;&#24207;&#26159;&#20219;&#24847;&#30340;&#65288;&#20063;&#23601;&#26159;&#35828;&#21487;&#20197;&#20808;&#23545;kittens&#36827;&#34892;&#25345;&#20037;&#21270;&#20063;&#21487;&#20197;&#20808;&#23545;pk&#36827;&#34892;&#25345;&#20037;&#21270;&#65289;&#65292; 
&#38500;&#38750;&#20320;&#22312;&#22806;&#38190;&#21015;&#19978;&#26377;<TT class=literal>NOT NULL</TT>&#32422;&#26463;&#12290; 
Hibernate&#19981;&#20250;&#36829;&#21453;&#22806;&#38190;&#32422;&#26463;&#65292;&#20294;&#26159;&#22914;&#26524;&#20320;&#29992;&#38169;&#35823;&#30340;&#39034;&#24207;&#25345;&#20037;&#21270;&#23545;&#35937;&#65288;&#35793;&#27880;&#65306;&#22312;pk&#25345;&#20037;&#21270;&#20043;&#21069;&#25345;&#20037;&#21270;kitten&#65289;&#65292;&#37027;&#20040;&#21487;&#33021;&#20250;&#36829;&#21453;<TT 
class=literal>NOT NULL</TT>&#32422;&#26463;&#12290; </P>
<P>&#36890;&#24120;&#20320;&#19981;&#20250;&#20026;&#36825;&#20123;&#32454;&#33410;&#28902;&#24515;&#65292;&#22240;&#20026;&#20320;&#24456;&#21487;&#33021;&#20250;&#20351;&#29992;Hibernate&#30340; <SPAN class=emphasis><EM>&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
persistence)</EM></SPAN>&#21151;&#33021;&#33258;&#21160;&#20445;&#23384;&#30456;&#20851;&#32852;&#37027;&#20123;&#23545;&#35937;&#12290; &#36825;&#26679;&#36830;&#36829;&#21453;<TT class=literal>NOT 
NULL</TT>&#32422;&#26463;&#30340;&#24773;&#20917;&#37117;&#19981;&#20250;&#20986;&#29616;&#20102; - Hibernate&#20250;&#31649;&#22909;&#25152;&#26377;&#30340;&#20107;&#24773;&#12290; &#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
persistence)&#23558;&#22312;&#26412;&#31456;&#31245;&#21518;&#35752;&#35770;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-loading></A>10.3.&nbsp;&#35013;&#36733;&#23545;&#35937;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#30693;&#36947;&#26576;&#20010;&#23454;&#20363;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#20320;&#23601;&#21487;&#20197;&#20351;&#29992;<TT class=literal>Session</TT>&#30340;<TT 
class=literal>load()</TT>&#26041;&#27861; &#26469;&#33719;&#21462;&#23427;&#12290; <TT 
class=literal>load()</TT>&#30340;&#21478;&#19968;&#20010;&#21442;&#25968;&#26159;&#25351;&#23450;&#31867;&#30340;.class&#23545;&#35937;&#12290; &#26412;&#26041;&#27861;&#20250;&#21019;&#24314;&#25351;&#23450;&#31867;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#65292;&#24182;&#20174;&#25968;&#25454;&#24211;&#21152;&#36733;&#20854;&#25968;&#25454;(state)&#12290; 
</P><PRE class=programlisting>Cat fritz = (Cat) sess.load(Cat.class, generatedId);</PRE><PRE class=programlisting>// you need to wrap primitive identifiers
long id = 1234;
DomesticCat pk = (DomesticCat) sess.load( DomesticCat.class, new Long(id) );</PRE>
<P>&#27492;&#22806;, &#20320;&#21487;&#20197;&#25226;&#25968;&#25454;(state)&#21152;&#36733;&#21040;&#25351;&#23450;&#30340;&#23545;&#35937;&#23454;&#20363;&#19978;&#65288;&#35206;&#30422;&#25481;&#35813;&#23454;&#20363;&#21407;&#26469;&#30340;&#25968;&#25454;&#65289;&#12290; </P><PRE class=programlisting>Cat cat = new DomesticCat();
// load pk's state into cat
sess.load( cat, new Long(pkId) );
Set kittens = cat.getKittens();</PRE>
<P>&#35831;&#27880;&#24847;&#22914;&#26524;&#27809;&#26377;&#21305;&#37197;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;&#65292;<TT class=literal>load()</TT>&#26041;&#27861;&#21487;&#33021;&#25243;&#20986;&#26080;&#27861;&#24674;&#22797;&#30340;&#24322;&#24120;(unrecoverable 
exception)&#12290; &#22914;&#26524;&#31867;&#30340;&#26144;&#23556;&#20351;&#29992;&#20102;&#20195;&#29702;(proxy)&#65292;<TT 
class=literal>load()</TT>&#26041;&#27861;&#20250;&#36820;&#22238;&#19968;&#20010;&#26410;&#21021;&#22987;&#21270;&#30340;&#20195;&#29702;&#65292;&#30452;&#21040;&#20320;&#35843;&#29992;&#35813;&#20195;&#29702;&#30340;&#26576;&#26041;&#27861;&#26102;&#25165;&#20250;&#21435;&#35775;&#38382;&#25968;&#25454;&#24211;&#12290; 
&#33509;&#20320;&#24076;&#26395;&#22312;&#26576;&#23545;&#35937;&#20013;&#21019;&#24314;&#19968;&#20010;&#25351;&#21521;&#21478;&#19968;&#20010;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#21448;&#19981;&#24819;&#22312;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#35813;&#23545;&#35937;&#26102;&#21516;&#26102;&#35013;&#36733;&#30456;&#20851;&#32852;&#30340;&#37027;&#20010;&#23545;&#35937;&#65292;&#37027;&#20040;&#36825;&#31181;&#25805;&#20316;&#26041;&#24335;&#23601;&#29992;&#24471;&#19978;&#30340;&#20102;&#12290; 
&#22914;&#26524;&#20026;&#30456;&#24212;&#31867;&#26144;&#23556;&#20851;&#31995;&#35774;&#32622;&#20102;<TT class=literal>batch-size</TT>&#65292; 
&#37027;&#20040;&#20351;&#29992;&#36825;&#31181;&#25805;&#20316;&#26041;&#24335;&#20801;&#35768;&#22810;&#20010;&#23545;&#35937;&#34987;&#19968;&#25209;&#35013;&#36733;&#65288;&#22240;&#20026;&#36820;&#22238;&#30340;&#26159;&#20195;&#29702;&#65292;&#26080;&#38656;&#20174;&#25968;&#25454;&#24211;&#20013;&#25235;&#21462;&#25152;&#26377;&#23545;&#35937;&#30340;&#25968;&#25454;&#65289;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#19981;&#30830;&#23450;&#26159;&#21542;&#26377;&#21305;&#37197;&#30340;&#34892;&#23384;&#22312;&#65292;&#24212;&#35813;&#20351;&#29992;<TT 
class=literal>get()</TT>&#26041;&#27861;&#65292;&#23427;&#20250;&#31435;&#21051;&#35775;&#38382;&#25968;&#25454;&#24211;&#65292;&#22914;&#26524;&#27809;&#26377;&#23545;&#24212;&#30340;&#35760;&#24405;&#65292;&#20250;&#36820;&#22238;null&#12290; </P><PRE class=programlisting>Cat cat = (Cat) sess.get(Cat.class, id);
if (cat==null) {
    cat = new Cat();
    sess.save(cat, id);
}
return cat;</PRE>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#36873;&#29992;&#26576;&#20010;<TT class=literal>LockMode</TT>&#65292;&#29992;SQL&#30340;<TT class=literal>SELECT ... 
FOR UPDATE</TT>&#35013;&#36733;&#23545;&#35937;&#12290; &#35831;&#26597;&#38405;API&#25991;&#26723;&#20197;&#33719;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290; </P><PRE class=programlisting>Cat cat = (Cat) sess.get(Cat.class, id, LockMode.UPGRADE);</PRE>
<P>&#27880;&#24847;&#65292;&#20219;&#20309;&#20851;&#32852;&#30340;&#23545;&#35937;&#25110;&#32773;&#21253;&#21547;&#30340;&#38598;&#21512;&#37117;<SPAN class=emphasis><EM>&#19981;&#20250;</EM></SPAN>&#34987;&#20197;<TT 
class=literal>FOR UPDATE</TT>&#26041;&#24335;&#36820;&#22238;&#65292; &#38500;&#38750;&#20320;&#25351;&#23450;&#20102;<TT class=literal>lock</TT>&#25110;&#32773;<TT 
class=literal>all</TT>&#20316;&#20026;&#20851;&#32852;(association)&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style)&#12290; </P>
<P>&#20219;&#20309;&#26102;&#20505;&#37117;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>refresh()</TT>&#26041;&#27861;&#24378;&#36843;&#35013;&#36733;&#23545;&#35937;&#21644;&#23427;&#30340;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#20351;&#29992;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#21151;&#33021;&#26469;&#22788;&#29702;&#23545;&#35937;&#30340;&#26576;&#20123;&#23646;&#24615;&#65292;&#36825;&#20010;&#26041;&#27861;&#23601;&#24456;&#26377;&#29992;&#20102;&#12290; 
</P><PRE class=programlisting>sess.save(cat);
sess.flush(); //force the SQL INSERT
sess.refresh(cat); //re-read the state (after the trigger executes)</PRE>
<P>&#27492;&#22788;&#36890;&#24120;&#20250;&#20986;&#29616;&#19968;&#20010;&#37325;&#35201;&#38382;&#39064;: Hibernate&#20250;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#22810;&#23569;&#19996;&#35199;&#65311;&#20250;&#25191;&#34892;&#22810;&#23569;&#26465;&#30456;&#24212;&#30340;SQL<TT 
class=literal>SELECT</TT>&#35821;&#21477;&#65311; &#36825;&#21462;&#20915;&#20110;<SPAN class=emphasis><EM>&#25235;&#21462;&#31574;&#30053;(fetching 
strategy)</EM></SPAN>&#65292;&#20250;&#22312;<A 
title="19.1.&nbsp;&#10;&#9;&#9;&#9;&#25235;&#21462;&#31574;&#30053;(Fetching strategies)&#10;&#9;&#9;" 
href="#performance-fetching">&#31532;&nbsp;19.1&nbsp;&#33410; “ &#25235;&#21462;&#31574;&#30053;(Fetching strategies) 
”</A>&#20013;&#35299;&#37322;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-querying></A>10.4.&nbsp;&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#19981;&#30693;&#36947;&#25152;&#35201;&#23547;&#25214;&#30340;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;&#65292;&#37027;&#20040;&#20320;&#38656;&#35201;&#20351;&#29992;&#26597;&#35810;&#12290;Hibernate&#25903;&#25345;&#24378;&#22823;&#19988;&#26131;&#20110;&#20351;&#29992;&#30340;&#38754;&#21521;&#23545;&#35937;&#26597;&#35810;&#35821;&#35328;(HQL)&#12290; 
&#22914;&#26524;&#24076;&#26395;&#36890;&#36807;&#32534;&#31243;&#30340;&#26041;&#24335;&#21019;&#24314;&#26597;&#35810;&#65292;Hibernate&#25552;&#20379;&#20102;&#23436;&#21892;&#30340;&#25353;&#26465;&#20214;(Query By Criteria, QBC)&#20197;&#21450;&#25353;&#26679;&#20363;(Query By 
Example, QBE)&#36827;&#34892;&#26597;&#35810;&#30340;&#21151;&#33021;&#12290; &#20320;&#20063;&#21487;&#20197;&#29992;&#21407;&#29983;SQL(native SQL)&#25551;&#36848;&#26597;&#35810;&#65292;Hibernate&#39069;&#22806;&#25552;&#20379;&#20102;&#23558;&#32467;&#26524;&#38598;(result 
set)&#36716;&#21270;&#20026;&#23545;&#35937;&#30340;&#25903;&#25345;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=objectstate-querying-executing></A>10.4.1.&nbsp;&#25191;&#34892;&#26597;&#35810;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>HQL&#21644;&#21407;&#29983;SQL(native SQL)&#26597;&#35810;&#35201;&#36890;&#36807;&#20026;<TT class=literal>org.hibernate.Query</TT>&#30340;&#23454;&#20363;&#26469;&#34920;&#36798;&#12290; 
&#36825;&#20010;&#25509;&#21475;&#25552;&#20379;&#20102;&#21442;&#25968;&#32465;&#23450;&#12289;&#32467;&#26524;&#38598;&#22788;&#29702;&#20197;&#21450;&#36816;&#34892;&#23454;&#38469;&#26597;&#35810;&#30340;&#26041;&#27861;&#12290; &#20320;&#24635;&#26159;&#21487;&#20197;&#36890;&#36807;&#24403;&#21069;<TT class=literal>Session</TT>&#33719;&#21462;&#19968;&#20010;<TT 
class=literal>Query</TT>&#23545;&#35937;&#65306; </P><PRE class=programlisting>List cats = session.createQuery(
    "from Cat as cat where cat.birthdate &lt; ?")
    .setDate(0, date)
    .list();

List mothers = session.createQuery(
    "select mother from Cat as cat join cat.mother as mother where cat.name = ?")
    .setString(0, name)
    .list();

List kittens = session.createQuery(
    "from Cat as cat where cat.mother = ?")
    .setEntity(0, pk)
    .list();

Cat mother = (Cat) session.createQuery(
    "select cat.mother from Cat as cat where cat = ?")
    .setEntity(0, izi)
    .uniqueResult();]]

Query mothersWithKittens = (Cat) session.createQuery(
    "select mother from Cat as mother left join fetch mother.kittens");
Set uniqueMothers = new HashSet(mothersWithKittens.list());</PRE>
<P>&#19968;&#20010;&#26597;&#35810;&#36890;&#24120;&#22312;&#35843;&#29992;<TT class=literal>list()</TT>&#26102;&#34987;&#25191;&#34892;&#65292;&#25191;&#34892;&#32467;&#26524;&#20250;&#23436;&#20840;&#35013;&#36733;&#36827;&#20869;&#23384;&#20013;&#30340;&#19968;&#20010;&#38598;&#21512;(collection)&#12290; 
&#26597;&#35810;&#36820;&#22238;&#30340;&#23545;&#35937;&#22788;&#20110;&#25345;&#20037;(persistent)&#29366;&#24577;&#12290;&#22914;&#26524;&#20320;&#30693;&#36947;&#30340;&#26597;&#35810;&#21482;&#20250;&#36820;&#22238;&#19968;&#20010;&#23545;&#35937;&#65292;&#21487;&#20351;&#29992;<TT 
class=literal>list()</TT>&#30340;&#24555;&#25463;&#26041;&#24335;<TT class=literal>uniqueResult()</TT>&#12290; 
&#27880;&#24847;&#65292;&#20351;&#29992;&#38598;&#21512;&#39044;&#20808;&#25235;&#21462;&#30340;&#26597;&#35810;&#24448;&#24448;&#20250;&#36820;&#22238;&#22810;&#27425;&#26681;&#23545;&#35937;&#65288;&#20182;&#20204;&#30340;&#38598;&#21512;&#31867;&#37117;&#34987;&#21021;&#22987;&#21270;&#20102;&#65289;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#19968;&#20010;&#38598;&#21512;&#26469;&#36807;&#28388;&#36825;&#20123;&#37325;&#22797;&#23545;&#35937;&#12290; </P>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-iterate></A>10.4.1.1.&nbsp;&#36845;&#20195;&#24335;&#33719;&#21462;&#32467;&#26524;(Iterating 
results)</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26576;&#20123;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>iterate()</TT>&#26041;&#27861;&#24471;&#21040;&#26356;&#22909;&#30340;&#24615;&#33021;&#12290; 
&#36825;&#36890;&#24120;&#26159;&#20320;&#39044;&#26399;&#36820;&#22238;&#30340;&#32467;&#26524;&#22312;session&#65292;&#25110;&#20108;&#32423;&#32531;&#23384;(second-level cache)&#20013;&#24050;&#32463;&#23384;&#22312;&#26102;&#30340;&#24773;&#20917;&#12290; &#22914;&#33509;&#19981;&#28982;&#65292;<TT 
class=literal>iterate()</TT>&#20250;&#27604;<TT 
class=literal>list()</TT>&#24930;&#65292;&#32780;&#19988;&#21487;&#33021;&#31616;&#21333;&#26597;&#35810;&#20063;&#38656;&#35201;&#36827;&#34892;&#22810;&#27425;&#25968;&#25454;&#24211;&#35775;&#38382;&#65306; <TT 
class=literal>iterate()</TT>&#20250;&#39318;&#20808;&#20351;&#29992;<SPAN 
class=emphasis><EM>1</EM></SPAN>&#26465;&#35821;&#21477;&#24471;&#21040;&#25152;&#26377;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifiers)&#65292;&#20877;&#26681;&#25454;&#25345;&#20037;&#21270;&#26631;&#35782;&#25191;&#34892;<SPAN 
class=emphasis><EM>n</EM></SPAN>&#26465;&#38468;&#21152;&#30340;select&#35821;&#21477;&#23454;&#20363;&#21270;&#23454;&#38469;&#30340;&#23545;&#35937;&#12290; </P><PRE class=programlisting>// fetch ids
Iterator iter = sess.createQuery("from eg.Qux q order by q.likeliness").iterate();
while ( iter.hasNext() ) {
    Qux qux = (Qux) iter.next();  // fetch the object
    // something we couldnt express in the query
    if ( qux.calculateComplicatedAlgorithm() ) {
        // delete the current instance
        iter.remove();
        // dont need to process the rest
        break;
    }
}</PRE></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-tuples></A>10.4.1.2.&nbsp;&#36820;&#22238;&#20803;&#32452;(tuples)&#30340;&#26597;&#35810;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#65288;&#35793;&#27880;&#65306;&#20803;&#32452;(tuples)&#25351;&#19968;&#26465;&#32467;&#26524;&#34892;&#21253;&#21547;&#22810;&#20010;&#23545;&#35937;&#65289; Hibernate&#26597;&#35810;&#26377;&#26102;&#36820;&#22238;&#20803;&#32452;(tuples)&#65292;&#27599;&#20010;&#20803;&#32452;(tuples)&#20197;&#25968;&#32452;&#30340;&#24418;&#24335;&#36820;&#22238;: 
</P><PRE class=programlisting>Iterator kittensAndMothers = sess.createQuery(
            "select kitten, mother from Cat kitten join kitten.mother mother")
            .list()
            .iterator();

while ( kittensAndMothers.hasNext() ) {
    Object[] tuple = (Object[]) kittensAndMothers.next();
    Cat kitten  = tuple[0];
    Cat mother  = tuple[1];
    ....
}</PRE></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-scalar></A>10.4.1.3.&nbsp;&#26631;&#37327;(Scalar)&#32467;&#26524;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26597;&#35810;&#21487;&#22312;<TT class=literal>select</TT>&#20174;&#21477;&#20013;&#25351;&#23450;&#31867;&#30340;&#23646;&#24615;&#65292;&#29978;&#33267;&#21487;&#20197;&#35843;&#29992;SQL&#32479;&#35745;(aggregate)&#20989;&#25968;&#12290; 
&#23646;&#24615;&#25110;&#32479;&#35745;&#32467;&#26524;&#34987;&#35748;&#23450;&#20026;"&#26631;&#37327;(Scalar)"&#30340;&#32467;&#26524;&#65288;&#32780;&#19981;&#26159;&#25345;&#20037;(persistent state)&#30340;&#23454;&#20307;&#65289;&#12290; </P><PRE class=programlisting>Iterator results = sess.createQuery(
        "select cat.color, min(cat.birthdate), count(cat) from Cat cat " +
        "group by cat.color")
        .list()
        .iterator();
        
while ( results.hasNext() ) {
    Object[] row = (Object[]) results.next();
    Color type = (Color) row[0];
    Date oldest = (Date) row[1];
    Integer count = (Integer) row[2];
    .....
}</PRE></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-parameters></A>10.4.1.4.&nbsp;&#32465;&#23450;&#21442;&#25968;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25509;&#21475;<TT class=literal>Query</TT>&#25552;&#20379;&#20102;&#23545;&#21629;&#21517;&#21442;&#25968;(named parameters)&#12289;JDBC&#39118;&#26684;&#30340;<TT 
class=literal>&#38382;&#21495;(?)</TT>&#21442;&#25968;&#36827;&#34892;&#32465;&#23450;&#30340;&#26041;&#27861;&#12290; <SPAN 
class=emphasis><EM>&#19981;&#21516;&#20110;JDBC&#65292;Hibernate&#23545;&#21442;&#25968;&#20174;0&#24320;&#22987;&#35745;&#25968;&#12290;</EM></SPAN> &#21629;&#21517;&#21442;&#25968;(named 
parameters)&#22312;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#26159;&#24418;&#22914;<TT class=literal>:name</TT>&#30340;&#26631;&#35782;&#31526;&#12290; &#21629;&#21517;&#21442;&#25968;(named 
parameters)&#30340;&#20248;&#28857;&#26159;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#21629;&#21517;&#21442;&#25968;(named parameters)&#19982;&#20854;&#22312;&#26597;&#35810;&#20018;&#20013;&#20986;&#29616;&#30340;&#39034;&#24207;&#26080;&#20851; </P>
  <LI>
  <P>&#23427;&#20204;&#21487;&#22312;&#21516;&#19968;&#26597;&#35810;&#20018;&#20013;&#22810;&#27425;&#20986;&#29616; </P>
  <LI>
  <P>&#23427;&#20204;&#26412;&#36523;&#26159;&#33258;&#25105;&#35828;&#26126;&#30340; </P></LI></UL></DIV><PRE class=programlisting>//named parameter (preferred)
Query q = sess.createQuery("from DomesticCat cat where cat.name = :name");
q.setString("name", "Fritz");
Iterator cats = q.iterate();</PRE><PRE class=programlisting>//positional parameter
Query q = sess.createQuery("from DomesticCat cat where cat.name = ?");
q.setString(0, "Izi");
Iterator cats = q.iterate();</PRE><PRE class=programlisting>//named parameter list
List names = new ArrayList();
names.add("Izi");
names.add("Fritz");
Query q = sess.createQuery("from DomesticCat cat where cat.name in (:namesList)");
q.setParameterList("namesList", names);
List cats = q.list();</PRE></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-pagination></A>10.4.1.5.&nbsp;&#20998;&#39029;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#38656;&#35201;&#25351;&#23450;&#32467;&#26524;&#38598;&#30340;&#33539;&#22260;&#65288;&#24076;&#26395;&#36820;&#22238;&#30340;&#26368;&#22823;&#34892;&#25968;/&#25110;&#24320;&#22987;&#30340;&#34892;&#25968;&#65289;&#65292;&#24212;&#35813;&#20351;&#29992;<TT class=literal>Query</TT>&#25509;&#21475;&#25552;&#20379;&#30340;&#26041;&#27861;: </P><PRE class=programlisting>Query q = sess.createQuery("from DomesticCat cat");
q.setFirstResult(20);
q.setMaxResults(10);
List cats = q.list();</PRE>
<P>Hibernate &#30693;&#36947;&#22914;&#20309;&#23558;&#36825;&#20010;&#26377;&#38480;&#23450;&#26465;&#20214;&#30340;&#26597;&#35810;&#36716;&#25442;&#25104;&#20320;&#30340;&#25968;&#25454;&#24211;&#30340;&#21407;&#29983;SQL(native SQL)&#12290; </P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-scrolling></A>10.4.1.6.&nbsp;&#21487;&#28378;&#21160;&#36941;&#21382;(Scrollable 
iteration)</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#30340;JDBC&#39537;&#21160;&#25903;&#25345;&#21487;&#28378;&#21160;&#30340;<TT class=literal>ResuleSet</TT>&#65292;<TT 
class=literal>Query</TT>&#25509;&#21475;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>ScrollableResults</TT>&#65292;&#20801;&#35768;&#20320;&#22312;&#26597;&#35810;&#32467;&#26524;&#20013;&#28789;&#27963;&#28216;&#36208;&#12290; </P><PRE class=programlisting>Query q = sess.createQuery("select cat.name, cat from DomesticCat cat " +
                            "order by cat.name");
ScrollableResults cats = q.scroll();
if ( cats.first() ) {

    // find the first name on each page of an alphabetical list of cats by name
    firstNamesOfPages = new ArrayList();
    do {
        String name = cats.getString(0);
        firstNamesOfPages.add(name);
    }
    while ( cats.scroll(PAGE_SIZE) );

    // Now get the first page of cats
    pageOfCats = new ArrayList();
    cats.beforeFirst();
    int i=0;
    while( ( PAGE_SIZE &gt; i++ ) &amp;&amp; cats.next() ) pageOfCats.add( cats.get(1) );

}
cats.close()</PRE>
<P>&#35831;&#27880;&#24847;&#65292;&#20351;&#29992;&#27492;&#21151;&#33021;&#38656;&#35201;&#20445;&#25345;&#25968;&#25454;&#24211;&#36830;&#25509;&#65288;&#20197;&#21450;&#28216;&#26631;(cursor)&#65289;&#22788;&#20110;&#19968;&#30452;&#25171;&#24320;&#29366;&#24577;&#12290; &#22914;&#26524;&#20320;&#38656;&#35201;&#26029;&#24320;&#36830;&#25509;&#20351;&#29992;&#20998;&#39029;&#21151;&#33021;&#65292;&#35831;&#20351;&#29992;<TT 
class=literal>setMaxResult()</TT>/<TT class=literal>setFirstResult()</TT> 
</P></DIV>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=objectstate-querying-executing-named></A>10.4.1.7.&nbsp;&#22806;&#32622;&#21629;&#21517;&#26597;&#35810;(Externalizing 
named queries)</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#23450;&#20041;&#21629;&#21517;&#26597;&#35810;(named queries)&#12290; &#65288;&#22914;&#26524;&#20320;&#30340;&#26597;&#35810;&#20018;&#20013;&#21253;&#21547;&#21487;&#33021;&#34987;&#35299;&#37322;&#20026;XML&#26631;&#35760;(markup)&#30340;&#23383;&#31526;&#65292;&#21035;&#24536;&#20102;&#29992;<TT 
class=literal>CDATA</TT>&#21253;&#35065;&#36215;&#26469;&#12290;&#65289; </P><PRE class=programlisting>&lt;query name="eg.DomesticCat.by.name.and.minimum.weight"&gt;&lt;![CDATA[
    from eg.DomesticCat as cat
        where cat.name = ?
        and cat.weight &gt; ?
] ]&gt;&lt;/query&gt;</PRE>
<P>&#21442;&#25968;&#32465;&#23450;&#21450;&#25191;&#34892;&#20197;&#32534;&#31243;&#26041;&#24335;(programatically)&#23436;&#25104;&#65306; </P><PRE class=programlisting>Query q = sess.getNamedQuery("eg.DomesticCat.by.name.and.minimum.weight");
q.setString(0, name);
q.setInt(1, minWeight);
List cats = q.list();</PRE>
<P>&#35831;&#27880;&#24847;&#23454;&#38469;&#30340;&#31243;&#24207;&#20195;&#30721;&#19982;&#25152;&#29992;&#30340;&#26597;&#35810;&#35821;&#35328;&#26080;&#20851;&#65292;&#20320;&#20063;&#21487;&#22312;&#20803;&#25968;&#25454;&#20013;&#23450;&#20041;&#21407;&#29983;SQL(native SQL)&#26597;&#35810;&#65292; 
&#25110;&#23558;&#21407;&#26377;&#30340;&#20854;&#20182;&#30340;&#26597;&#35810;&#35821;&#21477;&#25918;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#35753;Hibernate&#32479;&#19968;&#31649;&#29702;&#65292;&#36798;&#21040;&#36801;&#31227;&#30340;&#30446;&#30340;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=objectstate-filtering></A>10.4.2.&nbsp;&#36807;&#28388;&#38598;&#21512;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38598;&#21512;<SPAN 
class=emphasis><EM>&#36807;&#28388;&#22120;(filter)</EM></SPAN>&#26159;&#19968;&#31181;&#29992;&#20110;&#19968;&#20010;&#25345;&#20037;&#21270;&#38598;&#21512;&#25110;&#32773;&#25968;&#32452;&#30340;&#29305;&#27530;&#30340;&#26597;&#35810;&#12290;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>"this"</TT>&#26469;&#24341;&#29992;&#38598;&#21512;&#20013;&#30340;&#24403;&#21069;&#20803;&#32032;&#12290; </P><PRE class=programlisting>Collection blackKittens = session.createFilter(
    pk.getKittens(), 
    "where this.color = ?")
    .setParameter( Color.BLACK, Hibernate.custom(ColorUserType.class) )
    .list()
);</PRE>
<P>&#36820;&#22238;&#30340;&#38598;&#21512;&#21487;&#20197;&#34987;&#35748;&#20026;&#26159;&#19968;&#20010;&#21253;(bag, &#26080;&#39034;&#24207;&#21487;&#37325;&#22797;&#30340;&#38598;&#21512;(collection))&#65292;&#23427;&#26159;&#25152;&#32473;&#38598;&#21512;&#30340;&#21103;&#26412;&#12290; 
&#21407;&#26469;&#30340;&#38598;&#21512;&#19981;&#20250;&#34987;&#25913;&#21160;&#65288;&#36825;&#19982;“&#36807;&#28388;&#22120;(filter)”&#30340;&#38544;&#21547;&#30340;&#21547;&#20041;&#19981;&#31526;&#65292;&#19981;&#36807;&#19982;&#25105;&#20204;&#26399;&#24453;&#30340;&#34892;&#20026;&#19968;&#33268;&#65289;&#12290; </P>
<P>&#35831;&#27880;&#24847;&#36807;&#28388;&#22120;(filter)&#24182;&#19981;&#38656;&#35201;<TT 
class=literal>from</TT>&#23376;&#21477;&#65288;&#24403;&#28982;&#38656;&#35201;&#30340;&#35805;&#23427;&#20204;&#20063;&#21487;&#20197;&#21152;&#19978;&#65289;&#12290;&#36807;&#28388;&#22120;(filter)&#19981;&#38480;&#23450;&#20110;&#21482;&#33021;&#36820;&#22238;&#38598;&#21512;&#20803;&#32032;&#26412;&#36523;&#12290; </P><PRE class=programlisting>Collection blackKittenMates = session.createFilter(
    pk.getKittens(), 
    "select this.mate where this.color = eg.Color.BLACK.intValue")
    .list();</PRE>
<P>&#21363;&#20351;&#26080;&#26465;&#20214;&#30340;&#36807;&#28388;&#22120;(filter)&#20063;&#26159;&#26377;&#24847;&#20041;&#30340;&#12290;&#20363;&#22914;&#65292;&#29992;&#20110;&#21152;&#36733;&#19968;&#20010;&#22823;&#38598;&#21512;&#30340;&#23376;&#38598;&#65306; </P><PRE class=programlisting>Collection tenKittens = session.createFilter(
    mother.getKittens(), "")
    .setFirstResult(0).setMaxResults(10)
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=objecstate-querying-criteria></A>10.4.3.&nbsp;&#26465;&#20214;&#26597;&#35810;(Criteria 
queries)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>HQL&#26497;&#20026;&#24378;&#22823;&#65292;&#20294;&#26159;&#26377;&#20123;&#20154;&#24076;&#26395;&#33021;&#22815;&#21160;&#24577;&#30340;&#20351;&#29992;&#19968;&#31181;&#38754;&#21521;&#23545;&#35937;API&#21019;&#24314;&#26597;&#35810;&#65292;&#32780;&#38750;&#22312;&#20182;&#20204;&#30340;Java&#20195;&#30721;&#20013;&#23884;&#20837;&#23383;&#31526;&#20018;&#12290;&#23545;&#20110;&#37027;&#37096;&#20998;&#20154;&#26469;&#35828;&#65292;Hibernate&#25552;&#20379;&#20102;&#30452;&#35266;&#30340;<TT 
class=literal>Criteria</TT>&#26597;&#35810;API&#12290; </P><PRE class=programlisting>Criteria crit = session.createCriteria(Cat.class);
crit.add( Expression.eq( "color", eg.Color.BLACK ) );
crit.setMaxResults(10);
List cats = crit.list();</PRE>
<P><TT class=literal>Criteria</TT>&#20197;&#21450;&#30456;&#20851;&#30340;<TT 
class=literal>&#26679;&#20363;(Example)</TT>API&#23558;&#20250;&#20877;<A 
title="&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#10;    &#26465;&#20214;&#26597;&#35810;(Criteria Queries)&#10;    " 
href="#querycriteria">&#31532;&nbsp;15&nbsp;&#31456; <I>&#26465;&#20214;&#26597;&#35810;(Criteria Queries) </I></A>&#20013;&#35814;&#32454;&#35752;&#35770;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=objectstate-querying-nativesql></A>10.4.4.&nbsp;&#20351;&#29992;&#21407;&#29983;SQL&#30340;&#26597;&#35810;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>createSQLQuery()</TT>&#26041;&#27861;&#65292;&#29992;SQL&#26469;&#25551;&#36848;&#26597;&#35810;&#65292;&#24182;&#30001;Hibernate&#23558;&#32467;&#26524;&#38598;&#36716;&#25442;&#25104;&#23545;&#35937;&#12290; 
&#35831;&#27880;&#24847;&#65292;&#20320;&#21487;&#20197;&#22312;&#20219;&#20309;&#26102;&#20505;&#35843;&#29992;<TT class=literal>session.connection()</TT>&#26469;&#33719;&#24471;&#24182;&#20351;&#29992;JDBC <TT 
class=literal>Connection</TT>&#23545;&#35937;&#12290; &#22914;&#26524;&#20320;&#36873;&#25321;&#20351;&#29992;Hibernate&#30340;API, &#20320;&#24517;&#39035;&#25226;SQL&#21035;&#21517;&#29992;&#22823;&#25324;&#21495;&#21253;&#22260;&#36215;&#26469;: </P><PRE class=programlisting>List cats = session.createSQLQuery(
    "SELECT {cat.*} FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list();</PRE><PRE class=programlisting>List cats = session.createSQLQuery(
    "SELECT {cat}.ID AS {cat.id}, {cat}.SEX AS {cat.sex}, " +
           "{cat}.MATE AS {cat.mate}, {cat}.SUBCLASS AS {cat.class}, ... " +
    "FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list()</PRE>
<P>&#21644;Hibernate&#26597;&#35810;&#19968;&#26679;&#65292;SQL&#26597;&#35810;&#20063;&#21487;&#20197;&#21253;&#21547;&#21629;&#21517;&#21442;&#25968;&#21644;&#21344;&#20301;&#21442;&#25968;&#12290; &#21487;&#20197;&#22312;<A 
title="&#31532;&nbsp;16&nbsp;&#31456;&nbsp;Native SQL&#26597;&#35810;" href="#querysql">&#31532;&nbsp;16&nbsp;&#31456; 
<I>Native SQL&#26597;&#35810;</I></A>&#25214;&#21040;&#26356;&#22810;&#20851;&#20110;Hibernate&#20013;&#21407;&#29983;SQL(native SQL)&#30340;&#20449;&#24687;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-modifying></A>10.5.&nbsp;&#20462;&#25913;&#25345;&#20037;&#23545;&#35937;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#20107;&#21153;&#20013;&#30340;&#25345;&#20037;&#23454;&#20363;</EM></SPAN>&#65288;&#23601;&#26159;&#36890;&#36807;<TT 
class=literal>session</TT>&#35013;&#36733;&#12289;&#20445;&#23384;&#12289;&#21019;&#24314;&#25110;&#32773;&#26597;&#35810;&#20986;&#30340;&#23545;&#35937;&#65289; &#34987;&#24212;&#29992;&#31243;&#24207;&#25805;&#20316;&#25152;&#36896;&#25104;&#30340;&#20219;&#20309;&#20462;&#25913;&#37117;&#20250;&#22312;<TT 
class=literal>Session</TT>&#34987;<SPAN 
class=emphasis><EM>&#21047;&#20986;&#65288;flushed&#65289;</EM></SPAN>&#30340;&#26102;&#20505;&#34987;&#25345;&#20037;&#21270;&#65288;&#26412;&#31456;&#21518;&#38754;&#20250;&#35814;&#32454;&#35752;&#35770;&#65289;&#12290; 
&#36825;&#37324;&#19981;&#38656;&#35201;&#35843;&#29992;&#26576;&#20010;&#29305;&#23450;&#30340;&#26041;&#27861;&#65288;&#27604;&#22914;<TT class=literal>update()</TT>&#65292;&#35774;&#35745;&#23427;&#30340;&#30446;&#30340;&#26159;&#19981;&#21516;&#30340;&#65289;&#23558;&#20320;&#30340;&#20462;&#25913;&#25345;&#20037;&#21270;&#12290; 
&#25152;&#20197;&#26368;&#30452;&#25509;&#30340;&#26356;&#26032;&#19968;&#20010;&#23545;&#35937;&#30340;&#26041;&#27861;&#23601;&#26159;&#22312;<TT class=literal>Session</TT>&#22788;&#20110;&#25171;&#24320;&#29366;&#24577;&#26102;<TT 
class=literal>load()</TT>&#23427;&#65292;&#28982;&#21518;&#30452;&#25509;&#20462;&#25913;&#21363;&#21487;&#65306; </P><PRE class=programlisting>DomesticCat cat = (DomesticCat) sess.load( Cat.class, new Long(69) );
cat.setName("PK");
sess.flush();  // changes to cat are automatically detected and persisted</PRE>
<P>&#26377;&#26102;&#36825;&#31181;&#31243;&#24207;&#27169;&#22411;&#25928;&#29575;&#20302;&#19979;&#65292;&#22240;&#20026;&#23427;&#22312;&#21516;&#19968;Session&#37324;&#38656;&#35201;&#19968;&#26465;SQL <TT class=literal>SELECT</TT>&#35821;&#21477;&#65288;&#29992;&#20110;&#21152;&#36733;&#23545;&#35937;&#65289; 
&#20197;&#21450;&#19968;&#26465;SQL <TT class=literal>UPDATE</TT>&#35821;&#21477;(&#25345;&#20037;&#21270;&#26356;&#26032;&#30340;&#29366;&#24577;)&#12290; 
&#20026;&#27492;Hibernate&#25552;&#20379;&#20102;&#21478;&#19968;&#31181;&#36884;&#24452;&#65292;&#20351;&#29992;&#33073;&#31649;(detached)&#23454;&#20363;&#12290; </P>
<P><SPAN class=emphasis><EM>&#35831;&#27880;&#24847;Hibernate&#26412;&#36523;&#19981;&#25552;&#20379;&#30452;&#25509;&#25191;&#34892;<TT 
class=literal>UPDATE</TT>&#25110;<TT class=literal>DELETE</TT>&#35821;&#21477;&#30340;API&#12290; 
Hibernate&#25552;&#20379;&#30340;&#26159;<SPAN class=emphasis><EM>&#29366;&#24577;&#31649;&#29702;(state 
management)</EM></SPAN>&#26381;&#21153;&#65292;&#20320;&#19981;&#24517;&#32771;&#34385;&#35201;&#20351;&#29992;&#30340;<SPAN 
class=emphasis><EM>&#35821;&#21477;(statements)</EM></SPAN>&#12290; JDBC&#26159;&#20986;&#33394;&#30340;&#25191;&#34892;SQL&#35821;&#21477;&#30340;API&#65292;&#20219;&#20309;&#26102;&#20505;&#35843;&#29992;<TT 
class=literal>session.connection()</TT>&#20320;&#37117;&#21487;&#20197;&#24471;&#21040;&#19968;&#20010;JDBC <TT 
class=literal>Connection</TT>&#23545;&#35937;&#12290; &#27492;&#22806;&#65292;&#22312;&#32852;&#26426;&#20107;&#21153;&#22788;&#29702;(OLTP)&#31243;&#24207;&#20013;&#65292;&#22823;&#37327;&#25805;&#20316;(mass 
operations)&#19982;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#30340;&#35266;&#28857;&#26159;&#30456;&#20914;&#31361;&#30340;&#12290; Hibernate&#30340;&#23558;&#26469;&#29256;&#26412;&#21487;&#33021;&#20250;&#25552;&#20379;&#19987;&#38376;&#30340;&#36827;&#34892;&#22823;&#37327;&#25805;&#20316;(mass operation)&#30340;&#21151;&#33021;&#12290; 
&#21442;&#32771;<A title="&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#25209;&#37327;&#22788;&#29702;&#65288;Batch processing&#65289;" 
href="#batch">&#31532;&nbsp;13&nbsp;&#31456; <I>&#25209;&#37327;&#22788;&#29702;&#65288;Batch 
processing&#65289;</I></A>&#65292;&#23547;&#25214;&#19968;&#20123;&#21487;&#29992;&#30340;&#25209;&#37327;(batch)&#25805;&#20316;&#25216;&#24039;&#12290;</EM></SPAN> </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-detached></A>10.6.&nbsp;&#20462;&#25913;&#33073;&#31649;(Detached)&#23545;&#35937;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24456;&#22810;&#31243;&#24207;&#38656;&#35201;&#22312;&#26576;&#20010;&#20107;&#21153;&#20013;&#33719;&#21462;&#23545;&#35937;&#65292;&#28982;&#21518;&#23558;&#23545;&#35937;&#21457;&#36865;&#21040;&#30028;&#38754;&#23618;&#21435;&#25805;&#20316;&#65292;&#26368;&#21518;&#22312;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#20445;&#23384;&#25152;&#20570;&#30340;&#20462;&#25913;&#12290; 
&#22312;&#39640;&#24182;&#21457;&#35775;&#38382;&#30340;&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#36890;&#24120;&#20351;&#29992;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#25968;&#25454;&#26469;&#20445;&#35777;&#36825;&#20123;“&#38271;“&#24037;&#20316;&#21333;&#20803;&#20043;&#38388;&#30340;&#38548;&#31163;&#12290; </P>
<P>Hibernate&#36890;&#36807;&#25552;&#20379;<TT class=literal>Session.update()</TT>&#25110;<TT 
class=literal>Session.merge()</TT> &#37325;&#26032;&#20851;&#32852;&#33073;&#31649;&#23454;&#20363;&#30340;&#21150;&#27861;&#26469;&#25903;&#25345;&#36825;&#31181;&#27169;&#22411;&#12290; </P><PRE class=programlisting>// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catId);
Cat potentialMate = new Cat();
firstSession.save(potentialMate);

// in a higher layer of the application
cat.setMate(potentialMate);

// later, in a new session
secondSession.update(cat);  // update cat
secondSession.update(mate); // update mate</PRE>
<P>&#22914;&#26524;&#20855;&#26377;<TT class=literal>catId</TT>&#25345;&#20037;&#21270;&#26631;&#35782;&#30340;<TT class=literal>Cat</TT>&#20043;&#21069;&#24050;&#32463;&#34987;<TT 
class=literal>&#21478;&#19968;Session(secondSession)</TT>&#35013;&#36733;&#20102;&#65292; &#24212;&#29992;&#31243;&#24207;&#36827;&#34892;&#37325;&#20851;&#32852;&#25805;&#20316;(reattach)&#30340;&#26102;&#20505;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290; 
</P>
<P>&#22914;&#26524;&#20320;&#30830;&#23450;&#24403;&#21069;session&#27809;&#26377;&#21253;&#21547;&#19982;&#20043;&#20855;&#26377;&#30456;&#21516;&#25345;&#20037;&#21270;&#26631;&#35782;&#30340;&#25345;&#20037;&#23454;&#20363;&#65292;&#20351;&#29992;<TT class=literal>update()</TT>&#12290; 
&#22914;&#26524;&#24819;&#38543;&#26102;&#21512;&#24182;&#20320;&#30340;&#30340;&#25913;&#21160;&#32780;&#19981;&#32771;&#34385;session&#30340;&#29366;&#24577;&#65292;&#20351;&#29992;<TT class=literal>merge()</TT>&#12290; 
&#25442;&#21477;&#35805;&#35828;&#65292;&#22312;&#19968;&#20010;&#26032;session&#20013;&#36890;&#24120;&#31532;&#19968;&#20010;&#35843;&#29992;&#30340;&#26159;<TT 
class=literal>update()</TT>&#26041;&#27861;&#65292;&#20197;&#20415;&#20445;&#35777;&#37325;&#26032;&#20851;&#32852;&#33073;&#31649;(detached)&#23545;&#35937;&#30340;&#25805;&#20316;&#39318;&#20808;&#34987;&#25191;&#34892;&#12290; </P>
<P>&#22914;&#26524;&#24076;&#26395;&#30456;&#20851;&#32852;&#30340;&#33073;&#31649;&#23545;&#35937;&#65288;&#36890;&#36807;&#24341;&#29992;“&#21487;&#21040;&#36798;”&#30340;&#33073;&#31649;&#23545;&#35937;&#65289;&#30340;&#25968;&#25454;&#20063;&#35201;&#26356;&#26032;&#21040;&#25968;&#25454;&#24211;&#26102;&#65288;&#24182;&#19988;&#20063;<SPAN 
class=emphasis><EM>&#20165;&#20165;</EM></SPAN>&#22312;&#36825;&#31181;&#24773;&#20917;&#65289;&#65292; &#21487;&#20197;&#23545;&#35813;&#30456;&#20851;&#32852;&#30340;&#33073;&#31649;&#23545;&#35937;&#21333;&#29420;&#35843;&#29992;<TT 
class=literal>update()</TT> &#24403;&#28982;&#36825;&#20123;&#21487;&#20197;&#33258;&#21160;&#23436;&#25104;&#65292;&#21363;&#36890;&#36807;&#20351;&#29992;<SPAN 
class=emphasis><EM>&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</EM></SPAN>&#65292;&#35831;&#30475;<A 
title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)" 
href="#objectstate-transitive">&#31532;&nbsp;10.11&nbsp;&#33410; “&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
persistence)”</A>&#12290; </P>
<P><TT 
class=literal>lock()</TT>&#26041;&#27861;&#20063;&#20801;&#35768;&#31243;&#24207;&#37325;&#26032;&#20851;&#32852;&#26576;&#20010;&#23545;&#35937;&#21040;&#19968;&#20010;&#26032;session&#19978;&#12290;&#19981;&#36807;&#65292;&#35813;&#33073;&#31649;(detached)&#30340;&#23545;&#35937;&#24517;&#39035;&#26159;&#27809;&#26377;&#20462;&#25913;&#36807;&#30340;&#65281; 
</P><PRE class=programlisting>//just reassociate:
sess.lock(fritz, LockMode.NONE);
//do a version check, then reassociate:
sess.lock(izi, LockMode.READ);
//do a version check, using SELECT ... FOR UPDATE, then reassociate:
sess.lock(pk, LockMode.UPGRADE);</PRE>
<P>&#35831;&#27880;&#24847;&#65292;<TT class=literal>lock()</TT>&#21487;&#20197;&#25645;&#37197;&#22810;&#31181;<TT class=literal>LockMode</TT>&#65292; 
&#26356;&#22810;&#20449;&#24687;&#35831;&#38405;&#35835;API&#25991;&#26723;&#20197;&#21450;&#20851;&#20110;&#20107;&#21153;&#22788;&#29702;(transaction handling)&#30340;&#31456;&#33410;&#12290;&#37325;&#26032;&#20851;&#32852;&#19981;&#26159;<TT 
class=literal>lock()</TT>&#30340;&#21807;&#19968;&#29992;&#36884;&#12290; </P>
<P>&#20854;&#20182;&#29992;&#20110;&#38271;&#26102;&#38388;&#24037;&#20316;&#21333;&#20803;&#30340;&#27169;&#22411;&#20250;&#22312;<A title="11.3.&nbsp;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic concurrency control)" 
href="#transactions-optimistic">&#31532;&nbsp;11.3&nbsp;&#33410; “&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic 
concurrency control)”</A>&#20013;&#35752;&#35770;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-saveorupdate></A>10.7.&nbsp;&#33258;&#21160;&#29366;&#24577;&#26816;&#27979;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#30340;&#29992;&#25143;&#26366;&#35201;&#27714;&#19968;&#20010;&#26082;&#21487;&#33258;&#21160;&#20998;&#37197;&#26032;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#20445;&#23384;&#30636;&#26102;(transient)&#23545;&#35937;&#65292;&#21448;&#21487;&#26356;&#26032;/&#37325;&#26032;&#20851;&#32852;&#33073;&#31649;(detached)&#23454;&#20363;&#30340;&#36890;&#29992;&#26041;&#27861;&#12290; 
<TT class=literal>saveOrUpdate()</TT>&#26041;&#27861;&#23454;&#29616;&#20102;&#36825;&#20010;&#21151;&#33021;&#12290; </P><PRE class=programlisting>// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catID);

// in a higher tier of the application
Cat mate = new Cat();
cat.setMate(mate);

// later, in a new session
secondSession.saveOrUpdate(cat);   // update existing state (cat has a non-null id)
secondSession.saveOrUpdate(mate);  // save the new instance (mate has a null id)</PRE>
<P><TT class=literal>saveOrUpdate()</TT>&#29992;&#36884;&#21644;&#35821;&#20041;&#21487;&#33021;&#20250;&#20351;&#26032;&#29992;&#25143;&#24863;&#21040;&#36855;&#24785;&#12290; 
&#39318;&#20808;&#65292;&#21482;&#35201;&#20320;&#27809;&#26377;&#23581;&#35797;&#22312;&#26576;&#20010;session&#20013;&#20351;&#29992;&#26469;&#33258;&#21478;&#19968;session&#30340;&#23454;&#20363;&#65292;&#20320;&#23601;&#24212;&#35813;&#19981;&#38656;&#35201;&#20351;&#29992;<TT class=literal>update()</TT>&#65292; 
<TT class=literal>saveOrUpdate()</TT>&#65292;&#25110;<TT 
class=literal>merge()</TT>&#12290;&#26377;&#20123;&#31243;&#24207;&#20174;&#26469;&#19981;&#29992;&#36825;&#20123;&#26041;&#27861;&#12290; </P>
<P>&#36890;&#24120;&#19979;&#38754;&#30340;&#22330;&#26223;&#20250;&#20351;&#29992;<TT class=literal>update()</TT>&#25110;<TT 
class=literal>saveOrUpdate()</TT>&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#31243;&#24207;&#22312;&#31532;&#19968;&#20010;session&#20013;&#21152;&#36733;&#23545;&#35937; </P>
  <LI>
  <P>&#35813;&#23545;&#35937;&#34987;&#20256;&#36882;&#21040;&#34920;&#29616;&#23618; </P>
  <LI>
  <P>&#23545;&#35937;&#21457;&#29983;&#20102;&#19968;&#20123;&#25913;&#21160; </P>
  <LI>
  <P>&#35813;&#23545;&#35937;&#34987;&#36820;&#22238;&#21040;&#19994;&#21153;&#36923;&#36753;&#23618; </P>
  <LI>
  <P>&#31243;&#24207;&#35843;&#29992;&#31532;&#20108;&#20010;session&#30340;<TT class=literal>update()</TT>&#26041;&#27861;&#25345;&#20037;&#36825;&#20123;&#25913;&#21160; </P></LI></UL></DIV>
<P><TT class=literal>saveOrUpdate()</TT>&#20570;&#19979;&#38754;&#30340;&#20107;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#22914;&#26524;&#23545;&#35937;&#24050;&#32463;&#22312;&#26412;session&#20013;&#25345;&#20037;&#21270;&#20102;&#65292;&#19981;&#20570;&#20219;&#20309;&#20107; </P>
  <LI>
  <P>&#22914;&#26524;&#21478;&#19968;&#20010;&#19982;&#26412;session&#20851;&#32852;&#30340;&#23545;&#35937;&#25317;&#26377;&#30456;&#21516;&#30340;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120; </P>
  <LI>
  <P>&#22914;&#26524;&#23545;&#35937;&#27809;&#26377;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#23646;&#24615;&#65292;&#23545;&#20854;&#35843;&#29992;<TT class=literal>save()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#23545;&#35937;&#30340;&#25345;&#20037;&#26631;&#35782;(identifier)&#34920;&#26126;&#20854;&#26159;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65292;&#23545;&#20854;&#35843;&#29992;<TT class=literal>save()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#23545;&#35937;&#26159;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#65288;&#36890;&#36807;<TT class=literal>&lt;version&gt;</TT>&#25110;<TT 
  class=literal>&lt;timestamp&gt;</TT>&#65289; &#24182;&#19988;&#29256;&#26412;&#23646;&#24615;&#30340;&#20540;&#34920;&#26126;&#20854;&#26159;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65292;<TT 
  class=literal>save()</TT>&#23427;&#12290; </P>
  <LI>
  <P>&#21542;&#21017;<TT class=literal>update()</TT> &#36825;&#20010;&#23545;&#35937; </P></LI></UL></DIV>
<P><TT class=literal>merge()</TT>&#21487;&#38750;&#24120;&#19981;&#21516;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#22914;&#26524;session&#20013;&#23384;&#22312;&#30456;&#21516;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#30340;&#23454;&#20363;&#65292;&#29992;&#29992;&#25143;&#32473;&#20986;&#30340;&#23545;&#35937;&#30340;&#29366;&#24577;&#35206;&#30422;&#26087;&#26377;&#30340;&#25345;&#20037;&#23454;&#20363; </P>
  <LI>
  <P>&#22914;&#26524;session&#27809;&#26377;&#30456;&#24212;&#30340;&#25345;&#20037;&#23454;&#20363;&#65292;&#21017;&#23581;&#35797;&#20174;&#25968;&#25454;&#24211;&#20013;&#21152;&#36733;&#65292;&#25110;&#21019;&#24314;&#26032;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363; </P>
  <LI>
  <P>&#26368;&#21518;&#36820;&#22238;&#35813;&#25345;&#20037;&#23454;&#20363; </P>
  <LI>
  <P>&#29992;&#25143;&#32473;&#20986;&#30340;&#36825;&#20010;&#23545;&#35937;&#27809;&#26377;&#34987;&#20851;&#32852;&#21040;session&#19978;&#65292;&#23427;&#20381;&#26087;&#26159;&#33073;&#31649;&#30340; </P></LI></UL></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-deleting></A>10.8.&nbsp;&#21024;&#38500;&#25345;&#20037;&#23545;&#35937;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20351;&#29992;<TT class=literal>Session.delete()</TT>&#20250;&#25226;&#23545;&#35937;&#30340;&#29366;&#24577;&#20174;&#25968;&#25454;&#24211;&#20013;&#31227;&#38500;&#12290; 
&#24403;&#28982;&#65292;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#20173;&#28982;&#25345;&#26377;&#19968;&#20010;&#25351;&#21521;&#24050;&#21024;&#38500;&#23545;&#35937;&#30340;&#24341;&#29992;&#12290;&#25152;&#20197;&#65292;&#26368;&#22909;&#36825;&#26679;&#29702;&#35299;&#65306;<TT 
class=literal>delete()</TT>&#30340;&#29992;&#36884;&#26159;&#25226;&#19968;&#20010;&#25345;&#20037;&#23454;&#20363;&#21464;&#25104;&#30636;&#26102;(transient)&#23454;&#20363;&#12290; </P><PRE class=programlisting>sess.delete(cat);</PRE>
<P>&#20320;&#21487;&#20197;&#29992;&#20320;&#21916;&#27426;&#30340;&#20219;&#20309;&#39034;&#24207;&#21024;&#38500;&#23545;&#35937;&#65292;&#19981;&#29992;&#25285;&#24515;&#22806;&#38190;&#32422;&#26463;&#20914;&#31361;&#12290;&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#25630;&#38169;&#20102;&#39034;&#24207;&#65292;&#36824;&#26159;&#26377;&#21487;&#33021;&#24341;&#21457;&#22312;&#22806;&#38190;&#23383;&#27573;&#23450;&#20041;&#30340;<TT class=literal>NOT 
NULL</TT>&#32422;&#26463;&#20914;&#31361;&#12290; &#20363;&#22914;&#20320;&#21024;&#38500;&#20102;&#29238;&#23545;&#35937;&#65292;&#20294;&#26159;&#24536;&#35760;&#21024;&#38500;&#23401;&#23376;&#20204;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-replicating></A>10.9.&nbsp;&#22312;&#20004;&#20010;&#19981;&#21516;&#25968;&#25454;&#24211;&#38388;&#22797;&#21046;&#23545;&#35937;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20598;&#23572;&#20250;&#29992;&#21040;&#19981;&#37325;&#26032;&#29983;&#25104;&#25345;&#20037;&#21270;&#26631;&#35782;(identifier)&#65292;&#23558;&#25345;&#20037;&#23454;&#20363;&#20197;&#21450;&#20854;&#20851;&#32852;&#30340;&#23454;&#20363;&#25345;&#20037;&#21040;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#20013;&#30340;&#25805;&#20316;&#12290; </P><PRE class=programlisting>//retrieve a cat from one database
Session session1 = factory1.openSession();
Transaction tx1 = session1.beginTransaction();
Cat cat = session1.get(Cat.class, catId);
tx1.commit();
session1.close();

//reconcile with a second database
Session session2 = factory2.openSession();
Transaction tx2 = session2.beginTransaction();
session2.replicate(cat, ReplicationMode.LATEST_VERSION);
tx2.commit();
session2.close();</PRE>
<P><TT class=literal>ReplicationMode</TT>&#20915;&#23450;&#22312;&#21644;&#25968;&#25454;&#24211;&#20013;&#24050;&#23384;&#22312;&#35760;&#24405;&#30001;&#20914;&#31361;&#26102;&#65292;<TT 
class=literal>replicate()</TT>&#22914;&#20309;&#22788;&#29702;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>ReplicationMode.IGNORE</TT> - &#24573;&#30053;&#23427; </P>
  <LI>
  <P><TT class=literal>ReplicationMode.OVERWRITE</TT> - &#35206;&#30422;&#30456;&#21516;&#30340;&#34892; </P>
  <LI>
  <P><TT class=literal>ReplicationMode.EXCEPTION</TT> - &#25243;&#20986;&#24322;&#24120; </P>
  <LI>
  <P><TT class=literal>ReplicationMode.LATEST_VERSION</TT> - &#22914;&#26524;&#24403;&#21069;&#30340;&#29256;&#26412;&#36739;&#26032;&#65292;&#21017;&#35206;&#30422;&#65292;&#21542;&#21017;&#24573;&#30053; 
  </P></LI></UL></DIV>
<P>&#36825;&#20010;&#21151;&#33021;&#30340;&#29992;&#36884;&#21253;&#25324;&#20351;&#24405;&#20837;&#30340;&#25968;&#25454;&#22312;&#19981;&#21516;&#25968;&#25454;&#24211;&#20013;&#19968;&#33268;&#65292;&#20135;&#21697;&#21319;&#32423;&#26102;&#21319;&#32423;&#31995;&#32479;&#37197;&#32622;&#20449;&#24687;&#65292;&#22238;&#28378;non-ACID&#20107;&#21153;&#20013;&#30340;&#20462;&#25913;&#31561;&#31561;&#12290; 
&#65288;&#35793;&#27880;&#65292;non-ACID&#65292;&#38750;ACID;ACID&#65292;Atomic&#65292;Consistent&#65292;Isolated and Durable&#30340;&#32553;&#20889;&#65289; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-flushing></A>10.10.&nbsp;Session&#21047;&#20986;(flush)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#27599;&#38388;&#38548;&#19968;&#27573;&#26102;&#38388;&#65292;<TT 
class=literal>Session</TT>&#20250;&#25191;&#34892;&#19968;&#20123;&#24517;&#38656;&#30340;SQL&#35821;&#21477;&#26469;&#25226;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#30340;&#29366;&#24577;&#21516;&#27493;&#21040;JDBC&#36830;&#25509;&#20013;&#12290;&#36825;&#20010;&#36807;&#31243;&#34987;&#31216;&#20026;<SPAN 
class=emphasis><EM>&#21047;&#20986;(flush)</EM></SPAN>&#65292;&#40664;&#35748;&#20250;&#22312;&#19979;&#38754;&#30340;&#26102;&#38388;&#28857;&#25191;&#34892;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#22312;&#26576;&#20123;&#26597;&#35810;&#25191;&#34892;&#20043;&#21069; </P>
  <LI>
  <P>&#22312;&#35843;&#29992;<TT class=literal>org.hibernate.Transaction.commit()</TT>&#30340;&#26102;&#20505; </P>
  <LI>
  <P>&#22312;&#35843;&#29992;<TT class=literal>Session.flush()</TT>&#30340;&#26102;&#20505; </P></LI></UL></DIV>
<P>&#28041;&#21450;&#30340;SQL&#35821;&#21477;&#20250;&#25353;&#29031;&#19979;&#38754;&#30340;&#39034;&#24207;&#21457;&#20986;&#25191;&#34892;&#65306; </P>
<DIV class=orderedlist>
<OL type=1 compact>
  <LI>
  <P>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#25554;&#20837;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<TT class=literal>Session.save()</TT>&#30340;&#26102;&#38388;&#39034;&#24207; </P>
  <LI>
  <P>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#26356;&#26032;&#30340;&#35821;&#21477; </P>
  <LI>
  <P>&#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#21024;&#38500;&#30340;&#35821;&#21477; </P>
  <LI>
  <P>&#25152;&#26377;&#23545;&#38598;&#21512;&#20803;&#32032;&#36827;&#34892;&#21024;&#38500;&#65292;&#26356;&#26032;&#25110;&#32773;&#25554;&#20837;&#30340;&#35821;&#21477; </P>
  <LI>
  <P>&#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#25554;&#20837;&#30340;&#35821;&#21477; </P>
  <LI>
  <P>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#21024;&#38500;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<TT class=literal>Session.delete()</TT>&#30340;&#26102;&#38388;&#39034;&#24207; 
</P></LI></OL></DIV>
<P>&#65288;&#26377;&#19968;&#20010;&#20363;&#22806;&#26159;&#65292;&#22914;&#26524;&#23545;&#35937;&#20351;&#29992;<TT class=literal>native</TT>&#26041;&#24335;&#26469;&#29983;&#25104;ID&#65288;&#25345;&#20037;&#21270;&#26631;&#35782;&#65289;&#30340;&#35805;&#65292;&#23427;&#20204;&#19968;&#25191;&#34892;save&#23601;&#20250;&#34987;&#25554;&#20837;&#12290;&#65289; 
</P>
<P>&#38500;&#38750;&#20320;&#26126;&#30830;&#22320;&#21457;&#20986;&#20102;<TT class=literal>flush()</TT>&#25351;&#20196;&#65292;&#20851;&#20110;Session<SPAN 
class=emphasis><EM>&#20309;&#26102;</EM></SPAN>&#20250;&#25191;&#34892;&#36825;&#20123;JDBC&#35843;&#29992;&#26159;&#23436;&#20840;&#26080;&#27861;&#20445;&#35777;&#30340;&#65292;&#21482;&#33021;&#20445;&#35777;&#23427;&#20204;&#25191;&#34892;&#30340;&#21069;&#21518;&#39034;&#24207;&#12290; 
&#24403;&#28982;&#65292;Hibernate&#20445;&#35777;&#65292;<TT class=literal>Query.list(..)</TT>&#32477;&#23545;&#19981;&#20250;&#36820;&#22238;&#24050;&#32463;&#22833;&#25928;&#30340;&#25968;&#25454;&#65292;&#20063;&#19981;&#20250;&#36820;&#22238;&#38169;&#35823;&#25968;&#25454;&#12290; 
</P>
<P>&#20063;&#21487;&#20197;&#25913;&#21464;&#40664;&#35748;&#30340;&#35774;&#32622;&#65292;&#26469;&#35753;&#21047;&#20986;(flush)&#25805;&#20316;&#21457;&#29983;&#30340;&#19981;&#37027;&#20040;&#39057;&#32321;&#12290; <TT 
class=literal>FlushMode</TT>&#31867;&#23450;&#20041;&#20102;&#19977;&#31181;&#19981;&#21516;&#30340;&#26041;&#24335;&#12290; &#20165;&#22312;&#25552;&#20132;&#26102;&#21047;&#20986;(&#20165;&#24403;Hibernate&#30340;<TT 
class=literal>Transaction</TT> API&#34987;&#20351;&#29992;&#26102;&#26377;&#25928;)&#65292; &#25353;&#29031;&#21018;&#25165;&#35828;&#30340;&#26041;&#24335;&#21047;&#20986;&#65292; &#20197;&#21450;&#38500;&#38750;&#26126;&#30830;&#20351;&#29992;<TT 
class=literal>flush()</TT>&#21542;&#21017;&#20174;&#19981;&#21047;&#20986;&#12290; &#26368;&#21518;&#19968;&#31181;&#27169;&#24335;&#23545;&#20110;&#37027;&#20123;&#38656;&#35201;&#38271;&#26102;&#38388;&#20445;&#25345;<TT 
class=literal>Session</TT>&#20026;&#25171;&#24320;&#25110;&#32773;&#26029;&#32447;&#29366;&#24577;&#30340;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#24037;&#20316;&#21333;&#20803;&#24456;&#26377;&#29992;&#12290; (&#21442;&#35265; <A 
title=11.3.2.&nbsp;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270; 
href="#transactions-optimistic-longsession">&#31532;&nbsp;11.3.2&nbsp;&#33410; 
“&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;”</A>). </P><PRE class=programlisting>sess = sf.openSession();
Transaction tx = sess.beginTransaction();
sess.setFlushMode(FlushMode.COMMIT); // allow queries to return stale state

Cat izi = (Cat) sess.load(Cat.class, id);
izi.setName(iznizi);

// might return stale data
sess.find("from Cat as cat left outer join cat.kittens kitten");

// change to izi is not flushed!
...
tx.commit(); // flush occurs
sess.close();</PRE>
<P>&#21047;&#20986;(flush)&#26399;&#38388;&#65292;&#21487;&#33021;&#20250;&#25243;&#20986;&#24322;&#24120;&#12290;&#65288;&#20363;&#22914;&#19968;&#20010;DML&#25805;&#20316;&#36829;&#21453;&#20102;&#32422;&#26463;&#65289; &#24322;&#24120;&#22788;&#29702;&#28041;&#21450;&#21040;&#23545;Hibernate&#20107;&#21153;&#24615;&#34892;&#20026;&#30340;&#29702;&#35299;&#65292;&#22240;&#27492;&#25105;&#20204;&#23558;&#22312;<A 
title=&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457; href="#transactions">&#31532;&nbsp;11&nbsp;&#31456; 
<I>&#20107;&#21153;&#21644;&#24182;&#21457;</I></A>&#20013;&#35752;&#35770;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-transitive></A>10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive 
persistence)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#27599;&#19968;&#20010;&#23545;&#35937;&#37117;&#35201;&#25191;&#34892;&#20445;&#23384;&#65292;&#21024;&#38500;&#25110;&#37325;&#20851;&#32852;&#25805;&#20316;&#35753;&#20154;&#24863;&#35273;&#26377;&#28857;&#40635;&#28902;&#65292;&#23588;&#20854;&#26159;&#22312;&#22788;&#29702;&#35768;&#22810;&#24444;&#27492;&#20851;&#32852;&#30340;&#23545;&#35937;&#30340;&#26102;&#20505;&#12290; &#19968;&#20010;&#24120;&#35265;&#30340;&#20363;&#23376;&#26159;&#29238;&#23376;&#20851;&#31995;&#12290;&#32771;&#34385;&#19979;&#38754;&#30340;&#20363;&#23376;: </P>
<P>&#22914;&#26524;&#19968;&#20010;&#29238;&#23376;&#20851;&#31995;&#20013;&#30340;&#23376;&#23545;&#35937;&#26159;&#20540;&#31867;&#22411;(value 
typed)&#65288;&#20363;&#22914;&#65292;&#22320;&#22336;&#25110;&#23383;&#31526;&#20018;&#30340;&#38598;&#21512;&#65289;&#30340;&#65292;&#20182;&#20204;&#30340;&#29983;&#21629;&#21608;&#26399;&#20250;&#20381;&#36182;&#20110;&#29238;&#23545;&#35937;&#65292;&#21487;&#20197;&#20139;&#21463;&#26041;&#20415;&#30340;&#32423;&#32852;&#25805;&#20316;(Cascading)&#65292;&#19981;&#38656;&#35201;&#39069;&#22806;&#30340;&#21160;&#20316;&#12290; 
&#29238;&#23545;&#35937;&#34987;&#20445;&#23384;&#26102;&#65292;&#36825;&#20123;&#20540;&#31867;&#22411;(value typed)&#23376;&#23545;&#35937;&#20063;&#23558;&#34987;&#20445;&#23384;&#65307;&#29238;&#23545;&#35937;&#34987;&#21024;&#38500;&#26102;&#65292;&#23376;&#23545;&#35937;&#20063;&#23558;&#34987;&#21024;&#38500;&#12290; 
&#36825;&#23545;&#23558;&#19968;&#20010;&#23376;&#23545;&#35937;&#20174;&#38598;&#21512;&#20013;&#31227;&#38500;&#26159;&#21516;&#26679;&#26377;&#25928;&#65306;Hibernate&#20250;&#26816;&#27979;&#21040;&#65292;&#24182;&#19988;&#22240;&#20026;&#20540;&#31867;&#22411;(value 
typed)&#30340;&#23545;&#35937;&#19981;&#21487;&#33021;&#34987;&#20854;&#20182;&#23545;&#35937;&#24341;&#29992;&#65292;&#25152;&#20197;Hibernate&#20250;&#22312;&#25968;&#25454;&#24211;&#20013;&#21024;&#38500;&#36825;&#20010;&#23376;&#23545;&#35937;&#12290; </P>
<P>&#29616;&#22312;&#32771;&#34385;&#21516;&#26679;&#30340;&#22330;&#26223;&#65292;&#19981;&#36807;&#29238;&#23376;&#23545;&#35937;&#37117;&#26159;&#23454;&#20307;(entities)&#31867;&#22411;&#65292;&#32780;&#38750;&#20540;&#31867;&#22411;(value typed)&#65288;&#20363;&#22914;&#65292;&#31867;&#21035;&#19982;&#20010;&#20307;&#65292;&#25110;&#27597;&#29483;&#21644;&#23567;&#29483;&#65289;&#12290; 
&#23454;&#20307;&#26377;&#33258;&#24049;&#30340;&#29983;&#21629;&#26399;&#65292;&#20801;&#35768;&#20849;&#20139;&#23545;&#20854;&#30340;&#24341;&#29992;&#65288;&#22240;&#27492;&#20174;&#38598;&#21512;&#20013;&#31227;&#38500;&#19968;&#20010;&#23454;&#20307;&#65292;&#19981;&#24847;&#21619;&#30528;&#23427;&#21487;&#20197;&#34987;&#21024;&#38500;&#65289;&#65292; &#24182;&#19988;&#23454;&#20307;&#21040;&#20854;&#20182;&#20851;&#32852;&#23454;&#20307;&#20043;&#38388;&#40664;&#35748;&#27809;&#26377;&#32423;&#32852;&#25805;&#20316;&#30340;&#35774;&#32622;&#12290; 
Hibernate&#40664;&#35748;&#19981;&#23454;&#29616;&#25152;&#35859;&#30340;<SPAN class=emphasis><EM>&#21487;&#21040;&#36798;&#21363;&#25345;&#20037;&#21270;&#65288;persistence by 
reachability&#65289;</EM></SPAN>&#30340;&#31574;&#30053;&#12290; </P>
<P>&#27599;&#20010;Hibernate session&#30340;&#22522;&#26412;&#25805;&#20316; - &#21253;&#25324; <TT class=literal>persist(), merge(), 
saveOrUpdate(), delete(), lock(), refresh(), evict(), replicate()</TT> - 
&#37117;&#26377;&#23545;&#24212;&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style)&#12290; &#36825;&#20123;&#32423;&#32852;&#39118;&#26684;(cascade style)&#39118;&#26684;&#20998;&#21035;&#21629;&#21517;&#20026; <TT class=literal>create, 
merge, save-update, delete, lock, refresh, evict, replicate</TT>&#12290; 
&#22914;&#26524;&#20320;&#24076;&#26395;&#19968;&#20010;&#25805;&#20316;&#34987;&#39034;&#30528;&#20851;&#32852;&#20851;&#31995;&#32423;&#32852;&#20256;&#25773;&#65292;&#20320;&#24517;&#39035;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#20986;&#36825;&#19968;&#28857;&#12290;&#20363;&#22914;&#65306; </P><PRE class=programlisting>&lt;one-to-one name="person" cascade="persist"/&gt;</PRE>
<P>&#32423;&#32852;&#39118;&#26684;(cascade style)&#26159;&#21487;&#32452;&#21512;&#30340;: </P><PRE class=programlisting>&lt;one-to-one name="person" cascade="persist,delete,lock"/&gt;</PRE>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>cascade="all"</TT>&#26469;&#25351;&#23450;<SPAN 
class=emphasis><EM>&#20840;&#37096;</EM></SPAN>&#25805;&#20316;&#37117;&#39034;&#30528;&#20851;&#32852;&#20851;&#31995;&#32423;&#32852;(cascaded)&#12290; &#40664;&#35748;&#20540;&#26159;<TT 
class=literal>cascade="none"</TT>&#65292;&#21363;&#20219;&#20309;&#25805;&#20316;&#37117;&#19981;&#20250;&#34987;&#32423;&#32852;(cascaded)&#12290; </P>
<P>&#27880;&#24847;&#26377;&#19968;&#20010;&#29305;&#27530;&#30340;&#32423;&#32852;&#39118;&#26684;(cascade style) <TT 
class=literal>delete-orphan</TT>&#65292;&#21482;&#24212;&#29992;&#20110;one-to-many&#20851;&#32852;&#65292;&#34920;&#26126;<TT 
class=literal>delete()</TT>&#25805;&#20316; &#24212;&#35813;&#34987;&#24212;&#29992;&#20110;&#25152;&#26377;&#20174;&#20851;&#32852;&#20013;&#21024;&#38500;&#30340;&#23545;&#35937;&#12290; </P>
<P>&#24314;&#35758;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#36890;&#24120;&#22312;<TT class=literal>&lt;many-to-one&gt;</TT>&#25110;<TT 
  class=literal>&lt;many-to-many&gt;</TT>&#20851;&#31995;&#20013;&#24212;&#29992;&#32423;&#32852;(cascade)&#27809;&#20160;&#20040;&#24847;&#20041;&#12290; &#32423;&#32852;(cascade)&#36890;&#24120;&#22312; 
  <TT class=literal>&lt;one-to-one&gt;</TT>&#21644;<TT 
  class=literal>&lt;one-to-many&gt;</TT>&#20851;&#31995;&#20013;&#27604;&#36739;&#26377;&#29992;&#12290; </P>
  <LI>
  <P>&#22914;&#26524;&#23376;&#23545;&#35937;&#30340;&#23551;&#21629;&#38480;&#23450;&#22312;&#29238;&#20146;&#23545;&#35937;&#30340;&#23551;&#21629;&#20043;&#20869;&#65292;&#21487;&#36890;&#36807;&#25351;&#23450;<TT 
  class=literal>cascade="all,delete-orphan"</TT>&#23558;&#20854;&#21464;&#20026;<SPAN 
  class=emphasis><EM>&#33258;&#21160;&#29983;&#21629;&#21608;&#26399;&#31649;&#29702;&#30340;&#23545;&#35937;(lifecycle object)</EM></SPAN>&#12290; </P>
  <LI>
  <P>&#20854;&#20182;&#24773;&#20917;&#65292;&#20320;&#21487;&#26681;&#26412;&#19981;&#38656;&#35201;&#32423;&#32852;(cascade)&#12290;&#20294;&#26159;&#22914;&#26524;&#20320;&#35748;&#20026;&#20320;&#20250;&#32463;&#24120;&#22312;&#26576;&#20010;&#20107;&#21153;&#20013;&#21516;&#26102;&#29992;&#21040;&#29238;&#23545;&#35937;&#19982;&#23376;&#23545;&#35937;&#65292;&#24182;&#19988;&#20320;&#24076;&#26395;&#23569;&#25171;&#28857;&#20799;&#23383;&#65292;&#21487;&#20197;&#32771;&#34385;&#20351;&#29992;<TT 
  class=literal>cascade="persist,merge,save-update"</TT>&#12290; </P></LI></UL></DIV>
<P>&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>cascade="all"</TT>&#23558;&#19968;&#20010;&#20851;&#32852;&#20851;&#31995;&#65288;&#26080;&#35770;&#26159;&#23545;&#20540;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#25110;&#32773;&#23545;&#19968;&#20010;&#38598;&#21512;&#30340;&#20851;&#32852;&#65289;&#26631;&#35760;&#20026;<SPAN 
class=emphasis><EM>&#29238;/&#23376;</EM></SPAN>&#20851;&#31995;&#30340;&#20851;&#32852;&#12290; 
&#36825;&#26679;&#23545;&#29238;&#23545;&#35937;&#36827;&#34892;save/update/delete&#25805;&#20316;&#23601;&#20250;&#23548;&#33268;&#23376;&#23545;&#35937;&#20063;&#36827;&#34892;save/update/delete&#25805;&#20316;&#12290; </P>
<P>&#27492;&#22806;&#65292;&#19968;&#20010;&#25345;&#20037;&#30340;&#29238;&#23545;&#35937;&#23545;&#23376;&#23545;&#35937;&#30340;&#27973;&#24341;&#29992;(mere reference)&#20250;&#23548;&#33268;&#23376;&#23545;&#35937;&#34987;&#21516;&#27493;save/update&#12290; 
&#19981;&#36807;&#65292;&#36825;&#20010;&#38544;&#21947;(metaphor)&#30340;&#35828;&#27861;&#24182;&#19981;&#23436;&#25972;&#12290;&#38500;&#38750;&#20851;&#32852;&#26159;<TT 
class=literal>&lt;one-to-many&gt;</TT>&#20851;&#32852;&#24182;&#19988;&#34987;&#26631;&#35760;&#20026;<TT 
class=literal>cascade="delete-orphan"</TT>&#65292; &#21542;&#21017;&#29238;&#23545;&#35937;&#22833;&#21435;&#23545;&#26576;&#20010;&#23376;&#23545;&#35937;&#30340;&#24341;&#29992;<SPAN 
class=emphasis><EM>&#19981;&#20250;</EM></SPAN>&#23548;&#33268;&#35813;&#23376;&#23545;&#35937;&#34987;&#33258;&#21160;&#21024;&#38500;&#12290; &#29238;&#23376;&#20851;&#31995;&#30340;&#32423;&#32852;(cascading)&#25805;&#20316;&#20934;&#30830;&#35821;&#20041;&#22914;&#19979;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<TT class=literal>persist()</TT>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<TT 
  class=literal>persist()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<TT class=literal>merge()</TT>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<TT 
  class=literal>merge()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#29238;&#23545;&#35937;&#34987;<TT class=literal>save()</TT>&#65292;<TT class=literal>update()</TT>&#25110; <TT 
  class=literal>saveOrUpdate()</TT>&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#21017;&#20250;&#34987;<TT 
  class=literal>saveOrUpdate()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#26576;&#20010;&#25345;&#20037;&#30340;&#29238;&#23545;&#35937;&#24341;&#29992;&#20102;&#30636;&#26102;(transient)&#25110;&#32773;&#33073;&#31649;(detached)&#30340;&#23376;&#23545;&#35937;&#65292;&#37027;&#20040;&#23376;&#23545;&#35937;&#23558;&#20250;&#34987;<TT 
  class=literal>saveOrUpdate()</TT> </P>
  <LI>
  <P>&#22914;&#26524;&#29238;&#23545;&#35937;&#34987;&#21024;&#38500;&#65292;&#37027;&#20040;&#25152;&#26377;&#23376;&#23545;&#35937;&#20063;&#20250;&#34987;<TT class=literal>delete()</TT> </P>
  <LI>
  <P>&#38500;&#38750;&#34987;&#26631;&#35760;&#20026;<TT 
  class=literal>cascade="delete-orphan"</TT>&#65288;&#21024;&#38500;“&#23396;&#20799;”&#27169;&#24335;&#65292;&#27492;&#26102;&#19981;&#34987;&#20219;&#20309;&#19968;&#20010;&#29238;&#23545;&#35937;&#24341;&#29992;&#30340;&#23376;&#23545;&#35937;&#20250;&#34987;&#21024;&#38500;&#65289;&#65292; 
  &#21542;&#21017;&#23376;&#23545;&#35937;&#22833;&#25481;&#29238;&#23545;&#35937;&#23545;&#20854;&#30340;&#24341;&#29992;&#26102;&#65292;<SPAN class=emphasis><EM>&#20160;&#20040;&#20107;&#20063;&#19981;&#20250;&#21457;&#29983;</EM></SPAN>&#12290; 
  &#22914;&#26524;&#26377;&#29305;&#27530;&#38656;&#35201;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#36890;&#36807;&#26174;&#24335;&#35843;&#29992;delete()&#21024;&#38500;&#23376;&#23545;&#35937;&#12290; </P></LI></UL></DIV>
<P>&#26368;&#21518;&#65292;&#27880;&#24847;&#25805;&#20316;&#30340;&#32423;&#32852;&#21487;&#33021;&#26159;&#22312;<SPAN class=emphasis><EM>&#35843;&#29992;&#26399;(call time)</EM></SPAN>&#25110;&#32773;<SPAN 
class=emphasis><EM>&#20889;&#20837;&#26399;(flush 
time)</EM></SPAN>&#20316;&#29992;&#21040;&#23545;&#35937;&#22270;&#19978;&#30340;&#12290;&#25152;&#26377;&#30340;&#25805;&#20316;&#65292;&#22914;&#26524;&#20801;&#35768;&#65292;&#37117;&#22312;&#25805;&#20316;&#34987;&#25191;&#34892;&#30340;&#26102;&#20505;&#32423;&#32852;&#21040;&#21487;&#35302;&#21450;&#30340;&#20851;&#32852;&#23454;&#20307;&#19978;&#12290;&#28982;&#32780;&#65292;<TT 
class=literal>save-upate</TT>&#21644;<TT class=literal>delete-orphan</TT>&#26159;&#22312;<TT 
class=literal>Session</TT> flush&#30340;&#26102;&#20505;&#25165;&#20316;&#29992;&#21040;&#25152;&#26377;&#21487;&#35302;&#21450;&#30340;&#34987;&#20851;&#32852;&#23545;&#35937;&#19978;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-metadata></A>10.12.&nbsp;&#20351;&#29992;&#20803;&#25968;&#25454;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20013;&#26377;&#19968;&#20010;&#38750;&#24120;&#20016;&#23500;&#30340;&#20803;&#32423;&#21035;(meta-level)&#30340;&#27169;&#22411;&#65292;&#21547;&#26377;&#25152;&#26377;&#30340;&#23454;&#20307;&#21644;&#20540;&#31867;&#22411;&#25968;&#25454;&#30340;&#20803;&#25968;&#25454;&#12290; &#26377;&#26102;&#36825;&#20010;&#27169;&#22411;&#23545;&#24212;&#29992;&#31243;&#24207;&#26412;&#36523;&#20063;&#20250;&#38750;&#24120;&#26377;&#29992;&#12290; 
&#27604;&#22914;&#35828;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#22312;&#23454;&#29616;&#19968;&#31181;“&#26234;&#33021;”&#30340;&#28145;&#24230;&#25335;&#36125;&#31639;&#27861;&#26102;&#65292; &#36890;&#36807;&#20351;&#29992;Hibernate&#30340;&#20803;&#25968;&#25454;&#26469;&#20102;&#35299;&#21738;&#20123;&#23545;&#35937;&#24212;&#35813;&#34987;&#25335;&#36125;&#65288;&#27604;&#22914;&#65292;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#25968;&#25454;&#65289;&#65292; 
&#37027;&#20123;&#19981;&#24212;&#35813;&#65288;&#19981;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#25968;&#25454;&#65292;&#20063;&#35768;&#36824;&#26377;&#26576;&#20123;&#34987;&#20851;&#32852;&#30340;&#23454;&#20307;&#65289;&#12290; </P>
<P>Hibernate&#25552;&#20379;&#20102;<TT class=literal>ClassMetadata</TT>&#25509;&#21475;&#65292;<TT 
class=literal>CollectionMetadata</TT>&#25509;&#21475;&#21644;<TT class=literal>Type</TT>&#23618;&#27425;&#20307;&#31995;&#26469;&#35775;&#38382;&#20803;&#25968;&#25454;&#12290; 
&#21487;&#20197;&#36890;&#36807;<TT class=literal>SessionFactory</TT>&#33719;&#21462;&#20803;&#25968;&#25454;&#25509;&#21475;&#30340;&#23454;&#20363;&#12290; </P><PRE class=programlisting>Cat fritz = ......;
ClassMetadata catMeta = sessionfactory.getClassMetadata(Cat.class);

Object[] propertyValues = catMeta.getPropertyValues(fritz);
String[] propertyNames = catMeta.getPropertyNames();
Type[] propertyTypes = catMeta.getPropertyTypes();

// get a Map of all properties which are not collections or associations
Map namedValues = new HashMap();
for ( int i=0; i&lt;propertyNames.length; i++ ) {
    if ( !propertyTypes[i].isEntityType() &amp;&amp; !propertyTypes[i].isCollectionType() ) {
        namedValues.put( propertyNames[i], propertyValues[i] );
    }
}</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=transactions></A>&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#30340;&#20107;&#21153;&#21644;&#24182;&#21457;&#25511;&#21046;&#24456;&#23481;&#26131;&#25484;&#25569;&#12290;Hibernate&#30452;&#25509;&#20351;&#29992;JDBC&#36830;&#25509;&#21644;JTA&#36164;&#28304;&#65292;&#19981;&#28155;&#21152;&#20219;&#20309;&#38468;&#21152;&#38145;&#23450; 
&#34892;&#20026;&#12290;&#25105;&#20204;&#24378;&#28872;&#25512;&#33616;&#20320;&#33457;&#28857;&#26102;&#38388;&#20102;&#35299;JDBC&#32534;&#31243;&#65292;ANSI SQL&#26597;&#35810;&#35821;&#35328;&#21644;&#20320;&#20351;&#29992; &#30340;&#25968;&#25454;&#24211;&#31995;&#32479;&#30340;&#20107;&#21153;&#38548;&#31163;&#35268;&#33539;&#12290; </P>
<P>Hibernate&#19981;&#38145;&#23450;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#12290;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20250;&#25353;&#29031;&#20320;&#30340;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#38548;&#31163;&#32423;&#21035;&#35268;&#23450;&#30340;&#37027;&#26679;&#36816;&#20316;&#12290;&#24184;&#20111;&#26377;&#20102;<TT 
class=literal>Session</TT>&#65292;&#20351;&#24471;Hibernate&#36890;&#36807;&#26631;&#35782;&#31526;&#26597;&#25214;&#65292;&#21644;&#23454;&#20307;&#26597;&#35810;&#65288;&#19981;&#26159;&#36820;&#22238;&#26631;&#37327;&#20540;&#30340;&#25253;&#34920;&#26597;&#35810;&#65289;&#25552;&#20379;&#20102;&#21487;&#37325;&#22797;&#30340;&#35835;&#21462;&#65288;Repeatable 
reads&#65289;&#21151;&#33021;&#65292;<TT class=literal>Session</TT>&#21516;&#26102;&#20063;&#26159;&#20107;&#21153;&#33539;&#22260;&#20869;&#30340;&#32531;&#23384;&#65288;cache&#65289;&#12290; </P>
<P>&#38500;&#20102;&#23545;&#33258;&#21160;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#25552;&#20379;&#29256;&#26412;&#31649;&#29702;&#65292;&#38024;&#23545;&#34892;&#32423;&#24754;&#35266;&#38145;&#23450;&#65292;Hibernate&#20063;&#25552;&#20379;&#20102;&#36741;&#21161;&#30340;&#65288;&#36739;&#23567;&#30340;)API&#65292;&#23427;&#20351;&#29992;&#20102; <TT 
class=literal>SELECT FOR UPDATE</TT>&#30340;SQL&#35821;&#27861;&#12290;&#26412;&#31456;&#21518;&#38754;&#20250;&#35752;&#35770;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#21644;&#36825;&#20010;API&#12290; </P>
<P>&#25105;&#20204;&#20174;<TT class=literal>Configuration</TT>&#23618;&#12289;<TT 
class=literal>SessionFactory</TT>&#23618;, &#21644; <TT 
class=literal>Session</TT>&#23618;&#24320;&#22987;&#35752;&#35770;Hibernate&#30340;&#24182;&#34892;&#25511;&#21046;&#12289;&#25968;&#25454;&#24211;&#20107;&#21153;&#21644;&#24212;&#29992; &#31243;&#24207;&#30340;&#38271;&#20107;&#21153;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=transactions-basics></A>11.1.&nbsp;Session&#21644;&#20107;&#21153;&#33539;&#22260;(transaction 
scope)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT 
class=literal>SessionFactory</TT>&#23545;&#35937;&#30340;&#21019;&#24314;&#20195;&#20215;&#24456;&#26114;&#36149;&#65292;&#23427;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#23545;&#35937;&#65292;&#23427;&#20026;&#25152;&#26377;&#30340;&#24212;&#29992;&#31243;&#24207;&#32447;&#31243;&#25152;&#20849;&#20139;&#12290;&#23427;&#21482;&#21019;&#24314;&#19968;&#27425;&#65292;&#36890;&#24120;&#26159;&#22312;&#24212;&#29992;&#31243;&#24207;&#21551;&#21160;&#30340;&#26102;&#20505;&#65292;&#30001;&#19968;&#20010;<TT 
class=literal>Configuraion</TT>&#30340;&#23454;&#20363;&#26469;&#21019;&#24314;&#12290; </P>
<P><TT class=literal>Session</TT>&#23545;&#35937;&#30340;&#21019;&#24314;&#20195;&#20215;&#27604;&#36739;&#23567;&#65292;&#26159;&#38750;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#23545;&#20110;&#21333;&#20010;&#35831;&#27714;&#65292;&#21333;&#20010;&#20250;&#35805;&#12289;&#21333;&#20010;&#30340; 
&#24037;&#20316;&#21333;&#20803;&#32780;&#35328;&#65292;&#23427;&#21482;&#34987;&#20351;&#29992;&#19968;&#27425;&#65292;&#28982;&#21518;&#23601;&#20002;&#24323;&#12290;&#21482;&#26377;&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#65292;&#19968;&#20010;<TT class=literal>Session</TT>&#23545;&#35937; &#25165;&#20250;&#33719;&#21462;&#19968;&#20010;JDBC&#30340;<TT 
class=literal>Connection</TT>&#65288;&#25110;&#19968;&#20010;<TT class=literal>Datasource</TT>&#65289; 
&#23545;&#35937;&#65292;&#22240;&#27492;&#20551;&#33509;&#19981;&#20351;&#29992;&#30340;&#26102;&#20505;&#23427;&#19981;&#28040;&#36153;&#20219;&#20309;&#36164;&#28304;&#12290; </P>
<P>&#27492;&#22806;&#25105;&#20204;&#36824;&#35201;&#32771;&#34385;&#25968;&#25454;&#24211;&#20107;&#21153;&#12290;&#25968;&#25454;&#24211;&#20107;&#21153;&#24212;&#35813;&#23613;&#21487;&#33021;&#30340;&#30701;&#65292;&#38477;&#20302;&#25968;&#25454;&#24211;&#20013;&#30340;&#38145;&#20105;&#29992;&#12290; 
&#25968;&#25454;&#24211;&#38271;&#20107;&#21153;&#20250;&#38459;&#27490;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#25193;&#23637;&#21040;&#39640;&#30340;&#24182;&#21457;&#36127;&#36733;&#12290;&#22240;&#27492;&#65292;&#20551;&#33509;&#22312;&#29992;&#25143;&#24605;&#32771;&#26399;&#38388;&#35753;&#25968;&#25454;&#24211;&#20107;&#21153;&#24320;&#30528;&#65292;&#30452;&#21040;&#25972;&#20010;&#24037;&#20316;&#21333;&#20803;&#23436;&#25104;&#25165;&#20851;&#38381;&#36825;&#20010;&#20107;&#21153;&#65292;&#36825;&#32477;&#19981;&#26159;&#19968;&#20010;&#22909;&#30340;&#35774;&#35745;&#12290; </P>
<P>&#19968;&#20010;&#25805;&#20316;&#21333;&#20803;(Unit of work)&#30340;&#33539;&#22260;&#26159;&#22810;&#22823;&#65311;&#21333;&#20010;&#30340;Hibernate <TT class=literal>Session</TT>&#33021;&#36328;&#36234;&#22810;&#20010; 
&#25968;&#25454;&#24211;&#20107;&#21153;&#21527;&#65311;&#36824;&#26159;&#19968;&#20010;<TT class=literal>Session</TT>&#30340;&#20316;&#29992;&#33539;&#22260;&#23545;&#24212;&#19968;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#33539;&#22260;&#65311;&#24212;&#35813;&#20309;&#26102;&#25171;&#24320; <TT 
class=literal>Session</TT>&#65292;&#20309;&#26102;&#20851;&#38381;<TT class=literal>Session</TT>&#65311;&#65292;&#20320;&#21448;&#22914;&#20309;&#21010;&#20998;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#36793;&#30028;&#21602;&#65311; 
</P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=transactions-basics-uow></A>11.1.1.&nbsp;&#25805;&#20316;&#21333;&#20803;(Unit of 
work)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#39318;&#20808;&#65292;&#21035;&#29992;<SPAN 
class=emphasis><EM>session-per-operation</EM></SPAN>&#36825;&#31181;&#21453;&#27169;&#24335;&#20102;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#22312;&#21333;&#20010;&#32447;&#31243;&#20013;&#65292; 
&#19981;&#35201;&#22240;&#20026;&#19968;&#27425;&#31616;&#21333;&#30340;&#25968;&#25454;&#24211;&#35843;&#29992;&#65292;&#23601;&#25171;&#24320;&#21644;&#20851;&#38381;&#19968;&#27425;<TT class=literal>Session</TT>&#65281;&#25968;&#25454;&#24211;&#20107;&#21153;&#20063;&#26159;&#22914;&#27492;&#12290; 
&#24212;&#29992;&#31243;&#24207;&#20013;&#30340;&#25968;&#25454;&#24211;&#35843;&#29992;&#26159;&#25353;&#29031;&#35745;&#21010;&#22909;&#30340;&#27425;&#24207;&#65292;&#20998;&#32452;&#20026;&#21407;&#23376;&#30340;&#25805;&#20316;&#21333;&#20803;&#12290;&#65288;&#27880;&#24847;&#65292;&#36825;&#20063;&#24847;&#21619;&#30528;&#65292;&#24212;&#29992;&#31243; 
&#24207;&#20013;&#65292;&#22312;&#21333;&#20010;&#30340;SQL&#35821;&#21477;&#21457;&#36865;&#20043;&#21518;&#65292;&#33258;&#21160;&#20107;&#21153;&#25552;&#20132;(auto-commit)&#27169;&#24335;&#22833;&#25928;&#20102;&#12290;&#36825;&#31181;&#27169;&#24335;&#19987;&#38376;&#20026;SQL&#25511;&#21046;&#21488;&#25805;&#20316;&#35774;&#35745;&#30340;&#12290; 
Hibernate&#31105;&#27490;&#31435;&#21363;&#33258;&#21160;&#20107;&#21153;&#25552;&#20132;&#27169;&#24335;&#65292;&#25110;&#32773;&#26399;&#26395;&#24212;&#29992;&#26381;&#21153;&#22120;&#31105;&#27490;&#31435;&#21363;&#33258;&#21160;&#20107;&#21153;&#25552;&#20132;&#27169;&#24335;&#12290;&#65289;&#25968;&#25454;&#24211;&#20107;&#21153;&#32477;&#19981;&#26159;&#21487;&#26377;&#21487;&#26080;&#30340;&#65292;&#20219;&#20309;&#19982;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340;&#36890;&#35759;&#37117;&#24517;&#39035;&#22312;&#26576;&#20010;&#20107;&#21153;&#20013;&#36827;&#34892;&#65292;&#19981;&#31649;&#20320;&#26159;&#22312;&#35835;&#36824;&#26159;&#22312;&#20889;&#25968;&#25454;&#12290;&#23545;&#35835;&#25968;&#25454;&#32780;&#35328;&#65292;&#24212;&#35813;&#36991;&#20813;auto-commit&#34892;&#20026;&#65292;&#22240;&#20026;&#24456;&#22810;&#23567;&#30340;&#20107;&#21153;&#27604;&#19968;&#20010;&#28165;&#26224;&#23450;&#20041;&#30340;&#24037;&#20316;&#21333;&#20803;&#24615;&#33021;&#24046;&#12290;&#21518;&#32773;&#20063;&#26356;&#23481;&#26131;&#32500;&#25252;&#21644;&#25193;&#23637;&#12290; 
</P>
<P>&#22312;&#22810;&#29992;&#25143;&#30340;client/server&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#26368;&#24120;&#29992;&#30340;&#27169;&#24335;&#26159; <SPAN 
class=emphasis><EM>&#27599;&#20010;&#35831;&#27714;&#19968;&#20010;&#20250;&#35805;(session-per-request)</EM></SPAN>&#12290; 
&#22312;&#36825;&#31181;&#27169;&#24335;&#19979;&#65292;&#26469;&#33258;&#23458;&#25143;&#31471;&#30340;&#35831;&#27714;&#34987;&#21457;&#36865;&#21040;&#26381;&#21153;&#22120;&#31471;&#65288;&#21363;Hibernate&#25345;&#20037;&#21270;&#23618;&#36816;&#34892;&#30340;&#22320;&#26041;&#65289;&#65292;&#19968; &#20010;&#26032;&#30340;Hibernate <TT 
class=literal>Session</TT>&#34987;&#25171;&#24320;&#65292;&#24182;&#19988;&#25191;&#34892;&#36825;&#20010;&#25805;&#20316;&#21333;&#20803;&#20013;&#25152;&#26377;&#30340;&#25968;&#25454;&#24211;&#25805;&#20316;&#12290; 
&#19968;&#26086;&#25805;&#20316;&#23436;&#25104;&#65288;&#21516;&#26102;&#23545;&#23458;&#25143;&#31471;&#30340;&#21709;&#24212;&#20063;&#20934;&#22791;&#23601;&#32490;&#65289;&#65292;session&#34987;&#21516;&#27493;&#65292;&#28982;&#21518;&#20851;&#38381;&#12290;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#21333; &#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#26469;&#22788;&#29702;&#23458;&#25143;&#31471;&#35831;&#27714;&#65292;&#22312;&#20320;&#25171;&#24320;<TT 
class=literal>Session</TT>&#20043;&#21518;&#21551;&#21160;&#20107;&#21153;&#65292;&#22312;&#20320;&#20851;&#38381; <TT 
class=literal>Session</TT>&#20043;&#21069;&#25552;&#20132;&#20107;&#21153;&#12290;&#20250;&#35805;&#21644;&#35831;&#27714;&#20043;&#38388;&#30340;&#20851;&#31995;&#26159;&#19968;&#23545;&#19968;&#30340;&#20851;&#31995;&#65292;&#36825;&#31181;&#27169;&#24335;&#23545; &#20110;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#26469;&#35828;&#26159;&#24456;&#26834;&#30340;&#12290; </P>
<P>&#23454;&#29616;&#25165;&#26159;&#30495;&#27491;&#30340;&#25361;&#25112;&#12290;Hibernate&#20869;&#32622;&#20102;&#23545;"&#24403;&#21069;session(current session)" 
&#30340;&#31649;&#29702;&#65292;&#29992;&#20110;&#31616;&#21270;&#27492;&#27169;&#24335;&#12290;&#20320;&#35201;&#20570;&#30340;&#19968;&#20999;&#23601;&#26159;&#22312;&#26381;&#21153;&#22120;&#31471;&#35201;&#22788;&#29702;&#35831;&#27714;&#30340;&#26102;&#20505;&#65292;&#24320;&#21551;&#20107;&#21153;&#65292;&#22312;&#21709;&#24212;&#21457;&#36865;&#32473;&#23458;&#25143;&#20043;&#21069;&#32467;&#26463;&#20107;&#21153;&#12290;&#20320;&#21487;&#20197;&#29992;&#20219;&#20309;&#26041;&#24335;&#26469;&#23436;&#25104;&#36825;&#19968;&#25805;&#20316;&#65292;&#36890;&#24120;&#30340;&#26041;&#26696;&#26377;<TT 
class=literal>ServletFilter</TT>&#65292;&#22312;service&#26041;&#27861;&#20013;&#36827;&#34892;pointcut&#30340;AOP&#25318;&#25130;&#22120;&#65292;&#25110;&#32773;proxy/interception&#23481;&#22120;&#12290;EJB&#23481;&#22120;&#26159;&#23454;&#29616;&#27178;&#20999;&#35832;&#22914;EJB 
session bean&#19978;&#30340;&#20107;&#21153;&#20998;&#30028;&#65292;&#29992;CMT&#23545;&#20107;&#21153;&#36827;&#34892;&#22768;&#26126;&#31561;&#26041;&#38754;&#30340;&#26631;&#20934;&#25163;&#27573;&#12290;&#20551;&#33509;&#20320;&#20915;&#23450;&#20351;&#29992;&#32534;&#31243;&#24335;&#30340;&#20107;&#21153;&#20998;&#30028;&#65292;&#35831;&#21442;&#32771;&#26412;&#31456;&#21518;&#38754;&#35762;&#21040;&#30340;Hibernate <TT 
class=literal>Transaction</TT> API&#65292;&#36825;&#23545;&#26131;&#29992;&#24615;&#21644;&#20195;&#30721;&#21487;&#31227;&#26893;&#24615;&#37117;&#26377;&#22909;&#22788;&#12290; </P>
<P>&#22312;&#20219;&#20309;&#26102;&#38388;&#65292;&#20219;&#20309;&#22320;&#26041;&#65292;&#20320;&#30340;&#24212;&#29992;&#20195;&#30721;&#21487;&#20197;&#36890;&#36807;&#31616;&#21333;&#30340;&#35843;&#29992;<TT 
class=literal>sessionFactory.getCurrentSession()</TT>&#26469;&#35775;&#38382;"&#24403;&#21069;session"&#65292;&#29992;&#20110;&#22788;&#29702;&#35831;&#27714;&#12290;&#20320;&#24635;&#26159;&#20250;&#24471;&#21040;&#24403;&#21069;&#25968;&#25454;&#24211;&#20107;&#21153;&#33539;&#22260;&#20869;&#30340;<TT 
class=literal>Session</TT>&#12290;&#22312;&#20351;&#29992;&#26412;&#22320;&#36164;&#28304;&#25110;JTA&#29615;&#22659;&#26102;&#65292;&#24517;&#39035;&#37197;&#32622;&#23427;&#65292;&#35831;&#21442;&#35265;<A 
title=2.5.&nbsp;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session 
href="#architecture-current-session">&#31532;&nbsp;2.5&nbsp;&#33410; 
“&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#65288;Contextual&#65289;Session”</A>&#12290; </P>
<P>&#26377;&#26102;&#65292;&#23558;<TT 
class=literal>Session</TT>&#21644;&#25968;&#25454;&#24211;&#20107;&#21153;&#30340;&#36793;&#30028;&#24310;&#20280;&#21040;"&#23637;&#31034;&#23618;&#34987;&#28210;&#26579;&#21518;"&#20250;&#24102;&#26469;&#20415;&#21033;&#12290;&#26377;&#20123;serlvet&#24212;&#29992;&#31243;&#24207;&#22312;&#23545;&#35831;&#27714;&#36827;&#34892;&#22788;&#29702;&#21518;&#65292;&#26377;&#20010;&#21333;&#29420;&#30340;&#28210;&#26579;&#26399;&#65292;&#36825;&#31181;&#24310;&#20280;&#23545;&#36825;&#31181;&#31243;&#24207;&#29305;&#21035;&#26377;&#29992;&#12290;&#20551;&#33509;&#20320;&#23454;&#29616;&#20320;&#33258;&#24049;&#30340;&#25318;&#25130;&#22120;&#65292;&#25226;&#20107;&#21153;&#36793;&#30028;&#24310;&#20280;&#21040;&#23637;&#31034;&#23618;&#28210;&#26579;&#32467;&#26463;&#21518;&#38750;&#24120;&#23481;&#26131;&#12290;&#28982;&#32780;&#65292;&#20551;&#33509;&#20320;&#20381;&#36182;&#26377;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;&#30340;EJB&#65292;&#36825;&#23601;&#19981;&#22826;&#23481;&#26131;&#20102;&#65292;&#22240;&#20026;&#20107;&#21153;&#20250;&#22312;EJB&#26041;&#27861;&#36820;&#22238;&#21518;&#32467;&#26463;&#65292;&#32780;&#37027;&#26159;&#22312;&#20219;&#20309;&#23637;&#31034;&#23618;&#28210;&#26579;&#24320;&#22987;&#20043;&#21069;&#12290;&#35831;&#35775;&#38382;Hibernate&#32593;&#31449;&#21644;&#35770;&#22363;&#65292;&#20320;&#21487;&#20197;&#25214;&#21040;<SPAN 
class=emphasis><EM>Open Session in View</EM></SPAN>&#36825;&#19968;&#27169;&#24335;&#30340;&#25552;&#31034;&#21644;&#31034;&#20363;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-basics-apptx></A>11.1.2.&nbsp;&#38271;&#23545;&#35805;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>session-per-request&#27169;&#24335;&#19981;&#20165;&#20165;&#26159;&#19968;&#20010;&#21487;&#20197;&#29992;&#26469;&#35774;&#35745;&#25805;&#20316;&#21333;&#20803;&#30340;&#26377;&#29992;&#27010;&#24565;&#12290;&#24456;&#22810;&#19994;&#21153;&#22788;&#29702;&#37117;&#38656; 
&#35201;&#19968;&#31995;&#21015;&#23436;&#25972;&#30340;&#19982;&#29992;&#25143;&#20043;&#38388;&#30340;&#20132;&#20114;&#65292;&#32780;&#36825;&#20123;&#29992;&#25143;&#26159;&#25351;&#23545;&#25968;&#25454;&#24211;&#26377;&#20132;&#21449;&#35775;&#38382;&#30340;&#29992;&#25143;&#12290;&#22312;&#22522;&#20110;web&#30340;&#24212;&#29992;&#21644;&#20225;&#19994; &#24212;&#29992;&#20013;&#65292;&#36328;&#29992;&#25143;&#20132;&#20114;&#30340;&#25968;&#25454;&#24211;&#20107;&#21153;&#26159;&#26080;&#27861;&#25509;&#21463;&#30340;&#12290;&#32771;&#34385;&#19979;&#38754;&#30340;&#20363;&#23376;&#65306; 
</P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#22312;&#30028;&#38754;&#30340;&#31532;&#19968;&#23631;&#65292;&#25171;&#24320;&#23545;&#35805;&#26694;&#65292;&#29992;&#25143;&#25152;&#30475;&#21040;&#30340;&#25968;&#25454;&#26159;&#34987;&#19968;&#20010;&#29305;&#23450;&#30340; <TT class=literal>Session</TT> &#21644;&#25968;&#25454; 
  &#24211;&#20107;&#21153;&#36733;&#20837;(load)&#30340;&#12290;&#29992;&#25143;&#21487;&#20197;&#38543;&#24847;&#20462;&#25913;&#23545;&#35805;&#26694;&#20013;&#30340;&#25968;&#25454;&#23545;&#35937;&#12290; </P>
  <LI>
  <P>5&#20998;&#38047;&#21518;&#65292;&#29992;&#25143;&#28857;&#20987;“&#20445;&#23384;”&#65292;&#26399;&#26395;&#25152;&#20570;&#20986;&#30340;&#20462;&#25913;&#34987;&#25345;&#20037;&#21270;&#65307;&#21516;&#26102;&#20182;&#20063;&#26399;&#26395;&#33258;&#24049;&#26159;&#21807;&#19968;&#20462;&#25913;&#36825;&#20010;&#20449;&#24687;&#30340;&#20154;&#65292;&#19981;&#20250;&#20986;&#29616; &#20462;&#25913;&#20914;&#31361;&#12290; 
</P></LI></UL></DIV>
<P>&#20174;&#29992;&#25143;&#30340;&#35282;&#24230;&#26469;&#30475;&#65292;&#25105;&#20204;&#25226;&#36825;&#20010;&#25805;&#20316;&#21333;&#20803;&#31216;&#20026;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;<SPAN 
class=emphasis><EM>&#23545;&#35805;</EM></SPAN>&#65288;conversation&#65289;,&#25110;&#32773;(or <SPAN 
class=emphasis><EM>&#24212;&#29992;&#20107;&#21153;</EM></SPAN>,application transaction)&#12290; 
&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#21487;&#20197;&#26377;&#24456;&#22810;&#31181;&#26041;&#27861;&#26469;&#23454;&#29616;&#23427;&#12290; </P>
<P>&#22836;&#19968;&#20010;&#24188;&#31258;&#30340;&#20570;&#27861;&#26159;&#65292;&#22312;&#29992;&#25143;&#24605;&#32771;&#30340;&#36807;&#31243;&#20013;&#65292;&#20445;&#25345;<TT class=literal>Session</TT>&#21644;&#25968;&#25454;&#24211;&#20107;&#21153;&#26159;&#25171;&#24320;&#30340;&#65292; 
&#20445;&#25345;&#25968;&#25454;&#24211;&#38145;&#23450;&#65292;&#20197;&#38459;&#27490;&#24182;&#21457;&#20462;&#25913;&#65292;&#20174;&#32780;&#20445;&#35777;&#25968;&#25454;&#24211;&#20107;&#21153;&#38548;&#31163;&#32423;&#21035;&#21644;&#21407;&#23376;&#25805;&#20316;&#12290;&#36825;&#31181;&#26041;&#24335;&#24403;&#28982;&#26159;&#19968;&#20010;&#21453;&#27169;&#24335;&#65292; &#22240;&#20026;&#38145;&#20105;&#29992;&#20250;&#23548;&#33268;&#24212;&#29992;&#31243;&#24207;&#26080;&#27861;&#25193;&#23637;&#24182;&#21457;&#29992;&#25143;&#30340;&#25968;&#30446;&#12290; </P>
<P>&#24456;&#26126;&#26174;&#65292;&#25105;&#20204;&#24517;&#39035;&#20351;&#29992;&#22810;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#26469;&#23454;&#29616;&#36825;&#20010;&#23545;&#35805;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#32500;&#25252;&#19994;&#21153;&#22788;&#29702;&#30340; 
&#20107;&#21153;&#38548;&#31163;&#21464;&#25104;&#20102;&#24212;&#29992;&#31243;&#24207;&#23618;&#30340;&#37096;&#20998;&#36131;&#20219;&#12290;&#19968;&#20010;&#23545;&#35805;&#36890;&#24120;&#36328;&#36234;&#22810;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#12290;&#22914;&#26524;&#20165;&#20165;&#21482;&#26377;&#19968; 
&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#65288;&#26368;&#21518;&#30340;&#37027;&#20010;&#20107;&#21153;&#65289;&#20445;&#23384;&#26356;&#26032;&#36807;&#30340;&#25968;&#25454;&#65292;&#32780;&#25152;&#26377;&#20854;&#20182;&#20107;&#21153;&#21482;&#26159;&#21333;&#32431;&#30340;&#35835;&#21462;&#25968;&#25454;&#65288;&#20363;&#22914;&#22312;&#19968; 
&#20010;&#36328;&#36234;&#22810;&#20010;&#35831;&#27714;/&#21709;&#24212;&#21608;&#26399;&#30340;&#21521;&#23548;&#39118;&#26684;&#30340;&#23545;&#35805;&#26694;&#20013;&#65289;&#65292;&#37027;&#20040;&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;&#23558;&#20445;&#35777;&#20854;&#21407;&#23376;&#24615;&#12290;&#36825;&#31181;&#26041;&#24335;&#27604;&#21548; 
&#36215;&#26469;&#36824;&#35201;&#23481;&#26131;&#23454;&#29616;&#65292;&#29305;&#21035;&#26159;&#24403;&#20320;&#20351;&#29992;&#20102;Hibernate&#30340;&#19979;&#36848;&#29305;&#24615;&#30340;&#26102;&#20505;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>&#33258;&#21160;&#29256;&#26412;&#21270;</EM></SPAN> - Hibernate&#33021;&#22815;&#33258;&#21160;&#36827;&#34892;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046; &#65292;&#22914;&#26524;&#22312;&#29992;&#25143;&#24605;&#32771; 
  &#30340;&#36807;&#31243;&#20013;&#21457;&#29983;&#24182;&#21457;&#20462;&#25913;&#65292;Hibernate&#33021;&#22815;&#33258;&#21160;&#26816;&#27979;&#21040;&#12290;&#19968;&#33324;&#25105;&#20204;&#21482;&#22312;&#23545;&#35805;&#32467;&#26463;&#26102;&#25165;&#26816;&#26597;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#33073;&#31649;&#23545;&#35937;</EM></SPAN>&#65288;Detached Objects&#65289;- 
  &#22914;&#26524;&#20320;&#20915;&#23450;&#37319;&#29992;&#21069;&#38754;&#24050;&#32463;&#35752;&#35770;&#36807;&#30340; <SPAN 
  class=emphasis><EM>session-per-request</EM></SPAN>&#27169;&#24335;&#65292;&#25152;&#26377;&#36733;&#20837;&#30340;&#23454;&#20363;&#22312;&#29992;&#25143;&#24605;&#32771;&#30340;&#36807;&#31243; 
  &#20013;&#37117;&#22788;&#20110;&#19982;Session&#33073;&#31163;&#30340;&#29366;&#24577;&#12290;Hibernate&#20801;&#35768;&#20320;&#25226;&#19982;Session&#33073;&#31163;&#30340;&#23545;&#35937;&#37325;&#26032;&#20851;&#32852;&#21040;Session &#19978;&#65292;&#24182;&#19988;&#23545;&#20462;&#25913;&#36827;&#34892;&#25345;&#20037;&#21270;&#65292;&#36825;&#31181;&#27169;&#24335;&#34987;&#31216;&#20026; 
  <SPAN 
  class=emphasis><EM>session-per-request-with-detached-objects</EM></SPAN>&#12290;&#33258;&#21160;&#29256;&#26412;&#21270;&#34987;&#29992;&#26469;&#38548;&#31163;&#24182;&#21457;&#20462;&#25913;&#12290; 
  </P>
  <LI>
  <P><SPAN class=emphasis><EM>Extended (or Long) Session</EM></SPAN> - Hibernate 
  &#30340;<TT class=literal>Session</TT> 
  &#21487;&#20197;&#22312;&#25968;&#25454;&#24211;&#20107;&#21153;&#25552;&#20132;&#20043;&#21518;&#21644;&#24213;&#23618;&#30340;JDBC&#36830;&#25509;&#26029;&#24320;&#65292;&#24403;&#19968;&#20010;&#26032;&#30340;&#23458;&#25143;&#31471;&#35831;&#27714;&#21040;&#26469;&#30340;&#26102;&#20505;&#65292;&#23427;&#21448;&#37325;&#26032;&#36830;&#25509;&#19978;&#24213;&#23618;&#30340; JDBC&#36830;&#25509;&#12290;&#36825;&#31181;&#27169;&#24335;&#34987;&#31216;&#20043;&#20026;<SPAN 
  class=emphasis><EM>session-per-conversation</EM></SPAN>&#65292;&#36825;&#31181;&#24773;&#20917;&#21487; 
  &#33021;&#20250;&#36896;&#25104;&#19981;&#24517;&#35201;&#30340;Session&#21644;JDBC&#36830;&#25509;&#30340;&#37325;&#26032;&#20851;&#32852;&#12290;&#33258;&#21160;&#29256;&#26412;&#21270;&#34987;&#29992;&#26469;&#38548;&#31163;&#24182;&#21457;&#20462;&#25913;, <TT 
  class=literal>Session</TT>&#36890;&#24120;&#19981;&#20801;&#35768;&#33258;&#21160;flush,&#32780;&#26159;&#26126;&#30830;flush&#12290; </P></LI></UL></DIV>
<P><SPAN 
class=emphasis><EM>session-per-request-with-detached-objects</EM></SPAN> &#21644; <SPAN 
class=emphasis><EM>session-per-conversation</EM></SPAN> &#21508;&#26377;&#20248;&#32570;&#28857;&#65292;&#25105;&#20204;&#22312;&#26412;&#31456;&#21518;&#38754;&#20048;&#35266;&#24182;&#21457; 
&#25511;&#21046;&#37027;&#37096;&#20998;&#20877;&#36827;&#34892;&#35752;&#35770;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-basics-identity></A>11.1.3.&nbsp;&#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering object 
identity)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#22312;&#20004;&#20010;&#19981;&#21516;&#30340;<TT class=literal>Session</TT>&#20013;&#24182;&#21457;&#35775;&#38382;&#21516;&#19968;&#25345;&#20037;&#21270;&#29366;&#24577;&#65292;&#20294;&#26159;&#65292; &#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#26080;&#27861;&#22312;&#20004;&#20010; <TT 
class=literal>Session</TT>&#20013;&#20849;&#20139;&#12290;&#22240;&#27492;&#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#26631;&#35782;&#35821;&#20041;&#65306; </P>
<P></P>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>&#25968;&#25454;&#24211;&#26631;&#35782;</SPAN>
  <DD>
  <P><TT class=literal>foo.getId().equals( bar.getId() )</TT> </P>
  <DT><SPAN class=term>JVM &#26631;&#35782;</SPAN>
  <DD>
  <P><TT class=literal>foo==bar</TT> </P></DD></DL></DIV>
<P></P>
<P>&#23545;&#20110;&#37027;&#20123;&#20851;&#32852;&#21040; <SPAN class=emphasis><EM>&#29305;&#23450;</EM></SPAN><TT class=literal>Session</TT> 
&#65288;&#20063;&#23601;&#26159;&#22312;&#21333;&#20010;<TT class=literal>Session</TT>&#30340;&#33539;&#22260;&#20869;&#65289;&#19978;&#30340;&#23545;&#35937;&#26469;&#35828;&#65292;&#36825; 
&#20004;&#31181;&#26631;&#35782;&#30340;&#35821;&#20041;&#26159;&#31561;&#20215;&#30340;&#65292;&#19982;&#25968;&#25454;&#24211;&#26631;&#35782;&#23545;&#24212;&#30340;JVM&#26631;&#35782;&#26159;&#30001;Hibernate&#26469;&#20445; &#35777;&#30340;&#12290;&#19981;&#36807;&#65292;&#24403;&#24212;&#29992;&#31243;&#24207;&#22312;&#20004;&#20010;&#19981;&#21516;&#30340;session&#20013;&#24182;&#21457;&#35775;&#38382;&#20855;&#26377;&#21516;&#19968;&#25345;&#20037;&#21270;&#26631; 
&#35782;&#30340;&#19994;&#21153;&#23545;&#35937;&#23454;&#20363;&#30340;&#26102;&#20505;&#65292;&#36825;&#20010;&#19994;&#21153;&#23545;&#35937;&#30340;&#20004;&#20010;&#23454;&#20363;&#20107;&#23454;&#19978;&#26159;&#19981;&#30456;&#21516;&#30340;&#65288;&#20174; JVM&#35782;&#21035;&#26469;&#30475;&#65289;&#12290;&#36825;&#31181;&#20914;&#31361;&#21487;&#20197;&#36890;&#36807;&#22312;&#21516;&#27493;&#21644;&#25552;&#20132;&#30340;&#26102;&#20505;&#20351;&#29992;&#33258;&#21160;&#29256;&#26412;&#21270;&#21644;&#20048; &#35266;&#38145;&#23450;&#26041;&#27861;&#26469;&#35299;&#20915;&#12290; 
</P>
<P></P>
<P>&#36825;&#31181;&#26041;&#24335;&#25226;&#20851;&#20110;&#24182;&#21457;&#30340;&#22836;&#30140;&#38382;&#39064;&#30041;&#32473;&#20102;Hibernate&#21644;&#25968;&#25454;&#24211;&#65307;&#30001;&#20110;&#22312;&#21333;&#20010;&#32447;&#31243;&#20869;&#65292;&#25805;&#20316;&#21333;&#20803;&#20013;&#30340;&#23545;&#35937;&#35782;&#21035;&#19981; 
&#38656;&#35201;&#20195;&#20215;&#26114;&#36149;&#30340;&#38145;&#23450;&#25110;&#20854;&#20182;&#24847;&#20041;&#19978;&#30340;&#21516;&#27493;&#65292;&#22240;&#27492;&#23427;&#21516;&#26102;&#21487;&#20197;&#25552;&#20379;&#26368;&#22909;&#30340;&#21487;&#20280;&#32553;&#24615;&#12290;&#21482;&#35201;&#22312;&#21333;&#20010;&#32447;&#31243;&#21482;&#25345;&#26377;&#19968;&#20010; <TT 
class=literal>Session</TT>&#65292;&#24212;&#29992;&#31243;&#24207;&#23601;&#19981;&#38656;&#35201;&#21516;&#27493;&#20219;&#20309;&#19994;&#21153;&#23545;&#35937;&#12290;&#22312;<TT class=literal>Session</TT> 
&#30340;&#33539;&#22260;&#20869;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#25918;&#24515;&#30340;&#20351;&#29992;<TT class=literal>==</TT>&#36827;&#34892;&#23545;&#35937;&#27604;&#36739;&#12290; </P>
<P></P>
<P>&#19981;&#36807;&#65292;&#24212;&#29992;&#31243;&#24207;&#22312;<TT class=literal>Session</TT>&#30340;&#22806;&#38754;&#20351;&#29992;<TT class=literal>==</TT>&#36827;&#34892;&#23545;&#35937;&#27604;&#36739;&#21487;&#33021;&#20250; 
&#23548;&#33268;&#26080;&#27861;&#39044;&#26399;&#30340;&#32467;&#26524;&#12290;&#22312;&#19968;&#20123;&#26080;&#27861;&#39044;&#26009;&#30340;&#22330;&#21512;&#65292;&#20363;&#22914;&#65292;&#22914;&#26524;&#20320;&#25226;&#20004;&#20010;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363;&#25918;&#36827;&#21516;&#19968;&#20010; <TT 
class=literal>Set</TT>&#30340;&#26102;&#20505;&#65292;&#23601;&#21487;&#33021;&#21457;&#29983;&#12290;&#36825;&#20004;&#20010;&#23545;&#35937;&#23454;&#20363;&#21487;&#33021;&#26377;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#26631;&#35782;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292; 
&#20182;&#20204;&#20195;&#34920;&#20102;&#34920;&#30340;&#21516;&#19968;&#34892;&#25968;&#25454;&#65289;&#65292;&#20174;JVM&#26631;&#35782;&#30340;&#23450;&#20041;&#19978;&#26469;&#35828;&#65292;&#23545;&#33073;&#31649;&#30340;&#23545;&#35937;&#32780;&#35328;&#65292;Hibernate&#26080;&#27861;&#20445;&#35777;&#20182;&#20204; &#30340;&#30340;JVM&#26631;&#35782;&#19968;&#33268;&#12290;&#24320;&#21457;&#20154;&#21592;&#24517;&#39035;&#35206;&#30422;&#25345;&#20037;&#21270;&#31867;&#30340;<TT 
class=literal>equals()</TT>&#26041;&#27861;&#21644; <TT class=literal>hashCode()</TT> 
&#26041;&#27861;&#65292;&#20174;&#32780;&#23454;&#29616;&#33258;&#23450;&#20041;&#30340;&#23545;&#35937;&#30456;&#31561;&#35821;&#20041;&#12290;&#35686;&#21578;&#65306;&#19981;&#35201;&#20351;&#29992;&#25968;&#25454;&#24211;&#26631;&#35782; &#26469;&#23454;&#29616;&#23545;&#35937;&#30456;&#31561;&#65292;&#24212;&#35813;&#20351;&#29992;&#19994;&#21153;&#38190;&#20540;&#65292;&#30001;&#21807;&#19968;&#30340;&#65292;&#36890;&#24120;&#19981;&#21464;&#30340;&#23646;&#24615;&#32452;&#25104;&#12290;&#24403;&#19968;&#20010;&#30636;&#26102;&#23545;&#35937;&#34987;&#25345;&#20037;&#21270;&#30340;&#26102; 
&#20505;&#65292;&#23427;&#30340;&#25968;&#25454;&#24211;&#26631;&#35782;&#20250;&#21457;&#29983;&#25913;&#21464;&#12290;&#22914;&#26524;&#19968;&#20010;&#30636;&#26102;&#23545;&#35937;&#65288;&#36890;&#24120;&#20063;&#21253;&#25324;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363;&#65289;&#34987;&#25918;&#20837;&#19968; &#20010;<TT 
class=literal>Set</TT>&#65292;&#25913;&#21464;&#23427;&#30340;hashcode&#20250;&#23548;&#33268;&#19982;&#36825;&#20010;<TT class=literal>Set</TT>&#30340;&#20851;&#31995;&#20013;&#26029;&#12290;&#34429; 
&#28982;&#19994;&#21153;&#38190;&#20540;&#30340;&#23646;&#24615;&#19981;&#35937;&#25968;&#25454;&#24211;&#20027;&#38190;&#37027;&#26679;&#31283;&#23450;&#19981;&#21464;&#65292;&#20294;&#26159;&#20320;&#21482;&#38656;&#35201;&#20445;&#35777;&#22312;&#21516;&#19968;&#20010;<TT class=literal>Set</TT> 
&#20013;&#30340;&#23545;&#35937;&#23646;&#24615;&#30340;&#31283;&#23450;&#24615;&#23601;&#36275;&#22815;&#20102;&#12290;&#35831;&#21040;Hibernate&#32593;&#31449;&#21435;&#23547;&#27714;&#36825;&#20010;&#38382;&#39064;&#26356;&#22810;&#30340;&#35814;&#32454;&#30340;&#35752;&#35770;&#12290;&#35831;&#27880;&#24847;&#65292;&#36825;&#19981;&#26159;&#19968; 
&#20010;&#26377;&#20851;Hibernate&#30340;&#38382;&#39064;&#65292;&#32780;&#20165;&#20165;&#26159;&#19968;&#20010;&#20851;&#20110;Java&#23545;&#35937;&#26631;&#35782;&#21644;&#21028;&#31561;&#34892;&#20026;&#22914;&#20309;&#23454;&#29616;&#30340;&#38382;&#39064;&#12290; </P>
<P></P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-basics-issues></A>11.1.4.&nbsp;&#24120;&#35265;&#38382;&#39064;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20915;&#19981;&#35201;&#20351;&#29992;&#21453;&#27169;&#24335;<SPAN class=emphasis><EM>session-per-user-session</EM></SPAN>&#25110;&#32773;<SPAN 
class=emphasis><EM> session-per-application</EM></SPAN>&#65288;&#24403;&#28982;&#65292;&#36825;&#20010;&#35268;&#23450;&#20960;&#20046;&#27809;&#26377;&#20363;&#22806;&#65289;&#12290;&#35831;&#27880;&#24847;&#65292; 
&#19979;&#36848;&#19968;&#20123;&#38382;&#39064;&#21487;&#33021;&#20063;&#20250;&#20986;&#29616;&#22312;&#25105;&#20204;&#25512;&#33616;&#30340;&#27169;&#24335;&#20013;&#65292;&#22312;&#20320;&#20316;&#20986;&#26576;&#20010;&#35774;&#35745;&#20915;&#23450;&#20043;&#21069;&#65292;&#35831;&#21153;&#24517;&#29702;&#35299;&#35813;&#27169;&#24335;&#30340;&#24212;&#29992;&#21069;&#25552;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><TT class=literal>Session</TT> &#23545;&#35937;&#26159;&#38750;&#32447;&#31243;&#23433;&#20840;&#30340;&#12290;&#22914;&#26524;&#19968;&#20010;<TT class=literal>Session</TT> 
  &#23454;&#20363;&#20801;&#35768;&#20849;&#20139;&#30340;&#35805;&#65292;&#37027;&#20123;&#25903;&#25345;&#24182;&#21457;&#36816;&#34892;&#30340;&#19996;&#19996;&#65292;&#20363;&#22914;HTTP request&#65292;session beans,&#25110;&#32773;&#26159; Swing 
  workers&#65292;&#23558;&#20250;&#23548;&#33268;&#20986;&#29616;&#36164;&#28304;&#20105;&#29992;&#65288;race condition&#65289;&#12290;&#22914;&#26524;&#22312;<TT class=literal>HttpSession</TT>&#20013;&#26377; 
  Hibernate &#30340;<TT class=literal>Session</TT>&#30340;&#35805;&#65288;&#31245;&#21518;&#35752;&#35770;&#65289;&#65292;&#20320;&#24212;&#35813;&#32771;&#34385;&#21516;&#27493;&#35775;&#38382;&#20320;&#30340;Http session&#12290; 
  &#21542;&#21017;&#65292;&#21482;&#35201;&#29992;&#25143;&#36275;&#22815;&#24555;&#30340;&#28857;&#20987;&#27983;&#35272;&#22120;&#30340;“&#21047;&#26032;”&#65292;&#23601;&#20250;&#23548;&#33268;&#20004;&#20010;&#24182;&#21457;&#36816;&#34892;&#32447;&#31243;&#20351;&#29992;&#21516;&#19968;&#20010; <TT class=literal>Session</TT>&#12290; </P>
  <LI>
  <P>&#19968;&#20010;&#30001;Hibernate&#25243;&#20986;&#30340;&#24322;&#24120;&#24847;&#21619;&#30528;&#20320;&#24517;&#39035;&#31435;&#21363;&#22238;&#28378;&#25968;&#25454;&#24211;&#20107;&#21153;&#65292;&#24182;&#31435;&#21363;&#20851;&#38381;<TT class=literal>Session</TT> 
  &#65288;&#31245;&#21518;&#20250;&#23637;&#24320;&#35752;&#35770;&#65289;&#12290;&#22914;&#26524;&#20320;&#30340;<TT class=literal>Session</TT>&#32465;&#23450;&#21040;&#19968;&#20010;&#24212;&#29992;&#31243;&#24207;&#19978;&#65292;&#20320;&#24517; 
  &#39035;&#20572;&#27490;&#35813;&#24212;&#29992;&#31243;&#24207;&#12290;&#22238;&#28378;&#25968;&#25454;&#24211;&#20107;&#21153;&#24182;&#19981;&#20250;&#25226;&#20320;&#30340;&#19994;&#21153;&#23545;&#35937;&#36864;&#22238;&#21040;&#20107;&#21153;&#21551;&#21160;&#26102;&#20505;&#30340;&#29366;&#24577;&#12290;&#36825; 
  &#24847;&#21619;&#30528;&#25968;&#25454;&#24211;&#29366;&#24577;&#21644;&#19994;&#21153;&#23545;&#35937;&#29366;&#24577;&#19981;&#21516;&#27493;&#12290;&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#36825;&#19981;&#26159;&#20160;&#20040;&#38382;&#39064;&#65292;&#22240;&#20026;&#24322;&#24120;&#26159;&#19981;&#21487; &#24674;&#22797;&#30340;,&#20320;&#24517;&#39035;&#22312;&#22238;&#28378;&#20043;&#21518;&#37325;&#26032;&#24320;&#22987;&#25191;&#34892;&#12290; </P>
  <LI>
  <P><TT class=literal>Session</TT> &#32531;&#23384;&#20102;&#22788;&#20110;&#25345;&#20037;&#21270;&#29366;&#24577;&#30340;&#27599;&#20010;&#23545;&#35937;&#65288;Hibernate&#20250;&#30417;&#35270;&#21644;&#26816;&#26597;&#33039;&#25968;&#25454;&#65289;&#12290; 
  &#36825;&#24847;&#21619;&#30528;&#65292;&#22914;&#26524;&#20320;&#35753;<TT class=literal>Session</TT>&#25171;&#24320;&#24456;&#38271;&#19968;&#27573;&#26102;&#38388;&#65292;&#25110;&#26159;&#20165;&#20165;&#36733;&#20837;&#20102;&#36807;&#22810;&#30340;&#25968;&#25454;&#65292; <TT 
  class=literal>Session</TT>&#21344;&#29992;&#30340;&#20869;&#23384;&#20250;&#19968;&#30452;&#22686;&#38271;&#65292;&#30452;&#21040;&#25243;&#20986;OutOfMemoryException&#24322;&#24120;&#12290;&#36825;&#20010; 
  &#38382;&#39064;&#30340;&#19968;&#20010;&#35299;&#20915;&#26041;&#27861;&#26159;&#35843;&#29992;<TT class=literal>clear()</TT> &#21644;<TT class=literal>evict()</TT>&#26469;&#31649;&#29702; 
  <TT class=literal>Session</TT>&#30340;&#32531;&#23384;&#65292;&#20294;&#26159;&#22914;&#26524;&#20320;&#38656;&#35201;&#22823;&#25209;&#37327;&#25968;&#25454;&#25805;&#20316;&#30340;&#35805;&#65292;&#26368;&#22909;&#32771;&#34385; &#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#12290;&#22312;<A 
  title="&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#25209;&#37327;&#22788;&#29702;&#65288;Batch processing&#65289;" 
  href="#batch">&#31532;&nbsp;13&nbsp;&#31456; <I>&#25209;&#37327;&#22788;&#29702;&#65288;Batch 
  processing&#65289;</I></A>&#20013;&#26377;&#19968;&#20123;&#35299;&#20915;&#26041;&#26696;&#12290;&#22312;&#29992;&#25143;&#20250;&#35805;&#26399;&#38388;&#19968;&#30452;&#20445;&#25345; <TT 
  class=literal>Session</TT>&#25171;&#24320;&#20063;&#24847;&#21619;&#30528;&#20986;&#29616;&#33039;&#25968;&#25454;&#30340;&#21487;&#33021;&#24615;&#24456;&#39640;&#12290; </P></LI></UL></DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=transactions-demarcation></A>11.2.&nbsp;&#25968;&#25454;&#24211;&#20107;&#21153;&#22768;&#26126;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25968;&#25454;&#24211;&#65288;&#25110;&#32773;&#31995;&#32479;&#65289;&#20107;&#21153;&#30340;&#22768;&#26126;&#24635;&#26159;&#24517;&#39035;&#30340;&#12290;&#22312;&#25968;&#25454;&#24211;&#20107;&#21153;&#20043;&#22806;&#65292;&#23601;&#26080;&#27861;&#21644;&#25968;&#25454;&#24211;&#36890;&#35759;&#65288;&#36825;&#21487;&#33021;&#20250;&#35753;&#37027;&#20123;&#20064;&#24815;&#20110; 
&#33258;&#21160;&#25552;&#20132;&#20107;&#21153;&#27169;&#24335;&#30340;&#24320;&#21457;&#20154;&#21592;&#24863;&#21040;&#36855;&#24785;&#65289;&#12290;&#27704;&#36828;&#20351;&#29992;&#28165;&#26224;&#30340;&#20107;&#21153;&#22768;&#26126;&#65292;&#21363;&#20351;&#21482;&#35835;&#25805;&#20316;&#20063;&#26159;&#22914;&#27492;&#12290;&#36827;&#34892; 
&#26174;&#24335;&#30340;&#20107;&#21153;&#22768;&#26126;&#24182;&#19981;&#24635;&#26159;&#38656;&#35201;&#30340;&#65292;&#36825;&#21462;&#20915;&#20110;&#20320;&#30340;&#20107;&#21153;&#38548;&#31163;&#32423;&#21035;&#21644;&#25968;&#25454;&#24211;&#30340;&#33021;&#21147;&#65292;&#20294;&#19981;&#31649;&#24590;&#20040;&#35828;&#65292;&#22768;&#26126;&#20107;&#21153;&#24635;&#24402;&#26377;&#30410;&#26080;&#23475;&#12290;&#24403;&#28982;&#65292;&#19968;&#20010;&#21333;&#29420;&#30340;&#25968;&#25454;&#24211;&#20107;&#21153;&#24635;&#26159;&#27604;&#24456;&#22810;&#29712;&#30862;&#30340;&#20107;&#21153;&#24615;&#33021;&#26356;&#22909;&#65292;&#21363;&#26102;&#23545;&#35835;&#25968;&#25454;&#32780;&#35328;&#20063;&#26159;&#19968;&#26679;&#12290; 
</P>
<P>&#19968;&#20010;Hibernate&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#36816;&#34892;&#22312;&#38750;&#25176;&#31649;&#29615;&#22659;&#20013;&#65288;&#20063;&#23601;&#26159;&#29420;&#31435;&#36816;&#34892;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#31616;&#21333;Web&#24212;&#29992;&#31243;&#24207;&#65292; 
&#25110;&#32773;Swing&#22270;&#24418;&#26700;&#38754;&#24212;&#29992;&#31243;&#24207;&#65289;&#65292;&#20063;&#21487;&#20197;&#36816;&#34892;&#22312;&#25176;&#31649;&#30340;J2EE&#29615;&#22659;&#20013;&#12290;&#22312;&#19968;&#20010;&#38750;&#25176;&#31649;&#29615;&#22659;&#20013;&#65292;Hibernate 
&#36890;&#24120;&#33258;&#24049;&#36127;&#36131;&#31649;&#29702;&#25968;&#25454;&#24211;&#36830;&#25509;&#27744;&#12290;&#24212;&#29992;&#31243;&#24207;&#24320;&#21457;&#20154;&#21592;&#24517;&#39035;&#25163;&#24037;&#35774;&#32622;&#20107;&#21153;&#22768;&#26126;&#65292;&#25442;&#21477;&#35805;&#35828;&#65292;&#23601;&#26159;&#25163;&#24037;&#21551; 
&#21160;&#65292;&#25552;&#20132;&#65292;&#25110;&#32773;&#22238;&#28378;&#25968;&#25454;&#24211;&#20107;&#21153;&#12290;&#19968;&#20010;&#25176;&#31649;&#30340;&#29615;&#22659;&#36890;&#24120;&#25552;&#20379;&#20102;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;(CMT)&#65292;&#20363;&#22914;&#20107;&#21153;&#35013;&#37197;&#36890;&#36807;&#21487;&#22768; &#26126;&#30340;&#26041;&#24335;&#23450;&#20041;&#22312;EJB session 
beans&#30340;&#37096;&#32626;&#25551;&#36848;&#31526;&#20013;&#12290;&#21487;&#32534;&#31243;&#24335;&#20107;&#21153;&#22768;&#26126;&#19981;&#20877;&#38656;&#35201;&#65292;&#21363;&#20351;&#26159; <TT class=literal>Session</TT> &#30340;&#21516;&#27493;&#20063;&#21487;&#20197;&#33258;&#21160;&#23436;&#25104;&#12290; </P>
<P>&#35753;&#25345;&#20037;&#23618;&#20855;&#22791;&#21487;&#31227;&#26893;&#24615;&#26159;&#20154;&#20204;&#30340;&#29702;&#24819;,&#36825;&#31181;&#31227;&#26893;&#21457;&#29983;&#22312;&#38750;&#25176;&#31649;&#30340;&#26412;&#22320;&#36164;&#28304;&#29615;&#22659;&#65292;&#19982;&#20381;&#36182;JTA&#20294;&#26159;&#20351;&#29992;BMT&#32780;&#38750;CMT&#30340;&#31995;&#32479;&#20043;&#38388;&#12290;&#22312;&#20004;&#31181;&#24773;&#20917;&#19979;&#20320;&#37117;&#21487;&#20197;&#20351;&#29992;&#32534;&#31243;&#24335;&#30340;&#20107;&#21153;&#31649;&#29702;&#12290;Hibernate&#25552;&#20379;&#20102;&#19968;&#22871;&#31216;&#20026;<TT 
class=literal>Transaction</TT>&#30340;&#23553;&#35013;API&#65292; 
&#29992;&#26469;&#25226;&#20320;&#30340;&#37096;&#32626;&#29615;&#22659;&#20013;&#30340;&#26412;&#22320;&#20107;&#21153;&#31649;&#29702;&#31995;&#32479;&#36716;&#25442;&#21040;Hibernate&#20107;&#21153;&#19978;&#12290;&#36825;&#20010;API&#26159;&#21487;&#36873;&#30340;&#65292;&#20294;&#26159;&#25105;&#20204;&#24378;&#28872; &#25512;&#33616;&#20320;&#20351;&#29992;&#65292;&#38500;&#38750;&#20320;&#29992;CMT session bean&#12290; 
</P>
<P>&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#32467;&#26463; <TT class=literal>Session</TT> &#21253;&#21547;&#20102;&#22235;&#20010;&#19981;&#21516;&#30340;&#38454;&#27573;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#21516;&#27493;session(flush,&#21047;&#20986;&#21040;&#30913;&#30424;&#65289; </P>
  <LI>
  <P>&#25552;&#20132;&#20107;&#21153; </P>
  <LI>
  <P>&#20851;&#38381;session </P>
  <LI>
  <P>&#22788;&#29702;&#24322;&#24120; </P></LI></UL></DIV>
<P>session&#30340;&#21516;&#27493;(flush,&#21047;&#20986;&#65289;&#21069;&#38754;&#24050;&#32463;&#35752;&#35770;&#36807;&#20102;&#65292;&#25105;&#20204;&#29616;&#22312;&#36827;&#19968;&#27493;&#32771;&#23519;&#22312;&#25176;&#31649;&#21644;&#38750;&#25176;&#31649;&#29615;&#22659;&#19979;&#30340;&#20107;&#21153;&#22768;&#26126;&#21644;&#24322;&#24120;&#22788;&#29702;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-demarcation-nonmanaged></A>11.2.1.&nbsp;&#38750;&#25176;&#31649;&#29615;&#22659;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;Hibernat&#25345;&#20037;&#23618;&#36816;&#34892;&#22312;&#19968;&#20010;&#38750;&#25176;&#31649;&#29615;&#22659;&#20013;&#65292;&#25968;&#25454;&#24211;&#36830;&#25509;&#36890;&#24120;&#30001;Hibernate&#30340;&#31616;&#21333;&#65288;&#21363;&#38750;DataSource)&#36830;&#25509;&#27744;&#26426;&#21046; 
&#26469;&#22788;&#29702;&#12290;session/transaction&#22788;&#29702;&#26041;&#24335;&#22914;&#19979;&#25152;&#31034;&#65306; </P><PRE class=programlisting>//Non-managed environment idiom
Session sess = factory.openSession();
Transaction tx = null;
try {
    tx = sess.beginTransaction();

    // do some work
    ...

    tx.commit();
}
catch (RuntimeException e) {
    if (tx != null) tx.rollback();
    throw e; // or display error message
}
finally {
    sess.close();
}</PRE>
<P>&#20320;&#19981;&#38656;&#35201;&#26174;&#24335;<TT class=literal>flush()</TT> <TT class=literal>Session</TT> - &#23545;<TT 
class=literal>commit()</TT>&#30340;&#35843;&#29992;&#20250;&#33258;&#21160;&#35302;&#21457;session&#30340;&#21516;&#27493;(&#21462;&#20915;&#20110;session&#30340;<A 
title=10.10.&nbsp;Session&#21047;&#20986;(flush) 
href="#objectstate-flushing">&#31532;&nbsp;10.10&nbsp;&#33410; “Session&#21047;&#20986;(flush)”</A>)&#12290;&#35843;&#29992; <TT 
class=literal>close()</TT> &#26631;&#24535;session&#30340;&#32467;&#26463;&#12290;<TT 
class=literal>close()</TT>&#26041;&#27861;&#37325;&#35201;&#30340;&#26263;&#31034;&#26159;&#65292;<TT 
class=literal>session</TT>&#37322;&#25918;&#20102;JDBC&#36830;&#25509;&#12290;&#36825;&#27573;Java&#20195;&#30721;&#22312;&#38750;&#25176;&#31649;&#29615;&#22659;&#19979;&#21644;JTA&#29615;&#22659;&#19979;&#37117;&#21487;&#20197;&#36816;&#34892;&#12290; </P>
<P>&#26356;&#21152;&#28789;&#27963;&#30340;&#26041;&#26696;&#26159;Hibernate&#20869;&#32622;&#30340;"current session"&#19978;&#19979;&#25991;&#31649;&#29702;&#65292;&#21069;&#25991;&#24050;&#32463;&#35762;&#36807;&#65306; </P><PRE class=programlisting>// Non-managed environment idiom with getCurrentSession()
try {
    factory.getCurrentSession().beginTransaction();

    // do some work
    ...

    factory.getCurrentSession().getTransaction().commit();
}
catch (RuntimeException e) {
    factory.getCurrentSession().getTransaction().rollback();
    throw e; // or display error message
}</PRE>
<P>&#20320;&#24456;&#21487;&#33021;&#20174;&#26410;&#22312;&#19968;&#20010;&#36890;&#24120;&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;&#19994;&#21153;&#20195;&#30721;&#20013;&#35265;&#36807;&#36825;&#26679;&#30340;&#20195;&#30721;&#29255;&#26029;&#65306;&#33268;&#21629;&#30340;&#65288;&#31995;&#32479;&#65289;&#24322;&#24120;&#24212;&#35813;&#24635;&#26159; 
&#22312;&#24212;&#29992;&#31243;&#24207;“&#39030;&#23618;”&#34987;&#25429;&#33719;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#25191;&#34892;Hibernate&#35843;&#29992;&#30340;&#20195;&#30721;&#65288;&#22312;&#25345;&#20037;&#23618;&#65289;&#21644;&#22788;&#29702; <TT 
class=literal>RuntimeException</TT>&#24322;&#24120;&#30340;&#20195;&#30721;&#65288;&#36890;&#24120;&#21482;&#33021;&#28165;&#29702;&#21644;&#36864;&#20986;&#24212;&#29992;&#31243;&#24207;&#65289;&#24212;&#35813;&#22312;&#19981;&#21516; 
&#30340;&#24212;&#29992;&#31243;&#24207;&#36923;&#36753;&#23618;&#12290;Hibernate&#30340;&#24403;&#21069;&#19978;&#19979;&#25991;&#31649;&#29702;&#21487;&#20197;&#26497;&#22823;&#22320;&#31616;&#21270;&#36825;&#19968;&#35774;&#35745;&#65292;&#20320;&#25152;&#26377;&#30340;&#19968;&#20999;&#23601;&#26159;<TT 
class=literal>SessionFactory</TT>&#12290; &#24322;&#24120;&#22788;&#29702;&#23558;&#22312;&#26412;&#31456;&#31245;&#21518;&#36827;&#34892;&#35752;&#35770;&#12290; </P>
<P>&#35831;&#27880;&#24847;&#65292;&#20320;&#24212;&#35813;&#36873;&#25321; <TT 
class=literal>org.hibernate.transaction.JDBCTransactionFactory</TT> 
(&#36825;&#26159;&#40664;&#35748;&#36873;&#39033;)&#65292;&#23545;&#31532;&#20108;&#20010;&#20363;&#23376;&#26469;&#35828;&#65292;<TT 
class=literal>hibernate.current_session_context_class</TT>&#24212;&#35813;&#26159;<TT 
class=literal>"thread"</TT> </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-demarcation-jta></A>11.2.2.&nbsp;&#20351;&#29992;JTA</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#30340;&#25345;&#20037;&#23618;&#36816;&#34892;&#22312;&#19968;&#20010;&#24212;&#29992;&#26381;&#21153;&#22120;&#20013;&#65288;&#20363;&#22914;&#65292;&#22312;EJB session beans&#30340;&#21518;&#38754;&#65289;&#65292;Hibernate&#33719;&#21462; 
&#30340;&#27599;&#20010;&#25968;&#25454;&#28304;&#36830;&#25509;&#23558;&#33258;&#21160;&#25104;&#20026;&#20840;&#23616;JTA&#20107;&#21153;&#30340;&#19968;&#37096;&#20998;&#12290; &#20320;&#21487;&#20197;&#23433;&#35013;&#19968;&#20010;&#29420;&#31435;&#30340;JTA&#23454;&#29616;&#65292;&#20351;&#29992;&#23427;&#32780;&#19981;&#20351;&#29992;EJB&#12290;Hibernate&#25552;&#20379;&#20102;&#20004;&#31181;&#31574;&#30053;&#36827;&#34892;JTA&#38598;&#25104;&#12290; 
</P>
<P>&#22914;&#26524;&#20320;&#20351;&#29992;bean&#31649;&#29702;&#20107;&#21153;&#65288;BMT&#65289;&#65292;&#21487;&#20197;&#36890;&#36807;&#20351;&#29992;Hibernate&#30340; <TT class=literal>Transaction</TT> API&#26469;&#21578;&#35785; 
&#24212;&#29992;&#26381;&#21153;&#22120;&#21551;&#21160;&#21644;&#32467;&#26463;BMT&#20107;&#21153;&#12290;&#22240;&#27492;&#65292;&#20107;&#21153;&#31649;&#29702;&#20195;&#30721;&#21644;&#22312;&#38750;&#25176;&#31649;&#29615;&#22659;&#19979;&#26159;&#19968;&#26679;&#30340;&#12290; </P><PRE class=programlisting>// BMT idiom
Session sess = factory.openSession();
Transaction tx = null;
try {
    tx = sess.beginTransaction();

    // do some work
    ...

    tx.commit();
}
catch (RuntimeException e) {
    if (tx != null) tx.rollback();
    throw e; // or display error message
}
finally {
    sess.close();
}</PRE>
<P>&#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#19982;&#20107;&#21153;&#32465;&#23450;&#30340;<TT class=literal>Session</TT>&#65292;&#20063;&#23601;&#26159;&#20351;&#29992;<TT 
class=literal>getCurrentSession()</TT>&#26469;&#31616;&#21270;&#19978;&#19979;&#25991;&#31649;&#29702;&#65292;&#20320;&#23558;&#19981;&#24471;&#19981;&#30452;&#25509;&#20351;&#29992;JTA <TT 
class=literal>UserTransaction</TT>API&#12290; </P><PRE class=programlisting>// BMT idiom with getCurrentSession()
try {
    UserTransaction tx = (UserTransaction)new InitialContext()
                            .lookup("java:comp/UserTransaction");

    tx.begin();

    // Do some work on Session bound to transaction
    factory.getCurrentSession().load(...);
    factory.getCurrentSession().persist(...);

    tx.commit();
}
catch (RuntimeException e) {
    tx.rollback();
    throw e; // or display error message
}</PRE>
<P>&#22312;CMT&#26041;&#24335;&#19979;&#65292;&#20107;&#21153;&#22768;&#26126;&#26159;&#22312;session bean&#30340;&#37096;&#32626;&#25551;&#36848;&#31526;&#20013;&#65292;&#32780;&#19981;&#38656;&#35201;&#32534;&#31243;&#12290; &#22240;&#27492;&#65292;&#20195;&#30721;&#34987;&#31616;&#21270;&#20026;: </P><PRE class=programlisting>// CMT idiom
Session sess = factory.getCurrentSession();

// do some work
...

</PRE>
<P>&#22312;CMT/EJB&#20013;&#29978;&#33267;&#20250;&#33258;&#21160;rollback&#65292;&#22240;&#20026;&#20551;&#33509;&#26377;&#26410;&#25429;&#33719;&#30340;<TT 
class=literal>RuntimeException</TT>&#20174;session bean&#26041;&#27861;&#20013;&#25243;&#20986;&#65292;&#36825;&#23601;&#20250;&#36890;&#30693;&#23481;&#22120;&#25226;&#20840;&#23616;&#20107;&#21153;&#22238;&#28378;&#12290;<SPAN 
class=emphasis><EM>&#36825;&#23601;&#24847;&#21619;&#30528;&#65292;&#22312;BMT&#25110;&#32773;CMT&#20013;&#65292;&#20320;&#26681;&#26412;&#23601;&#19981;&#38656;&#35201;&#20351;&#29992;Hibernate <TT 
class=literal>Transaction</TT> API &#65292;&#20320;&#33258;&#21160;&#24471;&#21040;&#20102;&#32465;&#23450;&#21040;&#20107;&#21153;&#30340;“&#24403;&#21069;”Session&#12290; </EM></SPAN></P>
<P>&#27880;&#24847;&#65292;&#24403;&#20320;&#37197;&#32622;Hibernate&#30340;transaction factory&#30340;&#26102;&#20505;&#65292;&#22312;&#30452;&#25509;&#20351;&#29992;JTA&#30340;&#26102;&#20505;&#65288;BMT&#65289;&#65292;&#20320;&#24212;&#35813;&#36873;&#25321;<TT 
class=literal>org.hibernate.transaction.JTATransactionFactory</TT>,&#22312;CMT session 
bean&#20013;&#36873;&#25321;<TT 
class=literal>org.hibernate.transaction.CMTTransactionFactory</TT>&#12290;&#35760;&#24471;&#20063;&#35201;&#35774;&#32622;<TT 
class=literal>hibernate.transaction.manager_lookup_class</TT>&#12290;&#36824;&#26377;&#65292;&#30830;&#35748;&#20320;&#30340;<TT 
class=literal>hibernate.current_session_context_class</TT>&#26410;&#35774;&#32622;&#65288;&#20026;&#20102;&#21521;&#19979;&#20860;&#23481;&#65289;&#65292;&#25110;&#32773;&#35774;&#32622;&#20026;<TT 
class=literal>"jta"</TT>&#12290; </P>
<P><TT class=literal>getCurrentSession()</TT>&#22312;JTA&#29615;&#22659;&#20013;&#26377;&#19968;&#20010;&#24330;&#31471;&#12290;&#23545;<TT 
class=literal>after_statement</TT>&#36830;&#25509;&#37322;&#25918;&#26041;&#24335;&#26377;&#19968;&#20010;&#35686;&#21578;&#65292;&#36825;&#26159;&#34987;&#40664;&#35748;&#20351;&#29992;&#30340;&#12290;&#22240;&#20026;JTA&#35268;&#33539;&#30340;&#19968;&#20010;&#24456;&#24858;&#34850;&#30340;&#38480;&#21046;&#65292;Hibernate&#19981;&#21487;&#33021;&#33258;&#21160;&#28165;&#29702;&#20219;&#20309;&#26410;&#20851;&#38381;&#30340;<TT 
class=literal>ScrollableResults</TT> &#25110;&#32773;<TT class=literal>Iterator</TT>&#65292;&#23427;&#20204;&#26159;&#30001;<TT 
class=literal>scroll()</TT>&#25110;<TT class=literal>iterate()</TT>&#20135;&#29983;&#30340;&#12290;&#20320;<SPAN 
class=emphasis><EM>must</EM></SPAN>&#36890;&#36807;&#22312;<TT class=literal>finally</TT>&#22359;&#20013;&#65292;&#26174;&#24335;&#35843;&#29992;<TT 
class=literal>ScrollableResults.close()</TT>&#25110;&#32773;<TT 
class=literal>Hibernate.close(Iterator)</TT>&#26041;&#27861;&#26469;&#37322;&#25918;&#24213;&#23618;&#25968;&#25454;&#24211;&#28216;&#26631;&#12290;(&#24403;&#28982;&#65292;&#22823;&#37096;&#20998;&#31243;&#24207;&#23436;&#20840;&#21487;&#20197;&#24456;&#23481;&#26131;&#30340;&#36991;&#20813;&#22312;JTA&#25110;CMT&#20195;&#30721;&#20013;&#20986;&#29616;<TT 
class=literal>scroll()</TT>&#25110;<TT class=literal>iterate()</TT>&#12290;) </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-demarcation-exceptions></A>11.2.3.&nbsp;&#24322;&#24120;&#22788;&#29702;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524; <TT class=literal>Session</TT> &#25243;&#20986;&#24322;&#24120; (&#21253;&#25324;&#20219;&#20309;<TT 
class=literal>SQLException</TT>), &#20320;&#24212;&#35813;&#31435;&#21363;&#22238;&#28378;&#25968;&#25454;&#24211;&#20107;&#21153;&#65292;&#35843;&#29992; <TT 
class=literal>Session.close()</TT> &#65292;&#20002;&#24323;&#35813; <TT class=literal>Session</TT>&#23454;&#20363;&#12290;<TT 
class=literal>Session</TT>&#30340;&#26576;&#20123;&#26041;&#27861;&#21487;&#33021;&#20250;&#23548;&#33268;session 
&#22788;&#20110;&#19981;&#19968;&#33268;&#30340;&#29366;&#24577;&#12290;&#25152;&#26377;&#30001;Hibernate&#25243;&#20986;&#30340;&#24322;&#24120;&#37117;&#35270;&#20026;&#19981;&#21487;&#20197;&#24674;&#22797;&#30340;&#12290;&#30830;&#20445;&#22312; <TT class=literal>finally</TT> &#20195;&#30721;&#22359;&#20013;&#35843;&#29992;<TT 
class=literal>close()</TT>&#26041;&#27861;&#65292;&#20197;&#20851;&#38381;&#25481; <TT class=literal>Session</TT>&#12290; </P>
<P><TT class=literal>HibernateException</TT>&#26159;&#19968;&#20010;&#38750;&#26816;&#26597;&#26399;&#24322;&#24120;&#65288;&#36825;&#19981;&#21516;&#20110;Hibernate&#32769;&#30340;&#29256;&#26412;&#65289;&#65292; 
&#23427;&#23553;&#35013;&#20102;Hibernate&#25345;&#20037;&#23618;&#21487;&#33021;&#20986;&#29616;&#30340;&#22823;&#22810;&#25968;&#38169;&#35823;&#12290;&#25105;&#20204;&#30340;&#35266;&#28857;&#26159;&#65292;&#19981;&#24212;&#35813;&#24378;&#36843;&#24212;&#29992;&#31243;&#24207;&#24320;&#21457;&#20154;&#21592; 
&#22312;&#24213;&#23618;&#25429;&#33719;&#26080;&#27861;&#24674;&#22797;&#30340;&#24322;&#24120;&#12290;&#22312;&#22823;&#22810;&#25968;&#36719;&#20214;&#31995;&#32479;&#20013;&#65292;&#38750;&#26816;&#26597;&#26399;&#24322;&#24120;&#21644;&#33268;&#21629;&#24322;&#24120;&#37117;&#26159;&#22312;&#30456;&#24212;&#26041;&#27861;&#35843;&#29992; 
&#30340;&#22534;&#26632;&#30340;&#39030;&#23618;&#34987;&#22788;&#29702;&#30340;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#22312;&#36719;&#20214;&#19978;&#38754;&#30340;&#36923;&#36753;&#23618;&#65289;&#65292;&#24182;&#19988;&#25552;&#20379;&#19968;&#20010;&#38169;&#35823;&#20449;&#24687;&#32473;&#24212;&#29992;&#36719;&#20214;&#30340;&#29992;&#25143; 
&#65288;&#25110;&#32773;&#37319;&#21462;&#20854;&#20182;&#26576;&#20123;&#30456;&#24212;&#30340;&#25805;&#20316;&#65289;&#12290;&#35831;&#27880;&#24847;&#65292;Hibernate&#20063;&#26377;&#21487;&#33021;&#25243;&#20986;&#20854;&#20182;&#24182;&#19981;&#23646;&#20110; <TT 
class=literal>HibernateException</TT>&#30340;&#38750;&#26816;&#26597;&#26399;&#24322;&#24120;&#12290;&#36825;&#20123;&#24322;&#24120;&#21516;&#26679;&#20063;&#26159;&#26080;&#27861;&#24674;&#22797;&#30340;&#65292;&#24212;&#35813; &#37319;&#21462;&#26576;&#20123;&#30456;&#24212;&#30340;&#25805;&#20316;&#21435;&#22788;&#29702;&#12290; </P>
<P>&#22312;&#21644;&#25968;&#25454;&#24211;&#36827;&#34892;&#20132;&#20114;&#26102;&#65292;Hibernate&#25226;&#25429;&#33719;&#30340;<TT class=literal>SQLException</TT>&#23553;&#35013;&#20026;Hibernate&#30340; <TT 
class=literal>JDBCException</TT>&#12290;&#20107;&#23454;&#19978;&#65292;Hibernate&#23581;&#35797;&#25226;&#24322;&#24120;&#36716;&#25442;&#20026;&#26356;&#26377;&#23454;&#38469;&#21547;&#20041; &#30340;<TT 
class=literal>JDBCException</TT>&#24322;&#24120;&#30340;&#23376;&#31867;&#12290;&#24213;&#23618;&#30340;<TT class=literal>SQLException</TT>&#21487;&#20197; 
&#36890;&#36807;<TT class=literal>JDBCException.getCause()</TT>&#26469;&#24471;&#21040;&#12290;Hibernate&#36890;&#36807;&#20351;&#29992;&#20851;&#32852;&#21040; <TT 
class=literal>SessionFactory</TT>&#19978;&#30340;<TT class=literal>SQLExceptionConverter</TT>&#26469; 
&#25226;<TT class=literal>SQLException</TT>&#36716;&#25442;&#20026;&#19968;&#20010;&#23545;&#24212;&#30340;<TT class=literal>JDBCException</TT> 
&#24322;&#24120;&#30340;&#23376;&#31867;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;<TT class=literal>SQLExceptionConverter</TT>&#21487;&#20197;&#36890;&#36807;&#37197;&#32622;dialect 
&#36873;&#39033;&#25351;&#23450;&#65307;&#27492;&#22806;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#23454;&#29616;&#31867;&#65288;&#21442;&#32771;javadocs <TT 
class=literal>SQLExceptionConverterFactory</TT>&#31867;&#26469;&#20102;&#35299;&#35814;&#24773;&#65289;&#12290;&#26631;&#20934;&#30340; <TT 
class=literal>JDBCException</TT>&#23376;&#31867;&#22411;&#26159;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>JDBCConnectionException</TT> - &#25351;&#26126;&#24213;&#23618;&#30340;JDBC&#36890;&#35759;&#20986;&#29616;&#38169;&#35823; </P>
  <LI>
  <P><TT class=literal>SQLGrammarException</TT> - &#25351;&#26126;&#21457;&#36865;&#30340;SQL&#35821;&#21477;&#30340;&#35821;&#27861;&#25110;&#32773;&#26684;&#24335;&#38169;&#35823; </P>
  <LI>
  <P><TT class=literal>ConstraintViolationException</TT> - &#25351;&#26126;&#26576;&#31181;&#31867;&#22411;&#30340;&#32422;&#26463;&#36829;&#20363;&#38169;&#35823; </P>
  <LI>
  <P><TT class=literal>LockAcquisitionException</TT> - &#25351;&#26126;&#20102;&#22312;&#25191;&#34892;&#35831;&#27714;&#25805;&#20316;&#26102;&#65292;&#33719;&#21462; 
  &#25152;&#38656;&#30340;&#38145;&#32423;&#21035;&#26102;&#20986;&#29616;&#30340;&#38169;&#35823;&#12290; </P>
  <LI>
  <P><TT class=literal>GenericJDBCException</TT> - &#19981;&#23646;&#20110;&#20219;&#20309;&#20854;&#20182;&#31181;&#31867;&#30340;&#21407;&#29983;&#24322;&#24120; 
</P></LI></UL></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-demarcation-timeout></A>11.2.4.&nbsp;&#20107;&#21153;&#36229;&#26102;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>EJB&#36825;&#26679;&#30340;&#25176;&#31649;&#29615;&#22659;&#26377;&#19968;&#39033;&#26497;&#20026;&#37325;&#35201;&#30340;&#29305;&#24615;&#65292;&#32780;&#23427;&#20174;&#26410;&#22312;&#38750;&#25176;&#31649;&#29615;&#22659;&#20013;&#25552;&#20379;&#36807;&#65292;&#37027;&#23601;&#26159;&#20107;&#21153;&#36229;&#26102;&#12290;&#22312;&#20986;&#29616;&#38169;&#35823;&#30340;&#20107;&#21153;&#34892;&#20026;&#30340;&#26102;&#20505;&#65292;&#36229;&#26102;&#21487;&#20197;&#30830;&#20445;&#19981;&#20250;&#26080;&#38480;&#25346;&#36215;&#36164;&#28304;&#12289;&#23545;&#29992;&#25143;&#27809;&#26377;&#20132;&#20195;&#12290;&#22312;&#25176;&#31649;(JTA)&#29615;&#22659;&#20043;&#22806;&#65292;Hibernate&#26080;&#27861;&#23436;&#20840;&#25552;&#20379;&#36825;&#19968;&#21151;&#33021;&#12290;&#20294;&#26159;&#65292;Hiberante&#33267;&#23569;&#21487;&#20197;&#25511;&#21046;&#25968;&#25454;&#35775;&#38382;&#65292;&#30830;&#20445;&#25968;&#25454;&#24211;&#32423;&#21035;&#30340;&#27515;&#38145;&#65292;&#21644;&#36820;&#22238;&#24040;&#22823;&#32467;&#26524;&#38598;&#30340;&#26597;&#35810;&#34987;&#38480;&#23450;&#22312;&#19968;&#20010;&#35268;&#23450;&#30340;&#26102;&#38388;&#20869;&#12290;&#22312;&#25176;&#31649;&#29615;&#22659;&#20013;&#65292;Hibernate&#20250;&#25226;&#20107;&#21153;&#36229;&#26102;&#36716;&#20132;&#32473;JTA&#12290;&#36825;&#19968;&#21151;&#33021;&#36890;&#36807;Hibernate 
<TT class=literal>Transaction</TT>&#23545;&#35937;&#36827;&#34892;&#25277;&#35937;&#12290; </P><PRE class=programlisting>Session sess = factory.openSession();
try {
    //set transaction timeout to 3 seconds
    sess.getTransaction().setTimeout(3);
    sess.getTransaction().begin();

    // do some work
    ...

    sess.getTransaction().commit()
}
catch (RuntimeException e) {
    sess.getTransaction().rollback();
    throw e; // or display error message
}
finally {
    sess.close();
}</PRE>
<P>&#27880;&#24847;<TT class=literal>setTimeout()</TT>&#19981;&#24212;&#35813;&#22312;CMT bean&#20013;&#35843;&#29992;&#65292;&#27492;&#26102;&#20107;&#21153;&#36229;&#26102;&#20540;&#24212;&#35813;&#26159;&#34987;&#22768;&#26126;&#24335;&#23450;&#20041;&#30340;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=transactions-optimistic></A>11.3.&nbsp;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;(Optimistic concurrency 
control)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21807;&#19968;&#33021;&#22815;&#21516;&#26102;&#20445;&#25345;&#39640;&#24182;&#21457;&#21644;&#39640;&#21487;&#20280;&#32553;&#24615;&#30340;&#26041;&#27861;&#23601;&#26159;&#20351;&#29992;&#24102;&#29256;&#26412;&#21270;&#30340;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#12290;&#29256;&#26412;&#26816;&#26597;&#20351;&#29992;&#29256;&#26412;&#21495;&#12289; 
&#25110;&#32773;&#26102;&#38388;&#25139;&#26469;&#26816;&#27979;&#26356;&#26032;&#20914;&#31361;&#65288;&#24182;&#19988;&#38450;&#27490;&#26356;&#26032;&#20002;&#22833;&#65289;&#12290;Hibernate&#20026;&#20351;&#29992;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#30340;&#20195;&#30721;&#25552;&#20379;&#20102;&#19977;&#31181;&#21487; 
&#33021;&#30340;&#26041;&#27861;&#65292;&#24212;&#29992;&#31243;&#24207;&#22312;&#32534;&#20889;&#36825;&#20123;&#20195;&#30721;&#26102;&#65292;&#21487;&#20197;&#37319;&#29992;&#23427;&#20204;&#12290;&#25105;&#20204;&#24050;&#32463;&#22312;&#21069;&#38754;&#24212;&#29992;&#31243;&#24207;&#23545;&#35805;&#37027;&#37096;&#20998;&#23637;&#31034;&#20102; 
&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#30340;&#24212;&#29992;&#22330;&#26223;&#65292;&#27492;&#22806;&#65292;&#22312;&#21333;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#33539;&#22260;&#20869;&#65292;&#29256;&#26412;&#26816;&#26597;&#20063;&#25552;&#20379;&#20102;&#38450;&#27490;&#26356;&#26032;&#20002;&#22833;&#30340;&#22909;&#22788;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-optimistic-manual></A>11.3.1.&nbsp;&#24212;&#29992;&#31243;&#24207;&#32423;&#21035;&#30340;&#29256;&#26412;&#26816;&#26597;(Application 
version checking)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26410;&#33021;&#20805;&#20998;&#21033;&#29992;Hibernate&#21151;&#33021;&#30340;&#23454;&#29616;&#20195;&#30721;&#20013;&#65292;&#27599;&#27425;&#21644;&#25968;&#25454;&#24211;&#20132;&#20114;&#37117;&#38656;&#35201;&#19968;&#20010;&#26032;&#30340; <TT 
class=literal>Session</TT>&#65292;&#32780;&#19988;&#24320;&#21457;&#20154;&#21592;&#24517;&#39035;&#22312;&#26174;&#31034;&#25968;&#25454;&#20043;&#21069;&#20174;&#25968;&#25454;&#24211;&#20013;&#37325; 
&#26032;&#36733;&#20837;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#23454;&#20363;&#12290;&#36825;&#31181;&#26041;&#24335;&#36843;&#20351;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#23454;&#29616;&#29256;&#26412;&#26816;&#26597;&#26469;&#30830;&#20445; &#23545;&#35805;&#20107;&#21153;&#30340;&#38548;&#31163;&#65292;&#20174;&#25968;&#25454;&#35775;&#38382;&#30340;&#35282;&#24230;&#26469;&#35828;&#26159;&#26368;&#20302;&#25928;&#30340;&#12290;&#36825;&#31181;&#20351;&#29992;&#26041;&#24335;&#21644; entity 
EJB&#26368;&#30456;&#20284;&#12290; </P><PRE class=programlisting>// foo is an instance loaded by a previous Session
session = factory.openSession();
Transaction t = session.beginTransaction();

int oldVersion = foo.getVersion();
session.load( foo, foo.getKey() ); // load the current state
if ( oldVersion!=foo.getVersion ) throw new StaleObjectStateException();
foo.setProperty("bar");

t.commit();
session.close();</PRE>
<P><TT class=literal>version</TT> &#23646;&#24615;&#20351;&#29992; <TT 
class=literal>&lt;version&gt;</TT>&#26469;&#26144;&#23556;&#65292;&#22914;&#26524;&#23545;&#35937; &#26159;&#33039;&#25968;&#25454;&#65292;&#22312;&#21516;&#27493;&#30340;&#26102;&#20505;&#65292;Hibernate&#20250;&#33258;&#21160;&#22686;&#21152;&#29256;&#26412;&#21495;&#12290; </P>
<P>&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#26159;&#22312;&#19968;&#20010;&#20302;&#25968;&#25454;&#24182;&#21457;&#29615;&#22659;&#19979;&#65292;&#24182;&#19981;&#38656;&#35201;&#29256;&#26412;&#26816;&#26597;&#30340;&#35805;&#65292;&#20320;&#29031;&#26679;&#21487;&#20197;&#20351;&#29992; &#36825;&#31181;&#26041;&#24335;&#65292;&#21482;&#19981;&#36807;&#36339;&#36807;&#29256;&#26412;&#26816;&#26597;&#23601;&#26159;&#20102;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;<SPAN 
class=emphasis><EM>&#26368;&#26202;&#25552;&#20132;&#29983;&#25928;</EM></SPAN> &#65288;<SPAN class=emphasis><EM>last commit 
wins</EM></SPAN>&#65289;&#23601;&#26159;&#20320;&#30340;&#38271;&#23545;&#35805;&#30340;&#40664;&#35748;&#22788;&#29702;&#31574;&#30053;&#12290; &#35831;&#35760;&#20303;&#36825;&#31181;&#31574;&#30053;&#21487;&#33021;&#20250;&#35753;&#24212;&#29992;&#36719;&#20214;&#30340;&#29992;&#25143;&#24863;&#21040;&#22256;&#24785;&#65292;&#22240;&#20026;&#20182;&#20204;&#26377;&#21487;&#33021;&#20250;&#30896;&#19978;&#26356;&#26032;&#20002;&#22833;&#25481;&#21364;&#27809; 
&#26377;&#20986;&#38169;&#20449;&#24687;&#65292;&#25110;&#32773;&#38656;&#35201;&#21512;&#24182;&#26356;&#25913;&#20914;&#31361;&#30340;&#24773;&#20917;&#12290; </P>
<P>&#24456;&#26126;&#26174;&#65292;&#25163;&#24037;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#21482;&#36866;&#21512;&#20110;&#26576;&#20123;&#36719;&#20214;&#35268;&#27169;&#38750;&#24120;&#23567;&#30340;&#24212;&#29992;&#22330;&#26223;&#65292;&#23545;&#20110;&#22823;&#22810;&#25968;&#36719;&#20214;&#24212;&#29992;&#22330;&#26223; 
&#26469;&#35828;&#24182;&#19981;&#29616;&#23454;&#12290;&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#19981;&#20165;&#26159;&#21333;&#20010;&#23545;&#35937;&#23454;&#20363;&#38656;&#35201;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#65292;&#25972;&#20010;&#34987;&#20462;&#25913;&#36807;&#30340;&#20851; &#32852;&#23545;&#35937;&#22270;&#20063;&#37117;&#38656;&#35201;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#12290;&#20316;&#20026;&#26631;&#20934;&#35774;&#35745;&#33539;&#20363;&#65292;Hibernate&#20351;&#29992;&#25193;&#23637;&#21608;&#26399;&#30340; 
<TT class=literal>Session</TT>&#30340;&#26041;&#24335;&#65292;&#25110;&#32773;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363;&#30340;&#26041;&#24335;&#26469;&#25552;&#20379;&#33258;&#21160;&#29256;&#26412;&#26816;&#26597;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-optimistic-longsession></A>11.3.2.&nbsp;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21333;&#20010; <TT class=literal>Session</TT>&#23454;&#20363;&#21644;&#23427;&#25152;&#20851;&#32852;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#23545;&#35937;&#23454;&#20363;&#37117;&#34987;&#29992;&#20110;&#25972;&#20010; &#23545;&#35805;&#65292;&#36825;&#34987;&#31216;&#20026;<SPAN 
class=emphasis><EM>session-per-conversation</EM></SPAN>&#12290;Hibernate&#22312;&#21516;&#27493;&#30340;&#26102;&#20505;&#36827;&#34892;&#23545;&#35937;&#23454;&#20363;&#30340;&#29256;&#26412;&#26816;&#26597;&#65292;&#22914;&#26524;&#26816;&#27979;&#21040;&#24182;&#21457;&#20462; 
&#25913;&#21017;&#25243;&#20986;&#24322;&#24120;&#12290;&#30001;&#24320;&#21457;&#20154;&#21592;&#26469;&#20915;&#23450;&#26159;&#21542;&#38656;&#35201;&#25429;&#33719;&#21644;&#22788;&#29702;&#36825;&#20010;&#24322;&#24120;&#65288;&#36890;&#24120;&#30340;&#25225;&#25321;&#26159;&#32473;&#29992;&#25143; &#25552;&#20379;&#19968;&#20010;&#21512;&#24182;&#26356;&#25913;&#65292;&#25110;&#32773;&#22312;&#26080;&#33039;&#25968;&#25454;&#24773;&#20917;&#19979;&#37325;&#26032;&#36827;&#34892;&#19994;&#21153;&#23545;&#35805;&#30340;&#26426;&#20250;&#65289;&#12290; </P>
<P>&#22312;&#31561;&#24453;&#29992;&#25143;&#20132;&#20114;&#30340;&#26102;&#20505;&#65292; <TT class=literal>Session</TT> &#26029;&#24320;&#24213;&#23618;&#30340;JDBC&#36830;&#25509;&#12290;&#36825;&#31181;&#26041;&#24335; 
&#20197;&#25968;&#25454;&#24211;&#35775;&#38382;&#30340;&#35282;&#24230;&#26469;&#35828;&#26159;&#26368;&#39640;&#25928;&#30340;&#26041;&#24335;&#12290;&#24212;&#29992;&#31243;&#24207;&#19981;&#38656;&#35201;&#20851;&#24515;&#29256;&#26412;&#26816;&#26597;&#25110;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363; &#30340;&#37325;&#26032;&#20851;&#32852;&#65292;&#22312;&#27599;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#20013;&#65292;&#24212;&#29992;&#31243;&#24207;&#20063;&#19981;&#38656;&#35201;&#36733;&#20837;&#35835;&#21462;&#23545;&#35937;&#23454;&#20363;&#12290; </P><PRE class=programlisting>// foo is an instance loaded earlier by the old session
Transaction t = session.beginTransaction(); // Obtain a new JDBC connection, start transaction

foo.setProperty("bar");

session.flush();    // Only for last transaction in conversation
t.commit();         // Also return JDBC connection
session.close();    // Only for last transaction in conversation</PRE>
<P><TT class=literal>foo</TT>&#23545;&#35937;&#30693;&#36947;&#23427;&#26159;&#22312;&#21738;&#20010;<TT 
class=literal>Session</TT>&#20013;&#34987;&#35013;&#20837;&#30340;&#12290;&#22312;&#19968;&#20010;&#26087;session&#20013;&#24320;&#21551;&#19968;&#20010;&#26032;&#30340;&#25968;&#25454;&#24211;&#20107;&#21153;&#65292;&#20250;&#23548;&#33268;session&#33719;&#21462;&#19968;&#20010;&#26032;&#30340;&#36830;&#25509;&#65292;&#24182;&#24674;&#22797;session&#30340;&#21151;&#33021;&#12290;&#23558;&#25968;&#25454;&#24211;&#20107;&#21153;&#25552;&#20132;&#65292;&#20351;&#24471;session&#20174;JDBC&#36830;&#25509;&#26029;&#24320;&#65292;&#24182;&#23558;&#27492;&#36830;&#25509;&#20132;&#36824;&#32473;&#36830;&#25509;&#27744;&#12290;&#22312;&#37325;&#26032;&#36830;&#25509;&#20043;&#21518;&#65292;&#35201;&#24378;&#21046;&#23545;&#20320;&#27809;&#26377;&#26356;&#26032;&#30340;&#25968;&#25454;&#36827;&#34892;&#19968;&#27425;&#29256;&#26412;&#26816;&#26597;&#65292;&#20320;&#21487;&#20197;&#23545;&#25152;&#26377;&#21487;&#33021;&#34987;&#20854;&#20182;&#20107;&#21153;&#20462;&#25913;&#36807;&#30340;&#23545;&#35937;&#65292;&#20351;&#29992;&#21442;&#25968;<TT 
class=literal>LockMode.READ</TT>&#26469;&#35843;&#29992;<TT 
class=literal>Session.lock()</TT>&#12290;&#20320;&#19981;&#29992;lock&#20219;&#20309;&#20320;<SPAN 
class=emphasis><EM>&#27491;&#22312;</EM></SPAN>&#26356;&#26032;&#30340;&#25968;&#25454;&#12290;&#19968;&#33324;&#20320;&#20250;&#22312;&#25193;&#23637;&#30340;<TT 
class=literal>Session</TT>&#19978;&#35774;&#32622;<TT 
class=literal>FlushMode.NEVER</TT>&#65292;&#22240;&#27492;&#21482;&#26377;&#26368;&#21518;&#19968;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#24490;&#29615;&#25165;&#20250;&#30495;&#27491;&#30340;&#21543;&#25972;&#20010;&#23545;&#35805;&#20013;&#21457;&#29983;&#30340;&#20462;&#25913;&#21457;&#36865;&#21040;&#25968;&#25454;&#24211;&#12290;&#22240;&#27492;&#65292;&#21482;&#26377;&#36825;&#26368;&#21518;&#19968;&#27425;&#25968;&#25454;&#24211;&#20107;&#21153;&#25165;&#20250;&#21253;&#21547;<TT 
class=literal>flush()</TT>&#25805;&#20316;&#65292;&#28982;&#21518;&#22312;&#25972;&#20010;&#23545;&#35805;&#32467;&#26463;&#21518;&#65292;&#36824;&#35201;<TT 
class=literal>close()</TT>&#36825;&#20010;session&#12290; </P>
<P>&#22914;&#26524;&#22312;&#29992;&#25143;&#24605;&#32771;&#30340;&#36807;&#31243;&#20013;&#65292;<TT class=literal>Session</TT>&#22240;&#20026;&#22826;&#22823;&#20102;&#32780;&#19981;&#33021;&#20445;&#23384;&#65292;&#37027;&#20040;&#36825;&#31181;&#27169;&#24335;&#26159;&#26377; &#38382;&#39064;&#30340;&#12290;&#20030;&#20363;&#26469;&#35828;&#65292;&#19968;&#20010;<TT 
class=literal>HttpSession</TT>&#24212;&#35813;&#23613;&#21487;&#33021;&#30340;&#23567;&#12290;&#30001;&#20110; <TT 
class=literal>Session</TT>&#26159;&#19968;&#32423;&#32531;&#23384;&#65292;&#24182;&#19988;&#20445;&#25345;&#20102;&#25152;&#26377;&#34987;&#36733;&#20837;&#36807;&#30340;&#23545;&#35937;&#65292;&#22240;&#27492; 
&#25105;&#20204;&#21482;&#24212;&#35813;&#22312;&#37027;&#20123;&#23569;&#37327;&#30340;request/response&#24773;&#20917;&#19979;&#20351;&#29992;&#36825;&#31181;&#31574;&#30053;&#12290;&#20320;&#24212;&#35813;&#21482;&#25226;&#19968;&#20010;<TT 
class=literal>Session</TT>&#29992;&#20110;&#21333;&#20010;&#23545;&#35805;&#65292;&#22240;&#20026;&#23427;&#24456;&#24555;&#23601;&#20250;&#20986;&#29616;&#33039;&#25968;&#25454;&#12290; </P>
<P>&#65288;&#27880;&#24847;&#65292;&#26089;&#26399;&#30340;Hibernate&#29256;&#26412;&#38656;&#35201;&#26126;&#30830;&#30340;&#23545;<TT 
class=literal>Session</TT>&#36827;&#34892;disconnec&#21644;reconnect&#12290;&#36825;&#20123;&#26041;&#27861;&#29616;&#22312;&#24050;&#32463;&#36807;&#26102;&#20102;&#65292;&#25171;&#24320;&#20107;&#21153;&#21644;&#20851;&#38381;&#20107;&#21153;&#20250;&#36215;&#21040;&#21516;&#26679;&#30340;&#25928;&#26524;&#12290;&#65289; 
</P>
<P>&#27492;&#22806;&#65292;&#20063;&#35831;&#27880;&#24847;&#65292;&#20320;&#24212;&#35813;&#35753;&#19982;&#25968;&#25454;&#24211;&#36830;&#25509;&#26029;&#24320;&#30340;<TT class=literal>Session</TT>&#23545;&#25345;&#20037;&#23618;&#20445;&#25345; 
&#20851;&#38381;&#29366;&#24577;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#22312;&#19977;&#23618;&#29615;&#22659;&#20013;&#65292;&#20351;&#29992;&#26377;&#29366;&#24577;&#30340;EJB session bean&#26469;&#25345;&#26377;<TT class=literal>Session</TT>&#65292; 
&#32780;&#19981;&#35201;&#25226;&#23427;&#20256;&#36882;&#21040;web&#23618;&#65288;&#29978;&#33267;&#25226;&#23427;&#24207;&#21015;&#21270;&#21040;&#19968;&#20010;&#21333;&#29420;&#30340;&#23618;&#65289;&#65292;&#20445;&#23384;&#22312;<TT class=literal>HttpSession</TT>&#20013;&#12290; </P>
<P>&#25193;&#23637;session&#27169;&#24335;&#65292;&#25110;&#32773;&#34987;&#31216;&#20026;<SPAN 
class=emphasis><EM>&#27599;&#27425;&#23545;&#35805;&#19968;&#20010;session(session-per-conversation)</EM></SPAN>, 
&#22312;&#19982;&#33258;&#21160;&#31649;&#29702;&#24403;&#21069;session&#19978;&#19979;&#25991;&#32852;&#29992;&#30340;&#26102;&#20505;&#20250;&#26356;&#22256;&#38590;&#12290;&#20320;&#38656;&#35201;&#25552;&#20379;&#20320;&#33258;&#24049;&#30340;<TT 
class=literal>CurrentSessionContext</TT>&#23454;&#29616;&#12290;&#35831;&#21442;&#38405;Hibernate Wiki&#20197;&#33719;&#24471;&#31034;&#20363;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-optimistic-detached></A>11.3.3.&nbsp;&#33073;&#31649;&#23545;&#35937;(deatched 
object)&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#31181;&#26041;&#24335;&#19979;&#65292;&#19982;&#25345;&#20037;&#21270;&#23384;&#20648;&#30340;&#27599;&#27425;&#20132;&#20114;&#37117;&#21457;&#29983;&#22312;&#19968;&#20010;&#26032;&#30340;<TT class=literal>Session</TT>&#20013;&#12290; 
&#28982;&#32780;&#65292;&#21516;&#19968;&#25345;&#20037;&#21270;&#23545;&#35937;&#23454;&#20363;&#21487;&#20197;&#22312;&#22810;&#27425;&#19982;&#25968;&#25454;&#24211;&#30340;&#20132;&#20114;&#20013;&#37325;&#29992;&#12290;&#24212;&#29992;&#31243;&#24207;&#25805;&#32437;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363; &#30340;&#29366;&#24577;&#65292;&#36825;&#20010;&#33073;&#31649;&#23545;&#35937;&#23454;&#20363;&#26368;&#21021;&#26159;&#22312;&#21478;&#19968;&#20010;<TT 
class=literal>Session</TT> &#20013;&#36733;&#20837;&#30340;&#65292;&#28982;&#21518; &#35843;&#29992; <TT 
class=literal>Session.update()</TT>&#65292;<TT 
class=literal>Session.saveOrUpdate()</TT>, &#25110;&#32773; <TT 
class=literal>Session.merge()</TT> &#26469;&#37325;&#26032;&#20851;&#32852;&#35813;&#23545;&#35937;&#23454;&#20363;&#12290; </P><PRE class=programlisting>// foo is an instance loaded by a previous Session
foo.setProperty("bar");
session = factory.openSession();
Transaction t = session.beginTransaction();
session.saveOrUpdate(foo); // Use merge() if "foo" might have been loaded already
t.commit();
session.close();</PRE>
<P>Hibernate&#20250;&#20877;&#19968;&#27425;&#22312;&#21516;&#27493;&#30340;&#26102;&#20505;&#26816;&#26597;&#23545;&#35937;&#23454;&#20363;&#30340;&#29256;&#26412;&#65292;&#22914;&#26524;&#21457;&#29983;&#26356;&#26032;&#20914;&#31361;&#65292;&#23601;&#25243;&#20986;&#24322;&#24120;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#30830;&#20449;&#23545;&#35937;&#27809;&#26377;&#34987;&#20462;&#25913;&#36807;&#65292;&#20320;&#20063;&#21487;&#20197;&#35843;&#29992;<TT class=literal>lock()</TT> &#26469;&#35774;&#32622; <TT 
class=literal>LockMode.READ</TT>&#65288;&#32469;&#36807;&#25152;&#26377;&#30340;&#32531;&#23384;&#65292;&#25191;&#34892;&#29256;&#26412;&#26816;&#26597;&#65289;&#65292;&#20174;&#32780;&#21462; &#20195; <TT 
class=literal>update()</TT>&#25805;&#20316;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=transactions-optimistic-customizing></A>11.3.4.&nbsp;&#23450;&#21046;&#33258;&#21160;&#29256;&#26412;&#21270;&#34892;&#20026;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;&#29305;&#23450;&#30340;&#23646;&#24615;&#21644;&#38598;&#21512;&#65292;&#36890;&#36807;&#20026;&#23427;&#20204;&#35774;&#32622;&#26144;&#23556;&#23646;&#24615;<TT class=literal>optimistic-lock</TT>&#30340;&#20540; &#20026;<TT 
class=literal>false</TT>&#65292;&#26469;&#31105;&#27490;Hibernate&#30340;&#29256;&#26412;&#33258;&#21160;&#22686;&#21152;&#12290;&#36825;&#26679;&#30340;&#35805;&#65292;&#22914;&#26524;&#35813;&#23646;&#24615; &#33039;&#25968;&#25454;&#65292;Hibernate&#23558;&#19981;&#20877;&#22686;&#21152;&#29256;&#26412;&#21495;&#12290; 
</P>
<P>&#36951;&#30041;&#31995;&#32479;&#30340;&#25968;&#25454;&#24211;Schema&#36890;&#24120;&#26159;&#38745;&#24577;&#30340;&#65292;&#19981;&#21487;&#20462;&#25913;&#30340;&#12290;&#25110;&#32773;&#65292;&#20854;&#20182;&#24212;&#29992;&#31243;&#24207;&#20063;&#21487;&#33021;&#35775;&#38382;&#21516;&#19968;&#25968;&#25454; 
&#24211;&#65292;&#26681;&#26412;&#26080;&#27861;&#24471;&#30693;&#22914;&#20309;&#22788;&#29702;&#29256;&#26412;&#21495;&#65292;&#29978;&#33267;&#26102;&#38388;&#25139;&#12290;&#22312;&#20197;&#19978;&#30340;&#25152;&#26377;&#22330;&#26223;&#20013;&#65292;&#23454;&#29616;&#29256;&#26412;&#21270;&#19981;&#33021;&#20381;&#38752; &#25968;&#25454;&#24211;&#34920;&#30340;&#26576;&#20010;&#29305;&#23450;&#21015;&#12290;&#22312;<TT 
class=literal>&lt;class&gt;</TT>&#30340;&#26144;&#23556;&#20013;&#35774;&#32622; <TT 
class=literal>optimistic-lock="all"</TT>&#21487;&#20197;&#22312;&#27809;&#26377;&#29256;&#26412;&#25110;&#32773;&#26102;&#38388;&#25139;&#23646;&#24615;&#26144;&#23556;&#30340;&#24773;&#20917;&#19979;&#23454;&#29616; 
&#29256;&#26412;&#26816;&#26597;&#65292;&#27492;&#26102;Hibernate&#23558;&#27604;&#36739;&#19968;&#34892;&#35760;&#24405;&#30340;&#27599;&#20010;&#23383;&#27573;&#30340;&#29366;&#24577;&#12290;&#35831;&#27880;&#24847;&#65292;&#21482;&#26377;&#24403;Hibernate&#33021;&#22815;&#27604; &#36739;&#26032;&#26087;&#29366;&#24577;&#30340;&#24773;&#20917;&#19979;&#65292;&#36825;&#31181;&#26041;&#24335;&#25165;&#33021;&#29983;&#25928;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292; 
&#20320;&#24517;&#39035;&#20351;&#29992;&#21333;&#20010;&#38271;&#29983;&#21629;&#21608;&#26399;<TT class=literal>Session</TT>&#27169;&#24335;&#65292;&#32780;&#19981;&#33021;&#20351;&#29992; 
session-per-request-with-detached-objects&#27169;&#24335;&#12290; </P>
<P>&#26377;&#20123;&#24773;&#20917;&#19979;&#65292;&#21482;&#35201;&#26356;&#25913;&#19981;&#21457;&#29983;&#20132;&#38169;&#65292;&#24182;&#21457;&#20462;&#25913;&#20063;&#26159;&#20801;&#35768;&#30340;&#12290;&#24403;&#20320;&#22312;<TT class=literal>&lt;class&gt;</TT> &#30340;&#26144;&#23556;&#20013;&#35774;&#32622;<TT 
class=literal>optimistic-lock="dirty"</TT>&#65292;Hibernate&#22312;&#21516;&#27493;&#30340;&#26102;&#20505;&#23558;&#21482;&#27604;&#36739;&#26377;&#33039; &#25968;&#25454;&#30340;&#23383;&#27573;&#12290; </P>
<P>&#22312;&#20197;&#19978;&#25152;&#26377;&#22330;&#26223;&#20013;&#65292;&#19981;&#31649;&#26159;&#19987;&#38376;&#35774;&#32622;&#19968;&#20010;&#29256;&#26412;/&#26102;&#38388;&#25139;&#21015;&#65292;&#36824;&#26159;&#36827;&#34892;&#20840;&#37096;&#23383;&#27573;/&#33039;&#25968;&#25454;&#23383;&#27573;&#27604;&#36739;&#65292; Hibernate&#37117;&#20250;&#38024;&#23545;&#27599;&#20010;&#23454;&#20307;&#23545;&#35937;&#21457;&#36865;&#19968;&#26465;<TT 
class=literal>UPDATE</TT>&#65288;&#24102;&#26377;&#30456;&#24212;&#30340; <TT class=literal>WHERE</TT>&#35821;&#21477; 
&#65289;&#30340;SQL&#35821;&#21477;&#26469;&#25191;&#34892;&#29256;&#26412;&#26816;&#26597;&#21644;&#25968;&#25454;&#26356;&#26032;&#12290;&#22914;&#26524;&#20320;&#23545;&#20851;&#32852;&#23454;&#20307; &#35774;&#32622;&#32423;&#32852;&#20851;&#31995;&#20351;&#29992;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;&#65288;transitive 
persistence&#65289;&#65292;&#37027;&#20040;Hibernate&#21487;&#33021;&#20250;&#25191;&#34892;&#19981;&#24517; &#35201;&#30340;update&#35821;&#21477;&#12290;&#36825;&#36890;&#24120;&#19981;&#26159;&#20010;&#38382;&#39064;&#65292;&#20294;&#26159;&#25968;&#25454;&#24211;&#37324;&#38754;&#23545;<SPAN 
class=emphasis><EM>on update</EM></SPAN>&#28857;&#28779; &#30340;&#35302;&#21457;&#22120;&#21487;&#33021;&#22312;&#33073;&#31649;&#23545;&#35937;&#27809;&#26377;&#20219;&#20309;&#26356;&#25913;&#30340;&#24773;&#20917;&#19979;&#34987;&#35302;&#21457;&#12290;&#22240;&#27492;&#65292;&#20320;&#21487;&#20197;&#22312; <TT 
class=literal>&lt;class&gt;</TT>&#30340;&#26144;&#23556;&#20013;&#65292;&#36890;&#36807;&#35774;&#32622;<TT 
class=literal>select-before-update="true"</TT> &#26469;&#23450;&#21046;&#36825;&#19968;&#34892;&#20026;&#65292;&#24378;&#21046;Hibernate <TT 
class=literal>SELECT</TT>&#36825;&#20010;&#23545;&#35937;&#23454;&#20363;&#65292;&#20174;&#32780;&#20445;&#35777;&#65292; &#22312;&#26356;&#26032;&#35760;&#24405;&#20043;&#21069;&#65292;&#23545;&#35937;&#30340;&#30830;&#26159;&#34987;&#20462;&#25913;&#36807;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=transactions-locking></A>11.4.&nbsp;&#24754;&#35266;&#38145;&#23450;(Pessimistic 
Locking)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#29992;&#25143;&#20854;&#23454;&#24182;&#19981;&#38656;&#35201;&#33457;&#24456;&#22810;&#31934;&#21147;&#21435;&#25285;&#24515;&#38145;&#23450;&#31574;&#30053;&#30340;&#38382;&#39064;&#12290;&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#21482;&#35201;&#20026;JDBC&#36830;&#25509;&#25351;&#23450;&#19968;&#19979;&#38548; 
&#31163;&#32423;&#21035;&#65292;&#28982;&#21518;&#35753;&#25968;&#25454;&#24211;&#21435;&#25630;&#23450;&#19968;&#20999;&#23601;&#22815;&#20102;&#12290;&#28982;&#32780;&#65292;&#39640;&#32423;&#29992;&#25143;&#26377;&#26102;&#20505;&#24076;&#26395;&#36827;&#34892;&#19968;&#20010;&#25490;&#23427;&#30340;&#24754;&#35266;&#38145;&#23450;&#65292; &#25110;&#32773;&#22312;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#21551;&#21160;&#30340;&#26102;&#20505;&#65292;&#37325;&#26032;&#36827;&#34892;&#38145;&#23450;&#12290; </P>
<P>Hibernate&#24635;&#26159;&#20351;&#29992;&#25968;&#25454;&#24211;&#30340;&#38145;&#23450;&#26426;&#21046;&#65292;&#20174;&#19981;&#22312;&#20869;&#23384;&#20013;&#38145;&#23450;&#23545;&#35937;&#65281; </P>
<P>&#31867;<TT class=literal>LockMode</TT> &#23450;&#20041;&#20102;Hibernate&#25152;&#38656;&#30340;&#19981;&#21516;&#30340;&#38145;&#23450;&#32423;&#21035;&#12290;&#19968;&#20010;&#38145;&#23450; &#21487;&#20197;&#36890;&#36807;&#20197;&#19979;&#30340;&#26426;&#21046;&#26469;&#35774;&#32622;: 
</P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#24403;Hibernate&#26356;&#26032;&#25110;&#32773;&#25554;&#20837;&#19968;&#34892;&#35760;&#24405;&#30340;&#26102;&#20505;&#65292;&#38145;&#23450;&#32423;&#21035;&#33258;&#21160;&#35774;&#32622;&#20026;<TT class=literal>LockMode.WRITE</TT>&#12290; 
</P>
  <LI>
  <P>&#24403;&#29992;&#25143;&#26174;&#24335;&#30340;&#20351;&#29992;&#25968;&#25454;&#24211;&#25903;&#25345;&#30340;SQL&#26684;&#24335;<TT class=literal>SELECT ... FOR UPDATE</TT> 
  &#21457;&#36865;SQL&#30340;&#26102;&#20505;&#65292;&#38145;&#23450;&#32423;&#21035;&#35774;&#32622;&#20026;<TT class=literal>LockMode.UPGRADE</TT> </P>
  <LI>
  <P>&#24403;&#29992;&#25143;&#26174;&#24335;&#30340;&#20351;&#29992;Oracle&#25968;&#25454;&#24211;&#30340;SQL&#35821;&#21477;<TT class=literal>SELECT ... FOR UPDATE NOWAIT</TT> 
  &#30340;&#26102;&#20505;&#65292;&#38145;&#23450;&#32423;&#21035;&#35774;&#32622;<TT class=literal>LockMode.UPGRADE_NOWAIT</TT> </P>
  <LI>
  <P>&#24403;Hibernate&#22312;“&#21487;&#37325;&#22797;&#35835;”&#25110;&#32773;&#26159;“&#24207;&#21015;&#21270;”&#25968;&#25454;&#24211;&#38548;&#31163;&#32423;&#21035;&#19979;&#35835;&#21462;&#25968;&#25454;&#30340;&#26102;&#20505;&#65292;&#38145;&#23450;&#27169;&#24335; &#33258;&#21160;&#35774;&#32622;&#20026;<TT 
  class=literal>LockMode.READ</TT>&#12290;&#36825;&#31181;&#27169;&#24335;&#20063;&#21487;&#20197;&#36890;&#36807;&#29992;&#25143;&#26174;&#24335;&#25351;&#23450;&#36827;&#34892;&#35774;&#32622;&#12290; </P>
  <LI>
  <P><TT class=literal>LockMode.NONE</TT> &#20195;&#34920;&#26080;&#38656;&#38145;&#23450;&#12290;&#22312;<TT 
  class=literal>Transaction</TT>&#32467;&#26463;&#26102;&#65292; &#25152;&#26377;&#30340;&#23545;&#35937;&#37117;&#20999;&#25442;&#21040;&#35813;&#27169;&#24335;&#19978;&#26469;&#12290;&#19982;session&#30456;&#20851;&#32852;&#30340;&#23545;&#35937;&#36890;&#36807;&#35843;&#29992;<TT 
  class=literal>update()</TT> &#25110;&#32773;<TT class=literal>saveOrUpdate()</TT>&#33073;&#31163;&#35813;&#27169;&#24335;&#12290; 
  </P></LI></UL></DIV>
<P>"&#26174;&#24335;&#30340;&#29992;&#25143;&#25351;&#23450;"&#21487;&#20197;&#36890;&#36807;&#20197;&#19979;&#20960;&#31181;&#26041;&#24335;&#20043;&#19968;&#26469;&#34920;&#31034;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#35843;&#29992; <TT class=literal>Session.load()</TT>&#30340;&#26102;&#20505;&#25351;&#23450;<TT 
  class=literal>&#38145;&#23450;&#27169;&#24335;(LockMode)</TT>&#12290; </P>
  <LI>
  <P>&#35843;&#29992;<TT class=literal>Session.lock()</TT>&#12290; </P>
  <LI>
  <P>&#35843;&#29992;<TT class=literal>Query.setLockMode()</TT>&#12290; </P></LI></UL></DIV>
<P>&#22914;&#26524;&#22312;<TT class=literal>UPGRADE</TT>&#25110;&#32773;<TT 
class=literal>UPGRADE_NOWAIT</TT>&#38145;&#23450;&#27169;&#24335;&#19979;&#35843; &#29992;<TT 
class=literal>Session.load()</TT>&#65292;&#24182;&#19988;&#35201;&#35835;&#21462;&#30340;&#23545;&#35937;&#23578;&#26410;&#34987;session&#36733;&#20837;&#36807;&#65292;&#37027;&#20040;&#23545;&#35937; &#36890;&#36807;<TT 
class=literal>SELECT ... FOR UPDATE</TT>&#36825;&#26679;&#30340;SQL&#35821;&#21477;&#34987;&#36733;&#20837;&#12290;&#22914;&#26524;&#20026;&#19968;&#20010;&#23545;&#35937;&#35843;&#29992; <TT 
class=literal>load()</TT>&#26041;&#27861;&#26102;&#65292;&#35813;&#23545;&#35937;&#24050;&#32463;&#22312;&#21478;&#19968;&#20010;&#36739;&#23569;&#38480;&#21046;&#30340;&#38145;&#23450;&#27169;&#24335;&#19979;&#34987;&#36733;&#20837;&#20102;&#65292;&#37027; &#20040;Hibernate&#23601;&#23545;&#35813;&#23545;&#35937;&#35843;&#29992;<TT 
class=literal>lock()</TT> &#26041;&#27861;&#12290; </P>
<P>&#22914;&#26524;&#25351;&#23450;&#30340;&#38145;&#23450;&#27169;&#24335;&#26159;<TT class=literal>READ</TT>, <TT class=literal>UPGRADE</TT> &#25110; <TT 
class=literal>UPGRADE_NOWAIT</TT>&#65292;&#37027;&#20040;<TT class=literal>Session.lock()</TT>&#23601; 
&#25191;&#34892;&#29256;&#26412;&#21495;&#26816;&#26597;&#12290;&#65288;&#22312;<TT class=literal>UPGRADE</TT> &#25110;&#32773;<TT class=literal>UPGRADE_NOWAIT</TT> 
&#38145;&#23450;&#27169;&#24335;&#19979;&#65292;&#25191;&#34892;<TT class=literal>SELECT ... FOR UPDATE</TT>&#36825;&#26679;&#30340;SQL&#35821;&#21477;&#12290;&#65289; </P>
<P>&#22914;&#26524;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#29992;&#25143;&#35774;&#32622;&#30340;&#38145;&#23450;&#27169;&#24335;&#65292;Hibernate&#23558;&#20351;&#29992;&#36866;&#24403;&#30340;&#26367;&#20195;&#27169;&#24335;&#65288;&#32780;&#19981;&#26159;&#25172;&#20986;&#24322;&#24120;&#65289;&#12290; &#36825;&#19968;&#28857;&#21487;&#20197;&#30830;&#20445;&#24212;&#29992;&#31243;&#24207;&#30340;&#21487;&#31227;&#26893;&#24615;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=transactions-connection-release></A>11.5.&nbsp;&#36830;&#25509;&#37322;&#25918;&#27169;&#24335;(Connection Release 
Modes)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20851;&#20110;JDBC&#36830;&#25509;&#31649;&#29702;&#30340;&#26087;(2.x)&#34892;&#20026;&#26159;&#65292;<TT 
class=literal>Session</TT>&#22312;&#31532;&#19968;&#27425;&#38656;&#35201;&#30340;&#26102;&#20505;&#33719;&#21462;&#19968;&#20010;&#36830;&#25509;&#65292;&#22312;session&#20851;&#38381;&#20043;&#21069;&#19968;&#30452;&#20250;&#25345;&#26377;&#36825;&#20010;&#36830;&#25509;&#12290;Hibernate&#24341;&#20837;&#20102;&#36830;&#25509;&#37322;&#25918;&#30340;&#27010;&#24565;&#65292;&#26469;&#21578;&#35785;session&#22914;&#20309;&#22788;&#29702;&#23427;&#30340;JDBC&#36830;&#25509;&#12290;&#27880;&#24847;&#65292;&#19979;&#38754;&#30340;&#35752;&#35770;&#21482;&#36866;&#29992;&#20110;&#37319;&#29992;&#37197;&#32622;<TT 
class=literal>ConnectionProvider</TT>&#26469;&#25552;&#20379;&#36830;&#25509;&#30340;&#24773;&#20917;&#65292;&#29992;&#25143;&#33258;&#24049;&#25552;&#20379;&#30340;&#36830;&#25509;&#19982;&#36825;&#37324;&#30340;&#35752;&#35770;&#26080;&#20851;&#12290;&#36890;&#36807;<TT 
class=literal>org.hibernate.ConnectionReleaseMode</TT>&#30340;&#19981;&#21516;&#26522;&#20030;&#20540;&#26469;&#20351;&#29992;&#19981;&#29992;&#30340;&#37322;&#25918;&#27169;&#24335;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>ON_CLOSE</TT> - &#22522;&#26412;&#19978;&#23601;&#26159;&#19978;&#38754;&#25552;&#21040;&#30340;&#32769;&#24335;&#34892;&#20026;&#12290;Hibernate 
  session&#22312;&#31532;&#19968;&#27425;&#38656;&#35201;&#36827;&#34892;JDBC&#25805;&#20316;&#30340;&#26102;&#20505;&#33719;&#21462;&#36830;&#25509;&#65292;&#28982;&#21518;&#25345;&#26377;&#23427;&#65292;&#30452;&#21040;session&#20851;&#38381;&#12290; </P>
  <LI>
  <P><TT class=literal>AFTER_TRANSACTION</TT> - &#22312;<TT 
  class=literal>org.hibernate.Transaction</TT>&#32467;&#26463;&#21518;&#37322;&#25918;&#36830;&#25509;&#12290; </P>
  <LI>
  <P><TT class=literal>AFTER_STATEMENT</TT> (&#20063;&#34987;&#31216;&#20570;&#31215;&#26497;&#37322;&#25918;) - 
  &#22312;&#27599;&#19968;&#26465;&#35821;&#21477;&#34987;&#25191;&#34892;&#21518;&#23601;&#37322;&#25918;&#36830;&#25509;&#12290;&#20294;&#20551;&#33509;&#35821;&#21477;&#30041;&#19979;&#20102;&#19982;session&#30456;&#20851;&#30340;&#36164;&#28304;&#65292;&#37027;&#23601;&#19981;&#20250;&#34987;&#37322;&#25918;&#12290;&#30446;&#21069;&#21807;&#19968;&#30340;&#36825;&#31181;&#24773;&#24418;&#23601;&#26159;&#20351;&#29992;<TT 
  class=literal>org.hibernate.ScrollableResults</TT>&#12290; </P></LI></UL></DIV>
<P><TT 
class=literal>hibernate.connection.release_mode</TT>&#37197;&#32622;&#21442;&#25968;&#29992;&#26469;&#25351;&#23450;&#20351;&#29992;&#21738;&#19968;&#31181;&#37322;&#25918;&#27169;&#24335;&#12290;&#21487;&#33021;&#30340;&#20540;&#26377;&#65306; 
</P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>auto</TT>(&#40664;&#35748;) - &#36825;&#19968;&#36873;&#25321;&#25226;&#37322;&#25918;&#27169;&#24335;&#22996;&#27966;&#32473;<TT 
  class=literal>org.hibernate.transaction.TransactionFactory.getDefaultReleaseMode()</TT>&#26041;&#27861;&#12290;&#23545;JTATransactionFactory&#26469;&#35828;&#65292;&#23427;&#20250;&#36820;&#22238;ConnectionReleaseMode.AFTER_STATEMENT;&#23545;JDBCTransactionFactory&#26469;&#35828;&#65292;&#21017;&#26159;ConnectionReleaseMode.AFTER_TRANSACTION&#12290;&#24456;&#23569;&#38656;&#35201;&#20462;&#25913;&#36825;&#19968;&#40664;&#35748;&#34892;&#20026;&#65292;&#22240;&#20026;&#20551;&#33509;&#35774;&#32622;&#19981;&#24403;&#65292;&#23601;&#20250;&#24102;&#26469;bug&#65292;&#25110;&#32773;&#32473;&#29992;&#25143;&#20195;&#30721;&#24102;&#26469;&#35823;&#23548;&#12290; 
  </P>
  <LI>
  <P><TT class=literal>on_close</TT> - &#20351;&#29992; ConnectionReleaseMode.ON_CLOSE. 
  &#36825;&#31181;&#26041;&#24335;&#26159;&#20026;&#20102;&#21521;&#19979;&#20860;&#23481;&#30340;,&#20294;&#26159;&#24050;&#32463;&#23436;&#20840;&#19981;&#34987;&#40723;&#21169;&#20351;&#29992;&#20102;&#12290; </P>
  <LI>
  <P><TT class=literal>after_transaction</TT> - 
  &#20351;&#29992;ConnectionReleaseMode.AFTER_TRANSACTION&#12290;&#36825;&#19968;&#35774;&#32622;&#19981;&#24212;&#35813;&#22312;JTA&#29615;&#22659;&#19979;&#20351;&#29992;&#12290;&#20063;&#35201;&#27880;&#24847;&#65292;&#20351;&#29992;ConnectionReleaseMode.AFTER_TRANSACTION&#30340;&#26102;&#20505;&#65292;&#20551;&#33509;session 
  &#22788;&#20110;auto-commit&#29366;&#24577;&#65292;&#36830;&#25509;&#20250;&#20687;AFTER_STATEMENT&#37027;&#26679;&#34987;&#37322;&#25918;&#12290; </P>
  <LI>
  <P><TT class=literal>after_statement</TT> - 
  &#20351;&#29992;ConnectionReleaseMode.AFTER_STATEMENT&#12290;&#38500;&#27492;&#20043;&#22806;&#65292;&#20250;&#26597;&#35810;&#37197;&#32622;&#30340;<TT 
  class=literal>ConnectionProvider</TT>&#65292;&#26159;&#21542;&#23427;&#25903;&#25345;&#36825;&#19968;&#35774;&#32622;&#65288;(<TT 
  class=literal>supportsAggressiveRelease()</TT>)&#65289;&#12290;&#20551;&#33509;&#19981;&#25903;&#25345;&#65292;&#37322;&#25918;&#27169;&#24335;&#20250;&#34987;&#35774;&#32622;&#20026;ConnectionReleaseMode.AFTER_TRANSACTION&#12290;&#21482;&#26377;&#22312;&#20320;&#27599;&#27425;&#35843;&#29992;<TT 
  class=literal>ConnectionProvider.getConnection()</TT>&#33719;&#21462;&#24213;&#23618;JDBC&#36830;&#25509;&#30340;&#26102;&#20505;&#65292;&#37117;&#21487;&#20197;&#30830;&#20449;&#33719;&#24471;&#21516;&#19968;&#20010;&#36830;&#25509;&#30340;&#26102;&#20505;&#65292;&#36825;&#19968;&#35774;&#32622;&#25165;&#26159;&#23433;&#20840;&#30340;&#65307;&#25110;&#32773;&#22312;auto-commit&#29615;&#22659;&#20013;&#65292;&#20320;&#21487;&#20197;&#19981;&#31649;&#26159;&#21542;&#27599;&#27425;&#37117;&#33719;&#24471;&#21516;&#19968;&#20010;&#36830;&#25509;&#30340;&#26102;&#20505;&#65292;&#36825;&#25165;&#26159;&#23433;&#20840;&#30340;&#12290; 
  </P></LI></UL></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=events></A>&#31532;&nbsp;12&nbsp;&#31456;&nbsp; &#25318;&#25130;&#22120;&#19982;&#20107;&#20214;(Interceptors 
and events) </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24212;&#29992;&#31243;&#24207;&#33021;&#22815;&#21709;&#24212;Hibernate&#20869;&#37096;&#20135;&#29983;&#30340;&#29305;&#23450;&#20107;&#20214;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;&#36825;&#26679;&#23601;&#20801;&#35768;&#23454;&#29616;&#26576;&#20123;&#36890;&#29992;&#30340;&#21151;&#33021; &#20197;&#21450;&#20801;&#35768;&#23545;Hibernate&#21151;&#33021;&#36827;&#34892;&#25193;&#23637;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-interceptors></A>12.1.&nbsp; &#25318;&#25130;&#22120;(Interceptors) 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT 
class=literal>Interceptor</TT>&#25509;&#21475;&#25552;&#20379;&#20102;&#20174;&#20250;&#35805;(session)&#22238;&#35843;(callback)&#24212;&#29992;&#31243;&#24207;(application)&#30340;&#26426;&#21046;&#65292; 
&#36825;&#31181;&#22238;&#35843;&#26426;&#21046;&#21487;&#20197;&#20801;&#35768;&#24212;&#29992;&#31243;&#24207;&#22312;&#25345;&#20037;&#21270;&#23545;&#35937;&#34987;&#20445;&#23384;&#12289;&#26356;&#26032;&#12289;&#21024;&#38500;&#25110;&#26159;&#21152;&#36733;&#20043;&#21069;&#65292;&#26816;&#26597;&#24182;&#65288;&#25110;&#65289;&#20462;&#25913;&#20854; 
&#23646;&#24615;&#12290;&#19968;&#20010;&#21487;&#33021;&#30340;&#29992;&#36884;&#65292;&#23601;&#26159;&#29992;&#26469;&#36319;&#36394;&#23457;&#26680;(auditing)&#20449;&#24687;&#12290;&#20363;&#22914;&#65306;&#19979;&#38754;&#30340;&#36825;&#20010;<TT class=literal>&#25318;&#25130;&#22120;</TT>&#65292;&#20250;&#22312;&#19968;&#20010;&#23454;&#29616;&#20102; <TT 
class=literal>Auditable</TT>&#25509;&#21475;&#30340;&#23545;&#35937;&#34987;&#21019;&#24314;&#26102;&#33258;&#21160;&#22320;&#35774;&#32622;<TT 
class=literal>createTimestamp</TT>&#23646;&#24615;&#65292;&#24182;&#22312;&#23454;&#29616;&#20102; <TT 
class=literal>Auditable</TT>&#25509;&#21475;&#30340;&#23545;&#35937;&#34987;&#26356;&#26032;&#26102;&#65292;&#21516;&#27493;&#26356;&#26032;<TT 
class=literal>lastUpdateTimestamp</TT>&#23646;&#24615;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#30452;&#25509;&#23454;&#29616;<TT class=literal>Interceptor</TT>&#25509;&#21475;&#65292;&#20063;&#21487;&#20197;&#65288;&#26368;&#22909;&#65289;&#32487;&#25215;&#33258;<TT 
class=literal>EmptyInterceptor</TT>&#12290; </P><PRE class=programlisting>package org.hibernate.test;

import java.io.Serializable;
import java.util.Date;
import java.util.Iterator;

import org.hibernate.EmptyInterceptor;
import org.hibernate.Transaction;
import org.hibernate.type.Type;

public class AuditInterceptor extends EmptyInterceptor {

    private int updates;
    private int creates;
    private int loads;

    public void onDelete(Object entity,
                         Serializable id,
                         Object[] state,
                         String[] propertyNames,
                         Type[] types) {
        // do nothing
    }

    public boolean onFlushDirty(Object entity,
                                Serializable id,
                                Object[] currentState,
                                Object[] previousState,
                                String[] propertyNames,
                                Type[] types) {

        if ( entity instanceof Auditable ) {
            updates++;
            for ( int i=0; i &lt; propertyNames.length; i++ ) {
                if ( "lastUpdateTimestamp".equals( propertyNames[i] ) ) {
                    currentState[i] = new Date();
                    return true;
                }
            }
        }
        return false;
    }

    public boolean onLoad(Object entity,
                          Serializable id,
                          Object[] state,
                          String[] propertyNames,
                          Type[] types) {
        if ( entity instanceof Auditable ) {
            loads++;
        }
        return false;
    }

    public boolean onSave(Object entity,
                          Serializable id,
                          Object[] state,
                          String[] propertyNames,
                          Type[] types) {

        if ( entity instanceof Auditable ) {
            creates++;
            for ( int i=0; i&lt;propertyNames.length; i++ ) {
                if ( "createTimestamp".equals( propertyNames[i] ) ) {
                    state[i] = new Date();
                    return true;
                }
            }
        }
        return false;
    }

    public void afterTransactionCompletion(Transaction tx) {
        if ( tx.wasCommitted() ) {
            System.out.println("Creations: " + creates + ", Updates: " + updates, "Loads: " + loads);
        }
        updates=0;
        creates=0;
        loads=0;
    }

}</PRE>
<P>&#25318;&#25130;&#22120;&#21487;&#20197;&#26377;&#20004;&#31181;:<TT class=literal>Session</TT>&#33539;&#22260;&#20869;&#30340;&#65292;&#21644;<TT 
class=literal>SessionFactory</TT>&#33539;&#22260;&#20869;&#30340;&#12290; </P>
<P>&#24403;&#20351;&#29992;&#26576;&#20010;&#37325;&#36733;&#30340;SessionFactory.openSession()&#20351;&#29992;<TT 
class=literal>Interceptor</TT>&#20316;&#20026;&#21442;&#25968;&#35843;&#29992;&#25171;&#24320;&#19968;&#20010;session&#30340;&#26102;&#20505;&#65292;&#23601;&#25351;&#23450;&#20102;<TT 
class=literal>Session</TT>&#33539;&#22260;&#20869;&#30340;&#25318;&#25130;&#22120;&#12290; </P><PRE class=programlisting>Session session = sf.openSession( new AuditInterceptor() );</PRE>
<P><TT class=literal>SessionFactory</TT>&#33539;&#22260;&#20869;&#30340;&#25318;&#25130;&#22120;&#35201;&#36890;&#36807;<TT 
class=literal>Configuration</TT>&#20013;&#27880;&#20876;&#65292;&#32780;&#36825;&#24517;&#39035;&#22312;&#21019;&#24314;<TT 
class=literal>SessionFactory</TT>&#20043;&#21069;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#32473;&#20986;&#30340;&#25318;&#25130;&#22120;&#20250;&#34987;&#36825;&#20010;<TT 
class=literal>SessionFactory</TT>&#25152;&#25171;&#24320;&#30340;&#25152;&#26377;session&#20351;&#29992;&#20102;&#65307;&#38500;&#38750;session&#25171;&#24320;&#26102;&#26126;&#30830;&#25351;&#26126;&#20102;&#20351;&#29992;&#30340;&#25318;&#25130;&#22120;&#12290;<TT 
class=literal>SessionFactory</TT>&#33539;&#22260;&#20869;&#30340;&#25318;&#25130;&#22120;&#65292;&#24517;&#39035;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#22240;&#20026;&#22810;&#20010;session&#21487;&#33021;&#24182;&#21457;&#20351;&#29992;&#36825;&#20010;&#25318;&#25130;&#22120;&#65292;&#35201;&#22240;&#27492;&#23567;&#24515;&#19981;&#35201;&#20445;&#23384;&#19982;session&#30456;&#20851;&#30340;&#29366;&#24577;&#12290; 
</P><PRE class=programlisting>new Configuration().setInterceptor( new AuditInterceptor() );</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=objectstate-events></A>12.2.&nbsp; 
&#20107;&#20214;&#31995;&#32479;(Event system) </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#38656;&#35201;&#21709;&#24212;&#25345;&#20037;&#23618;&#30340;&#26576;&#20123;&#29305;&#27530;&#20107;&#20214;&#65292;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;Hibernate3&#30340;&#20107;&#20214;&#26694;&#26550;&#12290; &#35813;&#20107;&#20214;&#31995;&#32479;&#21487;&#20197;&#29992;&#26469;&#26367;&#20195;&#25318;&#25130;&#22120;&#65292;&#20063;&#21487;&#20197;&#20316;&#20026;&#25318;&#25130;&#22120;&#30340;&#34917;&#20805;&#26469;&#20351;&#29992;&#12290; </P>
<P>&#22522;&#26412;&#19978;&#65292;<TT class=literal>Session</TT>&#25509;&#21475;&#30340;&#27599;&#20010;&#26041;&#27861;&#37117;&#26377;&#30456;&#23545;&#24212;&#30340;&#20107;&#20214;&#12290;&#27604;&#22914; <TT 
class=literal>LoadEvent</TT>&#65292;<TT class=literal>FlushEvent</TT>&#65292;&#31561;&#31561;&#65288;&#26597;&#38405;XML&#37197;&#32622;&#25991;&#20214; 
&#30340;DTD&#65292;&#20197;&#21450;<TT class=literal>org.hibernate.event</TT>&#21253;&#26469;&#33719;&#24471;&#25152;&#26377;&#24050;&#23450;&#20041;&#30340;&#20107;&#20214;&#30340;&#21015;&#34920;&#65289;&#12290;&#24403;&#26576;&#20010;&#26041; 
&#27861;&#34987;&#35843;&#29992;&#26102;&#65292;Hibernate <TT class=literal>Session</TT>&#20250;&#29983;&#25104;&#19968;&#20010;&#30456;&#23545;&#24212;&#30340;&#20107;&#20214;&#24182;&#28608;&#27963;&#25152; 
&#26377;&#37197;&#32622;&#22909;&#30340;&#20107;&#20214;&#30417;&#21548;&#22120;&#12290;&#31995;&#32479;&#39044;&#35774;&#30340;&#30417;&#21548;&#22120;&#23454;&#29616;&#30340;&#22788;&#29702;&#36807;&#31243;&#23601;&#26159;&#34987;&#30417;&#21548;&#30340;&#26041;&#27861;&#35201;&#20570;&#30340;&#65288;&#34987;&#30417;&#21548;&#30340;&#26041;&#27861;&#25152;&#20570;&#30340;&#20854;&#23454;&#20165;&#20165;&#26159;&#28608;&#27963;&#30417;&#21548;&#22120;&#65292; 
“&#23454;&#38469;”&#30340;&#24037;&#20316;&#26159;&#30001;&#30417;&#21548;&#22120;&#23436;&#25104;&#30340;&#65289;&#12290;&#19981;&#36807;&#65292;&#20320;&#21487;&#20197;&#33258;&#30001;&#22320;&#36873;&#25321;&#23454;&#29616; &#19968;&#20010;&#33258;&#24049;&#23450;&#21046;&#30340;&#30417;&#21548;&#22120;&#65288;&#27604;&#22914;&#65292;&#23454;&#29616;&#24182;&#27880;&#20876;&#29992;&#26469;&#22788;&#29702;&#22788;&#29702;<TT 
class=literal>LoadEvent</TT>&#30340;<TT class=literal>LoadEventListener</TT>&#25509;&#21475;&#65289;&#65292; 
&#26469;&#36127;&#36131;&#22788;&#29702;&#25152;&#26377;&#30340;&#35843;&#29992;<TT class=literal>Session</TT>&#30340;<TT class=literal>load()</TT>&#26041;&#27861;&#30340;&#35831;&#27714;&#12290; 
</P>
<P>&#30417;&#21548;&#22120;&#24212;&#35813;&#34987;&#30475;&#20316;&#26159;&#21333;&#20363;(singleton)&#23545;&#35937;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#25152;&#26377;&#21516;&#31867;&#22411;&#30340;&#20107;&#20214;&#30340;&#22788;&#29702;&#20849;&#20139;&#21516;&#19968;&#20010;&#30417;&#21548;&#22120;&#23454;&#20363;&#65292;&#22240;&#27492;&#30417;&#21548;&#22120; 
&#19981;&#24212;&#35813;&#20445;&#23384;&#20219;&#20309;&#29366;&#24577;&#65288;&#20063;&#23601;&#26159;&#19981;&#24212;&#35813;&#20351;&#29992;&#25104;&#21592;&#21464;&#37327;&#65289;&#12290; </P>
<P>&#29992;&#25143;&#23450;&#21046;&#30340;&#30417;&#21548;&#22120;&#24212;&#35813;&#23454;&#29616;&#19982;&#25152;&#35201;&#22788;&#29702;&#30340;&#20107;&#20214;&#30456;&#23545;&#24212;&#30340;&#25509;&#21475;&#65292;&#25110;&#32773;&#20174;&#19968;&#20010;&#21512;&#36866;&#30340;&#22522;&#31867;&#32487;&#25215;&#65288;&#29978;&#33267;&#26159;&#20174;Hibernate&#33258;&#24102;&#30340;&#40664;&#35748;&#20107;&#20214;&#30417;&#21548;&#22120;&#31867;&#32487;&#25215;&#65292; 
&#20026;&#20102;&#26041;&#20415;&#20320;&#36825;&#26679;&#20570;&#65292;&#36825;&#20123;&#31867;&#37117;&#34987;&#22768;&#26126;&#25104;non-final&#30340;&#20102;&#65289;&#12290;&#29992;&#25143;&#23450;&#21046;&#30340;&#30417;&#21548;&#22120;&#21487;&#20197;&#36890;&#36807;&#32534;&#31243;&#20351;&#29992;<TT 
class=literal>Configuration</TT>&#23545;&#35937; 
&#26469;&#27880;&#20876;&#65292;&#20063;&#21487;&#20197;&#22312;Hibernate&#30340;XML&#26684;&#24335;&#30340;&#37197;&#32622;&#25991;&#20214;&#20013;&#36827;&#34892;&#22768;&#26126;&#65288;&#19981;&#25903;&#25345;&#22312;Properties&#26684;&#24335;&#30340;&#37197;&#32622;&#25991;&#20214;&#22768;&#26126;&#30417;&#21548;&#22120;&#65289;&#12290; 
&#19979;&#38754;&#26159;&#19968;&#20010;&#29992;&#25143;&#23450;&#21046;&#30340;&#21152;&#36733;&#20107;&#20214;(load event)&#30340;&#30417;&#21548;&#22120;&#65306; </P><PRE class=programlisting>public class MyLoadListener implements LoadEventListener {
    // this is the single method defined by the LoadEventListener interface
    public void onLoad(LoadEvent event, LoadEventListener.LoadType loadType)
            throws HibernateException {
        if ( !MySecurity.isAuthorized( event.getEntityClassName(), event.getEntityId() ) ) {
            throw MySecurityException("Unauthorized access");
        }
    }
}</PRE>
<P>&#20320;&#36824;&#38656;&#35201;&#20462;&#25913;&#19968;&#22788;&#37197;&#32622;&#65292;&#26469;&#21578;&#35785;Hibernate&#65292;&#38500;&#20102;&#40664;&#35748;&#30340;&#30417;&#21548;&#22120;&#65292;&#36824;&#35201;&#38468;&#21152;&#36873;&#23450;&#30340;&#30417;&#21548;&#22120;&#12290; </P><PRE class=programlisting>&lt;hibernate-configuration&gt;
    &lt;session-factory&gt;
        ...
        &lt;event type="load"&gt;
            &lt;listener class="com.eg.MyLoadListener"/&gt;
            &lt;listener class="org.hibernate.event.def.DefaultLoadEventListener"/&gt;
        &lt;/event&gt;
    &lt;/session-factory&gt;
&lt;/hibernate-configuration&gt;</PRE>
<P>&#30475;&#30475;&#29992;&#21478;&#19968;&#31181;&#26041;&#24335;&#65292;&#36890;&#36807;&#32534;&#31243;&#30340;&#26041;&#24335;&#26469;&#27880;&#20876;&#23427;&#12290; </P><PRE class=programlisting>Configuration cfg = new Configuration();
LoadEventListener[] stack = { new MyLoadListener(), new DefaultLoadEventListener() };
cfg.EventListeners().setLoadEventListeners(stack);</PRE>
<P>&#36890;&#36807;&#22312;XML&#37197;&#32622;&#25991;&#20214;&#22768;&#26126;&#32780;&#27880;&#20876;&#30340;&#30417;&#21548;&#22120;&#19981;&#33021;&#20849;&#20139;&#23454;&#20363;&#12290;&#22914;&#26524;&#22312;&#22810;&#20010;<TT class=literal>&lt;listener/&gt;</TT>&#33410;&#28857;&#20013;&#20351;&#29992; 
&#20102;&#30456;&#21516;&#30340;&#31867;&#30340;&#21517;&#23383;&#65292;&#21017;&#27599;&#19968;&#20010;&#24341;&#29992;&#37117;&#23558;&#20250;&#20135;&#29983;&#19968;&#20010;&#29420;&#31435;&#30340;&#23454;&#20363;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;&#22312;&#22810;&#20010;&#30417;&#21548;&#22120;&#31867;&#22411;&#20043;&#38388;&#20849;&#20139; &#30417;&#21548;&#22120;&#30340;&#23454;&#20363;&#65292;&#21017;&#20320;&#24517;&#39035;&#20351;&#29992;&#32534;&#31243;&#30340;&#26041;&#24335;&#26469;&#36827;&#34892;&#27880;&#20876;&#12290; </P>
<P>&#20026;&#20160;&#20040;&#25105;&#20204;&#23454;&#29616;&#20102;&#29305;&#23450;&#30417;&#21548;&#22120;&#30340;&#25509;&#21475;&#65292;&#22312;&#27880;&#20876;&#30340;&#26102;&#20505;&#36824;&#35201;&#26126;&#30830;&#25351;&#20986;&#25105;&#20204;&#35201;&#27880;&#20876;&#21738;&#20010;&#20107;&#20214;&#30340;&#30417;&#21548;&#22120;&#21602;&#65311; 
&#36825;&#26159;&#22240;&#20026;&#19968;&#20010;&#31867;&#21487;&#33021;&#23454;&#29616;&#22810;&#20010;&#30417;&#21548;&#22120;&#30340;&#25509;&#21475;&#12290;&#22312;&#27880;&#20876;&#30340;&#26102;&#20505;&#26126;&#30830;&#25351;&#23450;&#35201;&#30417;&#21548;&#30340;&#20107;&#20214;&#65292;&#21487;&#20197;&#35753;&#21551;&#29992;&#25110;&#32773;&#31105;&#29992;&#23545;&#26576;&#20010;&#20107;&#20214;&#30340;&#30417;&#21548;&#30340;&#37197;&#32622;&#24037;&#20316;&#31616;&#21333;&#20123;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-decl-security></A>12.3.&nbsp; Hibernate&#30340;&#22768;&#26126;&#24335;&#23433;&#20840;&#26426;&#21046; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36890;&#24120;&#65292;Hibernate&#24212;&#29992;&#31243;&#24207;&#30340;&#22768;&#26126;&#24335;&#23433;&#20840;&#26426;&#21046;&#30001;&#20250;&#35805;&#22806;&#35266;&#23618;(session facade)&#25152;&#31649;&#29702;&#12290; 
&#29616;&#22312;&#65292;Hibernate3&#20801;&#35768;&#26576;&#20123;&#29305;&#23450;&#30340;&#34892;&#20026;&#30001;JACC&#36827;&#34892;&#35768;&#21487;&#31649;&#29702;&#65292;&#30001;JAAS&#36827;&#34892;&#25480;&#26435;&#31649;&#29702;&#12290; &#26412;&#21151;&#33021;&#26159;&#19968;&#20010;&#24314;&#31435;&#22312;&#20107;&#20214;&#26694;&#26550;&#20043;&#19978;&#30340;&#21487;&#36873;&#30340;&#21151;&#33021;&#12290; </P>
<P>&#39318;&#20808;&#65292;&#20320;&#24517;&#39035;&#35201;&#37197;&#32622;&#36866;&#24403;&#30340;&#20107;&#20214;&#30417;&#21548;&#22120;&#65288;event listener&#65289;&#65292;&#26469;&#28608;&#27963;&#20351;&#29992;JAAS&#31649;&#29702;&#25480;&#26435;&#30340;&#21151;&#33021;&#12290; </P><PRE class=programlisting>&lt;listener type="pre-delete" class="org.hibernate.secure.JACCPreDeleteEventListener"/&gt;
&lt;listener type="pre-update" class="org.hibernate.secure.JACCPreUpdateEventListener"/&gt;
&lt;listener type="pre-insert" class="org.hibernate.secure.JACCPreInsertEventListener"/&gt;
&lt;listener type="pre-load" class="org.hibernate.secure.JACCPreLoadEventListener"/&gt;</PRE>
<P>&#27880;&#24847;&#65292;<TT class=literal>&lt;listener type="..." class="..."/&gt;</TT>&#21482;&#26159;<TT 
class=literal>&lt;event type="..."&gt;&lt;listener 
class="..."/&gt;&lt;/event&gt;</TT>&#30340;&#31616;&#20889;&#65292;&#23545;&#27599;&#19968;&#20010;&#20107;&#20214;&#31867;&#22411;&#37117;&#24517;&#39035;&#20005;&#26684;&#30340;&#26377;&#19968;&#20010;&#30417;&#21548;&#22120;&#19982;&#20043;&#23545;&#24212;&#12290; </P>
<P>&#25509;&#19979;&#26469;&#65292;&#20173;&#28982;&#22312;<TT class=literal>hibernate.cfg.xml</TT>&#25991;&#20214;&#20013;&#65292;&#32465;&#23450;&#35282;&#33394;&#30340;&#26435;&#38480;&#65306; </P><PRE class=programlisting>&lt;grant role="admin" entity-name="User" actions="insert,update,read"/&gt;
&lt;grant role="su" entity-name="User" actions="*"/&gt;</PRE>
<P>&#36825;&#20123;&#35282;&#33394;&#30340;&#21517;&#23383;&#23601;&#26159;&#20320;&#30340;JACC provider&#25152;&#23450;&#20041;&#30340;&#35282;&#33394;&#30340;&#21517;&#23383;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=batch></A>&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#25209;&#37327;&#22788;&#29702;&#65288;Batch 
processing&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20351;&#29992;Hibernate&#23558; 100 000 &#26465;&#35760;&#24405;&#25554;&#20837;&#21040;&#25968;&#25454;&#24211;&#30340;&#19968;&#20010;&#24456;&#33258;&#28982;&#30340;&#20570;&#27861;&#21487;&#33021;&#26159;&#36825;&#26679;&#30340; </P><PRE class=programlisting>Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();
for ( int i=0; i&lt;100000; i++ ) {
    Customer customer = new Customer(.....);
    session.save(customer);
}
tx.commit();
session.close();</PRE>
<P>&#36825;&#27573;&#31243;&#24207;&#22823;&#27010;&#36816;&#34892;&#21040; 50 000 &#26465;&#35760;&#24405;&#24038;&#21491;&#20250;&#22833;&#36133;&#24182;&#25243;&#20986; <TT 
class=literal>&#20869;&#23384;&#28322;&#20986;&#24322;&#24120;&#65288;OutOfMemoryException&#65289;</TT> &#12290; &#36825;&#26159;&#22240;&#20026; Hibernate &#25226;&#25152;&#26377;&#26032;&#25554;&#20837;&#30340; <TT 
class=literal>&#23458;&#25143;&#65288;Customer&#65289;</TT>&#23454;&#20363;&#22312; session&#32423;&#21035;&#30340;&#32531;&#23384;&#21306;&#36827;&#34892;&#20102;&#32531;&#23384;&#30340;&#32536;&#25925;&#12290; </P>
<P>&#25105;&#20204;&#20250;&#22312;&#26412;&#31456;&#21578;&#35785;&#20320;&#22914;&#20309;&#36991;&#20813;&#27492;&#31867;&#38382;&#39064;&#12290;&#39318;&#20808;&#65292;&#22914;&#26524;&#20320;&#35201;&#25191;&#34892;&#25209;&#37327;&#22788;&#29702;&#24182;&#19988;&#24819;&#35201;&#36798;&#21040;&#19968;&#20010;&#29702;&#24819;&#30340;&#24615;&#33021;&#65292; 
&#37027;&#20040;&#20351;&#29992;JDBC&#30340;&#25209;&#37327;&#65288;batching&#65289;&#21151;&#33021;&#26159;&#33267;&#20851;&#37325;&#35201;&#12290;&#23558;JDBC&#30340;&#25209;&#37327;&#25235;&#21462;&#25968;&#37327;&#65288;batch size&#65289;&#21442;&#25968;&#35774;&#32622;&#21040;&#19968;&#20010;&#21512;&#36866;&#20540; &#65288;&#27604;&#22914;&#65292;10-50&#20043;&#38388;&#65289;&#65306; 
</P><PRE class=programlisting>hibernate.jdbc.batch_size 20</PRE>
<P>&#20320;&#20063;&#21487;&#33021;&#24819;&#22312;&#25191;&#34892;&#25209;&#37327;&#22788;&#29702;&#26102;&#20851;&#38381;&#20108;&#32423;&#32531;&#23384;&#65306; </P><PRE class=programlisting>hibernate.cache.use_second_level_cache false</PRE>
<P>&#20294;&#26159;&#65292;&#36825;&#19981;&#26159;&#32477;&#23545;&#24517;&#39035;&#30340;&#65292;&#22240;&#20026;&#25105;&#20204;&#21487;&#20197;&#26174;&#24335;&#35774;&#32622;<TT class=literal>CacheMode</TT>&#26469;&#20851;&#38381;&#19982;&#20108;&#32423;&#32531;&#23384;&#30340;&#20132;&#20114;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=batch-inserts></A>13.1.&nbsp;&#25209;&#37327;&#25554;&#20837;&#65288;Batch inserts&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#35201;&#23558;&#24456;&#22810;&#23545;&#35937;&#25345;&#20037;&#21270;&#65292;&#20320;&#24517;&#39035;&#36890;&#36807;&#32463;&#24120;&#30340;&#35843;&#29992; <TT class=literal>flush()</TT> &#20197;&#21450;&#31245;&#21518;&#35843;&#29992; <TT 
class=literal>clear()</TT> &#26469;&#25511;&#21046;&#31532;&#19968;&#32423;&#32531;&#23384;&#30340;&#22823;&#23567;&#12290; </P><PRE class=programlisting>Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();
   
for ( int i=0; i&lt;100000; i++ ) {
    Customer customer = new Customer(.....);
    session.save(customer);
    if ( i % 20 == 0 ) { //20, same as the JDBC batch size //20,&#19982;JDBC&#25209;&#37327;&#35774;&#32622;&#30456;&#21516;
        //flush a batch of inserts and release memory:
        //&#23558;&#26412;&#25209;&#25554;&#20837;&#30340;&#23545;&#35937;&#31435;&#21363;&#20889;&#20837;&#25968;&#25454;&#24211;&#24182;&#37322;&#25918;&#20869;&#23384;
        session.flush();
        session.clear();
    }
}
   
tx.commit();
session.close();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=batch-update></A>13.2.&nbsp;&#25209;&#37327;&#26356;&#26032;&#65288;Batch updates&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#27492;&#26041;&#27861;&#21516;&#26679;&#36866;&#29992;&#20110;&#26816;&#32034;&#21644;&#26356;&#26032;&#25968;&#25454;&#12290;&#27492;&#22806;&#65292;&#22312;&#36827;&#34892;&#20250;&#36820;&#22238;&#24456;&#22810;&#34892;&#25968;&#25454;&#30340;&#26597;&#35810;&#26102;&#65292; &#20320;&#38656;&#35201;&#20351;&#29992; <TT class=literal>scroll()</TT> 
&#26041;&#27861;&#20197;&#20415;&#20805;&#20998;&#21033;&#29992;&#26381;&#21153;&#22120;&#31471;&#28216;&#26631;&#25152;&#24102;&#26469;&#30340;&#22909;&#22788;&#12290; </P><PRE class=programlisting>Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();
   
ScrollableResults customers = session.getNamedQuery("GetCustomers")
    .setCacheMode(CacheMode.IGNORE)
    .scroll(ScrollMode.FORWARD_ONLY);
int count=0;
while ( customers.next() ) {
    Customer customer = (Customer) customers.get(0);
    customer.updateStuff(...);
    if ( ++count % 20 == 0 ) {
        //flush a batch of updates and release memory:
        session.flush();
        session.clear();
    }
}
   
tx.commit();
session.close();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=batch-statelesssession></A>13.3.&nbsp;StatelessSession 
(&#26080;&#29366;&#24577;session)&#25509;&#21475;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20316;&#20026;&#36873;&#25321;&#65292;Hibernate&#25552;&#20379;&#20102;&#22522;&#20110;&#21629;&#20196;&#30340;API&#65292;&#21487;&#20197;&#29992;detached object&#30340;&#24418;&#24335;&#25226;&#25968;&#25454;&#20197;&#27969;&#30340;&#26041;&#27861;&#21152;&#20837;&#21040;&#25968;&#25454;&#24211;&#65292;&#25110;&#20174;&#25968;&#25454;&#24211;&#36755;&#20986;&#12290;<TT 
class=literal>StatelessSession</TT>&#27809;&#26377;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#65292;&#20063;&#19981;&#25552;&#20379;&#22810;&#23569;&#39640;&#23618;&#30340;&#29983;&#21629;&#21608;&#26399;&#35821;&#20041;&#12290;&#29305;&#21035;&#26159;&#65292;&#26080;&#29366;&#24577;session&#19981;&#23454;&#29616;&#31532;&#19968;&#32423;cache,&#20063;&#19981;&#21644;&#31532;&#20108;&#32423;&#32531;&#23384;&#65292;&#25110;&#32773;&#26597;&#35810;&#32531;&#23384;&#20132;&#20114;&#12290;&#23427;&#19981;&#23454;&#29616;&#20107;&#21153;&#21270;&#20889;&#65292;&#20063;&#19981;&#23454;&#29616;&#33039;&#25968;&#25454;&#26816;&#26597;&#12290;&#29992;stateless 
session&#36827;&#34892;&#30340;&#25805;&#20316;&#29978;&#33267;&#19981;&#32423;&#32852;&#21040;&#20851;&#32852;&#23454;&#20363;&#12290;stateless session&#24573;&#30053;&#38598;&#21512;&#31867;(Collections)&#12290;&#36890;&#36807;stateless 
session&#36827;&#34892;&#30340;&#25805;&#20316;&#19981;&#35302;&#21457;Hibernate&#30340;&#20107;&#20214;&#27169;&#22411;&#21644;&#25318;&#25130;&#22120;&#12290;&#26080;&#29366;&#24577;session&#23545;&#25968;&#25454;&#30340;&#28151;&#28102;&#29616;&#35937;&#20813;&#30123;&#65292;&#22240;&#20026;&#23427;&#27809;&#26377;&#31532;&#19968;&#32423;&#32531;&#23384;&#12290;&#26080;&#29366;&#24577;session&#26159;&#20302;&#23618;&#30340;&#25277;&#35937;&#65292;&#21644;&#20302;&#23618;JDBC&#30456;&#24403;&#25509;&#36817;&#12290; 
</P><PRE class=programlisting>StatelessSession session = sessionFactory.openStatelessSession();
Transaction tx = session.beginTransaction();
   
ScrollableResults customers = session.getNamedQuery("GetCustomers")
    .scroll(ScrollMode.FORWARD_ONLY);
while ( customers.next() ) {
    Customer customer = (Customer) customers.get(0);
    customer.updateStuff(...);
    session.update(customer);
}
   
tx.commit();
session.close();</PRE>
<P>&#27880;&#24847;&#22312;&#19978;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#26597;&#35810;&#36820;&#22238;&#30340;<TT 
class=literal>Customer</TT>&#23454;&#20363;&#31435;&#21363;&#34987;&#33073;&#31649;(detach)&#12290;&#23427;&#20204;&#19982;&#20219;&#20309;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;&#37117;&#27809;&#26377;&#20851;&#31995;&#12290; </P>
<P><TT class=literal>StatelessSession</TT> &#25509;&#21475;&#23450;&#20041;&#30340;<TT class=literal>insert(), 
update()</TT> &#21644; <TT class=literal>delete()</TT>&#25805;&#20316;&#26159;&#30452;&#25509;&#30340;&#25968;&#25454;&#24211;&#34892;&#32423;&#21035;&#25805;&#20316;&#65292;&#20854;&#32467;&#26524;&#26159;&#31435;&#21051;&#25191;&#34892;&#19968;&#26465;<TT 
class=literal>INSERT, UPDATE</TT> &#25110; <TT class=literal>DELETE</TT> 
&#35821;&#21477;&#12290;&#22240;&#27492;&#65292;&#23427;&#20204;&#30340;&#35821;&#20041;&#21644;<TT class=literal>Session</TT> &#25509;&#21475;&#23450;&#20041;&#30340;<TT class=literal>save(), 
saveOrUpdate()</TT> &#21644;<TT class=literal>delete()</TT> &#25805;&#20316;&#26377;&#24456;&#22823;&#30340;&#19981;&#21516;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=batch-direct></A>13.4.&nbsp;DML(&#25968;&#25454;&#25805;&#20316;&#35821;&#35328;)&#39118;&#26684;&#30340;&#25805;&#20316;(DML-style 
operations)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>hence manipulating (using the SQL <TT class=literal>Data Manipulation 
Language</TT> (DML) statements: <TT class=literal>INSERT</TT>, <TT 
class=literal>UPDATE</TT>, <TT class=literal>DELETE</TT>) data directly in the 
database will not affect in-memory state. However, Hibernate provides methods 
for bulk SQL-style DML statement execution which are performed through the 
Hibernate Query Language (<A title="&#31532;&nbsp;14&nbsp;&#31456;&nbsp;HQL: Hibernate&#26597;&#35810;&#35821;&#35328;" 
href="#queryhql">&#31532;&nbsp;14&nbsp;&#31456; <I>HQL: Hibernate&#26597;&#35810;&#35821;&#35328;</I></A>). 
&#23601;&#20687;&#24050;&#32463;&#35752;&#35770;&#30340;&#37027;&#26679;&#65292;&#33258;&#21160;&#21644;&#36879;&#26126;&#30340; &#23545;&#35937;/&#20851;&#31995; &#26144;&#23556;&#65288;object/relational mapping&#65289;&#20851;&#27880;&#20110;&#31649;&#29702;&#23545;&#35937;&#30340;&#29366;&#24577;&#12290; 
&#36825;&#23601;&#24847;&#21619;&#30528;&#23545;&#35937;&#30340;&#29366;&#24577;&#23384;&#22312;&#20110;&#20869;&#23384;&#65292;&#22240;&#27492;&#30452;&#25509;&#25805;&#20316; (&#20351;&#29992; SQL <TT class=literal>Data Manipulation 
Language</TT>(DML,&#25968;&#25454;&#25805;&#20316;&#35821;&#35328;&#65289;&#35821;&#21477; &#65306;<TT class=literal>INSERT</TT> ,<TT 
class=literal>UPDATE</TT> &#21644; <TT class=literal>DELETE</TT>) 
&#25968;&#25454;&#24211;&#20013;&#30340;&#25968;&#25454;&#23558;&#19981;&#20250;&#24433;&#21709;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#29366;&#24577;&#21644;&#23545;&#35937;&#25968;&#25454;&#12290; &#19981;&#36807;&#65292;Hibernate&#25552;&#20379;&#36890;&#36807;Hibernate&#26597;&#35810;&#35821;&#35328;&#65288;<A 
title="&#31532;&nbsp;14&nbsp;&#31456;&nbsp;HQL: Hibernate&#26597;&#35810;&#35821;&#35328;" 
href="#queryhql">&#31532;&nbsp;14&nbsp;&#31456; <I>HQL: Hibernate&#26597;&#35810;&#35821;&#35328;</I></A>&#65289;&#26469;&#25191;&#34892;&#22823;&#25209; 
&#37327;SQL&#39118;&#26684;&#30340;DML&#35821;&#21477;&#30340;&#26041;&#27861;&#12290; </P>
<P><TT class=literal>UPDATE</TT> &#21644; <TT class=literal>DELETE</TT>&#35821;&#21477;&#30340;&#35821;&#27861;&#20026;&#65306; <TT 
class=literal>( UPDATE | DELETE ) FROM? EntityName (WHERE 
where_conditions)?</TT> &#26377;&#20960;&#28857;&#35828;&#26126;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#22312;FROM&#23376;&#21477;&#65288;from-clause&#65289;&#20013;&#65292;FROM&#20851;&#38190;&#23383;&#26159;&#21487;&#36873;&#30340; </P>
  <LI>
  <P>&#22312;FROM&#23376;&#21477;&#65288;from-clause&#65289;&#20013;&#21482;&#33021;&#26377;&#19968;&#20010;&#23454;&#20307;&#21517;&#65292;&#23427;&#21487;&#20197;&#26159;&#21035;&#21517;&#12290;&#22914;&#26524;&#23454;&#20307;&#21517;&#26159;&#21035;&#21517;&#65292;&#37027;&#20040;&#20219;&#20309;&#34987;&#24341;&#29992;&#30340;&#23646;&#24615;&#37117;&#24517;&#39035;&#21152;&#19978;&#27492;&#21035;&#21517;&#30340;&#21069;&#32512;&#65307;&#22914;&#26524;&#19981;&#26159;&#21035;&#21517;&#65292;&#37027;&#20040;&#20219;&#20309;&#26377;&#21069;&#32512;&#30340;&#23646;&#24615;&#24341;&#29992;&#37117;&#26159;&#38750;&#27861;&#30340;&#12290; 
  </P>
  <LI>
  <P>&#19981;&#33021;&#22312;&#22823;&#25209;&#37327;HQL&#35821;&#21477;&#20013;&#20351;&#29992;<A title="14.4.&nbsp;join &#35821;&#27861;&#30340;&#24418;&#24335;" 
  href="#queryhql-joins-forms">&#31532;&nbsp;14.4&nbsp;&#33410; “join 
  &#35821;&#27861;&#30340;&#24418;&#24335;”</A>&#65288;&#26174;&#24335;&#25110;&#32773;&#38544;&#24335;&#30340;&#37117;&#19981;&#34892;&#65289;&#12290;&#19981;&#36807;&#22312;WHERE&#23376;&#21477;&#20013;&#21487;&#20197;&#20351;&#29992;&#23376;&#26597;&#35810;&#12290;&#21487;&#20197;&#22312;where&#23376;&#21477;&#20013;&#20351;&#29992;&#23376;&#26597;&#35810;&#65292;&#23376;&#26597;&#35810;&#26412;&#36523;&#21487;&#20197;&#21253;&#21547;join&#12290; </P>
  <LI>
  <P>&#25972;&#20010;WHERE&#23376;&#21477;&#26159;&#21487;&#36873;&#30340;&#12290; </P></LI></UL></DIV>
<P>&#20030;&#20010;&#20363;&#23376;&#65292;&#20351;&#29992;<TT class=literal>Query.executeUpdate()</TT>&#26041;&#27861;&#25191;&#34892;&#19968;&#20010;HQL <TT 
class=literal>UPDATE</TT>&#35821;&#21477;(&#65306; (&#26041;&#27861;&#21629;&#21517;&#26159;&#26469;&#28304;&#20110;JDBC's <TT 
class=literal>PreparedStatement.executeUpdate()</TT>): </P><PRE class=programlisting>Session session = sessionFactory.openSession();
		Transaction tx = session.beginTransaction();

		String hqlUpdate = "update Customer c set c.name = :newName where c.name = :oldName";
		// or String hqlUpdate = "update Customer set name = :newName where name = :oldName";
		int updatedEntities = s.createQuery( hqlUpdate )
		        .setString( "newName", newName )
		        .setString( "oldName", oldName )
		        .executeUpdate();
		tx.commit();
		session.close();</PRE>
<P>HQL <TT class=literal>UPDATE</TT>&#35821;&#21477;&#65292;&#40664;&#35748;&#19981;&#20250;&#24433;&#21709;&#26356;&#26032;&#23454;&#20307;&#30340;<A 
title=5.1.7.&nbsp;&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;) 
href="#mapping-declaration-version">&#31532;&nbsp;5.1.7&nbsp;&#33410; 
“&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)”</A>&#25110;&#32773;<A title="5.1.8.&nbsp;timestamp (&#21487;&#36873;)" 
href="#mapping-declaration-timestamp">&#31532;&nbsp;5.1.8&nbsp;&#33410; “timestamp 
(&#21487;&#36873;)”</A>&#23646;&#24615;&#20540;&#12290;&#36825;&#21644;EJB3&#35268;&#33539;&#26159;&#19968;&#33268;&#30340;&#12290;&#20294;&#26159;&#65292;&#36890;&#36807;&#20351;&#29992;<TT class=literal>versioned 
update</TT>&#65292;&#20320;&#21487;&#20197;&#24378;&#21046;Hibernate&#27491;&#30830;&#30340;&#37325;&#32622;<TT class=literal>version</TT>&#25110;&#32773;<TT 
class=literal>timestamp</TT>&#23646;&#24615;&#20540;&#12290;&#36825;&#36890;&#36807;&#22312;<TT class=literal>UPDATE</TT>&#20851;&#38190;&#23383;&#21518;&#38754;&#22686;&#21152;<TT 
class=literal>VERSIONED</TT>&#20851;&#38190;&#23383;&#26469;&#23454;&#29616;&#30340;&#12290; </P><PRE class=programlisting>Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();
String hqlVersionedUpdate = "update versioned Customer set name = :newName where name = :oldName";
int updatedEntities = s.createQuery( hqlUpdate )
        .setString( "newName", newName )
        .setString( "oldName", oldName )
        .executeUpdate();
tx.commit();
session.close();</PRE>
<P>&#27880;&#24847;&#65292;&#33258;&#23450;&#20041;&#30340;&#29256;&#26412;&#31867;&#22411;(<TT 
class=literal>org.hibernate.usertype.UserVersionType</TT>)&#19981;&#20801;&#35768;&#21644;<TT 
class=literal>update versioned</TT>&#35821;&#21477;&#32852;&#29992;&#12290; </P>
<P>&#25191;&#34892;&#19968;&#20010;HQL <TT class=literal>DELETE</TT>&#65292;&#21516;&#26679;&#20351;&#29992; <TT 
class=literal>Query.executeUpdate()</TT> &#26041;&#27861;: </P><PRE class=programlisting>Session session = sessionFactory.openSession();
		Transaction tx = session.beginTransaction();

		String hqlDelete = "delete Customer c where c.name = :oldName";
		// or String hqlDelete = "delete Customer where name = :oldName";
		int deletedEntities = s.createQuery( hqlDelete )
		        .setString( "oldName", oldName )
		        .executeUpdate();
		tx.commit();
		session.close();</PRE>
<P>&#30001;<TT class=literal>Query.executeUpdate()</TT>&#26041;&#27861;&#36820;&#22238;&#30340;<TT 
class=literal>&#25972;&#22411;</TT>&#20540;&#34920;&#26126;&#20102;&#21463;&#27492;&#25805;&#20316;&#24433;&#21709;&#30340;&#35760;&#24405;&#25968;&#37327;&#12290; 
&#27880;&#24847;&#36825;&#20010;&#25968;&#20540;&#21487;&#33021;&#19982;&#25968;&#25454;&#24211;&#20013;&#34987;&#65288;&#26368;&#21518;&#19968;&#26465;SQL&#35821;&#21477;&#65289;&#24433;&#21709;&#20102;&#30340;“&#34892;”&#25968;&#26377;&#20851;&#65292;&#20063;&#21487;&#33021;&#27809;&#26377;&#12290;&#19968;&#20010;&#22823;&#25209;&#37327;HQL&#25805;&#20316;&#21487;&#33021;&#23548;&#33268;&#22810;&#26465;&#23454;&#38469;&#30340;SQL&#35821;&#21477;&#34987;&#25191;&#34892;&#65292; 
&#20030;&#20010;&#20363;&#23376;&#65292;&#23545;joined-subclass&#26144;&#23556;&#26041;&#24335;&#30340;&#31867;&#36827;&#34892;&#30340;&#27492;&#31867;&#25805;&#20316;&#12290;&#36825;&#20010;&#36820;&#22238;&#20540;&#20195;&#34920;&#20102;&#23454;&#38469;&#34987;&#35821;&#21477;&#24433;&#21709;&#20102;&#30340;&#35760;&#24405;&#25968;&#37327;&#12290;&#22312;&#37027;&#20010;joined-subclass&#30340;&#20363;&#23376;&#20013;&#65292; 
&#23545;&#19968;&#20010;&#23376;&#31867;&#30340;&#21024;&#38500;&#23454;&#38469;&#19978;&#21487;&#33021;&#19981;&#20165;&#20165;&#20250;&#21024;&#38500;&#23376;&#31867;&#26144;&#23556;&#21040;&#30340;&#34920;&#32780;&#19988;&#20250;&#24433;&#21709;“&#26681;”&#34920;&#65292;&#36824;&#26377;&#21487;&#33021;&#24433;&#21709;&#19982;&#20043;&#26377;&#32487;&#25215;&#20851;&#31995;&#30340;joined-subclass&#26144;&#23556;&#26041;&#24335;&#30340;&#23376;&#31867;&#30340;&#34920;&#12290; </P>
<P><TT class=literal>INSERT</TT>&#35821;&#21477;&#30340;&#20266;&#30721;&#26159;: <TT class=literal>INSERT INTO EntityName 
properties_list select_statement</TT>. &#35201;&#27880;&#24847;&#30340;&#26159;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#21482;&#25903;&#25345;INSERT INTO ... SELECT ...&#24418;&#24335;,&#19981;&#25903;&#25345;INSERT INTO ... VALUES ...&#24418;&#24335;. </P>
  <P>properties_list&#21644;SQL <TT class=literal>INSERT</TT>&#35821;&#21477;&#20013;&#30340;<TT 
  class=literal>&#23383;&#27573;&#23450;&#20041;(column 
  speficiation)</TT>&#31867;&#20284;&#12290;&#23545;&#21442;&#19982;&#32487;&#25215;&#26641;&#26144;&#23556;&#30340;&#23454;&#20307;&#32780;&#35328;&#65292;&#21482;&#26377;&#30452;&#25509;&#23450;&#20041;&#22312;&#32473;&#23450;&#30340;&#31867;&#32423;&#21035;&#30340;&#23646;&#24615;&#25165;&#33021;&#30452;&#25509;&#22312;properties_list&#20013;&#20351;&#29992;&#12290;&#36229;&#31867;&#30340;&#23646;&#24615;&#19981;&#34987;&#25903;&#25345;&#65307;&#23376;&#31867;&#30340;&#23646;&#24615;&#26080;&#24847;&#20041;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;<TT 
  class=literal>INSERT</TT>&#22825;&#29983;&#19981;&#25903;&#25345;&#22810;&#24577;&#12290; </P>
  <LI>
  <P>select_statement&#21487;&#20197;&#26159;&#20219;&#20309;&#21512;&#27861;&#30340;HQL&#36873;&#25321;&#26597;&#35810;&#65292;&#19981;&#36807;&#35201;&#20445;&#35777;&#36820;&#22238;&#31867;&#22411;&#24517;&#39035;&#21644;&#35201;&#25554;&#20837;&#30340;&#31867;&#22411;&#23436;&#20840;&#21305;&#37197;&#12290;&#30446;&#21069;&#65292;&#36825;&#19968;&#26816;&#26597;&#26159;&#22312;&#26597;&#35810;&#32534;&#35793;&#30340;&#26102;&#20505;&#36827;&#34892;&#30340;&#65292;&#32780;&#19981;&#26159;&#25226;&#23427;&#20132;&#32473;&#25968;&#25454;&#24211;&#12290;&#27880;&#24847;&#65292;&#22312;Hibernate<TT 
  class=literal>Type</TT>&#38388;&#22914;&#26524;&#21482;&#26159;<SPAN 
  class=emphasis><EM>&#31561;&#20215;&#65288;equivalent&#65289;</EM></SPAN>&#32780;&#38750;<SPAN 
  class=emphasis><EM>&#30456;&#31561;(equal)</EM></SPAN>&#65292;&#20250;&#23548;&#33268;&#38382;&#39064;&#12290;&#23450;&#20041;&#20026;<TT 
  class=literal>org.hibernate.type.DateType</TT>&#21644;<TT 
  class=literal>org.hibernate.type.TimestampType</TT>&#30340;&#20004;&#20010;&#23646;&#24615;&#21487;&#33021;&#20250;&#20135;&#29983;&#31867;&#22411;&#19981;&#21305;&#37197;&#38169;&#35823;&#65292;&#34429;&#28982;&#25968;&#25454;&#24211;&#32423;&#21487;&#33021;&#19981;&#21152;&#21306;&#20998;&#25110;&#32773;&#21487;&#20197;&#22788;&#29702;&#36825;&#31181;&#36716;&#25442;&#12290; 
  </P>
  <LI>
  <P>&#23545;id&#23646;&#24615;&#26469;&#35828;,insert&#35821;&#21477;&#32473;&#20320;&#20004;&#20010;&#36873;&#25321;&#12290;&#20320;&#21487;&#20197;&#26126;&#30830;&#22320;&#22312;properties_list&#34920;&#20013;&#25351;&#23450;id&#23646;&#24615;&#65288;&#36825;&#26679;&#23427;&#30340;&#20540;&#26159;&#20174;&#23545;&#24212;&#30340;select&#34920;&#36798;&#24335;&#20013;&#33719;&#24471;&#65289;&#65292;&#25110;&#32773;&#22312;properties_list&#20013;&#30465;&#30053;&#23427;&#65288;&#27492;&#26102;&#20351;&#29992;&#29983;&#25104;&#25351;&#65289;&#12290;&#21518;&#19968;&#31181;&#36873;&#25321;&#21482;&#26377;&#24403;&#20351;&#29992;&#22312;&#25968;&#25454;&#24211;&#20013;&#29983;&#25104;&#20540;&#30340;id&#20135;&#29983;&#22120;&#26102;&#25165;&#33021;&#20351;&#29992;&#65307;&#22914;&#26524;&#26159;“&#20869;&#23384;”&#20013;&#35745;&#31639;&#30340;&#31867;&#22411;&#29983;&#25104;&#22120;&#65292;&#22312;&#35299;&#26512;&#26102;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;&#27880;&#24847;&#65292;&#20026;&#20102;&#35828;&#26126;&#36825;&#19968;&#38382;&#39064;&#65292;&#25968;&#25454;&#24211;&#20135;&#29983;&#20540;&#30340;&#29983;&#25104;&#22120;&#26159;<TT 
  class=literal>org.hibernate.id.SequenceGenerator</TT>&#65288;&#21644;&#23427;&#30340;&#23376;&#31867;&#65289;&#65292;&#20197;&#21450;&#20219;&#20309;<TT 
  class=literal>org.hibernate.id.PostInsertIdentifierGenerator</TT>&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;&#36825;&#20799;&#26368;&#20540;&#24471;&#27880;&#24847;&#30340;&#24847;&#22806;&#26159;<TT 
  class=literal>org.hibernate.id.TableHiLoGenerator</TT>&#65292;&#23427;&#19981;&#33021;&#22312;&#27492;&#20351;&#29992;&#65292;&#22240;&#20026;&#23427;&#27809;&#26377;&#24471;&#21040;&#20854;&#20540;&#30340;&#36884;&#24452;&#12290; 
  </P>
  <LI>
  <P>&#23545;&#26144;&#23556;&#20026;<TT class=literal>version</TT> &#25110; <TT 
  class=literal>timestamp</TT>&#30340;&#23646;&#24615;&#26469;&#35828;&#65292;insert&#35821;&#21477;&#20063;&#32473;&#20320;&#20004;&#20010;&#36873;&#25321;&#65292;&#20320;&#21487;&#20197;&#22312;properties_list&#34920;&#20013;&#25351;&#23450;&#65288;&#27492;&#26102;&#20854;&#20540;&#20174;&#23545;&#24212;&#30340;select&#34920;&#36798;&#24335;&#20013;&#33719;&#24471;&#65289;&#65292;&#25110;&#32773;&#22312;properties_list&#20013;&#30465;&#30053;&#23427;&#65288;&#27492;&#26102;&#65292;&#20351;&#29992;&#22312;<TT 
  class=literal>org.hibernate.type.VersionType</TT> &#20013;&#23450;&#20041;&#30340;<TT class=literal>seed 
  value(&#31181;&#23376;&#20540;)</TT>&#65289;&#12290; </P></LI></UL></DIV>
<P>&#25191;&#34892;HQL <TT class=literal>INSERT</TT>&#35821;&#21477;&#30340;&#20363;&#23376;&#22914;&#19979;&#65306; </P><PRE class=programlisting>Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();

String hqlInsert = "insert into DelinquentAccount (id, name) select c.id, c.name from Customer c where ...";
int createdEntities = s.createQuery( hqlInsert )
        .executeUpdate();
tx.commit();
session.close();</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=queryhql></A>&#31532;&nbsp;14&nbsp;&#31456;&nbsp;HQL: 
Hibernate&#26597;&#35810;&#35821;&#35328;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#37197;&#22791;&#20102;&#19968;&#31181;&#38750;&#24120;&#24378;&#22823;&#30340;&#26597;&#35810;&#35821;&#35328;&#65292;&#36825;&#31181;&#35821;&#35328;&#30475;&#19978;&#21435;&#24456;&#20687;SQL&#12290;&#20294;&#26159;&#19981;&#35201;&#34987;&#35821;&#27861;&#32467;&#26500; 
&#19978;&#30340;&#30456;&#20284;&#25152;&#36855;&#24785;&#65292;HQL&#26159;&#38750;&#24120;&#26377;&#24847;&#35782;&#30340;&#34987;&#35774;&#35745;&#20026;&#23436;&#20840;&#38754;&#21521;&#23545;&#35937;&#30340;&#26597;&#35810;&#65292;&#23427;&#21487;&#20197;&#29702;&#35299;&#22914;&#32487;&#25215;&#12289;&#22810;&#24577; &#21644;&#20851;&#32852;&#20043;&#31867;&#30340;&#27010;&#24565;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-casesensitivity></A>14.1.&nbsp;&#22823;&#23567;&#20889;&#25935;&#24863;&#24615;&#38382;&#39064;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38500;&#20102;Java&#31867;&#19982;&#23646;&#24615;&#30340;&#21517;&#31216;&#22806;&#65292;&#26597;&#35810;&#35821;&#21477;&#23545;&#22823;&#23567;&#20889;&#24182;&#19981;&#25935;&#24863;&#12290; &#25152;&#20197; <TT class=literal>SeLeCT</TT> &#19982; <TT 
class=literal>sELEct</TT> &#20197;&#21450; <TT class=literal>SELECT</TT> &#26159;&#30456;&#21516;&#30340;&#65292;&#20294;&#26159; <TT 
class=literal>org.hibernate.eg.FOO</TT> &#24182;&#19981;&#31561;&#20215;&#20110; <TT 
class=literal>org.hibernate.eg.Foo</TT> &#24182;&#19988; <TT class=literal>foo.barSet</TT> 
&#20063;&#19981;&#31561;&#20215;&#20110; <TT class=literal>foo.BARSET</TT>&#12290; </P>
<P>&#26412;&#25163;&#20876;&#20013;&#30340;HQL&#20851;&#38190;&#23383;&#23558;&#20351;&#29992;&#23567;&#20889;&#23383;&#27597;. &#24456;&#22810;&#29992;&#25143;&#21457;&#29616;&#20351;&#29992;&#23436;&#20840;&#22823;&#20889;&#30340;&#20851;&#38190;&#23383;&#20250;&#20351;&#26597;&#35810;&#35821;&#21477; &#30340;&#21487;&#35835;&#24615;&#26356;&#24378;, 
&#20294;&#25105;&#20204;&#21457;&#29616;&#65292;&#24403;&#25226;&#26597;&#35810;&#35821;&#21477;&#23884;&#20837;&#21040;Java&#35821;&#21477;&#20013;&#30340;&#26102;&#20505;&#20351;&#29992;&#22823;&#20889;&#20851;&#38190;&#23383;&#27604;&#36739;&#38590;&#30475;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-from></A>14.2.&nbsp;from&#23376;&#21477;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20013;&#26368;&#31616;&#21333;&#30340;&#26597;&#35810;&#35821;&#21477;&#30340;&#24418;&#24335;&#22914;&#19979;&#65306; </P><PRE class=programlisting>from eg.Cat</PRE>
<P>&#35813;&#23376;&#21477;&#31616;&#21333;&#30340;&#36820;&#22238;<TT class=literal>eg.Cat</TT>&#31867;&#30340;&#25152;&#26377;&#23454;&#20363;&#12290; &#36890;&#24120;&#25105;&#20204;&#19981;&#38656;&#35201;&#20351;&#29992;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;, &#22240;&#20026; <TT 
class=literal>auto-import</TT>&#65288;&#33258;&#21160;&#24341;&#20837;&#65289; &#26159;&#32570;&#30465;&#30340;&#24773;&#20917;&#12290; &#25152;&#20197;&#25105;&#20204;&#20960;&#20046;&#21482;&#20351;&#29992;&#22914;&#19979;&#30340;&#31616;&#21333;&#20889;&#27861;&#65306; </P><PRE class=programlisting>from Cat</PRE>
<P>&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;, &#20320;&#38656;&#35201;&#25351;&#23450;&#19968;&#20010;<SPAN class=emphasis><EM>&#21035;&#21517;</EM></SPAN>, &#21407;&#22240;&#26159;&#20320;&#21487;&#33021;&#38656;&#35201; 
&#22312;&#26597;&#35810;&#35821;&#21477;&#30340;&#20854;&#23427;&#37096;&#20998;&#24341;&#29992;&#21040;<TT class=literal>Cat</TT> </P><PRE class=programlisting>from Cat as cat</PRE>
<P>&#36825;&#20010;&#35821;&#21477;&#25226;&#21035;&#21517;<TT class=literal>cat</TT>&#25351;&#23450;&#32473;&#31867;<TT class=literal>Cat</TT> &#30340;&#23454;&#20363;, 
&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#22312;&#38543;&#21518;&#30340;&#26597;&#35810;&#20013;&#20351;&#29992;&#27492;&#21035;&#21517;&#20102;&#12290; &#20851;&#38190;&#23383;<TT class=literal>as</TT> &#26159;&#21487;&#36873;&#30340;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#36825;&#26679;&#20889;: </P><PRE class=programlisting>from Cat cat</PRE>
<P>&#23376;&#21477;&#20013;&#21487;&#20197;&#21516;&#26102;&#20986;&#29616;&#22810;&#20010;&#31867;, &#20854;&#26597;&#35810;&#32467;&#26524;&#26159;&#20135;&#29983;&#19968;&#20010;&#31515;&#21345;&#20799;&#31215;&#25110;&#20135;&#29983;&#36328;&#34920;&#30340;&#36830;&#25509;&#12290; </P><PRE class=programlisting>from Formula, Parameter</PRE><PRE class=programlisting>from Formula as form, Parameter as param</PRE>
<P>&#26597;&#35810;&#35821;&#21477;&#20013;&#21035;&#21517;&#30340;&#24320;&#22836;&#37096;&#20998;&#23567;&#20889;&#34987;&#35748;&#20026;&#26159;&#23454;&#36341;&#20013;&#30340;&#22909;&#20064;&#24815;&#65292; &#36825;&#26679;&#20570;&#19982;Java&#21464;&#37327;&#30340;&#21629;&#21517;&#26631;&#20934;&#20445;&#25345;&#20102;&#19968;&#33268; (&#27604;&#22914;&#65292;<TT 
class=literal>domesticCat</TT>)&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-joins></A>14.3.&nbsp;&#20851;&#32852;(Association)&#19982;&#36830;&#25509;(Join)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#25105;&#20204;&#20063;&#21487;&#20197;&#20026;&#30456;&#20851;&#32852;&#30340;&#23454;&#20307;&#29978;&#33267;&#26159;&#23545;&#19968;&#20010;&#38598;&#21512;&#20013;&#30340;&#20840;&#37096;&#20803;&#32032;&#25351;&#23450;&#19968;&#20010;&#21035;&#21517;, &#36825;&#26102;&#35201;&#20351;&#29992;&#20851;&#38190;&#23383;<TT class=literal>join</TT>&#12290; </P><PRE class=programlisting>from Cat as cat 
    inner join cat.mate as mate
    left outer join cat.kittens as kitten</PRE><PRE class=programlisting>from Cat as cat left join cat.mate.kittens as kittens</PRE><PRE class=programlisting>from Formula form full join form.parameter param</PRE>
<P>&#21463;&#25903;&#25345;&#30340;&#36830;&#25509;&#31867;&#22411;&#26159;&#20174;ANSI SQL&#20013;&#20511;&#37492;&#26469;&#30340;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>inner join</TT>&#65288;&#20869;&#36830;&#25509;&#65289; </P>
  <LI>
  <P><TT class=literal>left outer join</TT>&#65288;&#24038;&#22806;&#36830;&#25509;&#65289; </P>
  <LI>
  <P><TT class=literal>right outer join</TT>&#65288;&#21491;&#22806;&#36830;&#25509;&#65289; </P>
  <LI>
  <P><TT class=literal>full join</TT> (&#20840;&#36830;&#25509;&#65292;&#24182;&#19981;&#24120;&#29992;) </P></LI></UL></DIV>
<P>&#35821;&#21477;<TT class=literal>inner join</TT>, <TT class=literal>left outer join</TT> 
&#20197;&#21450; <TT class=literal>right outer join</TT> &#21487;&#20197;&#31616;&#20889;&#12290; </P><PRE class=programlisting>from Cat as cat 
    join cat.mate as mate
    left join cat.kittens as kitten</PRE>
<P>&#36890;&#36807;HQL&#30340;<TT class=literal>with</TT>&#20851;&#38190;&#23383;&#65292;&#20320;&#21487;&#20197;&#25552;&#20379;&#39069;&#22806;&#30340;join&#26465;&#20214;&#12290; </P><PRE class=programlisting>from Cat as cat 
    left join cat.kittens as kitten 
        with kitten.bodyWeight &gt; 10.0</PRE>
<P>&#36824;&#26377;&#65292;&#19968;&#20010;"fetch"&#36830;&#25509;&#20801;&#35768;&#20165;&#20165;&#20351;&#29992;&#19968;&#20010;&#36873;&#25321;&#35821;&#21477;&#23601;&#23558;&#30456;&#20851;&#32852;&#30340;&#23545;&#35937;&#25110;&#19968;&#32452;&#20540;&#30340;&#38598;&#21512;&#38543;&#30528;&#20182;&#20204;&#30340;&#29238;&#23545;&#35937;&#30340;&#21021;&#22987;&#21270;&#32780;&#34987;&#21021;&#22987;&#21270;&#65292;&#36825;&#31181;&#26041;&#27861;&#22312;&#20351;&#29992;&#21040;&#38598;&#21512;&#30340;&#24773;&#20917;&#19979;&#23588;&#20854;&#26377;&#29992;&#65292;&#23545;&#20110;&#20851;&#32852;&#21644;&#38598;&#21512;&#26469;&#35828;&#65292;&#23427;&#26377;&#25928;&#30340;&#20195;&#26367;&#20102;&#26144;&#23556;&#25991;&#20214;&#20013;&#30340;&#22806;&#32852;&#25509; 
&#19982;&#24310;&#36831;&#22768;&#26126;&#65288;lazy declarations&#65289;. &#26597;&#30475; <A 
title="19.1.&nbsp;&#10;&#9;&#9;&#9;&#25235;&#21462;&#31574;&#30053;(Fetching strategies)&#10;&#9;&#9;" 
href="#performance-fetching">&#31532;&nbsp;19.1&nbsp;&#33410; “ &#25235;&#21462;&#31574;&#30053;(Fetching strategies) 
”</A> &#20197;&#33719;&#24471;&#31561;&#22810;&#30340;&#20449;&#24687;&#12290; </P><PRE class=programlisting>from Cat as cat 
    inner join fetch cat.mate
    left join fetch cat.kittens</PRE>
<P>&#19968;&#20010;fetch&#36830;&#25509;&#36890;&#24120;&#19981;&#38656;&#35201;&#34987;&#25351;&#23450;&#21035;&#21517;, &#22240;&#20026;&#30456;&#20851;&#32852;&#30340;&#23545;&#35937;&#19981;&#24212;&#24403;&#34987;&#29992;&#22312; <TT class=literal>where</TT> &#23376;&#21477; 
(&#25110;&#20854;&#23427;&#20219;&#20309;&#23376;&#21477;)&#20013;&#12290;&#21516;&#26102;&#65292;&#30456;&#20851;&#32852;&#30340;&#23545;&#35937; &#24182;&#19981;&#22312;&#26597;&#35810;&#30340;&#32467;&#26524;&#20013;&#30452;&#25509;&#36820;&#22238;&#65292;&#20294;&#21487;&#20197;&#36890;&#36807;&#20182;&#20204;&#30340;&#29238;&#23545;&#35937;&#26469;&#35775;&#38382;&#21040;&#20182;&#20204;&#12290; </P><PRE class=programlisting>from Cat as cat 
    inner join fetch cat.mate
    left join fetch cat.kittens child
    left join fetch child.kittens</PRE>
<P>&#20551;&#33509;&#20351;&#29992;<TT class=literal>iterate()</TT>&#26469;&#35843;&#29992;&#26597;&#35810;&#65292;&#35831;&#27880;&#24847;<TT 
class=literal>fetch</TT>&#26500;&#36896;&#26159;&#19981;&#33021;&#20351;&#29992;&#30340;(<TT class=literal>scroll()</TT> &#21487;&#20197;&#20351;&#29992;)&#12290;<TT 
class=literal>fetch</TT>&#20063;&#19981;&#24212;&#35813;&#19982;<TT class=literal>setMaxResults()</TT> &#25110;<TT 
class=literal>setFirstResult()</TT>&#20849;&#29992;&#65292;&#36825;&#26159;&#22240;&#20026;&#36825;&#20123;&#25805;&#20316;&#26159;&#22522;&#20110;&#32467;&#26524;&#38598;&#30340;&#65292;&#32780;&#22312;&#39044;&#20808;&#25235;&#21462;&#38598;&#21512;&#31867;&#26102;&#21487;&#33021;&#21253;&#21547;&#37325;&#22797;&#30340;&#25968;&#25454;&#65292;&#20063;&#23601;&#26159;&#35828;&#26080;&#27861;&#39044;&#20808;&#30693;&#36947;&#31934;&#30830;&#30340;&#34892;&#25968;&#12290;<TT 
class=literal>fetch</TT>&#36824;&#19981;&#33021;&#19982;&#29420;&#31435;&#30340; <TT 
class=literal>with</TT>&#26465;&#20214;&#19968;&#36215;&#20351;&#29992;&#12290;&#36890;&#36807;&#22312;&#19968;&#27425;&#26597;&#35810;&#20013;fetch&#22810;&#20010;&#38598;&#21512;&#65292;&#21487;&#20197;&#21046;&#36896;&#20986;&#31515;&#21345;&#23572;&#31215;&#65292;&#22240;&#27492;&#35831;&#22810;&#21152;&#27880;&#24847;&#12290;&#23545;bag&#26144;&#23556;&#26469;&#35828;&#65292;&#21516;&#26102;join 
fetch&#22810;&#20010;&#38598;&#21512;&#35282;&#33394;&#21487;&#33021;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#32473;&#20986;&#24182;&#38750;&#39044;&#26399;&#30340;&#32467;&#26524;&#65292;&#20063;&#35831;&#23567;&#24515;&#12290;&#26368;&#21518;&#27880;&#24847;&#65292;&#20351;&#29992;<TT class=literal>full join fetch</TT> 
&#19982; <TT class=literal>right join fetch</TT>&#26159;&#27809;&#26377;&#24847;&#20041;&#30340;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#20351;&#29992;&#23646;&#24615;&#32423;&#21035;&#30340;&#24310;&#36831;&#33719;&#21462;&#65288;lazy fetching&#65289;&#65288;&#36825;&#26159;&#36890;&#36807;&#37325;&#26032;&#32534;&#20889;&#23383;&#33410;&#30721;&#23454;&#29616;&#30340;&#65289;&#65292;&#21487;&#20197;&#20351;&#29992; <TT class=literal>fetch 
all properties</TT> &#26469;&#24378;&#21046;Hibernate&#31435;&#21363;&#21462;&#24471;&#37027;&#20123;&#21407;&#26412;&#38656;&#35201;&#24310;&#36831;&#21152;&#36733;&#30340;&#23646;&#24615;&#65288;&#22312;&#31532;&#19968;&#20010;&#26597;&#35810;&#20013;&#65289;&#12290; </P><PRE class=programlisting>from Document fetch all properties order by name</PRE><PRE class=programlisting>from Document doc fetch all properties where lower(doc.name) like '%cats%'</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-joins-forms></A>14.4.&nbsp;join &#35821;&#27861;&#30340;&#24418;&#24335;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>HQL&#25903;&#25345;&#20004;&#31181;&#20851;&#32852;join&#30340;&#24418;&#24335;&#65306;<TT class=literal>implicit(&#38544;&#24335;)</TT> &#19982;<TT 
class=literal>explicit&#65288;&#26174;&#24335;&#65289;</TT>&#12290; </P>
<P>&#19978;&#19968;&#33410;&#20013;&#32473;&#20986;&#30340;&#26597;&#35810;&#37117;&#26159;&#20351;&#29992;<TT 
class=literal>explicit(&#26174;&#24335;)</TT>&#24418;&#24335;&#30340;&#65292;&#20854;&#20013;form&#23376;&#21477;&#20013;&#26126;&#30830;&#32473;&#20986;&#20102;join&#20851;&#38190;&#23383;&#12290;&#36825;&#26159;&#24314;&#35758;&#20351;&#29992;&#30340;&#26041;&#24335;&#12290; </P>
<P><TT class=literal>implicit&#65288;&#38544;&#24335;&#65289;</TT>&#24418;&#24335;&#19981;&#20351;&#29992;join&#20851;&#38190;&#23383;&#12290;&#20851;&#32852;&#20351;&#29992;"&#28857;&#21495;"&#26469;&#36827;&#34892;“&#24341;&#29992;”&#12290;<TT 
class=literal>implicit</TT> join&#21487;&#20197;&#22312;&#20219;&#20309;HQL&#23376;&#21477;&#20013;&#20986;&#29616;.<TT class=literal>implicit</TT> 
join&#22312;&#26368;&#32456;&#30340;SQL&#35821;&#21477;&#20013;&#20197;inner join&#30340;&#26041;&#24335;&#20986;&#29616;&#12290; </P><PRE class=programlisting>from Cat as cat where cat.mate.name like '%s%'</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-select></A>14.5.&nbsp;select&#23376;&#21477;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>select</TT> &#23376;&#21477;&#36873;&#25321;&#23558;&#21738;&#20123;&#23545;&#35937;&#19982;&#23646;&#24615;&#36820; &#22238;&#21040;&#26597;&#35810;&#32467;&#26524;&#38598;&#20013;. &#32771;&#34385;&#22914;&#19979;&#24773;&#20917;: </P><PRE class=programlisting>select mate 
from Cat as cat 
    inner join cat.mate as mate</PRE>
<P>&#35813;&#35821;&#21477;&#23558;&#36873;&#25321;<TT class=literal>mate</TT>s of other <TT 
class=literal>Cat</TT>s&#12290;&#65288;&#20854;&#20182;&#29483;&#30340;&#37197;&#20598;&#65289; &#23454;&#38469;&#19978;, &#20320;&#21487;&#20197;&#26356;&#31616;&#27905;&#30340;&#29992;&#20197;&#19979;&#30340;&#26597;&#35810;&#35821;&#21477;&#34920;&#36798;&#30456;&#21516;&#30340;&#21547;&#20041;: </P><PRE class=programlisting>select cat.mate from Cat cat</PRE>
<P>&#26597;&#35810;&#35821;&#21477;&#21487;&#20197;&#36820;&#22238;&#20540;&#20026;&#20219;&#20309;&#31867;&#22411;&#30340;&#23646;&#24615;&#65292;&#21253;&#25324;&#36820;&#22238;&#31867;&#22411;&#20026;&#26576;&#31181;&#32452;&#20214;(Component)&#30340;&#23646;&#24615;: </P><PRE class=programlisting>select cat.name from DomesticCat cat
where cat.name like 'fri%'</PRE><PRE class=programlisting>select cust.name.firstName from Customer as cust</PRE>
<P>&#26597;&#35810;&#35821;&#21477;&#21487;&#20197;&#36820;&#22238;&#22810;&#20010;&#23545;&#35937;&#21644;&#65288;&#25110;&#65289;&#23646;&#24615;&#65292;&#23384;&#25918;&#22312; <TT class=literal>Object[]</TT>&#38431;&#21015;&#20013;, </P><PRE class=programlisting>select mother, offspr, mate.name 
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr</PRE>
<P>&#25110;&#23384;&#25918;&#22312;&#19968;&#20010;<TT class=literal>List</TT>&#23545;&#35937;&#20013;, </P><PRE class=programlisting>select new list(mother, offspr, mate.name)
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr</PRE>
<P>&#20063;&#21487;&#33021;&#30452;&#25509;&#36820;&#22238;&#19968;&#20010;&#23454;&#38469;&#30340;&#31867;&#22411;&#23433;&#20840;&#30340;Java&#23545;&#35937;, </P><PRE class=programlisting>select new Family(mother, mate, offspr)
from DomesticCat as mother
    join mother.mate as mate
    left join mother.kittens as offspr</PRE>
<P>&#20551;&#35774;&#31867;<TT class=literal>Family</TT>&#26377;&#19968;&#20010;&#21512;&#36866;&#30340;&#26500;&#36896;&#20989;&#25968;. </P>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;&#20851;&#38190;&#23383;<TT class=literal>as</TT>&#32473;“&#34987;&#36873;&#25321;&#20102;&#30340;&#34920;&#36798;&#24335;”&#25351;&#27966;&#21035;&#21517;: </P><PRE class=programlisting>select max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n
from Cat cat</PRE>
<P>&#36825;&#31181;&#20570;&#27861;&#22312;&#19982;&#23376;&#21477;<TT class=literal>select new map</TT>&#19968;&#36215;&#20351;&#29992;&#26102;&#26368;&#26377;&#29992;: </P><PRE class=programlisting>select new map( max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n )
from Cat cat</PRE>
<P>&#35813;&#26597;&#35810;&#36820;&#22238;&#20102;&#19968;&#20010;<TT class=literal>Map</TT>&#30340;&#23545;&#35937;&#65292;&#20869;&#23481;&#26159;&#21035;&#21517;&#19982;&#34987;&#36873;&#25321;&#30340;&#20540;&#32452;&#25104;&#30340;&#21517;-&#20540;&#26144;&#23556;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-aggregation></A>14.6.&nbsp;&#32858;&#38598;&#20989;&#25968;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>HQL&#26597;&#35810;&#29978;&#33267;&#21487;&#20197;&#36820;&#22238;&#20316;&#29992;&#20110;&#23646;&#24615;&#20043;&#19978;&#30340;&#32858;&#38598;&#20989;&#25968;&#30340;&#35745;&#31639;&#32467;&#26524;: </P><PRE class=programlisting>select avg(cat.weight), sum(cat.weight), max(cat.weight), count(cat)
from Cat cat</PRE>
<P>&#21463;&#25903;&#25345;&#30340;&#32858;&#38598;&#20989;&#25968;&#22914;&#19979;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>avg(...), sum(...), min(...), max(...)</TT> </P>
  <LI>
  <P><TT class=literal>count(*)</TT> </P>
  <LI>
  <P><TT class=literal>count(...), count(distinct ...), count(all...)</TT> 
  </P></LI></UL></DIV>
<P>&#20320;&#21487;&#20197;&#22312;&#36873;&#25321;&#23376;&#21477;&#20013;&#20351;&#29992;&#25968;&#23398;&#25805;&#20316;&#31526;&#12289;&#36830;&#25509;&#20197;&#21450;&#32463;&#36807;&#39564;&#35777;&#30340;SQL&#20989;&#25968;&#65306; </P><PRE class=programlisting>select cat.weight + sum(kitten.weight) 
from Cat cat 
    join cat.kittens kitten
group by cat.id, cat.weight</PRE><PRE class=programlisting>select firstName||' '||initial||' '||upper(lastName) from Person</PRE>
<P>&#20851;&#38190;&#23383;<TT class=literal>distinct</TT>&#19982;<TT class=literal>all</TT> 
&#20063;&#21487;&#20197;&#20351;&#29992;&#65292;&#23427;&#20204;&#20855;&#26377;&#19982;SQL&#30456;&#21516;&#30340;&#35821;&#20041;. </P><PRE class=programlisting>select distinct cat.name from Cat cat

select count(distinct cat.name), count(cat) from Cat cat</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-polymorphism></A>14.7.&nbsp;&#22810;&#24577;&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;&#22914;&#19979;&#30340;&#26597;&#35810;&#35821;&#21477;: </P><PRE class=programlisting>from Cat as cat</PRE>
<P>&#19981;&#20165;&#36820;&#22238;<TT class=literal>Cat</TT>&#31867;&#30340;&#23454;&#20363;, &#20063;&#21516;&#26102;&#36820;&#22238;&#23376;&#31867; <TT 
class=literal>DomesticCat</TT>&#30340;&#23454;&#20363;. Hibernate &#21487;&#20197;&#22312;<TT 
class=literal>from</TT>&#23376;&#21477;&#20013;&#25351;&#23450;<SPAN class=emphasis><EM>&#20219;&#20309;</EM></SPAN> Java &#31867;&#25110;&#25509;&#21475;. 
&#26597;&#35810;&#20250;&#36820;&#22238;&#32487;&#25215;&#20102;&#35813;&#31867;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#23376;&#31867; &#30340;&#23454;&#20363;&#25110;&#36820;&#22238;&#22768;&#26126;&#20102;&#35813;&#25509;&#21475;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#12290;&#19979;&#38754;&#30340;&#26597;&#35810;&#35821;&#21477;&#36820;&#22238;&#25152;&#26377;&#30340;&#34987;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#65306; </P><PRE class=programlisting>from java.lang.Object o</PRE>
<P>&#25509;&#21475;<TT class=literal>Named</TT> &#21487;&#33021;&#34987;&#21508;&#31181;&#21508;&#26679;&#30340;&#25345;&#20037;&#21270;&#31867;&#22768;&#26126;&#65306; </P><PRE class=programlisting>from Named n, Named m where n.name = m.name</PRE>
<P>&#27880;&#24847;&#65292;&#26368;&#21518;&#30340;&#20004;&#20010;&#26597;&#35810;&#23558;&#38656;&#35201;&#36229;&#36807;&#19968;&#20010;&#30340;SQL <TT class=literal>SELECT</TT>.&#36825;&#34920;&#26126;<TT 
class=literal>order by</TT>&#23376;&#21477; &#27809;&#26377;&#23545;&#25972;&#20010;&#32467;&#26524;&#38598;&#36827;&#34892;&#27491;&#30830;&#30340;&#25490;&#24207;. (&#36825;&#20063;&#35828;&#26126;&#20320;&#19981;&#33021;&#23545;&#36825;&#26679;&#30340;&#26597;&#35810;&#20351;&#29992;<TT 
class=literal>Query.scroll()</TT>&#26041;&#27861;.) </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-where></A>14.8.&nbsp;where&#23376;&#21477;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>where</TT>&#23376;&#21477;&#20801;&#35768;&#20320;&#23558;&#36820;&#22238;&#30340;&#23454;&#20363;&#21015;&#34920;&#30340;&#33539;&#22260;&#32553;&#23567;. &#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#21035;&#21517;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#23646;&#24615;&#21517;&#26469;&#30452;&#25509;&#24341;&#29992;&#23646;&#24615;: 
</P><PRE class=programlisting>from Cat where name='Fritz'</PRE>
<P>&#22914;&#26524;&#25351;&#27966;&#20102;&#21035;&#21517;&#65292;&#38656;&#35201;&#20351;&#29992;&#23436;&#25972;&#30340;&#23646;&#24615;&#21517;: </P><PRE class=programlisting>from Cat as cat where cat.name='Fritz'</PRE>
<P>&#36820;&#22238;&#21517;&#20026;&#65288;&#23646;&#24615;name&#31561;&#20110;&#65289;'Fritz'&#30340;<TT class=literal>Cat</TT>&#31867;&#30340;&#23454;&#20363;&#12290; </P><PRE class=programlisting>select foo 
from Foo foo, Bar bar
where foo.startDate = bar.date</PRE>
<P>&#23558;&#36820;&#22238;&#25152;&#26377;&#28385;&#36275;&#19979;&#38754;&#26465;&#20214;&#30340;<TT class=literal>Foo</TT>&#31867;&#30340;&#23454;&#20363;&#65306; &#23384;&#22312;&#22914;&#19979;&#30340;<TT 
class=literal>bar</TT>&#30340;&#19968;&#20010;&#23454;&#20363;&#65292;&#20854;<TT class=literal>date</TT>&#23646;&#24615;&#31561;&#20110; <TT 
class=literal>Foo</TT>&#30340;<TT class=literal>startDate</TT>&#23646;&#24615;&#12290; &#22797;&#21512;&#36335;&#24452;&#34920;&#36798;&#24335;&#20351;&#24471;<TT 
class=literal>where</TT>&#23376;&#21477;&#38750;&#24120;&#30340;&#24378;&#22823;&#65292;&#32771;&#34385;&#22914;&#19979;&#24773;&#20917;&#65306; </P><PRE class=programlisting>from Cat cat where cat.mate.name is not null</PRE>
<P>&#35813;&#26597;&#35810;&#23558;&#34987;&#32763;&#35793;&#25104;&#20026;&#19968;&#20010;&#21547;&#26377;&#34920;&#36830;&#25509;&#65288;&#20869;&#36830;&#25509;&#65289;&#30340;SQL&#26597;&#35810;&#12290;&#22914;&#26524;&#20320;&#25171;&#31639;&#20889;&#20687;&#36825;&#26679;&#30340;&#26597;&#35810;&#35821;&#21477; </P><PRE class=programlisting>from Foo foo  
where foo.bar.baz.customer.address.city is not null</PRE>
<P>&#22312;SQL&#20013;&#65292;&#20320;&#20026;&#36798;&#27492;&#30446;&#30340;&#23558;&#38656;&#35201;&#36827;&#34892;&#19968;&#20010;&#22235;&#34920;&#36830;&#25509;&#30340;&#26597;&#35810;&#12290; </P>
<P><TT class=literal>=</TT>&#36816;&#31639;&#31526;&#19981;&#20165;&#21487;&#20197;&#34987;&#29992;&#26469;&#27604;&#36739;&#23646;&#24615;&#30340;&#20540;&#65292;&#20063;&#21487;&#20197;&#29992;&#26469;&#27604;&#36739;&#23454;&#20363;&#65306; </P><PRE class=programlisting>from Cat cat, Cat rival where cat.mate = rival.mate</PRE><PRE class=programlisting>select cat, mate 
from Cat cat, Cat mate
where cat.mate = mate</PRE>
<P>&#29305;&#27530;&#23646;&#24615;&#65288;&#23567;&#20889;&#65289;<TT class=literal>id</TT>&#21487;&#20197;&#29992;&#26469;&#34920;&#31034;&#19968;&#20010;&#23545;&#35937;&#30340;&#21807;&#19968;&#30340;&#26631;&#35782;&#31526;&#12290;&#65288;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#35813;&#23545;&#35937;&#30340;&#23646;&#24615;&#21517;&#12290;&#65289; </P><PRE class=programlisting>from Cat as cat where cat.id = 123

from Cat as cat where cat.mate.id = 69</PRE>
<P>&#31532;&#20108;&#20010;&#26597;&#35810;&#26159;&#26377;&#25928;&#30340;&#12290;&#27492;&#26102;&#19981;&#38656;&#35201;&#36827;&#34892;&#34920;&#36830;&#25509;&#65281; </P>
<P>&#21516;&#26679;&#20063;&#21487;&#20197;&#20351;&#29992;&#22797;&#21512;&#26631;&#35782;&#31526;&#12290;&#27604;&#22914;<TT class=literal>Person</TT>&#31867;&#26377;&#19968;&#20010;&#22797;&#21512;&#26631;&#35782;&#31526;&#65292;&#23427;&#30001;<TT 
class=literal>country</TT>&#23646;&#24615; &#19982;<TT class=literal>medicareNumber</TT>&#23646;&#24615;&#32452;&#25104;&#12290; </P><PRE class=programlisting>from bank.Person person
where person.id.country = 'AU' 
    and person.id.medicareNumber = 123456</PRE><PRE class=programlisting>from bank.Account account
where account.owner.id.country = 'AU' 
    and account.owner.id.medicareNumber = 123456</PRE>
<P>&#31532;&#20108;&#20010;&#26597;&#35810;&#20063;&#19981;&#38656;&#35201;&#36827;&#34892;&#34920;&#36830;&#25509;&#12290; </P>
<P>&#21516;&#26679;&#30340;&#65292;&#29305;&#27530;&#23646;&#24615;<TT class=literal>class</TT>&#22312;&#36827;&#34892;&#22810;&#24577;&#25345;&#20037;&#21270;&#30340;&#24773;&#20917;&#19979;&#34987;&#29992;&#26469;&#23384;&#21462;&#19968;&#20010;&#23454;&#20363;&#30340;&#37492;&#21035;&#20540;&#65288;discriminator 
value&#65289;&#12290; &#19968;&#20010;&#23884;&#20837;&#21040;where&#23376;&#21477;&#20013;&#30340;Java&#31867;&#30340;&#21517;&#23383;&#23558;&#34987;&#36716;&#25442;&#20026;&#35813;&#31867;&#30340;&#37492;&#21035;&#20540;&#12290; </P><PRE class=programlisting>from Cat cat where cat.class = DomesticCat</PRE>
<P>&#20320;&#20063;&#21487;&#20197;&#22768;&#26126;&#19968;&#20010;&#23646;&#24615;&#30340;&#31867;&#22411;&#26159;&#32452;&#20214;&#25110;&#32773;&#22797;&#21512;&#29992;&#25143;&#31867;&#22411;&#65288;&#20197;&#21450;&#30001;&#32452;&#20214;&#26500;&#25104;&#30340;&#32452;&#20214;&#31561;&#31561;&#65289;&#12290;&#27704;&#36828;&#19981;&#35201;&#23581;&#35797;&#20351;&#29992;&#20197;&#32452;&#20214;&#31867;&#22411;&#26469;&#32467;&#23614;&#30340;&#36335;&#24452;&#34920;&#36798;&#24335;&#65288;path-expression&#65289; 
&#65288;&#19982;&#27492;&#30456;&#21453;&#65292;&#20320;&#24212;&#24403;&#20351;&#29992;&#32452;&#20214;&#30340;&#19968;&#20010;&#23646;&#24615;&#26469;&#32467;&#23614;&#65289;&#12290; &#20030;&#20363;&#26469;&#35828;&#65292;&#22914;&#26524;<TT class=literal>store.owner</TT>&#21547;&#26377;&#19968;&#20010;&#21253;&#21547;&#20102;&#32452;&#20214;&#30340;&#23454;&#20307;<TT 
class=literal>address</TT> </P><PRE class=programlisting>store.owner.address.city    // &#27491;&#30830;
store.owner.address         // &#38169;&#35823;!</PRE>
<P>&#19968;&#20010;“&#20219;&#24847;”&#31867;&#22411;&#26377;&#20004;&#20010;&#29305;&#27530;&#30340;&#23646;&#24615;<TT class=literal>id</TT>&#21644;<TT class=literal>class</TT>, 
&#26469;&#20801;&#35768;&#25105;&#20204;&#25353;&#29031;&#19979;&#38754;&#30340;&#26041;&#24335;&#34920;&#36798;&#19968;&#20010;&#36830;&#25509;&#65288;<TT class=literal>AuditLog.item</TT> &#26159;&#19968;&#20010;&#23646;&#24615;&#65292;&#35813;&#23646;&#24615;&#34987;&#26144;&#23556;&#20026;<TT 
class=literal>&lt;any&gt;</TT>&#65289;&#12290; </P><PRE class=programlisting>from AuditLog log, Payment payment 
where log.item.class = 'Payment' and log.item.id = payment.id</PRE>
<P>&#27880;&#24847;&#65292;&#22312;&#19978;&#38754;&#30340;&#26597;&#35810;&#19982;&#21477;&#20013;&#65292;<TT class=literal>log.item.class</TT> &#21644; <TT 
class=literal>payment.class</TT> &#23558;&#28041;&#21450;&#21040;&#23436;&#20840;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#20013;&#30340;&#21015;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-expressions></A>14.9.&nbsp;&#34920;&#36798;&#24335;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;<TT class=literal>where</TT>&#23376;&#21477;&#20013;&#20801;&#35768;&#20351;&#29992;&#30340;&#34920;&#36798;&#24335;&#21253;&#25324; &#22823;&#22810;&#25968;&#20320;&#21487;&#20197;&#22312;SQL&#20351;&#29992;&#30340;&#34920;&#36798;&#24335;&#31181;&#31867;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#25968;&#23398;&#36816;&#31639;&#31526;<TT class=literal>+, -, *, /</TT> </P>
  <LI>
  <P>&#20108;&#36827;&#21046;&#27604;&#36739;&#36816;&#31639;&#31526;<TT class=literal>=, &gt;=, &lt;=, &lt;&gt;, !=, like</TT> </P>
  <LI>
  <P>&#36923;&#36753;&#36816;&#31639;&#31526;<TT class=literal>and, or, not</TT> </P>
  <LI>
  <P><TT class=literal>in</TT>, <TT class=literal>not in</TT>, <TT 
  class=literal>between</TT>, <TT class=literal>is null</TT>, <TT 
  class=literal>is not null</TT>, <TT class=literal>is empty</TT>, <TT 
  class=literal>is not empty</TT>, <TT class=literal>member of</TT> and <TT 
  class=literal>not member of</TT> </P>
  <LI>
  <P>"&#31616;&#21333;&#30340;" case, <TT class=literal>case ... when ... then ... else ... 
  end</TT>,&#21644; "&#25628;&#32034;" case, <TT class=literal>case when ... then ... else ... 
  end</TT> </P>
  <LI>
  <P>&#23383;&#31526;&#20018;&#36830;&#25509;&#31526;<TT class=literal>...||...</TT> or <TT 
  class=literal>concat(...,...)</TT> </P>
  <LI>
  <P><TT class=literal>current_date()</TT>, <TT 
  class=literal>current_time()</TT>, <TT class=literal>current_timestamp()</TT> 
  </P>
  <LI>
  <P><TT class=literal>second(...)</TT>, <TT class=literal>minute(...)</TT>, <TT 
  class=literal>hour(...)</TT>, <TT class=literal>day(...)</TT>, <TT 
  class=literal>month(...)</TT>, <TT class=literal>year(...)</TT>, </P>
  <LI>
  <P>EJB-QL 3.0&#23450;&#20041;&#30340;&#20219;&#20309;&#20989;&#25968;&#25110;&#25805;&#20316;&#65306;<TT class=literal>substring(), trim(), lower(), 
  upper(), length(), locate(), abs(), sqrt(), bit_length()&#65292; mod()</TT> </P>
  <LI>
  <P><TT class=literal>coalesce()</TT> &#21644; <TT class=literal>nullif()</TT> </P>
  <LI>
  <P><TT class=literal>str()</TT> &#25226;&#25968;&#23383;&#25110;&#32773;&#26102;&#38388;&#20540;&#36716;&#25442;&#20026;&#21487;&#35835;&#30340;&#23383;&#31526;&#20018; </P>
  <LI>
  <P><TT class=literal>cast(... as ...)</TT>, &#20854;&#31532;&#20108;&#20010;&#21442;&#25968;&#26159;&#26576;Hibernate&#31867;&#22411;&#30340;&#21517;&#23383;&#65292;&#20197;&#21450;<TT 
  class=literal>extract(... from ...)</TT>&#65292;&#21482;&#35201;ANSI <TT class=literal>cast()</TT> 
  &#21644; <TT class=literal>extract()</TT> &#34987;&#24213;&#23618;&#25968;&#25454;&#24211;&#25903;&#25345; </P>
  <LI>
  <P>HQL <TT class=literal>index()</TT> &#20989;&#25968;&#65292;&#20316;&#29992;&#20110;join&#30340;&#26377;&#24207;&#38598;&#21512;&#30340;&#21035;&#21517;&#12290; </P>
  <LI>
  <P>HQL&#20989;&#25968;&#65292;&#25226;&#38598;&#21512;&#20316;&#20026;&#21442;&#25968;:<TT class=literal>size(), minelement(), maxelement(), 
  minindex(), maxindex()</TT>,&#36824;&#26377;&#29305;&#21035;&#30340;<TT class=literal>elements()</TT> &#21644;<TT 
  class=literal>indices</TT>&#20989;&#25968;&#65292;&#21487;&#20197;&#19982;&#25968;&#37327;&#35789;&#21152;&#20197;&#38480;&#23450;&#65306;<TT class=literal>some, all, exists, 
  any, in</TT>&#12290; </P>
  <LI>
  <P>&#20219;&#20309;&#25968;&#25454;&#24211;&#25903;&#25345;&#30340;SQL&#26631;&#37327;&#20989;&#25968;&#65292;&#27604;&#22914;<TT class=literal>sign()</TT>, <TT 
  class=literal>trunc()</TT>, <TT class=literal>rtrim()</TT>, <TT 
  class=literal>sin()</TT> </P>
  <LI>
  <P>JDBC&#39118;&#26684;&#30340;&#21442;&#25968;&#20256;&#20837; <TT class=literal>?</TT> </P>
  <LI>
  <P>&#21629;&#21517;&#21442;&#25968;<TT class=literal>:name</TT>, <TT class=literal>:start_date</TT>, <TT 
  class=literal>:x1</TT> </P>
  <LI>
  <P>SQL &#30452;&#25509;&#24120;&#37327; <TT class=literal>'foo'</TT>, <TT class=literal>69</TT>, <TT 
  class=literal>6.66E+2</TT>, <TT class=literal>'1970-01-01 10:00:01.0'</TT> 
</P>
  <LI>
  <P>Java <TT class=literal>public static final</TT> &#31867;&#22411;&#30340;&#24120;&#37327; <TT 
  class=literal>eg.Color.TABBY</TT> </P></LI></UL></DIV>
<P>&#20851;&#38190;&#23383;<TT class=literal>in</TT>&#19982;<TT class=literal>between</TT>&#21487;&#25353;&#22914;&#19979;&#26041;&#27861;&#20351;&#29992;: </P><PRE class=programlisting>from DomesticCat cat where cat.name between 'A' and 'B'</PRE><PRE class=programlisting>from DomesticCat cat where cat.name in ( 'Foo', 'Bar', 'Baz' )</PRE>
<P>&#32780;&#19988;&#21542;&#23450;&#30340;&#26684;&#24335;&#20063;&#21487;&#20197;&#22914;&#19979;&#20070;&#20889;&#65306; </P><PRE class=programlisting>from DomesticCat cat where cat.name not between 'A' and 'B'</PRE><PRE class=programlisting>from DomesticCat cat where cat.name not in ( 'Foo', 'Bar', 'Baz' )</PRE>
<P>&#21516;&#26679;, &#23376;&#21477;<TT class=literal>is null</TT>&#19982;<TT class=literal>is not 
null</TT>&#21487;&#20197;&#34987;&#29992;&#26469;&#27979;&#35797;&#31354;&#20540;(null). </P>
<P>&#22312;Hibernate&#37197;&#32622;&#25991;&#20214;&#20013;&#22768;&#26126;HQL“&#26597;&#35810;&#26367;&#20195;&#65288;query substitutions&#65289;”&#20043;&#21518;&#65292; 
&#24067;&#23572;&#34920;&#36798;&#24335;&#65288;Booleans&#65289;&#21487;&#20197;&#22312;&#20854;&#20182;&#34920;&#36798;&#24335;&#20013;&#36731;&#26494;&#30340;&#20351;&#29992;: </P><PRE class=programlisting>&lt;property name="hibernate.query.substitutions"&gt;true 1, false 0&lt;/property&gt;</PRE>
<P>&#31995;&#32479;&#23558;&#35813;HQL&#36716;&#25442;&#20026;SQL&#35821;&#21477;&#26102;&#65292;&#35813;&#35774;&#32622;&#34920;&#26126;&#23558;&#29992;&#23383;&#31526; <TT class=literal>1</TT> &#21644; <TT 
class=literal>0</TT> &#26469; &#21462;&#20195;&#20851;&#38190;&#23383;<TT class=literal>true</TT> &#21644; <TT 
class=literal>false</TT>: </P><PRE class=programlisting>from Cat cat where cat.alive = true</PRE>
<P>&#20320;&#21487;&#20197;&#29992;&#29305;&#27530;&#23646;&#24615;<TT class=literal>size</TT>, &#25110;&#26159;&#29305;&#27530;&#20989;&#25968;<TT 
class=literal>size()</TT>&#27979;&#35797;&#19968;&#20010;&#38598;&#21512;&#30340;&#22823;&#23567;&#12290; </P><PRE class=programlisting>from Cat cat where cat.kittens.size &gt; 0</PRE><PRE class=programlisting>from Cat cat where size(cat.kittens) &gt; 0</PRE>
<P>&#23545;&#20110;&#32034;&#24341;&#20102;&#65288;&#26377;&#24207;&#65289;&#30340;&#38598;&#21512;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>minindex</TT> &#19982; <TT 
class=literal>maxindex</TT>&#20989;&#25968;&#26469;&#24341;&#29992;&#21040;&#26368;&#23567;&#19982;&#26368;&#22823;&#30340;&#32034;&#24341;&#24207;&#25968;&#12290; &#21516;&#29702;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT 
class=literal>minelement</TT> &#19982; <TT class=literal>maxelement</TT>&#20989;&#25968;&#26469; 
&#24341;&#29992;&#21040;&#19968;&#20010;&#22522;&#26412;&#25968;&#25454;&#31867;&#22411;&#30340;&#38598;&#21512;&#20013;&#26368;&#23567;&#19982;&#26368;&#22823;&#30340;&#20803;&#32032;&#12290; </P><PRE class=programlisting>from Calendar cal where maxelement(cal.holidays) &gt; current_date</PRE><PRE class=programlisting>from Order order where maxindex(order.items) &gt; 100</PRE><PRE class=programlisting>from Order order where minelement(order.items) &gt; 10000</PRE>
<P>&#22312;&#20256;&#36882;&#19968;&#20010;&#38598;&#21512;&#30340;&#32034;&#24341;&#38598;&#25110;&#32773;&#26159;&#20803;&#32032;&#38598;(<TT class=literal>elements</TT>&#19982;<TT 
class=literal>indices</TT> &#20989;&#25968;) &#25110;&#32773;&#20256;&#36882;&#19968;&#20010;&#23376;&#26597;&#35810;&#30340;&#32467;&#26524;&#30340;&#26102;&#20505;&#65292;&#21487;&#20197;&#20351;&#29992;SQL&#20989;&#25968;<TT class=literal>any, 
some, all, exists, in</TT> </P><PRE class=programlisting>select mother from Cat as mother, Cat as kit
where kit in elements(foo.kittens)</PRE><PRE class=programlisting>select p from NameList list, Person p
where p.name = some elements(list.names)</PRE><PRE class=programlisting>from Cat cat where exists elements(cat.kittens)</PRE><PRE class=programlisting>from Player p where 3 &gt; all elements(p.scores)</PRE><PRE class=programlisting>from Show show where 'fizard' in indices(show.acts)</PRE>
<P>&#27880;&#24847;&#65292;&#22312;Hibernate3&#31181;&#65292;&#36825;&#20123;&#32467;&#26500;&#21464;&#37327;- <TT class=literal>size</TT>, <TT 
class=literal>elements</TT>, <TT class=literal>indices</TT>, <TT 
class=literal>minindex</TT>, <TT class=literal>maxindex</TT>, <TT 
class=literal>minelement</TT>, <TT class=literal>maxelement</TT> - 
&#21482;&#33021;&#22312;where&#23376;&#21477;&#20013;&#20351;&#29992;&#12290; </P>
<P>&#19968;&#20010;&#34987;&#32034;&#24341;&#36807;&#30340;&#65288;&#26377;&#24207;&#30340;&#65289;&#38598;&#21512;&#30340;&#20803;&#32032;(arrays, lists, maps)&#21487;&#20197;&#22312;&#20854;&#20182;&#32034;&#24341;&#20013;&#34987;&#24341;&#29992;&#65288;&#21482;&#33021;&#22312;where&#23376;&#21477;&#20013;&#65289;&#65306; </P><PRE class=programlisting>from Order order where order.items[0].id = 1234</PRE><PRE class=programlisting>select person from Person person, Calendar calendar
where calendar.holidays['national day'] = person.birthDay
    and person.nationality.calendar = calendar</PRE><PRE class=programlisting>select item from Item item, Order order
where order.items[ order.deliveredItemIndices[0] ] = item and order.id = 11</PRE><PRE class=programlisting>select item from Item item, Order order
where order.items[ maxindex(order.items) ] = item and order.id = 11</PRE>
<P>&#22312;<TT class=literal>[]</TT>&#20013;&#30340;&#34920;&#36798;&#24335;&#29978;&#33267;&#21487;&#20197;&#26159;&#19968;&#20010;&#31639;&#25968;&#34920;&#36798;&#24335;&#12290; </P><PRE class=programlisting>select item from Item item, Order order
where order.items[ size(order.items) - 1 ] = item</PRE>
<P>&#23545;&#20110;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#65288;one-to-many association&#65289;&#25110;&#26159;&#20540;&#30340;&#38598;&#21512;&#20013;&#30340;&#20803;&#32032;&#65292; HQL&#20063;&#25552;&#20379;&#20869;&#24314;&#30340;<TT 
class=literal>index()</TT>&#20989;&#25968;&#65292; </P><PRE class=programlisting>select item, index(item) from Order order 
    join order.items item
where index(item) &lt; 5</PRE>
<P>&#22914;&#26524;&#24213;&#23618;&#25968;&#25454;&#24211;&#25903;&#25345;&#26631;&#37327;&#30340;SQL&#20989;&#25968;&#65292;&#23427;&#20204;&#20063;&#21487;&#20197;&#34987;&#20351;&#29992; </P><PRE class=programlisting>from DomesticCat cat where upper(cat.name) like 'FRI%'</PRE>
<P>&#22914;&#26524;&#20320;&#36824;&#19981;&#33021;&#23545;&#25152;&#26377;&#30340;&#36825;&#20123;&#28145;&#20449;&#19981;&#30097;&#65292;&#24819;&#24819;&#19979;&#38754;&#30340;&#26597;&#35810;&#12290;&#22914;&#26524;&#20351;&#29992;SQL&#65292;&#35821;&#21477;&#38271;&#24230;&#20250;&#22686;&#38271;&#22810;&#23569;&#65292;&#21487;&#35835;&#24615;&#20250;&#19979;&#38477;&#22810;&#23569;&#65306; </P><PRE class=programlisting>select cust
from Product prod,
    Store store
    inner join store.customers cust
where prod.name = 'widget'
    and store.location.name in ( 'Melbourne', 'Sydney' )
    and prod = all elements(cust.currentOrder.lineItems)</PRE>
<P><SPAN class=emphasis><EM>&#25552;&#31034;:</EM></SPAN> &#20250;&#20687;&#22914;&#19979;&#30340;&#35821;&#21477; </P><PRE class=programlisting>SELECT cust.name, cust.address, cust.phone, cust.id, cust.current_order
FROM customers cust,
    stores store,
    locations loc,
    store_customers sc,
    product prod
WHERE prod.name = 'widget'
    AND store.loc_id = loc.id
    AND loc.name IN ( 'Melbourne', 'Sydney' )
    AND sc.store_id = store.id
    AND sc.cust_id = cust.id
    AND prod.id = ALL(
        SELECT item.prod_id
        FROM line_items item, orders o
        WHERE item.order_id = o.id
            AND cust.current_order = o.id
    )</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-ordering></A>14.10.&nbsp;order by&#23376;&#21477;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26597;&#35810;&#36820;&#22238;&#30340;&#21015;&#34920;(list)&#21487;&#20197;&#25353;&#29031;&#19968;&#20010;&#36820;&#22238;&#30340;&#31867;&#25110;&#32452;&#20214;&#65288;components)&#20013;&#30340;&#20219;&#20309;&#23646;&#24615;&#65288;property&#65289;&#36827;&#34892;&#25490;&#24207;&#65306; </P><PRE class=programlisting>from DomesticCat cat
order by cat.name asc, cat.weight desc, cat.birthdate</PRE>
<P>&#21487;&#36873;&#30340;<TT class=literal>asc</TT>&#25110;<TT class=literal>desc</TT>&#20851;&#38190;&#23383;&#25351;&#26126;&#20102;&#25353;&#29031;&#21319;&#24207;&#25110;&#38477;&#24207;&#36827;&#34892;&#25490;&#24207;. 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-grouping></A>14.11.&nbsp;group by&#23376;&#21477;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;&#36820;&#22238;&#32858;&#38598;&#20540;(aggregate values)&#30340;&#26597;&#35810;&#21487;&#20197;&#25353;&#29031;&#19968;&#20010;&#36820;&#22238;&#30340;&#31867;&#25110;&#32452;&#20214;&#65288;components)&#20013;&#30340;&#20219;&#20309;&#23646;&#24615;&#65288;property&#65289;&#36827;&#34892;&#20998;&#32452;&#65306; 
</P><PRE class=programlisting>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color</PRE><PRE class=programlisting>select foo.id, avg(name), max(name) 
from Foo foo join foo.names name
group by foo.id</PRE>
<P><TT class=literal>having</TT>&#23376;&#21477;&#22312;&#36825;&#37324;&#20063;&#20801;&#35768;&#20351;&#29992;. </P><PRE class=programlisting>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color 
having cat.color in (eg.Color.TABBY, eg.Color.BLACK)</PRE>
<P>&#22914;&#26524;&#24213;&#23618;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;&#30340;&#35805;(&#20363;&#22914;&#19981;&#33021;&#22312;MySQL&#20013;&#20351;&#29992;)&#65292;SQL&#30340;&#19968;&#33324;&#20989;&#25968;&#19982;&#32858;&#38598;&#20989;&#25968;&#20063;&#21487;&#20197;&#20986;&#29616; &#22312;<TT 
class=literal>having</TT>&#19982;<TT class=literal>order by</TT> &#23376;&#21477;&#20013;&#12290; </P><PRE class=programlisting>select cat
from Cat cat
    join cat.kittens kitten
group by cat
having avg(kitten.weight) &gt; 100
order by count(kitten) asc, sum(kitten.weight) desc</PRE>
<P>&#27880;&#24847;<TT class=literal>group by</TT>&#23376;&#21477;&#19982; <TT class=literal>order 
by</TT>&#23376;&#21477;&#20013;&#37117;&#19981;&#33021;&#21253;&#21547;&#31639;&#26415;&#34920;&#36798;&#24335;&#65288;arithmetic expressions&#65289;. </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-subqueries></A>14.12.&nbsp;&#23376;&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#20110;&#25903;&#25345;&#23376;&#26597;&#35810;&#30340;&#25968;&#25454;&#24211;&#65292;Hibernate&#25903;&#25345;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;&#23376;&#26597;&#35810;&#12290;&#19968;&#20010;&#23376;&#26597;&#35810;&#24517;&#39035;&#34987;&#22278;&#25324;&#21495;&#21253;&#22260;&#36215;&#26469;&#65288;&#32463;&#24120;&#26159;SQL&#32858;&#38598;&#20989;&#25968;&#30340;&#22278;&#25324;&#21495;&#65289;&#12290; 
&#29978;&#33267;&#30456;&#20114;&#20851;&#32852;&#30340;&#23376;&#26597;&#35810;&#65288;&#24341;&#29992;&#21040;&#22806;&#37096;&#26597;&#35810;&#20013;&#30340;&#21035;&#21517;&#30340;&#23376;&#26597;&#35810;&#65289;&#20063;&#26159;&#20801;&#35768;&#30340;&#12290; </P><PRE class=programlisting>from Cat as fatcat 
where fatcat.weight &gt; ( 
    select avg(cat.weight) from DomesticCat cat 
)</PRE><PRE class=programlisting>from DomesticCat as cat 
where cat.name = some ( 
    select name.nickName from Name as name 
)</PRE><PRE class=programlisting>from Cat as cat 
where not exists ( 
    from Cat as mate where mate.mate = cat 
)</PRE><PRE class=programlisting>from DomesticCat as cat 
where cat.name not in ( 
    select name.nickName from Name as name 
)</PRE><PRE class=programlisting>select cat.id, (select max(kit.weight) from cat.kitten kit) 
from Cat as cat</PRE>
<P>&#27880;&#24847;&#65292;HQL&#33258;&#26597;&#35810;&#21482;&#21487;&#20197;&#22312;select&#25110;&#32773;where&#23376;&#21477;&#20013;&#20986;&#29616;&#12290; </P>
<P>&#22312;select&#21015;&#34920;&#20013;&#21253;&#21547;&#19968;&#20010;&#34920;&#36798;&#24335;&#20197;&#19978;&#30340;&#23376;&#26597;&#35810;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#20803;&#32452;&#26500;&#36896;&#31526;&#65288;tuple constructors&#65289;&#65306; </P><PRE class=programlisting>from Cat as cat 
where not ( cat.name, cat.color ) in ( 
    select cat.name, cat.color from DomesticCat cat 
)</PRE>
<P>&#27880;&#24847;&#22312;&#26576;&#20123;&#25968;&#25454;&#24211;&#20013;&#65288;&#19981;&#21253;&#25324;Oracle&#19982;HSQL&#65289;&#65292;&#20320;&#20063;&#21487;&#20197;&#22312;&#20854;&#20182;&#35821;&#22659;&#20013;&#20351;&#29992;&#20803;&#32452;&#26500;&#36896;&#31526;&#65292; &#27604;&#22914;&#26597;&#35810;&#29992;&#25143;&#31867;&#22411;&#30340;&#32452;&#20214;&#19982;&#32452;&#21512;&#65306; </P><PRE class=programlisting>from Person where name = ('Gavin', 'A', 'King')</PRE>
<P>&#35813;&#26597;&#35810;&#31561;&#20215;&#20110;&#26356;&#22797;&#26434;&#30340;&#65306; </P><PRE class=programlisting>from Person where name.first = 'Gavin' and name.initial = 'A' and name.last = 'King')</PRE>
<P>&#26377;&#20004;&#20010;&#24456;&#22909;&#30340;&#29702;&#30001;&#20351;&#20320;&#19981;&#24212;&#24403;&#20316;&#36825;&#26679;&#30340;&#20107;&#24773;&#65306;&#39318;&#20808;&#65292;&#23427;&#19981;&#23436;&#20840;&#36866;&#29992;&#20110;&#21508;&#20010;&#25968;&#25454;&#24211;&#24179;&#21488;&#65307;&#20854;&#27425;&#65292;&#26597;&#35810;&#29616;&#22312;&#20381;&#36182;&#20110;&#26144;&#23556;&#25991;&#20214;&#20013;&#23646;&#24615;&#30340;&#39034;&#24207;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-examples></A>14.13.&nbsp;HQL&#31034;&#20363;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#26597;&#35810;&#21487;&#20197;&#38750;&#24120;&#30340;&#24378;&#22823;&#19982;&#22797;&#26434;&#12290;&#23454;&#38469;&#19978;&#65292;Hibernate&#30340;&#19968;&#20010;&#20027;&#35201;&#21334;&#28857;&#23601;&#26159;&#26597;&#35810;&#35821;&#21477;&#30340;&#23041;&#21147;&#12290;&#36825;&#37324;&#26377;&#19968;&#20123;&#20363;&#23376;&#65292;&#23427;&#20204;&#19982;&#25105;&#22312;&#26368;&#36817;&#30340; 
&#19968;&#20010;&#39033;&#30446;&#20013;&#20351;&#29992;&#30340;&#26597;&#35810;&#38750;&#24120;&#30456;&#20284;&#12290;&#27880;&#24847;&#20320;&#33021;&#29992;&#21040;&#30340;&#22823;&#22810;&#25968;&#26597;&#35810;&#27604;&#36825;&#20123;&#35201;&#31616;&#21333;&#30340;&#22810;&#65281; </P>
<P>&#19979;&#38754;&#30340;&#26597;&#35810;&#23545;&#20110;&#26576;&#20010;&#29305;&#23450;&#30340;&#23458;&#25143;&#30340;&#25152;&#26377;&#26410;&#25903;&#20184;&#30340;&#36134;&#21333;&#65292;&#22312;&#32473;&#23450;&#32473;&#26368;&#23567;&#24635;&#20215;&#20540;&#30340;&#24773;&#20917;&#19979;&#65292;&#36820;&#22238;&#35746;&#21333;&#30340;id&#65292;&#26465;&#30446;&#30340;&#25968;&#37327;&#21644;&#24635;&#20215;&#20540;&#65292; 
&#36820;&#22238;&#20540;&#25353;&#29031;&#24635;&#20215;&#20540;&#30340;&#32467;&#26524;&#36827;&#34892;&#25490;&#24207;&#12290;&#20026;&#20102;&#20915;&#23450;&#20215;&#26684;&#65292;&#26597;&#35810;&#20351;&#29992;&#20102;&#24403;&#21069;&#30446;&#24405;&#12290;&#20316;&#20026;&#36716;&#25442;&#32467;&#26524;&#30340;SQL&#26597;&#35810;&#65292;&#20351;&#29992;&#20102;<TT class=literal>ORDER</TT>, 
<TT class=literal>ORDER_LINE</TT>, <TT class=literal>PRODUCT</TT>, <TT 
class=literal>CATALOG</TT> &#21644;<TT class=literal>PRICE</TT> &#24211;&#34920;&#12290; </P><PRE class=programlisting>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog.effectiveDate &lt; sysdate
    and catalog.effectiveDate &gt;= all (
        select cat.effectiveDate 
        from Catalog as cat
        where cat.effectiveDate &lt; sysdate
    )
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc</PRE>
<P>&#36825;&#31616;&#30452;&#26159;&#19968;&#20010;&#24618;&#29289;&#65281;&#23454;&#38469;&#19978;&#65292;&#22312;&#29616;&#23454;&#29983;&#27963;&#20013;&#65292;&#25105;&#24182;&#19981;&#28909;&#34935;&#20110;&#23376;&#26597;&#35810;&#65292;&#25152;&#20197;&#25105;&#30340;&#26597;&#35810;&#35821;&#21477;&#30475;&#36215;&#26469;&#26356;&#20687;&#36825;&#20010;&#65306; </P><PRE class=programlisting>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog = :currentCatalog
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc</PRE>
<P>&#19979;&#38754;&#19968;&#20010;&#26597;&#35810;&#35745;&#31639;&#27599;&#19968;&#31181;&#29366;&#24577;&#19979;&#30340;&#25903;&#20184;&#30340;&#25968;&#30446;&#65292;&#38500;&#21435;&#25152;&#26377;&#22788;&#20110;<TT 
class=literal>AWAITING_APPROVAL</TT>&#29366;&#24577;&#30340;&#25903;&#20184;&#65292;&#22240;&#20026;&#22312;&#35813;&#29366;&#24577;&#19979; 
&#24403;&#21069;&#30340;&#29992;&#25143;&#20316;&#20986;&#20102;&#29366;&#24577;&#30340;&#26368;&#26032;&#25913;&#21464;&#12290;&#35813;&#26597;&#35810;&#34987;&#36716;&#25442;&#25104;&#21547;&#26377;&#20004;&#20010;&#20869;&#36830;&#25509;&#20197;&#21450;&#19968;&#20010;&#30456;&#20851;&#32852;&#30340;&#23376;&#36873;&#25321;&#30340;SQL&#26597;&#35810;&#65292;&#35813;&#26597;&#35810;&#20351;&#29992;&#20102;&#34920; <TT 
class=literal>PAYMENT</TT>, <TT class=literal>PAYMENT_STATUS</TT> &#20197;&#21450; <TT 
class=literal>PAYMENT_STATUS_CHANGE</TT>&#12290; </P><PRE class=programlisting>select count(payment), status.name 
from Payment as payment 
    join payment.currentStatus as status
    join payment.statusChanges as statusChange
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or (
        statusChange.timeStamp = ( 
            select max(change.timeStamp) 
            from PaymentStatusChange change 
            where change.payment = payment
        )
        and statusChange.user &lt;&gt; :currentUser
    )
group by status.name, status.sortOrder
order by status.sortOrder</PRE>
<P>&#22914;&#26524;&#25105;&#25226;<TT class=literal>statusChanges</TT>&#23454;&#20363;&#38598;&#26144;&#23556;&#20026;&#19968;&#20010;&#21015;&#34920;&#65288;list&#65289;&#32780;&#19981;&#26159;&#19968;&#20010;&#38598;&#21512;&#65288;set&#65289;, 
&#20070;&#20889;&#26597;&#35810;&#35821;&#21477;&#23558;&#26356;&#21152;&#31616;&#21333;. </P><PRE class=programlisting>select count(payment), status.name 
from Payment as payment
    join payment.currentStatus as status
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or payment.statusChanges[ maxIndex(payment.statusChanges) ].user &lt;&gt; :currentUser
group by status.name, status.sortOrder
order by status.sortOrder</PRE>
<P>&#19979;&#38754;&#19968;&#20010;&#26597;&#35810;&#20351;&#29992;&#20102;MS SQL Server&#30340; <TT 
class=literal>isNull()</TT>&#20989;&#25968;&#29992;&#20197;&#36820;&#22238;&#24403;&#21069;&#29992;&#25143;&#25152;&#23646;&#32452;&#32455;&#30340;&#32452;&#32455;&#24080;&#21495;&#21450;&#32452;&#32455;&#26410;&#25903;&#20184;&#30340;&#36134;&#12290; &#23427;&#34987;&#36716;&#25442;&#25104;&#19968;&#20010;&#23545;&#34920;<TT 
class=literal>ACCOUNT</TT>, <TT class=literal>PAYMENT</TT>, <TT 
class=literal>PAYMENT_STATUS</TT>, <TT class=literal>ACCOUNT_TYPE</TT>, <TT 
class=literal>ORGANIZATION</TT> &#20197;&#21450; <TT class=literal>ORG_USER</TT>&#36827;&#34892;&#30340;&#19977;&#20010;&#20869;&#36830;&#25509;&#65292; 
&#19968;&#20010;&#22806;&#36830;&#25509;&#21644;&#19968;&#20010;&#23376;&#36873;&#25321;&#30340;SQL&#26597;&#35810;&#12290; </P><PRE class=programlisting>select account, payment
from Account as account
    left outer join account.payments as payment
where :currentUser in elements(account.holder.users)
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate</PRE>
<P>&#23545;&#20110;&#19968;&#20123;&#25968;&#25454;&#24211;&#65292;&#25105;&#20204;&#38656;&#35201;&#24323;&#29992;&#65288;&#30456;&#20851;&#30340;&#65289;&#23376;&#36873;&#25321;&#12290; </P><PRE class=programlisting>select account, payment
from Account as account
    join account.holder.users as user
    left outer join account.payments as payment
where :currentUser = user
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-bulk></A>14.14.&nbsp;&#25209;&#37327;&#30340;UPDATE&#21644;DELETE</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>HQL&#29616;&#22312;&#25903;&#25345; <TT class=literal>update</TT>, <TT class=literal>delete</TT> &#21644; <TT 
class=literal>insert ... select ...</TT>&#35821;&#21477;. &#26597;&#38405; <A 
title="13.4.&nbsp;DML(&#25968;&#25454;&#25805;&#20316;&#35821;&#35328;)&#39118;&#26684;&#30340;&#25805;&#20316;(DML-style operations)" 
href="#batch-direct">&#31532;&nbsp;13.4&nbsp;&#33410; “DML(&#25968;&#25454;&#25805;&#20316;&#35821;&#35328;)&#39118;&#26684;&#30340;&#25805;&#20316;(DML-style 
operations)”</A> &#20197;&#33719;&#24471;&#26356;&#22810;&#20449;&#24687;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=queryhql-tipstricks></A>14.15.&nbsp;&#23567;&#25216;&#24039; &amp; &#23567;&#31373;&#38376;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#32479;&#35745;&#26597;&#35810;&#32467;&#26524;&#30340;&#25968;&#30446;&#32780;&#19981;&#24517;&#23454;&#38469;&#30340;&#36820;&#22238;&#20182;&#20204;&#65306; </P><PRE class=programlisting>( (Integer) session.iterate("select count(*) from ....").next() ).intValue()</PRE>
<P>&#33509;&#24819;&#26681;&#25454;&#19968;&#20010;&#38598;&#21512;&#30340;&#22823;&#23567;&#26469;&#36827;&#34892;&#25490;&#24207;&#65292;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#30340;&#35821;&#21477;&#65306; </P><PRE class=programlisting>select usr.id, usr.name
from User as usr 
    left join usr.messages as msg
group by usr.id, usr.name
order by count(msg)</PRE>
<P>&#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;&#23376;&#36873;&#25321;&#65292;&#20320;&#21487;&#20197;&#22312;&#20320;&#30340;&#26597;&#35810;&#30340;where&#23376;&#21477;&#20013;&#20026;&#36873;&#25321;&#30340;&#22823;&#23567;&#65288;selection size&#65289;&#25351;&#23450;&#19968;&#20010;&#26465;&#20214;: </P><PRE class=programlisting>from User usr where size(usr.messages) &gt;= 1</PRE>
<P>&#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#23376;&#36873;&#25321;&#35821;&#21477;&#65292;&#20351;&#29992;&#19979;&#38754;&#30340;&#26597;&#35810;&#65306; </P><PRE class=programlisting>select usr.id, usr.name
from User usr.name
    join usr.messages msg
group by usr.id, usr.name
having count(msg) &gt;= 1</PRE>
<P>&#22240;&#20026;&#20869;&#36830;&#25509;&#65288;inner join&#65289;&#30340;&#21407;&#22240;&#65292;&#36825;&#20010;&#35299;&#20915;&#26041;&#26696;&#19981;&#33021;&#36820;&#22238;&#21547;&#26377;&#38646;&#20010;&#20449;&#24687;&#30340;<TT class=literal>User</TT> &#31867;&#30340;&#23454;&#20363;, 
&#25152;&#20197;&#36825;&#31181;&#24773;&#20917;&#19979;&#20351;&#29992;&#19979;&#38754;&#30340;&#26684;&#24335;&#23558;&#26159;&#26377;&#24110;&#21161;&#30340;: </P><PRE class=programlisting>select usr.id, usr.name
from User as usr
    left join usr.messages as msg
group by usr.id, usr.name
having count(msg) = 0</PRE>
<P>JavaBean&#30340;&#23646;&#24615;&#21487;&#20197;&#34987;&#32465;&#23450;&#21040;&#19968;&#20010;&#21629;&#21517;&#26597;&#35810;&#65288;named query&#65289;&#30340;&#21442;&#25968;&#19978;&#65306; </P><PRE class=programlisting>Query q = s.createQuery("from foo Foo as foo where foo.name=:name and foo.size=:size");
q.setProperties(fooBean); // fooBean&#21253;&#21547;&#26041;&#27861;getName()&#19982;getSize()
List foos = q.list();</PRE>
<P>&#36890;&#36807;&#23558;&#25509;&#21475;<TT class=literal>Query</TT>&#19982;&#19968;&#20010;&#36807;&#28388;&#22120;&#65288;filter&#65289;&#19968;&#36215;&#20351;&#29992;&#65292;&#38598;&#21512;&#65288;Collections&#65289;&#26159;&#21487;&#20197;&#20998;&#39029;&#30340;&#65306; 
</P><PRE class=programlisting>Query q = s.createFilter( collection, "" ); // &#19968;&#20010;&#31616;&#21333;&#30340;&#36807;&#28388;&#22120;
q.setMaxResults(PAGE_SIZE);
q.setFirstResult(PAGE_SIZE * pageNumber);
List page = q.list();</PRE>
<P>&#36890;&#36807;&#20351;&#29992;&#26597;&#35810;&#36807;&#28388;&#22120;&#65288;query filter&#65289;&#21487;&#20197;&#23558;&#38598;&#21512;&#65288;Collection&#65289;&#30340;&#21407;&#32032;&#20998;&#32452;&#25110;&#25490;&#24207;: </P><PRE class=programlisting>Collection orderedCollection = s.filter( collection, "order by this.amount" );
Collection counts = s.filter( collection, "select this.type, count(this) group by this.type" );</PRE>
<P>&#19981;&#29992;&#36890;&#36807;&#21021;&#22987;&#21270;&#65292;&#20320;&#23601;&#21487;&#20197;&#30693;&#36947;&#19968;&#20010;&#38598;&#21512;&#65288;Collection&#65289;&#30340;&#22823;&#23567;&#65306; </P><PRE class=programlisting>( (Integer) session.iterate("select count(*) from ....").next() ).intValue();</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=querycriteria></A>&#31532;&nbsp;15&nbsp;&#31456;&nbsp; &#26465;&#20214;&#26597;&#35810;(Criteria 
Queries) </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20855;&#26377;&#19968;&#20010;&#30452;&#35266;&#30340;&#12289;&#21487;&#25193;&#23637;&#30340;&#26465;&#20214;&#26597;&#35810;API&#26159;Hibernate&#30340;&#29305;&#33394;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-creating></A>15.1.&nbsp;&#21019;&#24314;&#19968;&#20010;<TT class=literal>Criteria</TT> 
&#23454;&#20363;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.Criteria</TT>&#25509;&#21475;&#34920;&#31034;&#29305;&#23450;&#25345;&#20037;&#31867;&#30340;&#19968;&#20010;&#26597;&#35810;&#12290;<TT 
class=literal>Session</TT>&#26159; <TT class=literal>Criteria</TT>&#23454;&#20363;&#30340;&#24037;&#21378;&#12290; </P><PRE class=programlisting>Criteria crit = sess.createCriteria(Cat.class);
crit.setMaxResults(50);
List cats = crit.list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-narrowing></A>15.2.&nbsp;&#38480;&#21046;&#32467;&#26524;&#38598;&#20869;&#23481;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19968;&#20010;&#21333;&#29420;&#30340;&#26597;&#35810;&#26465;&#20214;&#26159;<TT class=literal>org.hibernate.criterion.Criterion</TT> 
&#25509;&#21475;&#30340;&#19968;&#20010;&#23454;&#20363;&#12290;<TT class=literal>org.hibernate.criterion.Restrictions</TT>&#31867; 
&#23450;&#20041;&#20102;&#33719;&#24471;&#26576;&#20123;&#20869;&#32622;<TT class=literal>Criterion</TT>&#31867;&#22411;&#30340;&#24037;&#21378;&#26041;&#27861;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .add( Restrictions.between("weight", minWeight, maxWeight) )
    .list();</PRE>
<P>&#32422;&#26463;&#21487;&#20197;&#25353;&#36923;&#36753;&#20998;&#32452;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .add( Restrictions.or(
        Restrictions.eq( "age", new Integer(0) ),
        Restrictions.isNull("age")
    ) )
    .list();</PRE><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.in( "name", new String[] { "Fritz", "Izi", "Pk" } ) )
    .add( Restrictions.disjunction()
        .add( Restrictions.isNull("age") )
    	.add( Restrictions.eq("age", new Integer(0) ) )
    	.add( Restrictions.eq("age", new Integer(1) ) )
    	.add( Restrictions.eq("age", new Integer(2) ) )
    ) )
    .list();</PRE>
<P>Hibernate&#25552;&#20379;&#20102;&#30456;&#24403;&#22810;&#30340;&#20869;&#32622;criterion&#31867;&#22411;(<TT class=literal>Restrictions</TT> &#23376;&#31867;), 
&#20294;&#26159;&#23588;&#20854;&#26377;&#29992;&#30340;&#26159;&#21487;&#20197;&#20801;&#35768;&#20320;&#30452;&#25509;&#20351;&#29992;SQL&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.sqlRestriction("lower({alias}.name) like lower(?)", "Fritz%", Hibernate.STRING) )
    .list();</PRE>
<P><TT class=literal>{alias}</TT>&#21344;&#20301;&#31526;&#24212;&#24403;&#34987;&#26367;&#25442;&#20026;&#34987;&#26597;&#35810;&#23454;&#20307;&#30340;&#21015;&#21035;&#21517;&#12290; </P>
<P><TT class=literal>Property</TT>&#23454;&#20363;&#26159;&#33719;&#24471;&#19968;&#20010;&#26465;&#20214;&#30340;&#21478;&#22806;&#19968;&#31181;&#36884;&#24452;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;<TT 
class=literal>Property.forName()</TT> &#21019;&#24314;&#19968;&#20010;<TT class=literal>Property</TT>&#12290; </P><PRE class=programlisting>Property age = Property.forName("age");
List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.disjunction()
        .add( age.isNull() )
    	.add( age.eq( new Integer(0) ) )
    	.add( age.eq( new Integer(1) ) )
    	.add( age.eq( new Integer(2) ) )
    ) )
    .add( Property.forName("name").in( new String[] { "Fritz", "Izi", "Pk" } ) )
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-ordering></A>15.3.&nbsp;&#32467;&#26524;&#38598;&#25490;&#24207;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>org.hibernate.criterion.Order</TT>&#26469;&#20026;&#26597;&#35810;&#32467;&#26524;&#25490;&#24207;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "F%")
    .addOrder( Order.asc("name") )
    .addOrder( Order.desc("age") )
    .setMaxResults(50)
    .list();</PRE><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Property.forName("name").like("F%") )
    .addOrder( Property.forName("name").asc() )
    .addOrder( Property.forName("age").desc() )
    .setMaxResults(50)
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-associations></A>15.4.&nbsp;&#20851;&#32852;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>createCriteria()</TT>&#38750;&#24120;&#23481;&#26131;&#30340;&#22312;&#20114;&#30456;&#20851;&#32852;&#30340;&#23454;&#20307;&#38388;&#24314;&#31435; &#32422;&#26463;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "F%") )
    .createCriteria("kittens")
        .add( Restrictions.like("name", "F%") )
    .list();</PRE>
<P>&#27880;&#24847;&#31532;&#20108;&#20010; <TT class=literal>createCriteria()</TT>&#36820;&#22238;&#19968;&#20010;&#26032;&#30340; <TT 
class=literal>Criteria</TT>&#23454;&#20363;&#65292;&#35813;&#23454;&#20363;&#24341;&#29992;<TT class=literal>kittens</TT> &#38598;&#21512;&#20013;&#30340;&#20803;&#32032;&#12290; </P>
<P>&#25509;&#19979;&#26469;&#65292;&#26367;&#25442;&#24418;&#24577;&#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#20063;&#26159;&#24456;&#26377;&#29992;&#30340;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .createAlias("kittens", "kt")
    .createAlias("mate", "mt")
    .add( Restrictions.eqProperty("kt.name", "mt.name") )
    .list();</PRE>
<P>(<TT class=literal>createAlias()</TT>&#24182;&#19981;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340; <TT 
class=literal>Criteria</TT>&#23454;&#20363;&#12290;) </P>
<P><TT class=literal>Cat</TT>&#23454;&#20363;&#25152;&#20445;&#23384;&#30340;&#20043;&#21069;&#20004;&#27425;&#26597;&#35810;&#25152;&#36820;&#22238;&#30340;kittens&#38598;&#21512;&#26159; <SPAN 
class=emphasis><EM>&#27809;&#26377;</EM></SPAN>&#34987;&#26465;&#20214;&#39044;&#36807;&#28388;&#30340;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#21482;&#33719;&#24471;&#31526;&#21512;&#26465;&#20214;&#30340;kittens&#65292; &#20320;&#24517;&#39035;&#20351;&#29992;<TT 
class=literal>ResultTransformer</TT>&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .createCriteria("kittens", "kt")
        .add( Restrictions.eq("name", "F%") )
    .setResultTransformer(Criteria.ALIAS_TO_ENTITY_MAP)
    .list();
Iterator iter = cats.iterator();
while ( iter.hasNext() ) {
    Map map = (Map) iter.next();
    Cat cat = (Cat) map.get(Criteria.ROOT_ALIAS);
    Cat kitten = (Cat) map.get("kt");
}</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-dynamicfetching></A>15.5.&nbsp;&#21160;&#24577;&#20851;&#32852;&#25235;&#21462;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>setFetchMode()</TT>&#22312;&#36816;&#34892;&#26102;&#23450;&#20041;&#21160;&#24577;&#20851;&#32852;&#25235;&#21462;&#30340;&#35821;&#20041;&#12290; </P><PRE class=programlisting>List cats = sess.createCriteria(Cat.class)
    .add( Restrictions.like("name", "Fritz%") )
    .setFetchMode("mate", FetchMode.EAGER)
    .setFetchMode("kittens", FetchMode.EAGER)
    .list();</PRE>
<P>&#36825;&#20010;&#26597;&#35810;&#21487;&#20197;&#36890;&#36807;&#22806;&#36830;&#25509;&#25235;&#21462;<TT class=literal>mate</TT>&#21644;<TT class=literal>kittens</TT>&#12290; &#26597;&#30475;<A 
title="19.1.&nbsp;&#10;&#9;&#9;&#9;&#25235;&#21462;&#31574;&#30053;(Fetching strategies)&#10;&#9;&#9;" 
href="#performance-fetching">&#31532;&nbsp;19.1&nbsp;&#33410; “ &#25235;&#21462;&#31574;&#30053;(Fetching strategies) 
”</A>&#21487;&#20197;&#33719;&#24471;&#26356;&#22810;&#20449;&#24687;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-examples></A>15.6.&nbsp;&#26597;&#35810;&#31034;&#20363;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.criterion.Example</TT>&#31867;&#20801;&#35768;&#20320;&#36890;&#36807;&#19968;&#20010;&#32473;&#23450;&#23454;&#20363; &#26500;&#24314;&#19968;&#20010;&#26465;&#20214;&#26597;&#35810;&#12290; 
</P><PRE class=programlisting>Cat cat = new Cat();
cat.setSex('F');
cat.setColor(Color.BLACK);
List results = session.createCriteria(Cat.class)
    .add( Example.create(cat) )
    .list();</PRE>
<P>&#29256;&#26412;&#23646;&#24615;&#12289;&#26631;&#35782;&#31526;&#21644;&#20851;&#32852;&#34987;&#24573;&#30053;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#20540;&#20026;null&#30340;&#23646;&#24615;&#23558;&#34987;&#25490;&#38500;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#33258;&#34892;&#35843;&#25972;<TT class=literal>Example</TT>&#20351;&#20043;&#26356;&#23454;&#29992;&#12290; </P><PRE class=programlisting>Example example = Example.create(cat)
    .excludeZeroes()           //exclude zero valued properties
    .excludeProperty("color")  //exclude the property named "color"
    .ignoreCase()              //perform case insensitive string comparisons
    .enableLike();             //use like for string comparisons
List results = session.createCriteria(Cat.class)
    .add(example)
    .list();</PRE>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#20351;&#29992;examples&#22312;&#20851;&#32852;&#23545;&#35937;&#19978;&#25918;&#32622;&#26465;&#20214;&#12290; </P><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .add( Example.create(cat) )
    .createCriteria("mate")
        .add( Example.create( cat.getMate() ) )
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-projection></A>15.7.&nbsp;&#25237;&#24433;(Projections)&#12289;&#32858;&#21512;&#65288;aggregation&#65289;&#21644;&#20998;&#32452;&#65288;grouping&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.criterion.Projections</TT>&#26159; <TT 
class=literal>Projection</TT> &#30340;&#23454;&#20363;&#24037;&#21378;&#12290;&#25105;&#20204;&#36890;&#36807;&#35843;&#29992; <TT 
class=literal>setProjection()</TT>&#24212;&#29992;&#25237;&#24433;&#21040;&#19968;&#20010;&#26597;&#35810;&#12290; </P><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.rowCount() )
    .add( Restrictions.eq("color", Color.BLACK) )
    .list();</PRE><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.projectionList()
        .add( Projections.rowCount() )
        .add( Projections.avg("weight") )
        .add( Projections.max("weight") )
        .add( Projections.groupProperty("color") )
    )
    .list();</PRE>
<P>&#22312;&#19968;&#20010;&#26465;&#20214;&#26597;&#35810;&#20013;&#27809;&#26377;&#24517;&#35201;&#26174;&#24335;&#30340;&#20351;&#29992; "group by" &#12290;&#26576;&#20123;&#25237;&#24433;&#31867;&#22411;&#23601;&#26159;&#34987;&#23450;&#20041;&#20026;<SPAN class=emphasis><EM> 
&#20998;&#32452;&#25237;&#24433;</EM></SPAN>&#65292;&#20182;&#20204;&#20063;&#20986;&#29616;&#22312;SQL&#30340;<TT class=literal>group by</TT>&#23376;&#21477;&#20013;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#36873;&#25321;&#25226;&#19968;&#20010;&#21035;&#21517;&#25351;&#27966;&#32473;&#19968;&#20010;&#25237;&#24433;&#65292;&#36825;&#26679;&#21487;&#20197;&#20351;&#25237;&#24433;&#20540;&#34987;&#32422;&#26463;&#25110;&#25490;&#24207;&#25152;&#24341;&#29992;&#12290;&#19979;&#38754;&#26159;&#20004;&#31181;&#19981;&#21516;&#30340;&#23454;&#29616;&#26041;&#24335;&#65306; </P><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.alias( Projections.groupProperty("color"), "colr" ) )
    .addOrder( Order.asc("colr") )
    .list();</PRE><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.groupProperty("color").as("colr") )
    .addOrder( Order.asc("colr") )
    .list();</PRE>
<P><TT class=literal>alias()</TT>&#21644;<TT class=literal>as()</TT>&#26041;&#27861;&#31616;&#20415;&#30340;&#23558;&#19968;&#20010;&#25237;&#24433;&#23454;&#20363;&#21253;&#35013;&#21040;&#21478;&#22806;&#19968;&#20010; 
&#21035;&#21517;&#30340;<TT class=literal>Projection</TT>&#23454;&#20363;&#20013;&#12290;&#31616;&#32780;&#35328;&#20043;&#65292;&#24403;&#20320;&#28155;&#21152;&#19968;&#20010;&#25237;&#24433;&#21040;&#19968;&#20010;&#25237;&#24433;&#21015;&#34920;&#20013;&#26102; &#20320;&#21487;&#20197;&#20026;&#23427;&#25351;&#23450;&#19968;&#20010;&#21035;&#21517;&#65306; </P><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.projectionList()
        .add( Projections.rowCount(), "catCountByColor" )
        .add( Projections.avg("weight"), "avgWeight" )
        .add( Projections.max("weight"), "maxWeight" )
        .add( Projections.groupProperty("color"), "color" )
    )
    .addOrder( Order.desc("catCountByColor") )
    .addOrder( Order.desc("avgWeight") )
    .list();</PRE><PRE class=programlisting>List results = session.createCriteria(Domestic.class, "cat")
    .createAlias("kittens", "kit")
    .setProjection( Projections.projectionList()
        .add( Projections.property("cat.name"), "catName" )
        .add( Projections.property("kit.name"), "kitName" )
    )
    .addOrder( Order.asc("catName") )
    .addOrder( Order.asc("kitName") )
    .list();</PRE>
<P>&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;<TT class=literal>Property.forName()</TT>&#26469;&#34920;&#31034;&#25237;&#24433;&#65306; </P><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Property.forName("name") )
    .add( Property.forName("color").eq(Color.BLACK) )
    .list();</PRE><PRE class=programlisting>List results = session.createCriteria(Cat.class)
    .setProjection( Projections.projectionList()
        .add( Projections.rowCount().as("catCountByColor") )
        .add( Property.forName("weight").avg().as("avgWeight") )
        .add( Property.forName("weight").max().as("maxWeight") )
        .add( Property.forName("color").group().as("color" )
    )
    .addOrder( Order.desc("catCountByColor") )
    .addOrder( Order.desc("avgWeight") )
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querycriteria-detachedqueries></A>15.8.&nbsp;&#31163;&#32447;(detached)&#26597;&#35810;&#21644;&#23376;&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>DetachedCriteria</TT>&#31867;&#20351;&#20320;&#22312;&#19968;&#20010;session&#33539;&#22260;&#20043;&#22806;&#21019;&#24314;&#19968;&#20010;&#26597;&#35810;&#65292;&#24182;&#19988;&#21487;&#20197;&#20351;&#29992;&#20219;&#24847;&#30340; <TT 
class=literal>Session</TT>&#26469;&#25191;&#34892;&#23427;&#12290; </P><PRE class=programlisting>DetachedCriteria query = DetachedCriteria.forClass(Cat.class)
    .add( Property.forName("sex").eq('F') );
    
Session session = ....;
Transaction txn = session.beginTransaction();
List results = query.getExecutableCriteria(session).setMaxResults(100).list();
txn.commit();
session.close();</PRE>
<P><TT class=literal>DetachedCriteria</TT>&#20063;&#21487;&#20197;&#29992;&#20197;&#34920;&#31034;&#23376;&#26597;&#35810;&#12290;&#26465;&#20214;&#23454;&#20363;&#21253;&#21547;&#23376;&#26597;&#35810;&#21487;&#20197;&#36890;&#36807; <TT 
class=literal>Subqueries</TT>&#25110;&#32773;<TT class=literal>Property</TT>&#33719;&#24471;&#12290; </P><PRE class=programlisting>DetachedCriteria avgWeight = DetachedCriteria.forClass(Cat.class)
	.setProjection( Property.forName("weight").avg() );
session.createCriteria(Cat.class)
	.add( Property.forName("weight).gt(avgWeight) )
	.list();</PRE><PRE class=programlisting>DetachedCriteria weights = DetachedCriteria.forClass(Cat.class)
	.setProjection( Property.forName("weight") );
session.createCriteria(Cat.class)
	.add( Subqueries.geAll("weight", weights) )
	.list();</PRE>
<P>&#29978;&#33267;&#30456;&#20114;&#20851;&#32852;&#30340;&#23376;&#26597;&#35810;&#20063;&#26159;&#26377;&#21487;&#33021;&#30340;&#65306; </P><PRE class=programlisting>DetachedCriteria avgWeightForSex = DetachedCriteria.forClass(Cat.class, "cat2")
	.setProjection( Property.forName("weight").avg() )
	.add( Property.forName("cat2.sex").eqProperty("cat.sex") );
session.createCriteria(Cat.class, "cat")
	.add( Property.forName("weight).gt(avgWeightForSex) )
	.list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=query-criteria-naturalid></A>15.9.&nbsp;&#26681;&#25454;&#33258;&#28982;&#26631;&#35782;&#26597;&#35810;(Queries by natural 
identifier)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#22823;&#22810;&#25968;&#26597;&#35810;&#65292;&#21253;&#25324;&#26465;&#20214;&#26597;&#35810;&#32780;&#35328;&#65292;&#22240;&#20026;&#26597;&#35810;&#32531;&#23384;&#30340;&#22833;&#25928;(invalidation)&#21457;&#29983;&#24471;&#22826;&#39057;&#32321;&#65292;&#26597;&#35810;&#32531;&#23384;&#19981;&#26159;&#38750;&#24120;&#39640;&#25928;&#12290;&#28982;&#32780;&#65292;&#26377;&#19968;&#31181;&#29305;&#21035;&#30340;&#26597;&#35810;&#65292;&#21487;&#20197;&#36890;&#36807;&#19981;&#21464;&#30340;&#33258;&#28982;&#38190;&#20248;&#21270;&#32531;&#23384;&#30340;&#22833;&#25928;&#31639;&#27861;&#12290;&#22312;&#26576;&#20123;&#24212;&#29992;&#20013;&#65292;&#36825;&#31181;&#31867;&#22411;&#30340;&#26597;&#35810;&#27604;&#36739;&#24120;&#35265;&#12290;&#26465;&#20214;&#26597;&#35810;API&#23545;&#36825;&#31181;&#29992;&#20363;&#25552;&#20379;&#20102;&#29305;&#21035;&#35268;&#32422;&#12290; 
</P>
<P>&#39318;&#20808;&#65292;&#20320;&#24212;&#35813;&#23545;&#20320;&#30340;entity&#20351;&#29992;<TT class=literal>&lt;natural-id&gt;</TT>&#26469;&#26144;&#23556;&#33258;&#28982;&#38190;&#65292;&#28982;&#21518;&#25171;&#24320;&#31532;&#20108;&#32423;&#32531;&#23384;&#12290; 
</P><PRE class=programlisting>&lt;class name="User"&gt;
    &lt;cache usage="read-write"/&gt;
    &lt;id name="id"&gt;
        &lt;generator class="increment"/&gt;
    &lt;/id&gt;
    &lt;natural-id&gt;
        &lt;property name="name"/&gt;
        &lt;property name="org"/&gt;
    &lt;/natural-id&gt;
    &lt;property name="password"/&gt;
&lt;/class&gt;</PRE>
<P>&#27880;&#24847;,&#27492;&#21151;&#33021;&#23545;&#20855;&#26377;<SPAN class=emphasis><EM>mutable</EM></SPAN>&#33258;&#28982;&#38190;&#30340;entity&#24182;&#19981;&#36866;&#29992;&#12290; </P>
<P>&#28982;&#21518;&#65292;&#25171;&#24320;Hibernate &#26597;&#35810;&#32531;&#23384;&#12290; </P>
<P>&#29616;&#22312;&#65292;&#25105;&#20204;&#21487;&#20197;&#29992;<TT class=literal>Restrictions.naturalId()</TT>&#26469;&#20351;&#29992;&#26356;&#21152;&#39640;&#25928;&#30340;&#32531;&#23384;&#31639;&#27861;&#12290; </P><PRE class=programlisting>session.createCriteria(User.class)
    .add( Restrictions.naturalId()
        .set("name", "gavin")
        .set("org", "hb") 
    ).setCacheable(true)
    .uniqueResult();</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=querysql></A>&#31532;&nbsp;16&nbsp;&#31456;&nbsp;Native 
SQL&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#20320;&#30340;&#25968;&#25454;&#24211;&#30340;Native SQL&#35821;&#35328;&#26469;&#26597;&#35810;&#25968;&#25454;&#12290;&#36825;&#23545;&#20320;&#22312;&#35201;&#20351;&#29992;&#25968;&#25454;&#24211;&#30340;&#26576;&#20123;&#29305;&#24615;&#30340;&#26102;&#20505;(&#27604;&#22914;&#35828;&#22312;&#26597;&#35810;&#25552;&#31034;&#25110;&#32773;Oracle&#20013;&#30340; <TT 
class=literal>CONNECT</TT>&#20851;&#38190;&#23383;)&#65292;&#36825;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;&#36825;&#23601;&#33021;&#22815;&#25195;&#28165;&#20320;&#25226;&#21407;&#26469;&#30452;&#25509;&#20351;&#29992;SQL/JDBC &#30340;&#31243;&#24207;&#36801;&#31227;&#21040;&#22522;&#20110; 
Hibernate&#24212;&#29992;&#30340;&#36947;&#36335;&#19978;&#30340;&#38556;&#30861;&#12290; </P>
<P>Hibernate3&#20801;&#35768;&#20320;&#20351;&#29992;&#25163;&#20889;&#30340;sql&#26469;&#23436;&#25104;&#25152;&#26377;&#30340;create,update,delete,&#21644;load&#25805;&#20316;&#65288;&#21253;&#25324;&#23384;&#20648;&#36807;&#31243;&#65289; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querysql-creating></A>16.1.&nbsp;&#20351;&#29992;<TT 
class=literal>SQLQuery</TT></H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23545;&#21407;&#29983;SQL&#26597;&#35810;&#25191;&#34892;&#30340;&#25511;&#21046;&#26159;&#36890;&#36807;<TT class=literal>SQLQuery</TT>&#25509;&#21475;&#36827;&#34892;&#30340;&#65292;&#36890;&#36807;&#25191;&#34892;<TT 
class=literal>Session.createSQLQuery()</TT>&#33719;&#21462;&#36825;&#20010;&#25509;&#21475;&#12290;&#26368;&#31616;&#21333;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#21487;&#20197;&#37319;&#29992;&#20197;&#19979;&#24418;&#24335;&#65306;</P><PRE class=programlisting>List cats = sess.createSQLQuery("select * from cats")
    .addEntity(Cat.class)
    .list();</PRE>
<P>&#36825;&#20010;&#26597;&#35810;&#25351;&#23450;&#20102;:</P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>SQL&#26597;&#35810;&#23383;&#31526;&#20018;</P>
  <LI>
  <P>&#26597;&#35810;&#36820;&#22238;&#30340;&#23454;&#20307;</P></LI></UL></DIV>
<P>&#36825;&#37324;&#65292;&#32467;&#26524;&#38598;&#23383;&#27573;&#21517;&#34987;&#20551;&#35774;&#20026;&#19982;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#26126;&#30340;&#23383;&#27573;&#21517;&#30456;&#21516;&#12290;&#23545;&#20110;&#36830;&#25509;&#20102;&#22810;&#20010;&#34920;&#30340;&#26597;&#35810;&#65292;&#36825;&#23601;&#21487;&#33021;&#36896;&#25104;&#38382;&#39064;&#65292;&#22240;&#20026;&#21487;&#33021;&#22312;&#22810;&#20010;&#34920;&#20013;&#20986;&#29616;&#21516;&#26679;&#21517;&#23383;&#30340;&#23383;&#27573;&#12290;&#19979;&#38754;&#30340;&#26041;&#27861;&#23601;&#21487;&#20197;&#36991;&#20813;&#23383;&#27573;&#21517;&#37325;&#22797;&#30340;&#38382;&#39064;:</P><PRE class=programlisting>List cats = sess.createSQLQuery("select {cat.*} from cats cat")
    .addEntity("cat", Cat.class)
    .list();</PRE>
<P>&#36825;&#20010;&#26597;&#35810;&#25351;&#23450;&#20102;: </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>SQL&#26597;&#35810;&#35821;&#21477;&#65292;&#23427;&#24102;&#19968;&#20010;&#21344;&#20301;&#31526;&#65292;&#21487;&#20197;&#35753;Hibernate&#20351;&#29992;&#23383;&#27573;&#30340;&#21035;&#21517;. </P>
  <LI>
  <P>&#26597;&#35810;&#36820;&#22238;&#30340;&#23454;&#20307;&#65292;&#21644;&#23427;&#30340;SQL&#34920;&#30340;&#21035;&#21517;. </P></LI></UL></DIV>
<P><TT class=literal>addEntity()</TT>&#26041;&#27861;&#23558;SQL&#34920;&#30340;&#21035;&#21517;&#21644;&#23454;&#20307;&#31867;&#32852;&#31995;&#36215;&#26469;&#65292;&#24182;&#19988;&#30830;&#23450;&#26597;&#35810;&#32467;&#26524;&#38598;&#30340;&#24418;&#24577;&#12290; </P>
<P><TT class=literal>addJoin()</TT>&#26041;&#27861;&#21487;&#20197;&#34987;&#29992;&#20110;&#36733;&#20837;&#20854;&#20182;&#30340;&#23454;&#20307;&#21644;&#38598;&#21512;&#30340;&#20851;&#32852;. </P><PRE class=programlisting>List cats = sess.createSQLQuery(
        "select {cat.*}, {kitten.*} from cats cat, cats kitten where kitten.mother = cat.id"
    )
    .addEntity("cat", Cat.class)
    .addJoin("kitten", "cat.kittens")
    .list();</PRE>
<P>&#21407;&#29983;&#30340;SQL&#26597;&#35810;&#21487;&#33021;&#36820;&#22238;&#19968;&#20010;&#31616;&#21333;&#30340;&#26631;&#37327;&#20540;&#25110;&#32773;&#19968;&#20010;&#26631;&#37327;&#21644;&#23454;&#20307;&#30340;&#32467;&#21512;&#20307;&#12290; </P><PRE class=programlisting>Double max = (Double) sess.createSQLQuery("select max(cat.weight) as maxWeight from cats cat")
        .addScalar("maxWeight", Hibernate.DOUBLE);
        .uniqueResult();</PRE>
<P>&#38500;&#27492;&#20043;&#22806;&#65292;&#20320;&#36824;&#21487;&#20197;&#22312;&#20320;&#30340;hbm&#25991;&#20214;&#20013;&#25551;&#36848;&#32467;&#26524;&#38598;&#26144;&#23556;&#20449;&#24687;&#65292;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;&#12290;</P><PRE class=programlisting>List cats = sess.createSQLQuery(
        "select {cat.*}, {kitten.*} from cats cat, cats kitten where kitten.mother = cat.id"
    )
    .setResultSetMapping("catAndKitten")
    .list();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querysql-aliasreferences></A>16.2.&nbsp;&#21035;&#21517;&#21644;&#23646;&#24615;&#24341;&#29992;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19978;&#38754;&#20351;&#29992;&#30340;<TT class=literal>{cat.*}</TT>&#26631;&#35760;&#26159; "&#25152;&#26377;&#23646;&#24615;" 
&#30340;&#31616;&#20889;.&#20320;&#21487;&#20197;&#26174;&#24335;&#22320;&#21015;&#20986;&#38656;&#35201;&#30340;&#23383;&#27573;,&#20294;&#26159;&#20320;&#24517;&#39035;&#35753;Hibernate 
&#20026;&#27599;&#19968;&#20010;&#23646;&#24615;&#27880;&#20837;&#23383;&#27573;&#30340;&#21035;&#21517;.&#36825;&#20123;&#23383;&#27573;&#30340;&#31449;&#20301;&#31526;&#26159;&#20197;&#23383;&#27573;&#21035;&#21517;&#20026;&#21069;&#23548;,&#20877;&#21152;&#19978;&#23646;&#24615;&#21517;.&#22312;&#19979;&#38754;&#30340;&#20363;&#23376;&#37324;,&#25105;&#20204;&#20174;&#19968;&#20010;&#20854;&#20182;&#30340;&#34920;(<TT 
class=literal>cat_log</TT>) &#20013;&#33719;&#21462;<TT 
class=literal>Cat</TT>&#23545;&#35937;,&#32780;&#38750;Cat&#23545;&#35937;&#21407;&#26412;&#22312;&#26144;&#23556;&#20803;&#25968;&#25454;&#20013;&#22768;&#26126;&#30340;&#34920;.&#27880;&#24847;&#25105;&#20204;&#29978;&#33267;&#22312;where&#23376;&#21477;&#20013;&#20063;&#21487;&#20197;&#20351;&#29992;&#23646;&#24615;&#21035;&#21517;. 
&#23545;&#20110;&#21629;&#21517;&#26597;&#35810;,{}&#35821;&#27861;&#24182;&#19981;&#26159;&#24517;&#38656;&#30340;.&#20320;&#21487;&#20197;&#22312;<A title=16.3.&nbsp;&#21629;&#21517;SQL&#26597;&#35810; 
href="#querysql-namedqueries">&#31532;&nbsp;16.3&nbsp;&#33410; “&#21629;&#21517;SQL&#26597;&#35810;”</A>&#24471;&#21040;&#26356;&#22810;&#30340;&#32454;&#33410;. </P><PRE class=programlisting>String sql = "select cat.originalId as {cat.id}, " +
    "cat.mateid as {cat.mate}, cat.sex as {cat.sex}, " +
    "cat.weight*10 as {cat.weight}, cat.name as {cat.name} " +
    "from cat_log cat where {cat.mate} = :catId"
    
List loggedCats = sess.createSQLQuery(sql)
    .addEntity("cat", Cat.class)
    .setLong("catId", catId)
    .list();</PRE>
<P><SPAN class=emphasis><EM>&#27880;&#24847;:</EM></SPAN>&#22914;&#26524;&#20320;&#26126;&#30830;&#22320;&#21015;&#20986;&#20102;&#27599;&#20010;&#23646;&#24615;,&#20320;&#24517;&#39035;&#21253;&#21547;<SPAN 
class=emphasis><EM>&#36825;&#20010;&#31867;</EM></SPAN>&#21644;<SPAN class=emphasis><EM>&#23427;&#30340;&#23376;&#31867;</EM></SPAN>&#30340;&#23646;&#24615;! 
</P>
<P>&#19979;&#34920;&#21015;&#20986;&#20102;&#20351;&#29992;&#21035;&#21517;&#27880;&#23556;&#21442;&#25968;&#30340;&#19981;&#21516;&#21487;&#33021;&#24615;&#12290;&#27880;&#24847;&#65306;&#19979;&#38754;&#32467;&#26524;&#20013;&#30340;&#21035;&#21517;&#21482;&#26159;&#31034;&#20363;&#65292;&#23454;&#29992;&#26102;&#27599;&#20010;&#21035;&#21517;&#38656;&#35201;&#21807;&#19968;&#24182;&#19988;&#19981;&#21516;&#30340;&#21517;&#23383;&#12290; </P>
<DIV class=table><A name=aliasinjection-summary></A>
<P class=title><B>&#34920;&nbsp;16.1.&nbsp;&#21035;&#21517;&#27880;&#23556;(alias injection names)</B></P>
<TABLE summary="&#21035;&#21517;&#27880;&#23556;(alias injection names)" border=1>
  <COLGROUP>
  <COL>
  <COL>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#25551;&#36848;</TH>
    <TH>&#35821;&#27861;</TH>
    <TH>&#31034;&#20363;</TH>
    <TD class=auto-generated>&nbsp;</TD></TR></THEAD>
  <TBODY>
  <TR>
    <TD>&#31616;&#21333;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].[propertyname]</TT></TD>
    <TD><TT class=literal>A_NAME as {item.name}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#22797;&#21512;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].[componentname].[propertyname]}</TT></TD>
    <TD><TT class=literal>CURRENCY as {item.amount.currency}, VALUE as 
      {item.amount.value}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#23454;&#20307;&#36776;&#21035;&#22120;(Discriminator of an entity)</TD>
    <TD><TT class=literal>{[aliasname].class}</TT></TD>
    <TD><TT class=literal>DISC as {item.class}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#23454;&#20307;&#30340;&#25152;&#26377;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].*}</TT></TD>
    <TD><TT class=literal>{item.*}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;&#38190;(collection key)</TD>
    <TD><TT class=literal>{[aliasname].key}</TT></TD>
    <TD><TT class=literal>ORGID as {coll.key}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;id</TD>
    <TD><TT class=literal>{[aliasname].id}</TT></TD>
    <TD><TT class=literal>EMPID as {coll.id}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;&#20803;&#32032;</TD>
    <TD><TT class=literal>{[aliasname].element}</TT></TD>
    <TD><TT class=literal>XID as {coll.element}</TT></TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;&#20803;&#32032;&#30340;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].element.[propertyname]}</TT></TD>
    <TD><TT class=literal>NAME as {coll.element.name}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;&#20803;&#32032;&#30340;&#25152;&#26377;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].element.*}</TT></TD>
    <TD><TT class=literal>{coll.element.*}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR>
  <TR>
    <TD>&#38598;&#21512;&#30340;&#25152;&#26377;&#23646;&#24615;</TD>
    <TD><TT class=literal>{[aliasname].*}</TT></TD>
    <TD><TT class=literal>{coll.*}</TT></TD>
    <TD class=auto-generated>&nbsp;</TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querysql-namedqueries></A>16.3.&nbsp;&#21629;&#21517;SQL&#26597;&#35810;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;&#26597;&#35810;&#30340;&#21517;&#23383;,&#28982;&#21518;&#23601;&#21487;&#20197;&#35937;&#35843;&#29992;&#19968;&#20010;&#21629;&#21517;&#30340;HQL&#26597;&#35810;&#19968;&#26679;&#30452;&#25509;&#35843;&#29992;&#21629;&#21517;SQL&#26597;&#35810;.&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;,&#25105;&#20204;<SPAN 
class=emphasis><EM>&#19981;</EM></SPAN> &#38656;&#35201;&#35843;&#29992;<TT class=literal>addEntity()</TT>&#26041;&#27861;. </P><PRE class=programlisting>&lt;sql-query name="persons"&gt;
    &lt;return alias="person" class="eg.Person"/&gt;
    SELECT person.NAME AS {person.name},
           person.AGE AS {person.age},
           person.SEX AS {person.sex}
    FROM PERSON person
    WHERE person.NAME LIKE :namePattern
&lt;/sql-query&gt;</PRE><PRE class=programlisting>List people = sess.getNamedQuery("persons")
    .setString("namePattern", namePattern)
    .setMaxResults(50)
    .list();</PRE>
<P><TT class=literal>&lt;return-join&gt;</TT>&#21644; <TT 
class=literal>&lt;load-collection&gt;</TT> &#20803;&#32032;&#26159;&#29992;&#26469;&#36830;&#25509;&#20851;&#32852;&#20197;&#21450;&#23558;&#26597;&#35810;&#23450;&#20041;&#20026;&#39044;&#20808;&#21021;&#22987;&#21270;&#21508;&#20010;&#38598;&#21512;&#30340;&#12290;</P><PRE class=programlisting>&lt;sql-query name="personsWith"&gt;
    &lt;return alias="person" class="eg.Person"/&gt;
    &lt;return-join alias="address" property="person.mailingAddress"/&gt;
    SELECT person.NAME AS {person.name},
           person.AGE AS {person.age},
           person.SEX AS {person.sex},
           adddress.STREET AS {address.street},
           adddress.CITY AS {address.city},
           adddress.STATE AS {address.state},
           adddress.ZIP AS {address.zip}
    FROM PERSON person
    JOIN ADDRESS adddress
        ON person.ID = address.PERSON_ID AND address.TYPE='MAILING'
    WHERE person.NAME LIKE :namePattern
&lt;/sql-query&gt;</PRE>
<P>&#19968;&#20010;&#21629;&#21517;&#26597;&#35810;&#21487;&#33021;&#20250;&#36820;&#22238;&#19968;&#20010;&#26631;&#37327;&#20540;.&#20320;&#24517;&#39035;&#20351;&#29992;<TT class=literal>&lt;return-scalar&gt;</TT>&#20803;&#32032;&#26469;&#25351;&#23450;&#23383;&#27573;&#30340;&#21035;&#21517;&#21644; 
Hibernate&#31867;&#22411; </P><PRE class=programlisting>&lt;sql-query name="mySqlQuery"&gt;
    &lt;return-scalar column="name" type="string"/&gt;
    &lt;return-scalar column="age" type="long"/&gt;
    SELECT p.NAME AS name,
           p.AGE AS age,
    FROM PERSON p WHERE p.NAME LIKE 'Hiber%'
&lt;/sql-query&gt;</PRE>
<P>&#20320;&#21487;&#20197;&#25226;&#32467;&#26524;&#38598;&#26144;&#23556;&#30340;&#20449;&#24687;&#25918;&#22312;&#22806;&#37096;&#30340;<TT 
class=literal>&lt;resultset&gt;</TT>&#20803;&#32032;&#20013;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#22312;&#22810;&#20010;&#21629;&#21517;&#26597;&#35810;&#38388;&#65292;&#25110;&#32773;&#36890;&#36807;<TT 
class=literal>setResultSetMapping()</TT>API&#26469;&#35775;&#38382;&#12290;(&#27492;&#22788;&#21407;&#25991;&#21363;&#23384;&#30097;&#12290;&#21407;&#25991;&#20026;&#65306;You can externalize 
the resultset mapping informations in a <TT class=literal>&lt;resultset&gt;</TT> 
element to either reuse them accross several named queries or through the <TT 
class=literal>setResultSetMapping()</TT> API.) </P><PRE class=programlisting>&lt;resultset name="personAddress"&gt;
    &lt;return alias="person" class="eg.Person"/&gt;
    &lt;return-join alias="address" property="person.mailingAddress"/&gt;
&lt;/resultset&gt;

&lt;sql-query name="personsWith" resultset-ref="personAddress"&gt;
    SELECT person.NAME AS {person.name},
           person.AGE AS {person.age},
           person.SEX AS {person.sex},
           adddress.STREET AS {address.street},
           adddress.CITY AS {address.city},
           adddress.STATE AS {address.state},
           adddress.ZIP AS {address.zip}
    FROM PERSON person
    JOIN ADDRESS adddress
        ON person.ID = address.PERSON_ID AND address.TYPE='MAILING'
    WHERE person.NAME LIKE :namePattern
&lt;/sql-query&gt;</PRE>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=propertyresults></A>16.3.1.&nbsp;&#20351;&#29992;return-property&#26469;&#26126;&#30830;&#22320;&#25351;&#23450;&#23383;&#27573;/&#21035;&#21517;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20351;&#29992;<TT 
class=literal>&lt;return-property&gt;</TT>&#20320;&#21487;&#20197;&#26126;&#30830;&#30340;&#21578;&#35785;Hibernate&#20351;&#29992;&#21738;&#20123;&#23383;&#27573;&#21035;&#21517;,&#36825;&#21462;&#20195;&#20102;&#20351;&#29992;<TT 
class=literal>{}</TT>-&#35821;&#27861; &#26469;&#35753;Hibernate&#27880;&#20837;&#23427;&#33258;&#24049;&#30340;&#21035;&#21517;. </P><PRE class=programlisting>&lt;sql-query name="mySqlQuery"&gt;
    &lt;return alias="person" class="eg.Person"&gt;
      &lt;return-property name="name" column="myName"/&gt;
      &lt;return-property name="age" column="myAge"/&gt;
      &lt;return-property name="sex" column="mySex"/&gt;
    &lt;/return&gt;
    SELECT person.NAME AS myName,
           person.AGE AS myAge,
           person.SEX AS mySex,
    FROM PERSON person WHERE person.NAME LIKE :name
&lt;/sql-query&gt;
</PRE><TT class=literal>&lt;return-property&gt;</TT>&#20063;&#21487;&#29992;&#20110;&#22810;&#20010;&#23383;&#27573;,&#23427;&#35299;&#20915;&#20102;&#20351;&#29992;<TT 
class=literal>{}</TT>-&#35821;&#27861;&#19981;&#33021;&#32454;&#31890;&#24230;&#25511;&#21046;&#22810;&#20010;&#23383;&#27573;&#30340;&#38480;&#21046; <PRE class=programlisting>&lt;sql-query name="organizationCurrentEmployments"&gt;
            &lt;return alias="emp" class="Employment"&gt;            
             &lt;return-property name="salary"&gt; 
               &lt;return-column name="VALUE"/&gt;
               &lt;return-column name="CURRENCY"/&gt;            
             &lt;/return-property&gt;
             &lt;return-property name="endDate" column="myEndDate"/&gt;
            &lt;/return&gt;
            SELECT EMPLOYEE AS {emp.employee}, EMPLOYER AS {emp.employer}, 
            STARTDATE AS {emp.startDate}, ENDDATE AS {emp.endDate},
            REGIONCODE as {emp.regionCode}, EID AS {emp.id}, VALUE, CURRENCY
            FROM EMPLOYMENT
            WHERE EMPLOYER = :id AND ENDDATE IS NULL
            ORDER BY STARTDATE ASC
&lt;/sql-query&gt;</PRE>
<P>&#27880;&#24847;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;,&#25105;&#20204;&#20351;&#29992;&#20102;<TT class=literal>&lt;return-property&gt;</TT>&#32467;&#21512;<TT 
class=literal>{}</TT>&#30340;&#27880;&#20837;&#35821;&#27861;. &#20801;&#35768;&#29992;&#25143;&#26469;&#36873;&#25321;&#22914;&#20309;&#24341;&#29992;&#23383;&#27573;&#20197;&#21450;&#23646;&#24615;. </P>
<P>&#22914;&#26524;&#20320;&#26144;&#23556;&#19968;&#20010;&#35782;&#21035;&#22120;(discriminator),&#20320;&#24517;&#39035;&#20351;&#29992;<TT 
class=literal>&lt;return-discriminator&gt;</TT> &#26469;&#25351;&#23450;&#35782;&#21035;&#22120;&#23383;&#27573; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=sp_query></A>16.3.2.&nbsp;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#26469;&#26597;&#35810;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate 3&#24341;&#20837;&#20102;&#23545;&#23384;&#20648;&#36807;&#31243;&#26597;&#35810;(stored procedure)&#21644;&#20989;&#25968;(function)&#30340;&#25903;&#25345;.&#20197;&#19979;&#30340;&#35828;&#26126;&#20013;&#65292;&#36825;&#20108;&#32773;&#19968;&#33324;&#37117;&#36866;&#29992;&#12290; 
&#23384;&#20648;&#36807;&#31243;/&#20989;&#25968;&#24517;&#39035;&#36820;&#22238;&#19968;&#20010;&#32467;&#26524;&#38598;,&#20316;&#20026;Hibernate&#33021;&#22815;&#20351;&#29992;&#30340;&#31532;&#19968;&#20010;&#22806;&#37096;&#21442;&#25968;. &#19979;&#38754;&#26159;&#19968;&#20010;Oracle9&#21644;&#26356;&#39640;&#29256;&#26412;&#30340;&#23384;&#20648;&#36807;&#31243;&#20363;&#23376;.</P><PRE class=programlisting>CREATE OR REPLACE FUNCTION selectAllEmployments 
    RETURN SYS_REFCURSOR 
AS 
    st_cursor SYS_REFCURSOR; 
BEGIN 
    OPEN st_cursor FOR 
 SELECT EMPLOYEE, EMPLOYER, 
 STARTDATE, ENDDATE, 
 REGIONCODE, EID, VALUE, CURRENCY 
 FROM EMPLOYMENT; 
      RETURN  st_cursor; 
 END;</PRE>
<P>&#22312;Hibernate&#37324;&#35201;&#35201;&#20351;&#29992;&#36825;&#20010;&#26597;&#35810;,&#20320;&#38656;&#35201;&#36890;&#36807;&#21629;&#21517;&#26597;&#35810;&#26469;&#26144;&#23556;&#23427;. </P><PRE class=programlisting>&lt;sql-query name="selectAllEmployees_SP" callable="true"&gt;
    &lt;return alias="emp" class="Employment"&gt;
        &lt;return-property name="employee" column="EMPLOYEE"/&gt;
        &lt;return-property name="employer" column="EMPLOYER"/&gt;            
        &lt;return-property name="startDate" column="STARTDATE"/&gt;
        &lt;return-property name="endDate" column="ENDDATE"/&gt;            
        &lt;return-property name="regionCode" column="REGIONCODE"/&gt;            
        &lt;return-property name="id" column="EID"/&gt;                        
        &lt;return-property name="salary"&gt; 
            &lt;return-column name="VALUE"/&gt;
            &lt;return-column name="CURRENCY"/&gt;            
        &lt;/return-property&gt;
    &lt;/return&gt;
    { ? = call selectAllEmployments() }
&lt;/sql-query&gt;</PRE>
<P>&#27880;&#24847;&#23384;&#20648;&#36807;&#31243;&#24403;&#21069;&#20165;&#20165;&#36820;&#22238;&#26631;&#37327;&#21644;&#23454;&#20307;.&#29616;&#22312;&#19981;&#25903;&#25345;<TT class=literal>&lt;return-join&gt;</TT>&#21644;<TT 
class=literal>&lt;load-collection&gt;</TT> </P>
<DIV lang=zh-cn class=sect3>
<DIV class=titlepage>
<DIV>
<DIV>
<H4 class=title><A 
name=querysql-limits-storedprocedures></A>16.3.2.1.&nbsp;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#30340;&#35268;&#21017;&#21644;&#38480;&#21046;</H4></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20026;&#20102;&#22312;Hibernate&#20013;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;,&#20320;&#24517;&#39035;&#36981;&#24490;&#19968;&#20123;&#35268;&#21017;.&#19981;&#36981;&#24490;&#36825;&#20123;&#35268;&#21017;&#30340;&#23384;&#20648;&#36807;&#31243;&#23558;&#19981;&#21487;&#29992;.&#22914;&#26524;&#20320;&#20173;&#28982;&#24819;&#35201;&#20351;&#29992;&#20182;&#20204;, &#20320;&#24517;&#39035;&#36890;&#36807;<TT 
class=literal>session.connection()</TT>&#26469;&#25191;&#34892;&#20182;&#20204;.&#36825;&#20123;&#35268;&#21017;&#38024;&#23545;&#20110;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;.&#22240;&#20026;&#25968;&#25454;&#24211; 
&#25552;&#20379;&#21830;&#26377;&#21508;&#31181;&#19981;&#21516;&#30340;&#23384;&#20648;&#36807;&#31243;&#35821;&#27861;&#21644;&#35821;&#20041;. </P>
<P>&#23545;&#23384;&#20648;&#36807;&#31243;&#36827;&#34892;&#30340;&#26597;&#35810;&#26080;&#27861;&#20351;&#29992;<TT class=literal>setFirstResult()/setMaxResults()</TT>&#36827;&#34892;&#20998;&#39029;&#12290; 
</P>
<P>&#24314;&#35758;&#37319;&#29992;&#30340;&#35843;&#29992;&#26041;&#24335;&#26159;&#26631;&#20934;SQL92: <TT class=literal>{ ? = call 
functionName(&lt;parameters&gt;) }</TT> &#25110;&#32773; <TT class=literal>{ ? = call 
procedureName(&lt;parameters&gt;}</TT>.&#21407;&#29983;&#35843;&#29992;&#35821;&#27861;&#19981;&#34987;&#25903;&#25345;&#12290;</P>
<P>&#23545;&#20110;Oracle&#26377;&#22914;&#19979;&#35268;&#21017;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#20989;&#25968;&#24517;&#39035;&#36820;&#22238;&#19968;&#20010;&#32467;&#26524;&#38598;&#12290;&#23384;&#20648;&#36807;&#31243;&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#24517;&#39035;&#26159;<TT class=literal>OUT</TT>&#65292;&#23427;&#36820;&#22238;&#19968;&#20010;&#32467;&#26524;&#38598;&#12290;&#36825;&#26159;&#36890;&#36807;Oracle 
  9&#25110;10&#30340;<TT class=literal>SYS_REFCURSOR</TT>&#31867;&#22411;&#26469;&#23436;&#25104;&#30340;&#12290;&#22312;Oracle&#20013;&#20320;&#38656;&#35201;&#23450;&#20041;&#19968;&#20010;<TT 
  class=literal>REF CURSOR</TT>&#31867;&#22411;&#65292;&#21442;&#35265;Oracle&#30340;&#25163;&#20876;&#12290;</P></LI></UL></DIV>
<P>&#23545;&#20110;Sybase&#25110;&#32773;MS SQL server&#26377;&#22914;&#19979;&#35268;&#21017;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#23384;&#20648;&#36807;&#31243;&#24517;&#39035;&#36820;&#22238;&#19968;&#20010;&#32467;&#26524;&#38598;&#12290;.&#27880;&#24847;&#36825;&#20123;servers&#21487;&#33021;&#36820;&#22238;&#22810;&#20010;&#32467;&#26524;&#38598;&#20197;&#21450;&#26356;&#26032;&#30340;&#25968;&#30446;.Hibernate&#23558;&#21462;&#20986;&#31532;&#19968;&#26465;&#32467;&#26524;&#38598;&#20316;&#20026;&#23427;&#30340;&#36820;&#22238;&#20540;&#65292; 
  &#20854;&#20182;&#23558;&#34987;&#20002;&#24323;&#12290; </P>
  <LI>
  <P>&#22914;&#26524;&#20320;&#33021;&#22815;&#22312;&#23384;&#20648;&#36807;&#31243;&#37324;&#35774;&#23450;<TT class=literal>SET NOCOUNT ON</TT>&#65292;&#36825;&#21487;&#33021;&#20250;&#25928;&#29575;&#26356;&#39640;&#65292;&#20294;&#36825;&#19981;&#26159;&#24517;&#38656;&#30340;&#12290; 
  </P></LI></UL></DIV></DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querysql-cud></A>16.4.&nbsp;&#23450;&#21046;SQL&#29992;&#26469;create&#65292;update&#21644;delete</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate3&#33021;&#22815;&#20351;&#29992;&#23450;&#21046;&#30340;SQL&#35821;&#21477;&#26469;&#25191;&#34892;create,update&#21644;delete&#25805;&#20316;&#12290;&#22312;Hibernate&#20013;&#65292;&#25345;&#20037;&#21270;&#30340;&#31867;&#21644;&#38598;&#21512;&#24050;&#32463; 
&#21253;&#21547;&#20102;&#19968;&#22871;&#37197;&#32622;&#26399;&#20135;&#29983;&#30340;&#35821;&#21477;(insertsql, deletesql, updatesql&#31561;&#31561;)&#65292;&#36825;&#20123;&#26144;&#23556;&#26631;&#35760; <TT 
class=literal>&lt;sql-insert&gt;</TT>, <TT 
class=literal>&lt;sql-delete&gt;</TT>, and <TT 
class=literal>&lt;sql-update&gt;</TT>&#37325;&#36733;&#20102; &#36825;&#20123;&#35821;&#21477;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id"&gt;
        &lt;generator class="increment"/&gt;
    &lt;/id&gt;
    &lt;property name="name" not-null="true"/&gt;
    &lt;sql-insert&gt;INSERT INTO PERSON (NAME, ID) VALUES ( UPPER(?), ? )&lt;/sql-insert&gt;
    &lt;sql-update&gt;UPDATE PERSON SET NAME=UPPER(?) WHERE ID=?&lt;/sql-update&gt;
    &lt;sql-delete&gt;DELETE FROM PERSON WHERE ID=?&lt;/sql-delete&gt;
&lt;/class&gt;</PRE>
<P>&#36825;&#20123;SQL&#30452;&#25509;&#22312;&#20320;&#30340;&#25968;&#25454;&#24211;&#37324;&#25191;&#34892;&#65292;&#25152;&#20197;&#20320;&#21487;&#20197;&#33258;&#30001;&#30340;&#20351;&#29992;&#20320;&#21916;&#27426;&#30340;&#20219;&#24847;&#35821;&#27861;&#12290;&#20294;&#22914;&#26524;&#20320;&#20351;&#29992;&#25968;&#25454;&#24211;&#29305;&#23450;&#30340;&#35821;&#27861;&#65292; &#36825;&#24403;&#28982;&#20250;&#38477;&#20302;&#20320;&#26144;&#23556;&#30340;&#21487;&#31227;&#26893;&#24615;&#12290; </P>
<P>&#22914;&#26524;&#35774;&#23450;<TT class=literal>callable</TT>&#65292;&#21017;&#33021;&#22815;&#25903;&#25345;&#23384;&#20648;&#36807;&#31243;&#20102;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id"&gt;
        &lt;generator class="increment"/&gt;
    &lt;/id&gt;
    &lt;property name="name" not-null="true"/&gt;
    &lt;sql-insert callable="true"&gt;{call createPerson (?, ?)}&lt;/sql-insert&gt;
    &lt;sql-delete callable="true"&gt;{? = call deletePerson (?)}&lt;/sql-delete&gt;
    &lt;sql-update callable="true"&gt;{? = call updatePerson (?, ?)}&lt;/sql-update&gt;
&lt;/class&gt;</PRE>
<P>&#21442;&#25968;&#30340;&#20301;&#32622;&#39034;&#24207;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#65292;&#20182;&#20204;&#24517;&#39035;&#21644;Hibernate&#25152;&#26399;&#24453;&#30340;&#39034;&#24207;&#30456;&#21516;&#12290; </P>
<P>&#20320;&#33021;&#22815;&#36890;&#36807;&#35774;&#23450;&#26085;&#24535;&#35843;&#35797;&#32423;&#21035;&#20026;<TT 
class=literal>org.hiberante.persister.entity</TT>,&#26469;&#26597;&#30475;Hibernate&#25152;&#26399;&#24453;&#30340;&#39034;&#24207;&#12290;&#22312;&#36825;&#20010;&#32423;&#21035;&#19979;&#65292; 
Hibernate&#23558;&#20250;&#25171;&#21360;&#20986;create,update&#21644;delete&#23454;&#20307;&#30340;&#38745;&#24577;SQL&#12290;(&#22914;&#26524;&#24819;&#30475;&#21040;&#39044;&#35745;&#30340;&#39034;&#24207;&#12290;&#35760;&#24471;&#19981;&#35201;&#23558;&#23450;&#21046;SQL&#21253;&#21547;&#22312;&#26144;&#23556;&#25991;&#20214;&#37324;&#65292; 
&#22240;&#20026;&#20182;&#20204;&#20250;&#37325;&#36733;Hibernate&#29983;&#25104;&#30340;&#38745;&#24577;SQL&#12290;) </P>
<P>&#22312;&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;(&#26368;&#22909;&#36825;&#20040;&#20570;)&#65292;&#23384;&#20648;&#36807;&#31243;&#38656;&#35201;&#36820;&#22238;&#25554;&#20837;/&#26356;&#26032;/&#21024;&#38500;&#30340;&#34892;&#25968;&#65292;&#22240;&#20026;Hibernate&#23545;&#35821;&#21477;&#30340;&#25104;&#21151;&#25191;&#34892;&#26377;&#20123;&#36816;&#34892;&#26102;&#30340;&#26816;&#26597;&#12290; 
Hibernate&#24120;&#20250;&#25226;&#36827;&#34892;CUD&#25805;&#20316;&#30340;&#35821;&#21477;&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#27880;&#20876;&#20026;&#19968;&#20010;&#25968;&#20540;&#22411;&#36755;&#20986;&#21442;&#25968;&#12290; </P><PRE class=programlisting>CREATE OR REPLACE FUNCTION updatePerson (uid IN NUMBER, uname IN VARCHAR2)
    RETURN NUMBER IS
BEGIN

    update PERSON
    set
        NAME = uname,
    where
        ID = uid;

    return SQL%ROWCOUNT;

END updatePerson;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=querysql-load></A>16.5.&nbsp;&#23450;&#21046;&#35013;&#36733;SQL</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#33021;&#38656;&#35201;&#22768;&#26126;&#20320;&#33258;&#24049;&#30340;SQL(&#25110;HQL)&#26469;&#35013;&#36733;&#23454;&#20307; </P><PRE class=programlisting>&lt;sql-query name="person"&gt;
    &lt;return alias="pers" class="Person" lock-mode="upgrade"/&gt;
    SELECT NAME AS {pers.name}, ID AS {pers.id}
    FROM PERSON
    WHERE ID=?
    FOR UPDATE
&lt;/sql-query&gt;</PRE>
<P>&#36825;&#21482;&#26159;&#19968;&#20010;&#21069;&#38754;&#35752;&#35770;&#36807;&#30340;&#21629;&#21517;&#26597;&#35810;&#22768;&#26126;&#65292;&#20320;&#21487;&#20197;&#22312;&#31867;&#26144;&#23556;&#37324;&#24341;&#29992;&#36825;&#20010;&#21629;&#21517;&#26597;&#35810;&#12290; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="id"&gt;
        &lt;generator class="increment"/&gt;
    &lt;/id&gt;
    &lt;property name="name" not-null="true"/&gt;
    &lt;loader query-ref="person"/&gt;
&lt;/class&gt;</PRE>
<P>&#36825;&#20063;&#21487;&#20197;&#29992;&#20110;&#23384;&#20648;&#36807;&#31243; </P>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#23450;&#19968;&#20010;&#29992;&#20110;&#38598;&#21512;&#35013;&#36733;&#30340;&#26597;&#35810;:</P><PRE class=programlisting>&lt;set name="employments" inverse="true"&gt;
    &lt;key/&gt;
    &lt;one-to-many class="Employment"/&gt;
    &lt;loader query-ref="employments"/&gt;
&lt;/set&gt;</PRE><PRE class=programlisting>&lt;sql-query name="employments"&gt;
    &lt;load-collection alias="emp" role="Person.employments"/&gt;
    SELECT {emp.*}
    FROM EMPLOYMENT emp
    WHERE EMPLOYER = :id
    ORDER BY STARTDATE ASC, EMPLOYEE ASC
&lt;/sql-query&gt;</PRE>
<P>&#20320;&#29978;&#33267;&#36824;&#21487;&#20197;&#23450;&#20041;&#19968;&#20010;&#23454;&#20307;&#35013;&#36733;&#22120;&#65292;&#23427;&#36890;&#36807;&#36830;&#25509;&#25235;&#21462;&#35013;&#36733;&#19968;&#20010;&#38598;&#21512;:</P><PRE class=programlisting>&lt;sql-query name="person"&gt;
    &lt;return alias="pers" class="Person"/&gt;
    &lt;return-join alias="emp" property="pers.employments"/&gt;
    SELECT NAME AS {pers.*}, {emp.*}
    FROM PERSON pers
    LEFT OUTER JOIN EMPLOYMENT emp
        ON pers.ID = emp.PERSON_ID
    WHERE ID=?
&lt;/sql-query&gt;</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=filters></A>&#31532;&nbsp;17&nbsp;&#31456;&nbsp;&#36807;&#28388;&#25968;&#25454;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate3 &#25552;&#20379;&#20102;&#19968;&#31181;&#21019;&#26032;&#30340;&#26041;&#24335;&#26469;&#22788;&#29702;&#20855;&#26377;“&#26174;&#24615;(visibility)”&#35268;&#21017;&#30340;&#25968;&#25454;&#65292;&#37027;&#23601;&#26159;&#20351;&#29992;<SPAN 
class=emphasis><EM>Hibernate filter</EM></SPAN>&#12290; <SPAN 
class=emphasis><EM>Hibernate filter</EM></SPAN>&#26159;&#20840;&#23616;&#26377;&#25928;&#30340;&#12289;&#20855;&#26377;&#21517;&#23383;&#12289;&#21487;&#20197;&#24102;&#21442;&#25968;&#30340;&#36807;&#28388;&#22120;&#65292; 
&#23545;&#20110;&#26576;&#20010;&#29305;&#23450;&#30340;Hibernate session&#24744;&#21487;&#20197;&#36873;&#25321;&#26159;&#21542;&#21551;&#29992;&#65288;&#25110;&#31105;&#29992;&#65289;&#26576;&#20010;&#36807;&#28388;&#22120;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=objectstate-filters></A>17.1.&nbsp;Hibernate &#36807;&#28388;&#22120;(filters)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate3&#26032;&#22686;&#20102;&#23545;&#26576;&#20010;&#31867;&#25110;&#32773;&#38598;&#21512;&#20351;&#29992;&#39044;&#20808;&#23450;&#20041;&#30340;&#36807;&#28388;&#22120;&#26465;&#20214;(filter criteria)&#30340;&#21151;&#33021;&#12290;&#36807;&#28388;&#22120;&#26465;&#20214;&#30456;&#24403;&#20110;&#23450;&#20041;&#19968;&#20010; 
&#38750;&#24120;&#31867;&#20284;&#20110;&#31867;&#21644;&#21508;&#31181;&#38598;&#21512;&#19978;&#30340;“where”&#23646;&#24615;&#30340;&#32422;&#26463;&#23376;&#21477;&#65292;&#20294;&#26159;&#36807;&#28388;&#22120;&#26465;&#20214;&#21487;&#20197;&#24102;&#21442;&#25968;&#12290; &#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#20915;&#23450;&#26159;&#21542;&#21551;&#29992;&#32473;&#23450;&#30340;&#36807;&#28388;&#22120;&#65292;&#20197;&#21450;&#20351;&#29992;&#20160;&#20040;&#26679;&#30340;&#21442;&#25968;&#20540;&#12290; 
&#36807;&#28388;&#22120;&#30340;&#29992;&#27861;&#24456;&#20687;&#25968;&#25454;&#24211;&#35270;&#22270;&#65292;&#21482;&#19981;&#36807;&#26159;&#22312;&#24212;&#29992;&#31243;&#24207;&#20013;&#30830;&#23450;&#20351;&#29992;&#20160;&#20040;&#26679;&#30340;&#21442;&#25968;&#30340;&#12290; </P>
<P>&#35201;&#20351;&#29992;&#36807;&#28388;&#22120;&#65292;&#24517;&#39035;&#39318;&#20808;&#22312;&#30456;&#24212;&#30340;&#26144;&#23556;&#33410;&#28857;&#20013;&#23450;&#20041;&#12290;&#32780;&#23450;&#20041;&#19968;&#20010;&#36807;&#28388;&#22120;&#65292;&#35201;&#29992;&#21040;&#20301;&#20110;<TT 
class=literal>&lt;hibernate-mapping/&gt;</TT> &#33410;&#28857;&#20043;&#20869;&#30340;<TT 
class=literal>&lt;filter-def/&gt;</TT>&#33410;&#28857;&#65306; </P><PRE class=programlisting>&lt;filter-def name="myFilter"&gt;
    &lt;filter-param name="myFilterParam" type="string"/&gt;
&lt;/filter-def&gt;</PRE>
<P>&#23450;&#20041;&#22909;&#20043;&#21518;&#65292;&#23601;&#21487;&#20197;&#22312;&#26576;&#20010;&#31867;&#20013;&#20351;&#29992;&#36825;&#20010;&#36807;&#28388;&#22120;&#65306; </P><PRE class=programlisting>&lt;class name="myClass" ...&gt;
    ...
    &lt;filter name="myFilter" condition=":myFilterParam = MY_FILTERED_COLUMN"/&gt;
&lt;/class&gt;</PRE>
<P>&#20063;&#21487;&#20197;&#22312;&#26576;&#20010;&#38598;&#21512;&#20351;&#29992;&#23427;&#65306; </P><PRE class=programlisting>&lt;set ...&gt;
    &lt;filter name="myFilter" condition=":myFilterParam = MY_FILTERED_COLUMN"/&gt;
&lt;/set&gt;</PRE>
<P>&#21487;&#20197;&#22312;&#22810;&#20010;&#31867;&#25110;&#38598;&#21512;&#20013;&#20351;&#29992;&#26576;&#20010;&#36807;&#28388;&#22120;&#65307;&#26576;&#20010;&#31867;&#25110;&#32773;&#38598;&#21512;&#20013;&#20063;&#21487;&#20197;&#20351;&#29992;&#22810;&#20010;&#36807;&#28388;&#22120;&#12290; </P>
<P><TT class=literal>Session</TT>&#23545;&#35937;&#20013;&#20250;&#29992;&#21040;&#30340;&#26041;&#27861;&#26377;&#65306;<TT 
class=literal>enableFilter(String filterName)</TT>, <TT 
class=literal>getEnabledFilter(String filterName)</TT>, &#21644; <TT 
class=literal>disableFilter(String filterName)</TT>. Session&#20013;&#40664;&#35748;&#26159;<SPAN 
class=emphasis><EM>&#19981;</EM></SPAN>&#21551;&#29992;&#36807;&#28388;&#22120;&#30340;&#65292;&#24517;&#39035;&#36890;&#36807;<TT 
class=literal>Session.enabledFilter()</TT>&#26041;&#27861;&#26174;&#24335;&#30340;&#21551;&#29992;&#12290; &#35813;&#26041;&#27861;&#36820;&#22238;&#34987;&#21551;&#29992;&#30340;<TT 
class=literal>Filter</TT>&#30340;&#23454;&#20363;&#12290;&#20197;&#19978;&#25991;&#23450;&#20041;&#30340;&#36807;&#28388;&#22120;&#20026;&#20363;&#65306; </P><PRE class=programlisting>session.enableFilter("myFilter").setParameter("myFilterParam", "some-value");</PRE>
<P>&#27880;&#24847;&#65292;org.hibernate.Filter&#30340;&#26041;&#27861;&#20801;&#35768;&#38142;&#24335;&#26041;&#27861;&#35843;&#29992;&#12290;&#65288;&#31867;&#20284;&#19978;&#38754;&#20363;&#23376;&#20013;&#21551;&#29992;Filter&#20043;&#21518;&#35774;&#23450;Filter&#21442;&#25968;&#36825;&#20010;“&#26041;&#27861;&#38142;”&#65289; 
Hibernate&#30340;&#20854;&#20182;&#37096;&#20998;&#20063;&#22823;&#22810;&#26377;&#36825;&#20010;&#29305;&#24615;&#12290; </P>
<P>&#19979;&#38754;&#26159;&#19968;&#20010;&#27604;&#36739;&#23436;&#25972;&#30340;&#20363;&#23376;&#65292;&#20351;&#29992;&#20102;&#35760;&#24405;&#29983;&#25928;&#26085;&#26399;&#27169;&#24335;&#36807;&#28388;&#26377;&#26102;&#25928;&#30340;&#25968;&#25454;&#65306; </P><PRE class=programlisting>&lt;filter-def name="effectiveDate"&gt;
    &lt;filter-param name="asOfDate" type="date"/&gt;
&lt;/filter-def&gt;

&lt;class name="Employee" ...&gt;
...
    &lt;many-to-one name="department" column="dept_id" class="Department"/&gt;
    &lt;property name="effectiveStartDate" type="date" column="eff_start_dt"/&gt;
    &lt;property name="effectiveEndDate" type="date" column="eff_end_dt"/&gt;
...
    &lt;!--
        Note that this assumes non-terminal records have an eff_end_dt set to
        a max db date for simplicity-sake

		&#27880;&#24847;&#65292;&#20026;&#20102;&#31616;&#21333;&#36215;&#35265;&#65292;&#27492;&#22788;&#20551;&#35774;&#38599;&#29992;&#20851;&#31995;&#29983;&#25928;&#26399;&#23578;&#26410;&#32467;&#26463;&#30340;&#35760;&#24405;&#30340;eff_end_dt&#23383;&#27573;&#30340;&#20540;&#31561;&#20110;&#25968;&#25454;&#24211;&#26368;&#22823;&#30340;&#26085;&#26399;
    --&gt;
    &lt;filter name="effectiveDate"
            condition=":asOfDate BETWEEN eff_start_dt and eff_end_dt"/&gt;
&lt;/class&gt;

&lt;class name="Department" ...&gt;
...
    &lt;set name="employees" lazy="true"&gt;
        &lt;key column="dept_id"/&gt;
        &lt;one-to-many class="Employee"/&gt;
        &lt;filter name="effectiveDate"
                condition=":asOfDate BETWEEN eff_start_dt and eff_end_dt"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</PRE>
<P>&#23450;&#20041;&#22909;&#21518;&#65292;&#22914;&#26524;&#24819;&#35201;&#20445;&#35777;&#21462;&#22238;&#30340;&#37117;&#26159;&#30446;&#21069;&#22788;&#20110;&#29983;&#25928;&#26399;&#30340;&#35760;&#24405;&#65292;&#21482;&#38656;&#22312;&#33719;&#21462;&#38599;&#21592;&#25968;&#25454;&#30340;&#25805;&#20316;&#20043;&#21069;&#20808;&#24320;&#21551;&#36807;&#28388;&#22120;&#21363;&#21487;&#65306; </P><PRE class=programlisting>Session session = ...;
session.enabledFilter("effectiveDate").setParameter("asOfDate", new Date());
List results = session.createQuery("from Employee as e where e.salary &gt; :targetSalary")
         .setLong("targetSalary", new Long(1000000))
         .list();
</PRE>
<P>&#22312;&#19978;&#38754;&#30340;HQL&#20013;&#65292;&#34429;&#28982;&#25105;&#20204;&#20165;&#20165;&#26174;&#24335;&#30340;&#20351;&#29992;&#20102;&#19968;&#20010;&#34218;&#27700;&#26465;&#20214;&#65292;&#20294;&#22240;&#20026;&#21551;&#29992;&#20102;&#36807;&#28388;&#22120;&#65292;&#26597;&#35810;&#23558;&#20165;&#36820;&#22238;&#37027;&#20123;&#30446;&#21069;&#38599;&#29992; 
&#20851;&#31995;&#22788;&#20110;&#29983;&#25928;&#26399;&#30340;&#65292;&#24182;&#19988;&#34218;&#27700;&#39640;&#20110;&#19968;&#30334;&#19975;&#32654;&#20992;&#30340;&#38599;&#21592;&#30340;&#25968;&#25454;&#12290; </P>
<P>&#27880;&#24847;&#65306;&#22914;&#26524;&#20320;&#25171;&#31639;&#22312;&#20351;&#29992;&#22806;&#36830;&#25509;&#65288;&#25110;&#32773;&#36890;&#36807;HQL&#25110;load fetching&#65289;&#30340;&#21516;&#26102;&#20351;&#29992;&#36807;&#28388;&#22120;&#65292;&#35201;&#27880;&#24847;&#26465;&#20214;&#34920;&#36798;&#24335;&#30340;&#26041;&#21521;&#65288;&#24038;&#36824;&#26159;&#21491;&#65289;&#12290; 
&#26368;&#23433;&#20840;&#30340;&#26041;&#24335;&#26159;&#20351;&#29992;&#24038;&#22806;&#36830;&#25509;&#65288;left outer joining&#65289;&#12290;&#24182;&#19988;&#36890;&#24120;&#26469;&#35828;&#65292;&#20808;&#20889;&#21442;&#25968;&#65292; &#28982;&#21518;&#26159;&#25805;&#20316;&#31526;&#65292;&#26368;&#21518;&#20889;&#25968;&#25454;&#24211;&#23383;&#27573;&#21517;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=xml></A>&#31532;&nbsp;18&nbsp;&#31456;&nbsp;XML&#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#27880;&#24847;&#36825;&#26159;Hibernate 3.0&#30340;&#19968;&#20010;&#23454;&#39564;&#24615;&#30340;&#29305;&#24615;&#12290;&#36825;&#19968;&#29305;&#24615;&#20173;&#22312;&#31215;&#26497;&#24320;&#21457;&#20013;&#12290; 
</EM></SPAN></P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=xml-intro></A>18.1.&nbsp;&#29992;XML&#25968;&#25454;&#36827;&#34892;&#24037;&#20316;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#20351;&#24471;&#20320;&#21487;&#20197;&#29992;XML&#25968;&#25454;&#26469;&#36827;&#34892;&#24037;&#20316;&#65292;&#24688;&#22914;&#20320;&#29992;&#25345;&#20037;&#21270;&#30340;POJO&#36827;&#34892;&#24037;&#20316;&#37027;&#26679;&#12290;&#35299;&#26512;&#36807;&#30340;XML&#26641; 
&#21487;&#20197;&#34987;&#35748;&#20026;&#26159;&#20195;&#26367;POJO&#30340;&#21478;&#22806;&#19968;&#31181;&#22312;&#23545;&#35937;&#23618;&#38754;&#19978;&#34920;&#31034;&#20851;&#31995;&#22411;&#25968;&#25454;&#30340;&#36884;&#24452;. </P>
<P>Hibernate&#25903;&#25345;&#37319;&#29992;dom4j&#20316;&#20026;&#25805;&#20316;XML&#26641;&#30340;API&#12290;&#20320;&#21487;&#20197;&#20889;&#19968;&#20123;&#26597;&#35810;&#20174;&#25968;&#25454;&#24211;&#20013;&#26816;&#32034;&#20986; 
dom4j&#26641;&#65292;&#38543;&#21518;&#20320;&#23545;&#36825;&#39063;&#26641;&#20570;&#30340;&#20219;&#20309;&#20462;&#25913;&#37117;&#23558;&#33258;&#21160;&#21516;&#27493;&#22238;&#25968;&#25454;&#24211;&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;dom4j&#35299;&#26512; 
&#19968;&#31687;XML&#25991;&#26723;&#65292;&#28982;&#21518;&#20351;&#29992;Hibernate&#30340;&#20219;&#19968;&#22522;&#26412;&#25805;&#20316;&#23558;&#23427;&#20889;&#20837;&#25968;&#25454;&#24211;&#65306; <TT class=literal>persist(), 
saveOrUpdate(), merge(), delete(), replicate()</TT> (&#21512;&#24182;&#25805;&#20316;merge()&#30446;&#21069;&#36824;&#19981;&#25903;&#25345;)&#12290; </P>
<P>&#36825;&#19968;&#29305;&#24615;&#21487;&#20197;&#24212;&#29992;&#22312;&#24456;&#22810;&#22330;&#21512;&#65292;&#21253;&#25324;&#25968;&#25454;&#23548;&#20837;&#23548;&#20986;&#65292;&#36890;&#36807;JMS&#25110;SOAP&#20855;&#20307;&#21270;&#23454;&#20307;&#25968;&#25454;&#20197;&#21450; &#22522;&#20110;XSLT&#30340;&#25253;&#34920;&#12290; </P>
<P>&#19968;&#20010;&#21333;&#19968;&#30340;&#26144;&#23556;&#23601;&#21487;&#20197;&#23558;&#31867;&#30340;&#23646;&#24615;&#21644;XML&#25991;&#26723;&#30340;&#33410;&#28857;&#21516;&#26102;&#26144;&#23556;&#21040;&#25968;&#25454;&#24211;&#12290;&#22914;&#26524;&#19981;&#38656;&#35201;&#26144;&#23556;&#31867;&#65292; &#23427;&#20063;&#21487;&#20197;&#29992;&#26469;&#21482;&#26144;&#23556;XML&#25991;&#26723;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=xml-intro-mapping></A>18.1.1.&nbsp;&#25351;&#23450;&#21516;&#26102;&#26144;&#23556;XML&#21644;&#31867;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#26159;&#19968;&#20010;&#21516;&#26102;&#26144;&#23556;POJO&#21644;XML&#30340;&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;class name="Account" 
        table="ACCOUNTS" 
        node="account"&gt;
        
    &lt;id name="accountId" 
            column="ACCOUNT_ID" 
            node="@id"/&gt;
            
    &lt;many-to-one name="customer" 
            column="CUSTOMER_ID" 
            node="customer/@id" 
            embed-xml="false"/&gt;
            
    &lt;property name="balance" 
            column="BALANCE" 
            node="balance"/&gt;
            
    ...
    
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=xml-onlyxml></A>18.1.2.&nbsp;&#21482;&#23450;&#20041;XML&#26144;&#23556;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#26159;&#19968;&#20010;&#19981;&#26144;&#23556;POJO&#30340;&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;class entity-name="Account" 
        table="ACCOUNTS" 
        node="account"&gt;
        
    &lt;id name="id" 
            column="ACCOUNT_ID" 
            node="@id" 
            type="string"/&gt;
            
    &lt;many-to-one name="customerId" 
            column="CUSTOMER_ID" 
            node="customer/@id" 
            embed-xml="false" 
            entity-name="Customer"/&gt;
            
    &lt;property name="balance" 
            column="BALANCE" 
            node="balance" 
            type="big_decimal"/&gt;
            
    ...
    
&lt;/class&gt;</PRE>
<P>&#36825;&#20010;&#26144;&#23556;&#20351;&#24471;&#20320;&#26082;&#21487;&#20197;&#25226;&#25968;&#25454;&#20316;&#20026;&#19968;&#26869;dom4j&#26641;&#37027;&#26679;&#35775;&#38382;&#65292;&#21448;&#21487;&#20197;&#20316;&#20026;&#30001;&#23646;&#24615;&#38190;&#20540;&#23545;(java <TT class=literal>Map</TT>s) 
&#32452;&#25104;&#30340;&#22270;&#37027;&#26679;&#35775;&#38382;&#12290;&#23646;&#24615;&#21517;&#23383;&#32431;&#31929;&#26159;&#36923;&#36753;&#19978;&#30340;&#32467;&#26500;&#65292;&#20320;&#21487;&#20197;&#22312;HQL&#26597;&#35810;&#20013;&#24341;&#29992;&#23427;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=xml-mapping></A>18.2.&nbsp;XML&#26144;&#23556;&#20803;&#25968;&#25454;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#35768;&#22810;Hibernate&#26144;&#23556;&#20803;&#32032;&#20855;&#26377;<TT class=literal>node</TT>&#23646;&#24615;&#12290;&#36825;&#20351;&#20320;&#21487;&#20197;&#25351;&#23450;&#29992;&#26469;&#20445;&#23384; 
&#23646;&#24615;&#25110;&#23454;&#20307;&#25968;&#25454;&#30340;XML&#23646;&#24615;&#25110;&#20803;&#32032;&#12290;<TT class=literal>node</TT>&#23646;&#24615;&#24517;&#39035;&#26159;&#19979;&#21015;&#26684;&#24335;&#20043;&#19968;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>"element-name"</TT> - &#26144;&#23556;&#20026;&#25351;&#23450;&#30340;XML&#20803;&#32032;</P>
  <LI>
  <P><TT class=literal>"@attribute-name"</TT> - &#26144;&#23556;&#20026;&#25351;&#23450;&#30340;XML&#23646;&#24615;</P>
  <LI>
  <P><TT class=literal>"."</TT> - &#26144;&#23556;&#20026;&#29238;&#20803;&#32032;</P>
  <LI>
  <P><TT class=literal>"element-name/@attribute-name"</TT> - &#26144;&#23556;&#20026;&#25351;&#23450;&#20803;&#32032;&#30340;&#25351;&#23450;&#23646;&#24615; 
  </P></LI></UL></DIV>
<P>&#23545;&#20110;&#38598;&#21512;&#21644;&#21333;&#20540;&#30340;&#20851;&#32852;&#65292;&#26377;&#19968;&#20010;&#39069;&#22806;&#30340;<TT class=literal>embed-xml</TT>&#23646;&#24615;&#21487;&#29992;&#12290; &#36825;&#20010;&#23646;&#24615;&#30340;&#32570;&#30465;&#20540;&#26159;&#30495;(<TT 
class=literal>embed-xml="true"</TT>)&#12290;&#22914;&#26524;<TT class=literal>embed-xml="true"</TT>&#65292; 
&#21017;&#23545;&#24212;&#20110;&#34987;&#20851;&#32852;&#23454;&#20307;&#25110;&#20540;&#31867;&#22411;&#30340;&#38598;&#21512;&#30340;XML&#26641;&#23558;&#30452;&#25509;&#23884;&#20837;&#25317;&#26377;&#36825;&#20123;&#20851;&#32852;&#30340;&#23454;&#20307;&#30340;XML&#26641;&#20013;&#12290; &#21542;&#21017;&#65292;&#22914;&#26524;<TT 
class=literal>embed-xml="false"</TT>&#65292;&#37027;&#20040;&#23545;&#20110;&#21333;&#20540;&#30340;&#20851;&#32852;&#65292;&#20165;&#34987;&#24341;&#29992;&#30340;&#23454;&#20307;&#30340;&#26631;&#35782;&#31526;&#20986;&#29616;&#22312; 
XML&#26641;&#20013;(&#34987;&#24341;&#29992;&#23454;&#20307;&#26412;&#36523;&#19981;&#20986;&#29616;)&#65292;&#32780;&#38598;&#21512;&#21017;&#26681;&#26412;&#19981;&#20986;&#29616;&#12290; </P>
<P>&#20320;&#24212;&#35813;&#23567;&#24515;&#65292;&#19981;&#35201;&#35753;&#22826;&#22810;&#20851;&#32852;&#30340;embed-xml&#23646;&#24615;&#20026;&#30495;(<TT 
class=literal>embed-xml="true"</TT>)&#65292;&#22240;&#20026;XML&#19981;&#33021;&#24456;&#22909;&#22320;&#22788;&#29702; &#24490;&#29615;&#24341;&#29992;! </P><PRE class=programlisting>&lt;class name="Customer" 
        table="CUSTOMER" 
        node="customer"&gt;
        
    &lt;id name="id" 
            column="CUST_ID" 
            node="@id"/&gt;
            
    &lt;map name="accounts" 
            node="." 
            embed-xml="true"&gt;
        &lt;key column="CUSTOMER_ID" 
                not-null="true"/&gt;
        &lt;map-key column="SHORT_DESC" 
                node="@short-desc" 
                type="string"/&gt;
        &lt;one-to-many entity-name="Account"
                embed-xml="false" 
                node="account"/&gt;
    &lt;/map&gt;
    
    &lt;component name="name" 
            node="name"&gt;
        &lt;property name="firstName" 
                node="first-name"/&gt;
        &lt;property name="initial" 
                node="initial"/&gt;
        &lt;property name="lastName" 
                node="last-name"/&gt;
    &lt;/component&gt;
    
    ...
    
&lt;/class&gt;</PRE>
<P>&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#20915;&#23450;&#23884;&#20837;&#24080;&#30446;&#21495;&#30721;(account id)&#30340;&#38598;&#21512;&#65292;&#20294;&#19981;&#23884;&#20837;&#23454;&#38469;&#30340;&#24080;&#30446;&#25968;&#25454;&#12290;&#19979;&#38754;&#30340;HQL&#26597;&#35810;&#65306; </P><PRE class=programlisting>from Customer c left join fetch c.accounts where c.lastName like :lastName</PRE>
<P>&#36820;&#22238;&#30340;&#25968;&#25454;&#38598;&#23558;&#26159;&#36825;&#26679;&#65306; </P><PRE class=programlisting>&lt;customer id="123456789"&gt;
    &lt;account id="987632567" short-desc="Savings"/&gt;
    &lt;account id="985612323" short-desc="Credit Card"/&gt;
    &lt;name&gt;
        &lt;first-name&gt;Gavin&lt;/first-name&gt;
        &lt;initial&gt;A&lt;/initial&gt;
        &lt;last-name&gt;King&lt;/last-name&gt;
    &lt;/name&gt;
    ...
&lt;/customer&gt;</PRE>
<P>&#22914;&#26524;&#20320;&#25226;&#19968;&#23545;&#22810;&#26144;&#23556;<TT class=literal>&lt;one-to-many&gt;</TT>&#30340;embed-xml&#23646;&#24615;&#32622;&#20026;&#30495;(<TT 
class=literal>embed-xml="true"</TT>)&#65292; &#21017;&#25968;&#25454;&#30475;&#19978;&#21435;&#23601;&#20687;&#36825;&#26679;&#65306; </P><PRE class=programlisting>&lt;customer id="123456789"&gt;
    &lt;account id="987632567" short-desc="Savings"&gt;
        &lt;customer id="123456789"/&gt;
        &lt;balance&gt;100.29&lt;/balance&gt;
    &lt;/account&gt;
    &lt;account id="985612323" short-desc="Credit Card"&gt;
        &lt;customer id="123456789"/&gt;
        &lt;balance&gt;-2370.34&lt;/balance&gt;
    &lt;/account&gt;
    &lt;name&gt;
        &lt;first-name&gt;Gavin&lt;/first-name&gt;
        &lt;initial&gt;A&lt;/initial&gt;
        &lt;last-name&gt;King&lt;/last-name&gt;
    &lt;/name&gt;
    ...
&lt;/customer&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=xml-manipulation></A>18.3.&nbsp;&#25805;&#20316;XML&#25968;&#25454;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#35753;&#25105;&#20204;&#26469;&#35835;&#20837;&#21644;&#26356;&#26032;&#24212;&#29992;&#31243;&#24207;&#20013;&#30340;XML&#25991;&#26723;&#12290;&#36890;&#36807;&#33719;&#21462;&#19968;&#20010;dom4j&#20250;&#35805;&#21487;&#20197;&#20570;&#21040;&#36825;&#19968;&#28857;&#65306; </P><PRE class=programlisting>Document doc = ....;
       
Session session = factory.openSession();
Session dom4jSession = session.getSession(EntityMode.DOM4J);
Transaction tx = session.beginTransaction();

List results = dom4jSession
    .createQuery("from Customer c left join fetch c.accounts where c.lastName like :lastName")
    .list();
for ( int i=0; i&lt;results.size(); i++ ) {
    //add the customer data to the XML document
    Element customer = (Element) results.get(i);
    doc.add(customer);
}

tx.commit();
session.close();</PRE><PRE class=programlisting>Session session = factory.openSession();
Session dom4jSession = session.getSession(EntityMode.DOM4J);
Transaction tx = session.beginTransaction();

Element cust = (Element) dom4jSession.get("Customer", customerId);
for ( int i=0; i&lt;results.size(); i++ ) {
    Element customer = (Element) results.get(i);
    //change the customer name in the XML and database
    Element name = customer.element("name");
    name.element("first-name").setText(firstName);
    name.element("initial").setText(initial);
    name.element("last-name").setText(lastName);
}

tx.commit();
session.close();</PRE>
<P>&#23558;&#36825;&#19968;&#29305;&#33394;&#19982;Hibernate&#30340;<TT 
class=literal>replicate()</TT>&#25805;&#20316;&#32467;&#21512;&#36215;&#26469;&#23545;&#20110;&#23454;&#29616;&#30340;&#22522;&#20110;XML&#30340;&#25968;&#25454;&#23548;&#20837;/&#23548;&#20986;&#23558;&#38750;&#24120;&#26377;&#29992;. </P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=performance></A>&#31532;&nbsp;19&nbsp;&#31456;&nbsp;&#25552;&#21319;&#24615;&#33021; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A name=performance-fetching></A>19.1.&nbsp; 
&#25235;&#21462;&#31574;&#30053;(Fetching strategies) </H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#25235;&#21462;&#31574;&#30053;&#65288;fetching strategy&#65289;</EM></SPAN> 
&#26159;&#25351;&#65306;&#24403;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#22312;&#65288;Hibernate&#23454;&#20307;&#23545;&#35937;&#22270;&#30340;&#65289;&#20851;&#32852;&#20851;&#31995;&#38388;&#36827;&#34892;&#23548;&#33322;&#30340;&#26102;&#20505;&#65292; 
Hibernate&#22914;&#20309;&#33719;&#21462;&#20851;&#32852;&#23545;&#35937;&#30340;&#31574;&#30053;&#12290;&#25235;&#21462;&#31574;&#30053;&#21487;&#20197;&#22312;O/R&#26144;&#23556;&#30340;&#20803;&#25968;&#25454;&#20013;&#22768;&#26126;&#65292;&#20063;&#21487;&#20197;&#22312;&#29305;&#23450;&#30340;HQL &#25110;<TT 
class=literal>&#26465;&#20214;&#26597;&#35810;&#65288;Criteria Query&#65289;</TT>&#20013;&#37325;&#36733;&#22768;&#26126;&#12290; </P>
<P>Hibernate3 &#23450;&#20041;&#20102;&#22914;&#19979;&#20960;&#31181;&#25235;&#21462;&#31574;&#30053;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>&#36830;&#25509;&#25235;&#21462;&#65288;Join fetching&#65289;</EM></SPAN> - Hibernate&#36890;&#36807; &#22312;<TT 
  class=literal>SELECT</TT>&#35821;&#21477;&#20351;&#29992;<TT class=literal>OUTER JOIN</TT>&#65288;&#22806;&#36830;&#25509;&#65289;&#26469; 
  &#33719;&#24471;&#23545;&#35937;&#30340;&#20851;&#32852;&#23454;&#20363;&#25110;&#32773;&#20851;&#32852;&#38598;&#21512;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#26597;&#35810;&#25235;&#21462;&#65288;Select fetching&#65289;</EM></SPAN> - &#21478;&#22806;&#21457;&#36865;&#19968;&#26465; <TT 
  class=literal>SELECT</TT> &#35821;&#21477;&#25235;&#21462;&#24403;&#21069;&#23545;&#35937;&#30340;&#20851;&#32852;&#23454;&#20307;&#25110;&#38598;&#21512;&#12290;&#38500;&#38750;&#20320;&#26174;&#24335;&#30340;&#25351;&#23450;<TT 
  class=literal>lazy="false"</TT>&#31105;&#27490; &#24310;&#36831;&#25235;&#21462;&#65288;lazy 
  fetching&#65289;&#65292;&#21542;&#21017;&#21482;&#26377;&#24403;&#20320;&#30495;&#27491;&#35775;&#38382;&#20851;&#32852;&#20851;&#31995;&#30340;&#26102;&#20505;&#65292;&#25165;&#20250;&#25191;&#34892;&#31532;&#20108;&#26465;select&#35821;&#21477;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#23376;&#26597;&#35810;&#25235;&#21462;&#65288;Subselect fetching&#65289;</EM></SPAN> - &#21478;&#22806;&#21457;&#36865;&#19968;&#26465;<TT 
  class=literal>SELECT</TT> &#35821;&#21477;&#25235;&#21462;&#22312;&#21069;&#38754;&#26597;&#35810;&#21040;&#65288;&#25110;&#32773;&#25235;&#21462;&#21040;&#65289;&#30340;&#25152;&#26377;&#23454;&#20307;&#23545;&#35937;&#30340;&#20851;&#32852;&#38598;&#21512;&#12290;&#38500;&#38750;&#20320;&#26174;&#24335;&#30340;&#25351;&#23450;<TT 
  class=literal>lazy="false"</TT> &#31105;&#27490;&#24310;&#36831;&#25235;&#21462;&#65288;lazy 
  fetching&#65289;&#65292;&#21542;&#21017;&#21482;&#26377;&#24403;&#20320;&#30495;&#27491;&#35775;&#38382;&#20851;&#32852;&#20851;&#31995;&#30340;&#26102;&#20505;&#65292;&#25165;&#20250;&#25191;&#34892;&#31532;&#20108;&#26465;select&#35821;&#21477;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>&#25209;&#37327;&#25235;&#21462;&#65288;Batch fetching&#65289;</EM></SPAN> - &#23545;&#26597;&#35810;&#25235;&#21462;&#30340;&#20248;&#21270;&#26041;&#26696;&#65292; 
  &#36890;&#36807;&#25351;&#23450;&#19968;&#20010;&#20027;&#38190;&#25110;&#22806;&#38190;&#21015;&#34920;&#65292;Hibernate&#20351;&#29992;&#21333;&#26465;<TT class=literal>SELECT</TT>&#35821;&#21477;&#33719;&#21462;&#19968;&#25209;&#23545;&#35937;&#23454;&#20363;&#25110;&#38598;&#21512;&#12290; 
  </P></LI></UL></DIV>
<P>Hibernate&#20250;&#21306;&#20998;&#19979;&#21015;&#21508;&#31181;&#24773;&#20917;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>Immediate fetching&#65292;&#31435;&#21363;&#25235;&#21462;</EM></SPAN> - 
  &#24403;&#23487;&#20027;&#34987;&#21152;&#36733;&#26102;&#65292;&#20851;&#32852;&#12289;&#38598;&#21512;&#25110;&#23646;&#24615;&#34987;&#31435;&#21363;&#25235;&#21462;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>Lazy collection fetching&#65292;&#24310;&#36831;&#38598;&#21512;&#25235;&#21462;</EM></SPAN>- 
  &#30452;&#21040;&#24212;&#29992;&#31243;&#24207;&#23545;&#38598;&#21512;&#36827;&#34892;&#20102;&#19968;&#27425;&#25805;&#20316;&#26102;&#65292;&#38598;&#21512;&#25165;&#34987;&#25235;&#21462;&#12290;&#65288;&#23545;&#38598;&#21512;&#32780;&#35328;&#36825;&#26159;&#40664;&#35748;&#34892;&#20026;&#12290;&#65289; </P>
  <LI>
  <P><SPAN class=emphasis><EM>"Extra-lazy" collection 
  fetching,"Extra-lazy"&#38598;&#21512;&#25235;&#21462;</EM></SPAN> 
  -&#23545;&#38598;&#21512;&#31867;&#20013;&#30340;&#27599;&#20010;&#20803;&#32032;&#32780;&#35328;&#65292;&#37117;&#26159;&#30452;&#21040;&#38656;&#35201;&#26102;&#25165;&#21435;&#35775;&#38382;&#25968;&#25454;&#24211;&#12290;&#38500;&#38750;&#32477;&#23545;&#24517;&#35201;&#65292;Hibernate&#19981;&#20250;&#35797;&#22270;&#21435;&#25226;&#25972;&#20010;&#38598;&#21512;&#37117;&#25235;&#21462;&#21040;&#20869;&#23384;&#37324;&#26469;&#65288;&#36866;&#29992;&#20110;&#38750;&#24120;&#22823;&#30340;&#38598;&#21512;&#65289;&#12290; 
  </P>
  <LI>
  <P><SPAN class=emphasis><EM>Proxy fetching&#65292;&#20195;&#29702;&#25235;&#21462;</EM></SPAN> - 
  &#23545;&#36820;&#22238;&#21333;&#20540;&#30340;&#20851;&#32852;&#32780;&#35328;&#65292;&#24403;&#20854;&#26576;&#20010;&#26041;&#27861;&#34987;&#35843;&#29992;&#65292;&#32780;&#38750;&#23545;&#20854;&#20851;&#38190;&#23383;&#36827;&#34892;get&#25805;&#20316;&#26102;&#25165;&#25235;&#21462;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>"No-proxy" fetching,&#38750;&#20195;&#29702;&#25235;&#21462;</EM></SPAN> - 
  &#23545;&#36820;&#22238;&#21333;&#20540;&#30340;&#20851;&#32852;&#32780;&#35328;&#65292;&#24403;&#23454;&#20363;&#21464;&#37327;&#34987;&#35775;&#38382;&#30340;&#26102;&#20505;&#36827;&#34892;&#25235;&#21462;&#12290;&#19982;&#19978;&#38754;&#30340;&#20195;&#29702;&#25235;&#21462;&#30456;&#27604;&#65292;&#36825;&#31181;&#26041;&#27861;&#27809;&#26377;&#37027;&#20040;“&#24310;&#36831;”&#24471;&#21385;&#23475;(&#23601;&#31639;&#21482;&#35775;&#38382;&#26631;&#35782;&#31526;&#65292;&#20063;&#20250;&#23548;&#33268;&#20851;&#32852;&#25235;&#21462;)&#20294;&#26159;&#26356;&#21152;&#36879;&#26126;&#65292;&#22240;&#20026;&#23545;&#24212;&#29992;&#31243;&#24207;&#26469;&#35828;&#65292;&#19981;&#20877;&#30475;&#21040;proxy&#12290;&#36825;&#31181;&#26041;&#27861;&#38656;&#35201;&#22312;&#32534;&#35793;&#26399;&#38388;&#36827;&#34892;&#23383;&#33410;&#30721;&#22686;&#24378;&#25805;&#20316;&#65292;&#22240;&#27492;&#24456;&#23569;&#38656;&#35201;&#29992;&#21040;&#12290; 
  </P>
  <LI>
  <P><SPAN class=emphasis><EM>Lazy attribute fetching&#65292;&#23646;&#24615;&#24310;&#36831;&#21152;&#36733;</EM></SPAN> - 
  &#23545;&#23646;&#24615;&#25110;&#36820;&#22238;&#21333;&#20540;&#30340;&#20851;&#32852;&#32780;&#35328;&#65292;&#24403;&#20854;&#23454;&#20363;&#21464;&#37327;&#34987;&#35775;&#38382;&#30340;&#26102;&#20505;&#36827;&#34892;&#25235;&#21462;&#12290;&#38656;&#35201;&#32534;&#35793;&#26399;&#23383;&#33410;&#30721;&#24378;&#21270;&#65292;&#22240;&#27492;&#36825;&#19968;&#26041;&#27861;&#24456;&#23569;&#26159;&#24517;&#35201;&#30340;&#12290; </P></LI></UL></DIV>
<P>&#36825;&#37324;&#26377;&#20004;&#20010;&#27491;&#20132;&#30340;&#27010;&#24565;&#65306;&#20851;&#32852;<SPAN class=emphasis><EM>&#20309;&#26102;</EM></SPAN>&#34987;&#25235;&#21462;&#65292;&#20197;&#21450;&#34987;<SPAN 
class=emphasis><EM>&#22914;&#20309;</EM></SPAN>&#25235;&#21462;&#65288;&#20250;&#37319;&#29992;&#20160;&#20040;&#26679;&#30340;SQL&#35821;&#21477;&#65289;&#12290;&#19981;&#35201;&#28151;&#28102;&#23427;&#20204;&#65281;&#25105;&#20204;&#20351;&#29992;<TT 
class=literal>&#25235;&#21462;</TT>&#26469;&#25913;&#21892;&#24615;&#33021;&#12290;&#25105;&#20204;&#20351;&#29992;<TT 
class=literal>&#24310;&#36831;</TT>&#26469;&#23450;&#20041;&#19968;&#20123;&#22865;&#32422;&#65292;&#23545;&#26576;&#29305;&#23450;&#31867;&#30340;&#26576;&#20010;&#33073;&#31649;&#30340;&#23454;&#20363;&#65292;&#30693;&#36947;&#26377;&#21738;&#20123;&#25968;&#25454;&#26159;&#21487;&#20197;&#20351;&#29992;&#30340;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-fetching-lazy></A>19.1.1.&nbsp;&#25805;&#20316;&#24310;&#36831;&#21152;&#36733;&#30340;&#20851;&#32852;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Hibernate 
3&#23545;&#38598;&#21512;&#20351;&#29992;&#24310;&#36831;select&#25235;&#21462;&#65292;&#23545;&#36820;&#22238;&#21333;&#20540;&#30340;&#20851;&#32852;&#20351;&#29992;&#24310;&#36831;&#20195;&#29702;&#25235;&#21462;&#12290;&#23545;&#20960;&#20046;&#26159;&#25152;&#26377;&#30340;&#24212;&#29992;&#32780;&#35328;&#65292;&#20854;&#32477;&#22823;&#22810;&#25968;&#30340;&#20851;&#32852;&#65292;&#36825;&#31181;&#31574;&#30053;&#37117;&#26159;&#26377;&#25928;&#30340;&#12290; </P>
<P><SPAN class=emphasis><EM>&#27880;&#24847;:</EM></SPAN>&#20551;&#33509;&#20320;&#35774;&#32622;&#20102;<TT 
class=literal>hibernate.default_batch_fetch_size</TT>,Hibernate&#20250;&#23545;&#24310;&#36831;&#21152;&#36733;&#37319;&#21462;&#25209;&#37327;&#25235;&#21462;&#20248;&#21270;&#25514;&#26045;&#65288;&#36825;&#31181;&#20248;&#21270;&#20063;&#21487;&#33021;&#20250;&#22312;&#26356;&#32454;&#21270;&#30340;&#32423;&#21035;&#25171;&#24320;&#65289;&#12290; 
</P>
<P>&#28982;&#32780;&#65292;&#20320;&#24517;&#39035;&#20102;&#35299;&#24310;&#36831;&#25235;&#21462;&#24102;&#26469;&#30340;&#19968;&#20010;&#38382;&#39064;&#12290;&#22312;&#19968;&#20010;&#25171;&#24320;&#30340;Hibernate session&#19978;&#19979;&#25991;&#20043;&#22806;&#35843;&#29992;&#24310;&#36831;&#38598;&#21512;&#20250;&#23548;&#33268;&#19968;&#27425;&#24847;&#22806;&#12290;&#27604;&#22914;&#65306; </P><PRE class=programlisting>s = sessions.openSession();
Transaction tx = s.beginTransaction();
            
User u = (User) s.createQuery("from User u where u.name=:userName")
	.setString("userName", userName).uniqueResult();
Map permissions = u.getPermissions();

tx.commit();
s.close();

Integer accessLevel = (Integer) permissions.get("accounts");  // Error!</PRE>
<P>&#22312;<TT class=literal>Session</TT>&#20851;&#38381;&#21518;&#65292;permessions&#38598;&#21512;&#23558;&#26159;&#26410;&#23454;&#20363;&#21270;&#30340;&#12289;&#19981;&#20877;&#21487;&#29992;&#65292;&#22240;&#27492;&#26080;&#27861;&#27491;&#24120;&#36733;&#20837;&#20854;&#29366;&#24577;&#12290; 
<SPAN class=emphasis><EM>Hibernate&#23545;&#33073;&#31649;&#23545;&#35937;&#19981;&#25903;&#25345;&#24310;&#36831;&#23454;&#20363;&#21270;</EM></SPAN>. 
&#36825;&#37324;&#30340;&#20462;&#25913;&#26041;&#27861;&#26159;&#65306;&#23558;permissions&#35835;&#21462;&#25968;&#25454;&#30340;&#20195;&#30721; &#31227;&#21040;tx.commit()&#20043;&#21069;&#12290; </P>
<P>&#38500;&#27492;&#20043;&#22806;&#65292;&#36890;&#36807;&#23545;&#20851;&#32852;&#26144;&#23556;&#25351;&#23450;<TT class=literal>lazy="false"</TT>,&#25105;&#20204;&#20063;&#21487;&#20197;&#20351;&#29992;&#38750;&#24310;&#36831;&#30340;&#38598;&#21512;&#25110;&#20851;&#32852;&#12290;&#20294;&#26159;&#65292; 
&#23545;&#32477;&#22823;&#37096;&#20998;&#38598;&#21512;&#26469;&#35828;&#65292;&#26356;&#25512;&#33616;&#20351;&#29992;&#24310;&#36831;&#26041;&#24335;&#25235;&#21462;&#25968;&#25454;&#12290;&#22914;&#26524;&#22312;&#20320;&#30340;&#23545;&#35937;&#27169;&#22411;&#20013;&#23450;&#20041;&#20102;&#22826;&#22810;&#30340;&#38750;&#24310;&#36831;&#20851;&#32852;&#65292;Hibernate&#26368;&#32456;&#20960;&#20046;&#38656;&#35201;&#22312;&#27599;&#20010;&#20107;&#21153;&#20013;&#36733;&#20837;&#25972;&#20010;&#25968;&#25454;&#24211;&#21040;&#20869;&#23384;&#20013;&#65281; 
</P>
<P>&#20294;&#26159;&#65292;&#21478;&#19968;&#26041;&#38754;&#65292;&#22312;&#19968;&#20123;&#29305;&#27530;&#30340;&#20107;&#21153;&#20013;&#65292;&#25105;&#20204;&#20063;&#32463;&#24120;&#38656;&#35201;&#20351;&#29992;&#21040;&#36830;&#25509;&#25235;&#21462;&#65288;&#23427;&#26412;&#36523;&#19978;&#23601;&#26159;&#38750;&#24310;&#36831;&#30340;&#65289;&#65292;&#20197;&#20195;&#26367;&#26597;&#35810;&#25235;&#21462;&#12290; 
&#19979;&#38754;&#25105;&#20204;&#23558;&#20250;&#24456;&#24555;&#26126;&#30333;&#22914;&#20309;&#20855;&#20307;&#30340;&#23450;&#21046;Hibernate&#20013;&#30340;&#25235;&#21462;&#31574;&#30053;&#12290;&#22312;Hibernate3&#20013;&#65292;&#20855;&#20307;&#36873;&#25321;&#21738;&#31181;&#25235;&#21462;&#31574;&#30053;&#30340;&#26426;&#21046;&#26159;&#21644;&#36873;&#25321; &#21333;&#20540;&#20851;&#32852;&#25110;&#38598;&#21512;&#20851;&#32852;&#30456;&#19968;&#33268;&#30340;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-fetching-custom></A>19.1.2.&nbsp; 
&#35843;&#25972;&#25235;&#21462;&#31574;&#30053;&#65288;Tuning fetch strategies&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26597;&#35810;&#25235;&#21462;&#65288;&#40664;&#35748;&#30340;&#65289;&#22312;N+1&#26597;&#35810;&#30340;&#24773;&#20917;&#19979;&#26159;&#26497;&#20854;&#33030;&#24369;&#30340;&#65292;&#22240;&#27492;&#25105;&#20204;&#21487;&#33021;&#20250;&#35201;&#27714;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;&#20351;&#29992;&#36830;&#25509;&#25235;&#21462;&#65306; </P><PRE class=programlisting>&lt;set name="permissions" 
            fetch="join"&gt;
    &lt;key column="userId"/&gt;
    &lt;one-to-many class="Permission"/&gt;
&lt;/set</PRE><PRE class=programlisting>&lt;many-to-one name="mother" class="Cat" fetch="join"/&gt;</PRE>
<P>&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;&#30340;<TT class=literal>&#25235;&#21462;</TT>&#31574;&#30053;&#23558;&#20250;&#23545;&#20197;&#19979;&#21015;&#34920;&#26465;&#30446;&#20135;&#29983;&#24433;&#21709;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#36890;&#36807;<TT class=literal>get()</TT>&#25110;<TT class=literal>load()</TT>&#26041;&#27861;&#21462;&#24471;&#25968;&#25454;&#12290; </P>
  <LI>
  <P>&#21482;&#26377;&#22312;&#20851;&#32852;&#20043;&#38388;&#36827;&#34892;&#23548;&#33322;&#26102;&#65292;&#25165;&#20250;&#38544;&#24335;&#30340;&#21462;&#24471;&#25968;&#25454;&#12290; </P>
  <LI>
  <P><TT class=literal>&#26465;&#20214;&#26597;&#35810;</TT> </P>
  <LI>
  <P>&#20351;&#29992;&#20102;<TT class=literal>subselect</TT>&#25235;&#21462;&#30340;HQL&#26597;&#35810; </P></LI></UL></DIV>
<P>&#19981;&#31649;&#20320;&#20351;&#29992;&#21738;&#31181;&#25235;&#21462;&#31574;&#30053;&#65292;&#23450;&#20041;&#20026;&#38750;&#24310;&#36831;&#30340;&#31867;&#22270;&#20250;&#34987;&#20445;&#35777;&#19968;&#23450;&#35013;&#36733;&#20837;&#20869;&#23384;&#12290;&#27880;&#24847;&#36825;&#21487;&#33021;&#24847;&#21619;&#30528;&#22312;&#19968;&#26465;HQL&#26597;&#35810;&#21518;&#32039;&#36319;&#30528;&#19968;&#31995;&#21015;&#30340;&#26597;&#35810;&#12290; </P>
<P>&#36890;&#24120;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#24182;&#19981;&#20351;&#29992;&#26144;&#23556;&#25991;&#26723;&#36827;&#34892;&#25235;&#21462;&#31574;&#30053;&#30340;&#23450;&#21046;&#12290;&#26356;&#22810;&#30340;&#26159;&#65292;&#20445;&#25345;&#20854;&#40664;&#35748;&#20540;&#65292;&#28982;&#21518;&#22312;&#29305;&#23450;&#30340;&#20107;&#21153;&#20013;&#65292; &#20351;&#29992;HQL&#30340;<TT 
class=literal>&#24038;&#36830;&#25509;&#25235;&#21462;&#65288;left join fetch&#65289;</TT> &#23545;&#20854;&#36827;&#34892;&#37325;&#36733;&#12290;&#36825;&#23558;&#36890;&#30693; 
Hibernate&#22312;&#31532;&#19968;&#27425;&#26597;&#35810;&#20013;&#20351;&#29992;&#22806;&#37096;&#20851;&#32852;&#65288;outer join&#65289;&#65292;&#30452;&#25509;&#24471;&#21040;&#20854;&#20851;&#32852;&#25968;&#25454;&#12290; &#22312;<TT class=literal>&#26465;&#20214;&#26597;&#35810;</TT> 
API&#20013;&#65292;&#24212;&#35813;&#35843;&#29992; <TT class=literal>setFetchMode(FetchMode.JOIN)</TT>&#35821;&#21477;&#12290; </P>
<P>&#20063;&#35768;&#20320;&#21916;&#27426;&#20165;&#20165;&#36890;&#36807;&#26465;&#20214;&#26597;&#35810;&#65292;&#23601;&#21487;&#20197;&#25913;&#21464;<TT class=literal>get()</TT> &#25110; <TT 
class=literal>load()</TT>&#35821;&#21477;&#20013;&#30340;&#25968;&#25454;&#25235;&#21462;&#31574;&#30053;&#12290;&#20363;&#22914;&#65306; </P><PRE class=programlisting>User user = (User) session.createCriteria(User.class)
            	.setFetchMode("permissions", FetchMode.JOIN)
            	.add( Restrictions.idEq(userId) )
            	.uniqueResult();</PRE>
<P>&#65288;&#36825;&#23601;&#26159;&#20854;&#20182;ORM&#35299;&#20915;&#26041;&#26696;&#30340;“&#25235;&#21462;&#35745;&#21010;(fetch plan)”&#22312;Hibernate&#20013;&#30340;&#31561;&#20215;&#29289;&#12290;&#65289; </P>
<P>&#25130;&#28982;&#19981;&#21516;&#30340;&#19968;&#31181;&#36991;&#20813;N+1&#27425;&#26597;&#35810;&#30340;&#26041;&#27861;&#26159;&#65292;&#20351;&#29992;&#20108;&#32423;&#32531;&#23384;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-fetching-proxies></A>19.1.3.&nbsp;&#21333;&#31471;&#20851;&#32852;&#20195;&#29702;&#65288;Single-ended 
association proxies&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;Hinerbate&#20013;&#65292;&#23545;&#38598;&#21512;&#30340;&#24310;&#36831;&#25235;&#21462;&#30340;&#37319;&#29992;&#20102;&#33258;&#24049;&#30340;&#23454;&#29616;&#26041;&#27861;&#12290;&#20294;&#26159;&#65292;&#23545;&#20110;&#21333;&#31471;&#20851;&#32852;&#30340;&#24310;&#36831;&#25235;&#21462;&#65292;&#21017;&#38656;&#35201;&#37319;&#29992; 
&#20854;&#20182;&#19981;&#21516;&#30340;&#26426;&#21046;&#12290;&#21333;&#31471;&#20851;&#32852;&#30340;&#30446;&#26631;&#23454;&#20307;&#24517;&#39035;&#20351;&#29992;&#20195;&#29702;&#65292;Hihernate&#22312;&#36816;&#34892;&#26399;&#20108;&#36827;&#21046;&#32423;&#65288;&#36890;&#36807;&#20248;&#24322;&#30340;CGLIB&#24211;&#65289;&#65292; &#20026;&#25345;&#20037;&#23545;&#35937;&#23454;&#29616;&#20102;&#24310;&#36831;&#36733;&#20837;&#20195;&#29702;&#12290; </P>
<P>&#40664;&#35748;&#30340;&#65292;Hibernate3&#23558;&#20250;&#20026;&#25152;&#26377;&#30340;&#25345;&#20037;&#23545;&#35937;&#20135;&#29983;&#20195;&#29702;&#65288;&#22312;&#21551;&#21160;&#38454;&#27573;&#65289;&#65292;&#28982;&#21518;&#20351;&#29992;&#20182;&#20204;&#23454;&#29616; <TT 
class=literal>&#22810;&#23545;&#19968;&#65288;many-to-one&#65289;</TT>&#20851;&#32852;&#21644;<TT class=literal>&#19968;&#23545;&#19968;&#65288;one-to-one&#65289;</TT> 
&#20851;&#32852;&#30340;&#24310;&#36831;&#25235;&#21462;&#12290; </P>
<P>&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#21487;&#20197;&#36890;&#36807;&#35774;&#32622;<TT class=literal>proxy</TT>&#23646;&#24615;&#20026;&#30446;&#26631;class&#22768;&#26126;&#19968;&#20010;&#25509;&#21475;&#20379;&#20195;&#29702;&#25509;&#21475;&#20351;&#29992;&#12290; 
&#40664;&#35748;&#30340;&#65292;Hibernate&#23558;&#20250;&#20351;&#29992;&#35813;&#31867;&#30340;&#19968;&#20010;&#23376;&#31867;&#12290; <SPAN 
class=emphasis><EM>&#27880;&#24847;&#65306;&#34987;&#20195;&#29702;&#30340;&#31867;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010;&#33267;&#23569;&#21253;&#21487;&#35265;&#30340;&#40664;&#35748;&#26500;&#36896;&#20989;&#25968;&#65292;&#25105;&#20204;&#24314;&#35758;&#25152;&#26377;&#30340;&#25345;&#20037;&#31867;&#37117;&#24212;&#25317;&#26377;&#36825;&#26679;&#30340;&#26500;&#36896;&#20989;&#25968;</EM></SPAN> 
</P>
<P>&#22312;&#22914;&#27492;&#26041;&#24335;&#23450;&#20041;&#19968;&#20010;&#22810;&#24577;&#31867;&#30340;&#26102;&#20505;&#65292;&#26377;&#35768;&#22810;&#20540;&#24471;&#27880;&#24847;&#30340;&#24120;&#35265;&#24615;&#30340;&#38382;&#39064;&#65292;&#20363;&#22914;&#65306; </P><PRE class=programlisting>&lt;class name="Cat" proxy="Cat"&gt;
    ......
    &lt;subclass name="DomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</PRE>
<P>&#39318;&#20808;&#65292;<TT class=literal>Cat</TT>&#23454;&#20363;&#27704;&#36828;&#19981;&#21487;&#20197;&#34987;&#24378;&#21046;&#36716;&#25442;&#20026;<TT class=literal>DomesticCat</TT>, 
&#21363;&#20351;&#23427;&#26412;&#36523;&#23601;&#26159;<TT class=literal>DomesticCat</TT>&#23454;&#20363;&#12290; </P><PRE class=programlisting>Cat cat = (Cat) session.load(Cat.class, id);  // instantiate a proxy (does not hit the db)
if ( cat.isDomesticCat() ) {                  // hit the db to initialize the proxy
    DomesticCat dc = (DomesticCat) cat;       // Error!
    ....
}</PRE>
<P>&#20854;&#27425;&#65292;&#20195;&#29702;&#30340;“<TT class=literal>==</TT>”&#21487;&#33021;&#19981;&#20877;&#25104;&#31435;&#12290; </P><PRE class=programlisting>Cat cat = (Cat) session.load(Cat.class, id);            // instantiate a Cat proxy
DomesticCat dc = 
        (DomesticCat) session.load(DomesticCat.class, id);  // acquire new DomesticCat proxy!
System.out.println(cat==dc);                            // false</PRE>
<P>&#34429;&#28982;&#22914;&#27492;&#65292;&#20294;&#23454;&#38469;&#24773;&#20917;&#24182;&#27809;&#26377;&#30475;&#19978;&#21435;&#37027;&#20040;&#31967;&#31957;&#12290;&#34429;&#28982;&#25105;&#20204;&#29616;&#22312;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#24341;&#29992;&#65292;&#20998;&#21035;&#25351;&#21521;&#36825;&#20004;&#20010;&#19981;&#21516;&#30340;&#20195;&#29702;&#23545;&#35937;&#65292; &#20294;&#23454;&#38469;&#19978;&#65292;&#20854;&#24213;&#23618;&#24212;&#35813;&#26159;&#21516;&#19968;&#20010;&#23454;&#20363;&#23545;&#35937;&#65306; </P><PRE class=programlisting>cat.setWeight(11.0);  // hit the db to initialize the proxy
System.out.println( dc.getWeight() );  // 11.0</PRE>
<P>&#31532;&#19977;&#65292;&#20320;&#19981;&#33021;&#23545;“final&#31867;”&#25110;“&#20855;&#26377;final&#26041;&#27861;&#30340;&#31867;”&#20351;&#29992;CGLIB&#20195;&#29702;&#12290; </P>
<P>&#26368;&#21518;&#65292;&#22914;&#26524;&#20320;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#22312;&#23454;&#20363;&#21270;&#26102;&#38656;&#35201;&#26576;&#20123;&#36164;&#28304;&#65288;&#20363;&#22914;&#65292;&#22312;&#23454;&#20363;&#21270;&#26041;&#27861;&#12289;&#40664;&#35748;&#26500;&#36896;&#26041;&#27861;&#20013;&#65289;&#65292; 
&#37027;&#20040;&#20195;&#29702;&#23545;&#35937;&#20063;&#21516;&#26679;&#38656;&#35201;&#20351;&#29992;&#36825;&#20123;&#36164;&#28304;&#12290;&#23454;&#38469;&#19978;&#65292;&#20195;&#29702;&#31867;&#26159;&#25345;&#20037;&#21270;&#31867;&#30340;&#23376;&#31867;&#12290; </P>
<P>&#36825;&#20123;&#38382;&#39064;&#37117;&#28304;&#20110;Java&#30340;&#21333;&#26681;&#32487;&#25215;&#27169;&#22411;&#30340;&#22825;&#29983;&#38480;&#21046;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#36991;&#20813;&#36825;&#20123;&#38382;&#39064;&#65292;&#37027;&#20040;&#20320;&#30340;&#27599;&#20010;&#25345;&#20037;&#21270;&#31867;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010;&#25509;&#21475;&#65292; 
&#22312;&#27492;&#25509;&#21475;&#20013;&#24050;&#32463;&#22768;&#26126;&#20102;&#20854;&#19994;&#21153;&#26041;&#27861;&#12290;&#28982;&#21518;&#65292;&#20320;&#38656;&#35201;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#20877;&#25351;&#23450;&#36825;&#20123;&#25509;&#21475;&#12290;&#20363;&#22914;&#65306; </P><PRE class=programlisting>&lt;class name="CatImpl" proxy="Cat"&gt;
    ......
    &lt;subclass name="DomesticCatImpl" proxy="DomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</PRE>
<P>&#36825;&#37324;<TT class=literal>CatImpl</TT>&#23454;&#29616;&#20102;<TT class=literal>Cat</TT>&#25509;&#21475;&#65292; <TT 
class=literal>DomesticCatImpl</TT>&#23454;&#29616;<TT class=literal>DomesticCat</TT>&#25509;&#21475;&#12290; &#22312;<TT 
class=literal>load()</TT>&#12289;<TT class=literal>iterate()</TT>&#26041;&#27861;&#20013;&#23601;&#20250;&#36820;&#22238; <TT 
class=literal>Cat</TT>&#21644;<TT class=literal>DomesticCat</TT>&#30340;&#20195;&#29702;&#23545;&#35937;&#12290; (&#27880;&#24847;<TT 
class=literal>list()</TT>&#24182;&#19981;&#20250;&#36820;&#22238;&#20195;&#29702;&#23545;&#35937;&#12290;) </P><PRE class=programlisting>Cat cat = (Cat) session.load(CatImpl.class, catid);
Iterator iter = session.iterate("from CatImpl as cat where cat.name='fritz'");
Cat fritz = (Cat) iter.next();</PRE>
<P>&#36825;&#37324;&#65292;&#23545;&#35937;&#20043;&#38388;&#30340;&#20851;&#31995;&#20063;&#23558;&#34987;&#24310;&#36831;&#36733;&#20837;&#12290;&#36825;&#23601;&#24847;&#21619;&#30528;&#65292;&#20320;&#24212;&#35813;&#23558;&#23646;&#24615;&#22768;&#26126;&#20026;<TT class=literal>Cat</TT>&#65292;&#32780;&#19981;&#26159;<TT 
class=literal>CatImpl</TT>&#12290; </P>
<P>&#20294;&#26159;&#65292;&#22312;&#26377;&#20123;&#26041;&#27861;&#20013;&#26159;<SPAN class=emphasis><EM>&#19981;&#38656;&#35201;</EM></SPAN>&#20351;&#29992;&#20195;&#29702;&#30340;&#12290;&#20363;&#22914;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P><TT class=literal>equals()</TT>&#26041;&#27861;&#65292;&#22914;&#26524;&#25345;&#20037;&#31867;&#27809;&#26377;&#37325;&#36733;<TT 
  class=literal>equals()</TT>&#26041;&#27861;&#12290; </P>
  <LI>
  <P><TT class=literal>hashCode()</TT>&#26041;&#27861;&#65292;&#22914;&#26524;&#25345;&#20037;&#31867;&#27809;&#26377;&#37325;&#36733;<TT 
  class=literal>hashCode()</TT>&#26041;&#27861;&#12290; </P>
  <LI>
  <P>&#26631;&#24535;&#31526;&#30340;getter&#26041;&#27861;&#12290; </P></LI></UL></DIV>
<P>Hibernate&#23558;&#20250;&#35782;&#21035;&#20986;&#37027;&#20123;&#37325;&#36733;&#20102;<TT class=literal>equals()</TT>&#12289;&#25110;<TT 
class=literal>hashCode()</TT>&#26041;&#27861;&#30340;&#25345;&#20037;&#21270;&#31867;&#12290; </P>
<P>&#33509;&#36873;&#25321;<TT class=literal>lazy="no-proxy"</TT>&#32780;&#38750;&#40664;&#35748;&#30340;<TT 
class=literal>lazy="proxy"</TT>&#65292;&#25105;&#20204;&#21487;&#20197;&#36991;&#20813;&#31867;&#22411;&#36716;&#25442;&#24102;&#26469;&#30340;&#38382;&#39064;&#12290;&#28982;&#32780;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#38656;&#35201;&#32534;&#35793;&#26399;&#23383;&#33410;&#30721;&#22686;&#24378;&#65292;&#24182;&#19988;&#25152;&#26377;&#30340;&#25805;&#20316;&#37117;&#20250;&#23548;&#33268;&#31435;&#21051;&#36827;&#34892;&#20195;&#29702;&#21021;&#22987;&#21270;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-fetching-initialization></A>19.1.4.&nbsp;&#23454;&#20363;&#21270;&#38598;&#21512;&#21644;&#20195;&#29702;&#65288;Initializing 
collections and proxies&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;<TT class=literal>Session</TT>&#33539;&#22260;&#20043;&#22806;&#35775;&#38382;&#26410;&#21021;&#22987;&#21270;&#30340;&#38598;&#21512;&#25110;&#20195;&#29702;&#65292;Hibernate&#23558;&#20250;&#25243;&#20986;<TT 
class=literal>LazyInitializationException</TT>&#24322;&#24120;&#12290; 
&#20063;&#23601;&#26159;&#35828;&#65292;&#22312;&#20998;&#31163;&#29366;&#24577;&#19979;&#65292;&#35775;&#38382;&#19968;&#20010;&#23454;&#20307;&#25152;&#25317;&#26377;&#30340;&#38598;&#21512;&#65292;&#25110;&#32773;&#35775;&#38382;&#20854;&#25351;&#21521;&#20195;&#29702;&#30340;&#23646;&#24615;&#26102;&#65292;&#20250;&#24341;&#21457;&#27492;&#24322;&#24120;&#12290; </P>
<P>&#26377;&#26102;&#20505;&#25105;&#20204;&#38656;&#35201;&#20445;&#35777;&#26576;&#20010;&#20195;&#29702;&#25110;&#32773;&#38598;&#21512;&#22312;Session&#20851;&#38381;&#21069;&#23601;&#24050;&#32463;&#34987;&#21021;&#22987;&#21270;&#20102;&#12290; &#24403;&#28982;&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#24378;&#34892;&#35843;&#29992;<TT 
class=literal>cat.getSex()</TT>&#25110;&#32773;<TT 
class=literal>cat.getKittens().size()</TT>&#20043;&#31867;&#30340;&#26041;&#27861;&#26469;&#30830;&#20445;&#36825;&#19968;&#28857;&#12290; 
&#20294;&#26159;&#36825;&#26679;&#30340;&#31243;&#24207;&#20250;&#36896;&#25104;&#35835;&#32773;&#30340;&#30097;&#24785;&#65292;&#20063;&#19981;&#31526;&#21512;&#36890;&#24120;&#30340;&#20195;&#30721;&#35268;&#33539;&#12290; </P>
<P>&#38745;&#24577;&#26041;&#27861;<TT class=literal>Hibernate.initialized()</TT> 
&#20026;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#25552;&#20379;&#20102;&#19968;&#20010;&#20415;&#25463;&#30340;&#36884;&#24452;&#26469;&#24310;&#36831;&#21152;&#36733;&#38598;&#21512;&#25110;&#20195;&#29702;&#12290; &#21482;&#35201;&#23427;&#30340;Session&#22788;&#20110;open&#29366;&#24577;&#65292;<TT 
class=literal>Hibernate.initialize(cat)</TT> &#23558;&#20250;&#20026;cat&#24378;&#21046;&#23545;&#20195;&#29702;&#23454;&#20363;&#21270;&#12290; &#21516;&#26679;&#65292;<TT 
class=literal>Hibernate.initialize( cat.getKittens() )</TT> &#23545;kittens&#30340;&#38598;&#21512;&#20855;&#26377;&#21516;&#26679;&#30340;&#21151;&#33021;&#12290; 
</P>
<P>&#36824;&#26377;&#21478;&#22806;&#19968;&#31181;&#36873;&#25321;&#65292;&#23601;&#26159;&#20445;&#25345;<TT class=literal>Session</TT>&#19968;&#30452;&#22788;&#20110;open&#29366;&#24577;&#65292;&#30452;&#21040;&#25152;&#26377;&#38656;&#35201;&#30340;&#38598;&#21512;&#25110;&#20195;&#29702;&#37117;&#34987;&#36733;&#20837;&#12290; 
&#22312;&#26576;&#20123;&#24212;&#29992;&#26550;&#26500;&#20013;&#65292;&#29305;&#21035;&#26159;&#23545;&#20110;&#37027;&#20123;&#20351;&#29992;Hibernate&#36827;&#34892;&#25968;&#25454;&#35775;&#38382;&#30340;&#20195;&#30721;&#65292;&#20197;&#21450;&#37027;&#20123;&#22312;&#19981;&#21516;&#24212;&#29992;&#23618;&#21644;&#19981;&#21516;&#29289;&#29702;&#36827;&#31243;&#20013;&#20351;&#29992;Hibernate&#30340;&#20195;&#30721;&#12290; 
&#22312;&#38598;&#21512;&#23454;&#20363;&#21270;&#26102;&#65292;&#22914;&#20309;&#20445;&#35777;<TT class=literal>Session</TT>&#22788;&#20110;open&#29366;&#24577;&#32463;&#24120;&#20250;&#26159;&#19968;&#20010;&#38382;&#39064;&#12290;&#26377;&#20004;&#31181;&#26041;&#27861;&#21487;&#20197;&#35299;&#20915;&#27492;&#38382;&#39064;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#22312;&#19968;&#20010;&#22522;&#20110;Web&#30340;&#24212;&#29992;&#20013;&#65292;&#21487;&#20197;&#21033;&#29992;servlet&#36807;&#28388;&#22120;&#65288;filter&#65289;&#65292;&#22312;&#29992;&#25143;&#35831;&#27714;&#65288;request&#65289;&#32467;&#26463;&#12289;&#39029;&#38754;&#29983;&#25104; &#32467;&#26463;&#26102;&#20851;&#38381;<TT 
  class=literal>Session</TT>&#65288;&#36825;&#37324;&#20351;&#29992;&#20102;<SPAN 
  class=emphasis><EM>&#22312;&#23637;&#31034;&#23618;&#20445;&#25345;&#25171;&#24320;Session&#27169;&#24335;&#65288;Open Session in View&#65289;</EM></SPAN>&#65289;&#65292; 
  &#24403;&#28982;&#65292;&#36825;&#23558;&#20381;&#36182;&#20110;&#24212;&#29992;&#26694;&#26550;&#20013;&#24322;&#24120;&#38656;&#35201;&#34987;&#27491;&#30830;&#30340;&#22788;&#29702;&#12290;&#22312;&#36820;&#22238;&#30028;&#38754;&#32473;&#29992;&#25143;&#20043;&#21069;&#65292;&#20035;&#33267;&#22312;&#29983;&#25104;&#30028;&#38754;&#36807;&#31243;&#20013;&#21457;&#29983;&#24322;&#24120;&#30340;&#24773;&#20917;&#19979;&#65292; &#27491;&#30830;&#20851;&#38381;<TT 
  class=literal>Session</TT>&#21644;&#32467;&#26463;&#20107;&#21153;&#23558;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#65292; &#35831;&#21442;&#35265;Hibernate wiki&#19978;&#30340;"Open Session in 
  View"&#27169;&#24335;&#65292;&#20320;&#21487;&#20197;&#25214;&#21040;&#31034;&#20363;&#12290; </P>
  <LI>
  <P>&#22312;&#19968;&#20010;&#25317;&#26377;&#21333;&#29420;&#19994;&#21153;&#23618;&#30340;&#24212;&#29992;&#20013;&#65292;&#19994;&#21153;&#23618;&#24517;&#39035;&#22312;&#36820;&#22238;&#20043;&#21069;&#65292;&#20026;web&#23618;“&#20934;&#22791;”&#22909;&#20854;&#25152;&#38656;&#30340;&#25968;&#25454;&#38598;&#21512;&#12290;&#36825;&#23601;&#24847;&#21619;&#30528; 
  &#19994;&#21153;&#23618;&#24212;&#35813;&#36733;&#20837;&#25152;&#26377;&#34920;&#29616;&#23618;/web&#23618;&#25152;&#38656;&#30340;&#25968;&#25454;&#65292;&#24182;&#23558;&#36825;&#20123;&#24050;&#23454;&#20363;&#21270;&#23436;&#27605;&#30340;&#25968;&#25454;&#36820;&#22238;&#12290;&#36890;&#24120;&#65292;&#24212;&#29992;&#31243;&#24207;&#24212;&#35813; &#20026;web&#23618;&#25152;&#38656;&#30340;&#27599;&#20010;&#38598;&#21512;&#35843;&#29992;<TT 
  class=literal>Hibernate.initialize()</TT>&#65288;&#36825;&#20010;&#35843;&#29992;&#24517;&#39035;&#21457;&#29983;&#21681;session&#20851;&#38381;&#20043;&#21069;&#65289;&#65307; &#25110;&#32773;&#20351;&#29992;&#24102;&#26377;<TT 
  class=literal>FETCH</TT>&#20174;&#21477;&#65292;&#25110;<TT class=literal>FetchMode.JOIN</TT>&#30340;Hibernate&#26597;&#35810;&#65292; 
  &#20107;&#20808;&#21462;&#24471;&#25152;&#26377;&#30340;&#25968;&#25454;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#22312;&#24212;&#29992;&#20013;&#20351;&#29992;&#20102;<SPAN class=emphasis><EM>Command</EM></SPAN>&#27169;&#24335;&#65292;&#20195;&#26367;<SPAN 
  class=emphasis><EM>Session Facade</EM></SPAN> &#65292; &#37027;&#20040;&#36825;&#39033;&#20219;&#21153;&#23558;&#20250;&#21464;&#24471;&#31616;&#21333;&#30340;&#22810;&#12290; </P>
  <LI>
  <P>&#20320;&#20063;&#21487;&#20197;&#36890;&#36807;<TT class=literal>merge()</TT>&#25110;<TT 
  class=literal>lock()</TT>&#26041;&#27861;&#65292;&#22312;&#35775;&#38382;&#26410;&#23454;&#20363;&#21270;&#30340;&#38598;&#21512;&#65288;&#25110;&#20195;&#29702;&#65289;&#20043;&#21069;&#65292; &#20026;&#20808;&#21069;&#36733;&#20837;&#30340;&#23545;&#35937;&#32465;&#23450;&#19968;&#20010;&#26032;&#30340;<TT 
  class=literal>Session</TT>&#12290; &#26174;&#28982;&#65292;Hibernate&#23558;&#19981;&#20250;&#65292;&#20063;&#19981;<SPAN 
  class=emphasis><EM>&#24212;&#35813;</EM></SPAN>&#33258;&#21160;&#23436;&#25104;&#36825;&#20123;&#20219;&#21153;&#65292;&#22240;&#20026;&#36825;&#23558;&#24341;&#20837;&#19968;&#20010;&#29305;&#27530;&#30340;&#20107;&#21153;&#35821;&#20041;&#12290; </P></LI></UL></DIV>
<P>&#26377;&#26102;&#20505;&#65292;&#20320;&#24182;&#19981;&#38656;&#35201;&#23436;&#20840;&#23454;&#20363;&#21270;&#25972;&#20010;&#22823;&#30340;&#38598;&#21512;&#65292;&#20165;&#38656;&#35201;&#20102;&#35299;&#23427;&#30340;&#37096;&#20998;&#20449;&#24687;&#65288;&#20363;&#22914;&#20854;&#22823;&#23567;&#65289;&#12289;&#25110;&#32773;&#38598;&#21512;&#30340;&#37096;&#20998;&#20869;&#23481;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#20351;&#29992;&#38598;&#21512;&#36807;&#28388;&#22120;&#24471;&#21040;&#20854;&#38598;&#21512;&#30340;&#22823;&#23567;&#65292;&#32780;&#19981;&#24517;&#23454;&#20363;&#21270;&#25972;&#20010;&#38598;&#21512;&#65306; </P><PRE class=programlisting>( (Integer) s.createFilter( collection, "select count(*)" ).list().get(0) ).intValue()</PRE>
<P>&#36825;&#37324;&#30340;<TT class=literal>createFilter()</TT>&#26041;&#27861;&#20063;&#21487;&#20197;&#34987;&#29992;&#26469;&#26377;&#25928;&#30340;&#25235;&#21462;&#38598;&#21512;&#30340;&#37096;&#20998;&#20869;&#23481;&#65292;&#32780;&#26080;&#38656;&#23454;&#20363;&#21270;&#25972;&#20010;&#38598;&#21512;&#65306; </P><PRE class=programlisting>s.createFilter( lazyCollection, "").setFirstResult(0).setMaxResults(10).list();</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-fetching-batch></A>19.1.5.&nbsp;&#20351;&#29992;&#25209;&#37327;&#25235;&#21462;&#65288;Using 
batch fetching&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#21487;&#20197;&#20805;&#20998;&#26377;&#25928;&#30340;&#20351;&#29992;&#25209;&#37327;&#25235;&#21462;&#65292;&#20063;&#23601;&#26159;&#35828;&#65292;&#22914;&#26524;&#20165;&#19968;&#20010;&#35775;&#38382;&#20195;&#29702;&#65288;&#25110;&#38598;&#21512;&#65289;&#65292;&#37027;&#20040;Hibernate&#23558;&#19981;&#36733;&#20837;&#20854;&#20182;&#26410;&#23454;&#20363;&#21270;&#30340;&#20195;&#29702;&#12290; 
&#25209;&#37327;&#25235;&#21462;&#26159;&#24310;&#36831;&#26597;&#35810;&#25235;&#21462;&#30340;&#20248;&#21270;&#26041;&#26696;&#65292;&#20320;&#21487;&#20197;&#22312;&#20004;&#31181;&#25209;&#37327;&#25235;&#21462;&#26041;&#26696;&#20043;&#38388;&#36827;&#34892;&#36873;&#25321;&#65306;&#22312;&#31867;&#32423;&#21035;&#21644;&#38598;&#21512;&#32423;&#21035;&#12290; </P>
<P>&#31867;/&#23454;&#20307;&#32423;&#21035;&#30340;&#25209;&#37327;&#25235;&#21462;&#24456;&#23481;&#26131;&#29702;&#35299;&#12290;&#20551;&#35774;&#20320;&#22312;&#36816;&#34892;&#26102;&#23558;&#38656;&#35201;&#38754;&#23545;&#19979;&#38754;&#30340;&#38382;&#39064;&#65306;&#20320;&#22312;&#19968;&#20010;<TT class=literal>Session</TT>&#20013;&#36733;&#20837;&#20102;25&#20010; 
<TT class=literal>Cat</TT>&#23454;&#20363;&#65292;&#27599;&#20010;<TT class=literal>Cat</TT>&#23454;&#20363;&#37117;&#25317;&#26377;&#19968;&#20010;&#24341;&#29992;&#25104;&#21592;<TT 
class=literal>owner</TT>&#65292; &#20854;&#25351;&#21521;<TT class=literal>Person</TT>&#65292;&#32780;<TT 
class=literal>Person</TT>&#31867;&#26159;&#20195;&#29702;&#65292;&#21516;&#26102;<TT class=literal>lazy="true"</TT>&#12290; 
&#22914;&#26524;&#20320;&#24517;&#39035;&#36941;&#21382;&#25972;&#20010;cats&#38598;&#21512;&#65292;&#23545;&#27599;&#20010;&#20803;&#32032;&#35843;&#29992;<TT 
class=literal>getOwner()</TT>&#26041;&#27861;&#65292;Hibernate&#23558;&#20250;&#40664;&#35748;&#30340;&#25191;&#34892;25&#27425;<TT 
class=literal>SELECT</TT>&#26597;&#35810;&#65292; &#24471;&#21040;&#20854;owner&#30340;&#20195;&#29702;&#23545;&#35937;&#12290;&#36825;&#26102;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#22312;&#26144;&#23556;&#25991;&#20214;&#30340;<TT 
class=literal>Person</TT>&#23646;&#24615;&#65292;&#26174;&#24335;&#22768;&#26126;<TT class=literal>batch-size</TT>&#65292;&#25913;&#21464;&#20854;&#34892;&#20026;&#65306; </P><PRE class=programlisting>&lt;class name="Person" batch-size="10"&gt;...&lt;/class&gt;</PRE>
<P>&#38543;&#20043;&#65292;Hibernate&#23558;&#21482;&#38656;&#35201;&#25191;&#34892;&#19977;&#27425;&#26597;&#35810;&#65292;&#20998;&#21035;&#20026;10&#12289;10&#12289; 5&#12290; </P>
<P>&#20320;&#20063;&#21487;&#20197;&#22312;&#38598;&#21512;&#32423;&#21035;&#23450;&#20041;&#25209;&#37327;&#25235;&#21462;&#12290;&#20363;&#22914;&#65292;&#22914;&#26524;&#27599;&#20010;<TT class=literal>Person</TT>&#37117;&#25317;&#26377;&#19968;&#20010;&#24310;&#36831;&#36733;&#20837;&#30340;<TT 
class=literal>Cats</TT>&#38598;&#21512;&#65292; &#29616;&#22312;&#65292;<TT 
class=literal>Sesssion</TT>&#20013;&#36733;&#20837;&#20102;10&#20010;person&#23545;&#35937;&#65292;&#36941;&#21382;person&#38598;&#21512;&#23558;&#20250;&#24341;&#36215;10&#27425;<TT 
class=literal>SELECT</TT>&#26597;&#35810;&#65292; &#27599;&#27425;&#26597;&#35810;&#37117;&#20250;&#35843;&#29992;<TT class=literal>getCats()</TT>&#26041;&#27861;&#12290;&#22914;&#26524;&#20320;&#22312;<TT 
class=literal>Person</TT>&#30340;&#26144;&#23556;&#23450;&#20041;&#37096;&#20998;&#65292;&#20801;&#35768;&#23545;<TT class=literal>cats</TT>&#25209;&#37327;&#25235;&#21462;, 
&#37027;&#20040;&#65292;Hibernate&#23558;&#21487;&#20197;&#39044;&#20808;&#25235;&#21462;&#25972;&#20010;&#38598;&#21512;&#12290;&#35831;&#30475;&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;set name="cats" batch-size="3"&gt;
        ...
    &lt;/set&gt;
&lt;/class&gt;</PRE>
<P>&#22914;&#26524;&#25972;&#20010;&#30340;<TT class=literal>batch-size</TT>&#26159;3&#65288;&#31508;&#35823;&#65311;&#65289;&#65292;&#37027;&#20040;Hibernate&#23558;&#20250;&#20998;&#22235;&#27425;&#25191;&#34892;<TT 
class=literal>SELECT</TT>&#26597;&#35810;&#65292; &#25353;&#29031;3&#12289;3&#12289;3&#12289;1&#30340;&#22823;&#23567;&#20998;&#21035;&#36733;&#20837;&#25968;&#25454;&#12290;&#36825;&#37324;&#30340;&#27599;&#27425;&#36733;&#20837;&#30340;&#25968;&#25454;&#37327;&#36824;&#20855;&#20307;&#20381;&#36182;&#20110;&#24403;&#21069;<TT 
class=literal>Session</TT>&#20013;&#26410;&#23454;&#20363;&#21270;&#38598;&#21512;&#30340;&#20010;&#25968;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#30340;&#27169;&#22411;&#20013;&#26377;&#23884;&#22871;&#30340;&#26641;&#29366;&#32467;&#26500;&#65292;&#20363;&#22914;&#20856;&#22411;&#30340;&#24080;&#21333;&#65293;&#21407;&#26009;&#32467;&#26500;&#65288;bill-of-materials pattern&#65289;&#65292;&#38598;&#21512;&#30340;&#25209;&#37327;&#25235;&#21462;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290; 
&#65288;&#23613;&#31649;&#22312;&#26356;&#22810;&#24773;&#20917;&#19979;&#23545;&#26641;&#36827;&#34892;&#35835;&#21462;&#26102;&#65292;<SPAN class=emphasis><EM>&#23884;&#22871;&#38598;&#21512;&#65288;nested set&#65289;</EM></SPAN>&#25110;<SPAN 
class=emphasis><EM>&#21407;&#26009;&#36335;&#24452;(materialized path)</EM></SPAN>&#65288;××&#65289; &#26159;&#26356;&#22909;&#30340;&#35299;&#20915;&#26041;&#27861;&#12290;&#65289; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-fetching-subselect></A>19.1.6.&nbsp;&#20351;&#29992;&#23376;&#26597;&#35810;&#25235;&#21462;&#65288;Using subselect 
fetching&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20551;&#33509;&#19968;&#20010;&#24310;&#36831;&#38598;&#21512;&#25110;&#21333;&#20540;&#20195;&#29702;&#38656;&#35201;&#25235;&#21462;&#65292;Hibernate&#20250;&#20351;&#29992;&#19968;&#20010;subselect&#37325;&#26032;&#36816;&#34892;&#21407;&#26469;&#30340;&#26597;&#35810;&#65292;&#19968;&#27425;&#24615;&#35835;&#20837;&#25152;&#26377;&#30340;&#23454;&#20363;&#12290;&#36825;&#21644;&#25209;&#37327;&#25235;&#21462;&#30340;&#23454;&#29616;&#26041;&#27861;&#26159;&#19968;&#26679;&#30340;&#65292;&#19981;&#20250;&#26377;&#30772;&#30862;&#30340;&#21152;&#36733;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-fetching-lazyproperties></A>19.1.7.&nbsp;&#20351;&#29992;&#24310;&#36831;&#23646;&#24615;&#25235;&#21462;&#65288;Using lazy 
property fetching&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate3&#23545;&#21333;&#29420;&#30340;&#23646;&#24615;&#25903;&#25345;&#24310;&#36831;&#25235;&#21462;&#65292;&#36825;&#39033;&#20248;&#21270;&#25216;&#26415;&#20063;&#34987;&#31216;&#20026;<SPAN class=emphasis><EM>&#32452;&#25235;&#21462;&#65288;fetch 
groups&#65289;</EM></SPAN>&#12290; 
&#35831;&#27880;&#24847;&#65292;&#35813;&#25216;&#26415;&#26356;&#22810;&#30340;&#23646;&#20110;&#24066;&#22330;&#29305;&#24615;&#12290;&#22312;&#23454;&#38469;&#24212;&#29992;&#20013;&#65292;&#20248;&#21270;&#34892;&#35835;&#21462;&#27604;&#20248;&#21270;&#21015;&#35835;&#21462;&#26356;&#37325;&#35201;&#12290;&#20294;&#26159;&#65292;&#20165;&#36733;&#20837;&#31867;&#30340;&#37096;&#20998;&#23646;&#24615;&#22312;&#26576;&#20123;&#29305;&#23450;&#24773;&#20917;&#19979;&#20250;&#26377;&#29992;&#65292;&#20363;&#22914;&#22312;&#21407;&#26377;&#34920;&#20013;&#25317;&#26377;&#20960;&#30334;&#21015;&#25968;&#25454;&#12289;&#25968;&#25454;&#27169;&#22411;&#26080;&#27861;&#25913;&#21160;&#30340;&#24773;&#20917;&#19979;&#12290; 
</P>
<P>&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#23545;&#29305;&#23450;&#30340;&#23646;&#24615;&#35774;&#32622;<TT class=literal>lazy</TT>&#65292;&#23450;&#20041;&#35813;&#23646;&#24615;&#20026;&#24310;&#36831;&#36733;&#20837;&#12290; </P><PRE class=programlisting>&lt;class name="Document"&gt;
       &lt;id name="id"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="name" not-null="true" length="50"/&gt;
    &lt;property name="summary" not-null="true" length="200" lazy="true"/&gt;
    &lt;property name="text" not-null="true" length="2000" lazy="true"/&gt;
&lt;/class&gt;</PRE>
<P>&#23646;&#24615;&#30340;&#24310;&#36831;&#36733;&#20837;&#35201;&#27714;&#22312;&#20854;&#20195;&#30721;&#26500;&#24314;&#26102;&#21152;&#20837;&#20108;&#36827;&#21046;&#25351;&#31034;&#25351;&#20196;&#65288;bytecode instrumentation&#65289;&#65292;&#22914;&#26524;&#20320;&#30340;&#25345;&#20037;&#31867;&#20195;&#30721;&#20013;&#26410;&#21547;&#26377;&#36825;&#20123;&#25351;&#20196;&#65292; 
Hibernate&#23558;&#20250;&#24573;&#30053;&#36825;&#20123;&#23646;&#24615;&#30340;&#24310;&#36831;&#35774;&#32622;&#65292;&#20173;&#28982;&#23558;&#20854;&#30452;&#25509;&#36733;&#20837;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#22312;Ant&#30340;Task&#20013;&#65292;&#36827;&#34892;&#22914;&#19979;&#23450;&#20041;&#65292;&#23545;&#25345;&#20037;&#31867;&#20195;&#30721;&#21152;&#20837;“&#20108;&#36827;&#21046;&#25351;&#20196;&#12290;” </P><PRE class=programlisting>&lt;target name="instrument" depends="compile"&gt;
    &lt;taskdef name="instrument" classname="org.hibernate.tool.instrument.InstrumentTask"&gt;
        &lt;classpath path="${jar.path}"/&gt;
        &lt;classpath path="${classes.dir}"/&gt;
        &lt;classpath refid="lib.class.path"/&gt;
    &lt;/taskdef&gt;

    &lt;instrument verbose="true"&gt;
        &lt;fileset dir="${testclasses.dir}/org/hibernate/auction/model"&gt;
            &lt;include name="*.class"/&gt;
        &lt;/fileset&gt;
    &lt;/instrument&gt;
&lt;/target&gt;</PRE>
<P>&#36824;&#26377;&#19968;&#31181;&#21487;&#20197;&#20248;&#21270;&#30340;&#26041;&#27861;&#65292;&#23427;&#20351;&#29992;HQL&#25110;&#26465;&#20214;&#26597;&#35810;&#30340;&#25237;&#24433;&#65288;projection&#65289;&#29305;&#24615;&#65292;&#21487;&#20197;&#36991;&#20813;&#35835;&#21462;&#38750;&#24517;&#35201;&#30340;&#21015;&#65292; 
&#36825;&#19968;&#28857;&#33267;&#23569;&#23545;&#21482;&#35835;&#20107;&#21153;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;&#23427;&#26080;&#38656;&#22312;&#20195;&#30721;&#26500;&#24314;&#26102;“&#20108;&#36827;&#21046;&#25351;&#20196;”&#22788;&#29702;&#65292;&#22240;&#27492;&#26159;&#19968;&#20010;&#26356;&#21152;&#20540;&#24471;&#36873;&#25321;&#30340;&#35299;&#20915;&#26041;&#27861;&#12290; </P>
<P>&#26377;&#26102;&#20320;&#38656;&#35201;&#22312;HQL&#20013;&#36890;&#36807;<TT class=literal>&#25235;&#21462;&#25152;&#26377;&#23646;&#24615;</TT>&#65292;&#24378;&#34892;&#25235;&#21462;&#25152;&#26377;&#20869;&#23481;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=performance-cache></A>19.2.&nbsp;&#20108;&#32423;&#32531;&#23384;&#65288;The Second Level Cache&#65289; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#30340;<TT class=literal>Session</TT>&#22312;&#20107;&#21153;&#32423;&#21035;&#36827;&#34892;&#25345;&#20037;&#21270;&#25968;&#25454;&#30340;&#32531;&#23384;&#25805;&#20316;&#12290; 
&#24403;&#28982;&#65292;&#20063;&#26377;&#21487;&#33021;&#20998;&#21035;&#20026;&#27599;&#20010;&#31867;&#65288;&#25110;&#38598;&#21512;)&#65292;&#37197;&#32622;&#38598;&#32676;&#12289;&#25110;JVM&#32423;&#21035;(<TT class=literal>SessionFactory&#32423;&#21035;</TT>)&#30340;&#32531;&#23384;&#12290; 
&#20320;&#29978;&#33267;&#21487;&#20197;&#20026;&#20043;&#25554;&#20837;&#19968;&#20010;&#38598;&#32676;&#30340;&#32531;&#23384;&#12290;&#27880;&#24847;&#65292;&#32531;&#23384;&#27704;&#36828;&#19981;&#30693;&#36947;&#20854;&#20182;&#24212;&#29992;&#31243;&#24207;&#23545;&#25345;&#20037;&#21270;&#20179;&#24211;&#65288;&#25968;&#25454;&#24211;&#65289;&#21487;&#33021;&#36827;&#34892;&#30340;&#20462;&#25913; &#65288;&#21363;&#20351;&#21487;&#20197;&#23558;&#32531;&#23384;&#25968;&#25454;&#35774;&#23450;&#20026;&#23450;&#26399;&#22833;&#25928;&#65289;&#12290; </P>
<P>&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Hibernate&#20351;&#29992;EHCache&#36827;&#34892;JVM&#32423;&#21035;&#30340;&#32531;&#23384;&#65288;&#30446;&#21069;&#65292;Hibernate&#24050;&#32463;&#24223;&#24323;&#20102;&#23545;JCS&#30340;&#25903;&#25345;&#65292;&#26410;&#26469;&#29256;&#26412;&#20013;&#23558;&#20250;&#21435;&#25481;&#23427;&#65289;&#12290; 
&#20320;&#21487;&#20197;&#36890;&#36807;&#35774;&#32622;<TT class=literal>hibernate.cache.provider_class</TT>&#23646;&#24615;&#65292;&#25351;&#23450;&#20854;&#20182;&#30340;&#32531;&#23384;&#31574;&#30053;&#65292; 
&#35813;&#32531;&#23384;&#31574;&#30053;&#24517;&#39035;&#23454;&#29616;<TT class=literal>org.hibernate.cache.CacheProvider</TT>&#25509;&#21475;&#12290; </P>
<DIV class=table><A name=cacheproviders></A>
<P class=title><B>&#34920;&nbsp;19.1.&nbsp; &#32531;&#23384;&#31574;&#30053;&#25552;&#20379;&#21830;&#65288;Cache Providers&#65289; </B></P>
<TABLE summary="&#10;&#9;&#9;&#9;&#9;&#32531;&#23384;&#31574;&#30053;&#25552;&#20379;&#21830;&#65288;Cache Providers&#65289;&#10;&#9;&#9;&#9;" 
border=1>
  <COLGROUP>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left></COLGROUP>
  <THEAD>
  <TR>
    <TH align=left>Cache</TH>
    <TH align=left>Provider class</TH>
    <TH align=left>Type</TH>
    <TH align=left>Cluster Safe</TH>
    <TH align=left>Query Cache Supported</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD align=left>Hashtable (not intended for production use)</TD>
    <TD align=left><TT 
      class=literal>org.hibernate.cache.HashtableCacheProvider</TT></TD>
    <TD align=left>memory</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>yes</TD></TR>
  <TR>
    <TD align=left>EHCache</TD>
    <TD align=left><TT 
    class=literal>org.hibernate.cache.EhCacheProvider</TT></TD>
    <TD align=left>memory, disk</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>yes</TD></TR>
  <TR>
    <TD align=left>OSCache</TD>
    <TD align=left><TT 
    class=literal>org.hibernate.cache.OSCacheProvider</TT></TD>
    <TD align=left>memory, disk</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>yes</TD></TR>
  <TR>
    <TD align=left>SwarmCache</TD>
    <TD align=left><TT 
      class=literal>org.hibernate.cache.SwarmCacheProvider</TT></TD>
    <TD align=left>clustered (ip multicast)</TD>
    <TD align=left>yes (clustered invalidation)</TD>
    <TD align=left>&nbsp;</TD></TR>
  <TR>
    <TD align=left>JBoss TreeCache</TD>
    <TD align=left><TT 
    class=literal>org.hibernate.cache.TreeCacheProvider</TT></TD>
    <TD align=left>clustered (ip multicast), transactional</TD>
    <TD align=left>yes (replication)</TD>
    <TD align=left>yes (clock sync req.)</TD></TR></TBODY></TABLE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-cache-mapping></A>19.2.1.&nbsp;&#32531;&#23384;&#26144;&#23556;&#65288;Cache 
mappings&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#31867;&#25110;&#32773;&#38598;&#21512;&#26144;&#23556;&#30340;“<TT class=literal>&lt;cache&gt;</TT>&#20803;&#32032;”&#21487;&#20197;&#26377;&#19979;&#21015;&#24418;&#24335;&#65306; </P>
<DIV class=programlistingco><PRE class=programlisting>&lt;cache 
    usage="transactional|read-write|nonstrict-read-write|read-only"  <SPAN class=co>(1)</SPAN>
    region="RegionName"                                              <SPAN class=co>(2)</SPAN>
    include="all|non-lazy"                                           <SPAN class=co>(3)</SPAN>
/&gt;</PRE>
<DIV class=calloutlist>
<TABLE summary="Callout list" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top width="5%" align=left>(1)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>usage</TT>(&#24517;&#39035;)&#35828;&#26126;&#20102;&#32531;&#23384;&#30340;&#31574;&#30053;: <TT 
      class=literal>transactional</TT>&#12289; <TT class=literal>read-write</TT>&#12289; <TT 
      class=literal>nonstrict-read-write</TT>&#25110; <TT class=literal>read-only</TT>&#12290; 
      </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(2)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>region</TT> (&#21487;&#36873;, &#40664;&#35748;&#20026;&#31867;&#25110;&#32773;&#38598;&#21512;&#30340;&#21517;&#23383;(class or collection role 
      name)) &#25351;&#23450;&#31532;&#20108;&#32423;&#32531;&#23384;&#30340;&#21306;&#22495;&#21517;(name of the second level cache region) </P></TD></TR>
  <TR>
    <TD vAlign=top width="5%" align=left>(3)</TD>
    <TD vAlign=top align=left>
      <P><TT class=literal>include</TT> (&#21487;&#36873;,&#40664;&#35748;&#20026; <TT class=literal>all</TT>) <TT 
      class=literal>non-lazy</TT> &#24403;&#23646;&#24615;&#32423;&#24310;&#36831;&#25235;&#21462;&#25171;&#24320;&#26102;, &#26631;&#35760;&#20026;<TT 
      class=literal>lazy="true"</TT>&#30340;&#23454;&#20307;&#30340;&#23646;&#24615;&#21487;&#33021;&#26080;&#27861;&#34987;&#32531;&#23384; 
</P></TD></TR></TBODY></TABLE></DIV></DIV>
<P>&#21478;&#22806;(&#39318;&#36873;?), &#20320;&#21487;&#20197;&#22312;hibernate.cfg.xml&#20013;&#25351;&#23450;<TT class=literal>&lt;class-cache&gt;</TT>&#21644; 
<TT class=literal>&lt;collection-cache&gt;</TT> &#20803;&#32032;&#12290; </P>
<P>&#36825;&#37324;&#30340;<TT class=literal>usage</TT> &#23646;&#24615;&#25351;&#26126;&#20102;<SPAN class=emphasis><EM>&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#65288;cache 
concurrency strategy&#65289;</EM></SPAN>&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-cache-readonly></A>19.2.2.&nbsp;&#31574;&#30053;&#65306;&#21482;&#35835;&#32531;&#23384;&#65288;Strategy: read only&#65289; 
</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#21482;&#38656;&#35835;&#21462;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#65292;&#32780;&#26080;&#38656;&#23545;&#20854;&#20462;&#25913;&#65292; &#37027;&#20040;&#23601;&#21487;&#20197;&#23545;&#20854;&#36827;&#34892;<TT class=literal>&#21482;&#35835;</TT> 
&#32531;&#23384;&#12290;&#36825;&#26159;&#26368;&#31616;&#21333;&#65292;&#20063;&#26159;&#23454;&#29992;&#24615;&#26368;&#22909;&#30340;&#26041;&#27861;&#12290;&#29978;&#33267;&#22312;&#38598;&#32676;&#20013;&#65292;&#23427;&#20063;&#33021;&#23436;&#32654;&#22320;&#36816;&#20316;&#12290; </P><PRE class=programlisting>&lt;class name="eg.Immutable" mutable="false"&gt;
    &lt;cache usage="read-only"/&gt;
    ....
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-cache-readwrite></A>19.2.3.&nbsp; 
&#31574;&#30053;:&#35835;/&#20889;&#32531;&#23384;&#65288;Strategy: read/write&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65292;&#37027;&#20040;&#20351;&#29992;<TT class=literal>&#35835;/&#20889;&#32531;&#23384;</TT> &#27604;&#36739;&#21512;&#36866;&#12290; 
&#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#35201;&#27714;“&#24207;&#21015;&#21270;&#20107;&#21153;”&#30340;&#38548;&#31163;&#32423;&#21035;&#65288;serializable transaction isolation level&#65289;&#65292;&#37027;&#20040;&#23601;&#20915;&#19981;&#33021;&#20351;&#29992;&#36825;&#31181;&#32531;&#23384;&#31574;&#30053;&#12290; 
&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<TT 
class=literal>hibernate.transaction.manager_lookup_class</TT>&#23646;&#24615;&#30340;&#20540;&#65292; 
&#36890;&#36807;&#23427;&#65292;Hibernate&#25165;&#33021;&#30693;&#36947;&#35813;&#24212;&#29992;&#31243;&#24207;&#20013;JTA&#30340;<TT class=literal>TransactionManager</TT>&#30340;&#20855;&#20307;&#31574;&#30053;&#12290; 
&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#20445;&#35777;&#22312;<TT class=literal>Session.close()</TT>&#12289;&#25110;<TT 
class=literal>Session.disconnect()</TT>&#35843;&#29992;&#21069;&#65292; &#25972;&#20010;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#12290; 
&#22914;&#26524;&#20320;&#24819;&#22312;&#38598;&#32676;&#29615;&#22659;&#20013;&#20351;&#29992;&#27492;&#31574;&#30053;&#65292;&#20320;&#24517;&#39035;&#20445;&#35777;&#24213;&#23618;&#30340;&#32531;&#23384;&#23454;&#29616;&#25903;&#25345;&#38145;&#23450;(locking)&#12290;Hibernate&#20869;&#32622;&#30340;&#32531;&#23384;&#31574;&#30053;&#24182;&#19981;&#25903;&#25345;&#38145;&#23450;&#21151;&#33021;&#12290; </P><PRE class=programlisting>&lt;class name="eg.Cat" .... &gt;
    &lt;cache usage="read-write"/&gt;
    ....
    &lt;set name="kittens" ... &gt;
        &lt;cache usage="read-write"/&gt;
        ....
    &lt;/set&gt;
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-cache-nonstrict></A>19.2.4.&nbsp; 
&#31574;&#30053;:&#38750;&#20005;&#26684;&#35835;/&#20889;&#32531;&#23384;&#65288;Strategy: nonstrict read/write&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#21482;&#20598;&#23572;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#20004;&#20010;&#20107;&#21153;&#21516;&#26102;&#26356;&#26032;&#21516;&#19968;&#35760;&#24405;&#30340;&#24773;&#20917;&#24456;&#19981;&#24120;&#35265;&#65289;&#65292;&#20063;&#19981;&#38656;&#35201;&#21313;&#20998;&#20005;&#26684;&#30340;&#20107;&#21153;&#38548;&#31163;&#65292; &#37027;&#20040;&#27604;&#36739;&#36866;&#21512;&#20351;&#29992;<TT 
class=literal>&#38750;&#20005;&#26684;&#35835;/&#20889;&#32531;&#23384;</TT>&#31574;&#30053;&#12290;&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#35813;&#31574;&#30053;&#65292; &#20320;&#24517;&#39035;&#20026;&#20854;&#25351;&#23450;<TT 
class=literal>hibernate.transaction.manager_lookup_class</TT>&#23646;&#24615;&#30340;&#20540;&#65292; 
&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#20445;&#35777;&#22312;<TT class=literal>Session.close()</TT>&#12289;&#25110;<TT 
class=literal>Session.disconnect()</TT>&#35843;&#29992;&#21069;&#65292; &#25972;&#20010;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-cache-transactional></A>19.2.5.&nbsp; 
&#31574;&#30053;:&#20107;&#21153;&#32531;&#23384;&#65288;transactional&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#30340;<TT class=literal>&#20107;&#21153;&#32531;&#23384;</TT>&#31574;&#30053;&#25552;&#20379;&#20102;&#20840;&#20107;&#21153;&#30340;&#32531;&#23384;&#25903;&#25345;&#65292; &#20363;&#22914;&#23545;JBoss 
TreeCache&#30340;&#25903;&#25345;&#12290;&#36825;&#26679;&#30340;&#32531;&#23384;&#21482;&#33021;&#29992;&#20110;JTA&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450; &#20026;&#20854;<TT 
class=literal>hibernate.transaction.manager_lookup_class</TT>&#23646;&#24615;&#12290; </P></DIV>
<P>&#27809;&#26377;&#19968;&#31181;&#32531;&#23384;&#25552;&#20379;&#21830;&#33021;&#22815;&#25903;&#25345;&#19978;&#21015;&#30340;&#25152;&#26377;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#12290;&#19979;&#34920;&#20013;&#21015;&#20986;&#20102;&#21508;&#31181;&#25552;&#20379;&#22120;&#12289;&#21450;&#20854;&#21508;&#33258;&#36866;&#29992;&#30340;&#24182;&#21457;&#31574;&#30053;&#12290; </P>
<DIV class=table><A name=d0e14570></A>
<P class=title><B>&#34920;&nbsp;19.2.&nbsp; &#21508;&#31181;&#32531;&#23384;&#25552;&#20379;&#21830;&#23545;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#30340;&#25903;&#25345;&#24773;&#20917;&#65288;Cache Concurrency 
Strategy Support&#65289; </B></P>
<TABLE 
summary="&#10;&#9;&#9;&#9;&#21508;&#31181;&#32531;&#23384;&#25552;&#20379;&#21830;&#23545;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#30340;&#25903;&#25345;&#24773;&#20917;&#65288;Cache Concurrency Strategy Support&#65289;&#10;&#9;&#9;&#9;" 
border=1>
  <COLGROUP>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left>
  <COL align=left></COLGROUP>
  <THEAD>
  <TR>
    <TH align=left>Cache</TH>
    <TH align=left>read-only</TH>
    <TH align=left>nonstrict-read-write</TH>
    <TH align=left>read-write</TH>
    <TH align=left>transactional</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD align=left>Hashtable (not intended for production use)</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>&nbsp;</TD></TR>
  <TR>
    <TD align=left>EHCache</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>&nbsp;</TD></TR>
  <TR>
    <TD align=left>OSCache</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>&nbsp;</TD></TR>
  <TR>
    <TD align=left>SwarmCache</TD>
    <TD align=left>yes</TD>
    <TD align=left>yes</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>&nbsp;</TD></TR>
  <TR>
    <TD align=left>JBoss TreeCache</TD>
    <TD align=left>yes</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>&nbsp;</TD>
    <TD align=left>yes</TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=performance-sessioncache></A>19.3.&nbsp; &#31649;&#29702;&#32531;&#23384;&#65288;Managing the caches&#65289; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26080;&#35770;&#20309;&#26102;&#65292;&#24403;&#20320;&#32473;<TT class=literal>save()</TT>&#12289;<TT class=literal>update()</TT>&#25110; <TT 
class=literal>saveOrUpdate()</TT>&#26041;&#27861;&#20256;&#36882;&#19968;&#20010;&#23545;&#35937;&#26102;&#65292;&#25110;&#20351;&#29992;<TT class=literal>load()</TT>&#12289; <TT 
class=literal>get()</TT>&#12289;<TT class=literal>list()</TT>&#12289;<TT 
class=literal>iterate()</TT> &#25110;<TT class=literal>scroll()</TT>&#26041;&#27861;&#33719;&#24471;&#19968;&#20010;&#23545;&#35937;&#26102;, 
&#35813;&#23545;&#35937;&#37117;&#23558;&#34987;&#21152;&#20837;&#21040;<TT class=literal>Session</TT>&#30340;&#20869;&#37096;&#32531;&#23384;&#20013;&#12290; </P>
<P>&#24403;&#38543;&#21518;flush()&#26041;&#27861;&#34987;&#35843;&#29992;&#26102;&#65292;&#23545;&#35937;&#30340;&#29366;&#24577;&#20250;&#21644;&#25968;&#25454;&#24211;&#21462;&#24471;&#21516;&#27493;&#12290; &#22914;&#26524;&#20320;&#19981;&#24076;&#26395;&#27492;&#21516;&#27493;&#25805;&#20316;&#21457;&#29983;&#65292;&#25110;&#32773;&#20320;&#27491;&#22788;&#29702;&#22823;&#37327;&#23545;&#35937;&#12289;&#38656;&#35201;&#23545;&#26377;&#25928;&#31649;&#29702;&#20869;&#23384;&#26102;&#65292;&#20320;&#21487;&#20197;&#35843;&#29992;<TT 
class=literal>evict()</TT> &#26041;&#27861;&#65292;&#20174;&#19968;&#32423;&#32531;&#23384;&#20013;&#21435;&#25481;&#36825;&#20123;&#23545;&#35937;&#21450;&#20854;&#38598;&#21512;&#12290; </P><PRE class=programlisting>ScrollableResult cats = sess.createQuery("from Cat as cat").scroll(); //a huge result set
while ( cats.next() ) {
    Cat cat = (Cat) cats.get(0);
    doSomethingWithACat(cat);
    sess.evict(cat);
}</PRE>
<P>Session&#36824;&#25552;&#20379;&#20102;&#19968;&#20010;<TT class=literal>contains()</TT>&#26041;&#27861;&#65292;&#29992;&#26469;&#21028;&#26029;&#26576;&#20010;&#23454;&#20363;&#26159;&#21542;&#22788;&#20110;&#24403;&#21069;session&#30340;&#32531;&#23384;&#20013;&#12290; 
</P>
<P>&#22914;&#33509;&#35201;&#25226;&#25152;&#26377;&#30340;&#23545;&#35937;&#20174;session&#32531;&#23384;&#20013;&#24443;&#24213;&#28165;&#38500;&#65292;&#21017;&#38656;&#35201;&#35843;&#29992;<TT class=literal>Session.clear()</TT>&#12290; </P>
<P>&#23545;&#20110;&#20108;&#32423;&#32531;&#23384;&#26469;&#35828;&#65292;&#22312;<TT class=literal>SessionFactory</TT>&#20013;&#23450;&#20041;&#20102;&#35768;&#22810;&#26041;&#27861;&#65292; 
&#28165;&#38500;&#32531;&#23384;&#20013;&#23454;&#20363;&#12289;&#25972;&#20010;&#31867;&#12289;&#38598;&#21512;&#23454;&#20363;&#25110;&#32773;&#25972;&#20010;&#38598;&#21512;&#12290; </P><PRE class=programlisting>sessionFactory.evict(Cat.class, catId); //evict a particular Cat
sessionFactory.evict(Cat.class);  //evict all Cats
sessionFactory.evictCollection("Cat.kittens", catId); //evict a particular collection of kittens
sessionFactory.evictCollection("Cat.kittens"); //evict all kitten collections</PRE>
<P><TT class=literal>CacheMode</TT>&#21442;&#25968;&#29992;&#20110;&#25511;&#21046;&#20855;&#20307;&#30340;Session&#22914;&#20309;&#19982;&#20108;&#32423;&#32531;&#23384;&#36827;&#34892;&#20132;&#20114;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><TT class=literal>CacheMode.NORMAL</TT> - &#20174;&#20108;&#32423;&#32531;&#23384;&#20013;&#35835;&#12289;&#20889;&#25968;&#25454;&#12290; </P>
  <LI>
  <P><TT class=literal>CacheMode.GET</TT> - &#20174;&#20108;&#32423;&#32531;&#23384;&#20013;&#35835;&#21462;&#25968;&#25454;&#65292;&#20165;&#22312;&#25968;&#25454;&#26356;&#26032;&#26102;&#23545;&#20108;&#32423;&#32531;&#23384;&#20889;&#25968;&#25454;&#12290; </P>
  <LI>
  <P><TT class=literal>CacheMode.PUT</TT> - &#20165;&#21521;&#20108;&#32423;&#32531;&#23384;&#20889;&#25968;&#25454;&#65292;&#20294;&#19981;&#20174;&#20108;&#32423;&#32531;&#23384;&#20013;&#35835;&#25968;&#25454;&#12290; </P>
  <LI>
  <P><TT class=literal>CacheMode.REFRESH</TT> - &#20165;&#21521;&#20108;&#32423;&#32531;&#23384;&#20889;&#25968;&#25454;&#65292;&#20294;&#19981;&#20174;&#20108;&#32423;&#32531;&#23384;&#20013;&#35835;&#25968;&#25454;&#12290;&#36890;&#36807; <TT 
  class=literal>hibernate.cache.use_minimal_puts</TT>&#30340;&#35774;&#32622;&#65292;&#24378;&#21046;&#20108;&#32423;&#32531;&#23384;&#20174;&#25968;&#25454;&#24211;&#20013;&#35835;&#21462;&#25968;&#25454;&#65292;&#21047;&#26032;&#32531;&#23384;&#20869;&#23481;&#12290; 
  </P></LI></UL></DIV>
<P>&#22914;&#33509;&#38656;&#35201;&#26597;&#30475;&#20108;&#32423;&#32531;&#23384;&#25110;&#26597;&#35810;&#32531;&#23384;&#21306;&#22495;&#30340;&#20869;&#23481;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<TT class=literal>&#32479;&#35745;&#65288;Statistics&#65289;</TT> API&#12290; </P><PRE class=programlisting>Map cacheEntries = sessionFactory.getStatistics()
        .getSecondLevelCacheStatistics(regionName)
        .getEntries();</PRE>
<P>&#27492;&#26102;&#65292;&#20320;&#24517;&#39035;&#25163;&#24037;&#25171;&#24320;&#32479;&#35745;&#36873;&#39033;&#12290;&#21487;&#36873;&#30340;&#65292;&#20320;&#21487;&#20197;&#35753;Hibernate&#26356;&#20154;&#24037;&#21487;&#35835;&#30340;&#26041;&#24335;&#32500;&#25252;&#32531;&#23384;&#20869;&#23481;&#12290; </P><PRE class=programlisting>hibernate.generate_statistics true
hibernate.cache.use_structured_entries true</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=performance-querycache></A>19.4.&nbsp;&#26597;&#35810;&#32531;&#23384;&#65288;The Query Cache&#65289; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26597;&#35810;&#30340;&#32467;&#26524;&#38598;&#20063;&#21487;&#20197;&#34987;&#32531;&#23384;&#12290;&#21482;&#26377;&#24403;&#32463;&#24120;&#20351;&#29992;&#21516;&#26679;&#30340;&#21442;&#25968;&#36827;&#34892;&#26597;&#35810;&#26102;&#65292;&#36825;&#25165;&#20250;&#26377;&#20123;&#29992;&#22788;&#12290; &#35201;&#20351;&#29992;&#26597;&#35810;&#32531;&#23384;&#65292;&#39318;&#20808;&#20320;&#24517;&#39035;&#25171;&#24320;&#23427;&#65306; </P><PRE class=programlisting>hibernate.cache.use_query_cache true</PRE>
<P>&#35813;&#35774;&#32622;&#23558;&#20250;&#21019;&#24314;&#20004;&#20010;&#32531;&#23384;&#21306;&#22495; - &#19968;&#20010;&#29992;&#20110;&#20445;&#23384;&#26597;&#35810;&#32467;&#26524;&#38598;(<TT 
class=literal>org.hibernate.cache.StandardQueryCache</TT>)&#65307; 
&#21478;&#19968;&#20010;&#21017;&#29992;&#20110;&#20445;&#23384;&#26368;&#36817;&#26597;&#35810;&#30340;&#19968;&#31995;&#21015;&#34920;&#30340;&#26102;&#38388;&#25139;(<TT 
class=literal>org.hibernate.cache.UpdateTimestampsCache</TT>)&#12290; 
&#35831;&#27880;&#24847;&#65306;&#22312;&#26597;&#35810;&#32531;&#23384;&#20013;&#65292;&#23427;&#24182;&#19981;&#32531;&#23384;&#32467;&#26524;&#38598;&#20013;&#25152;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#30830;&#20999;&#29366;&#24577;&#65307;&#23427;&#21482;&#32531;&#23384;&#36825;&#20123;&#23454;&#20307;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#20540;&#12289;&#20197;&#21450;&#21508;&#20540;&#31867;&#22411;&#30340;&#32467;&#26524;&#12290; &#25152;&#20197;&#26597;&#35810;&#32531;&#23384;&#36890;&#24120;&#20250;&#21644;&#20108;&#32423;&#32531;&#23384;&#19968;&#36215;&#20351;&#29992;&#12290; 
</P>
<P>&#32477;&#22823;&#22810;&#25968;&#30340;&#26597;&#35810;&#24182;&#19981;&#33021;&#20174;&#26597;&#35810;&#32531;&#23384;&#20013;&#21463;&#30410;&#65292;&#25152;&#20197;Hibernate&#40664;&#35748;&#26159;&#19981;&#36827;&#34892;&#26597;&#35810;&#32531;&#23384;&#30340;&#12290;&#22914;&#33509;&#38656;&#35201;&#36827;&#34892;&#32531;&#23384;&#65292;&#35831;&#35843;&#29992; <TT 
class=literal>Query.setCacheable(true)</TT>&#26041;&#27861;&#12290;&#36825;&#20010;&#35843;&#29992;&#20250;&#35753;&#26597;&#35810;&#22312;&#25191;&#34892;&#36807;&#31243;&#20013;&#26102;&#20808;&#20174;&#32531;&#23384;&#20013;&#26597;&#25214;&#32467;&#26524;&#65292; 
&#24182;&#23558;&#33258;&#24049;&#30340;&#32467;&#26524;&#38598;&#25918;&#21040;&#32531;&#23384;&#20013;&#21435;&#12290; </P>
<P>&#22914;&#26524;&#20320;&#35201;&#23545;&#26597;&#35810;&#32531;&#23384;&#30340;&#22833;&#25928;&#25919;&#31574;&#36827;&#34892;&#31934;&#30830;&#30340;&#25511;&#21046;&#65292;&#20320;&#24517;&#39035;&#35843;&#29992;<TT class=literal>Query.setCacheRegion()</TT>&#26041;&#27861;&#65292; 
&#20026;&#27599;&#20010;&#26597;&#35810;&#25351;&#23450;&#20854;&#21629;&#21517;&#30340;&#32531;&#23384;&#21306;&#22495;&#12290; </P><PRE class=programlisting>List blogs = sess.createQuery("from Blog blog where blog.blogger = :blogger")
    .setEntity("blogger", blogger)
    .setMaxResults(15)
    .setCacheable(true)
    .setCacheRegion("frontpages")
    .list();</PRE>
<P>&#22914;&#26524;&#26597;&#35810;&#38656;&#35201;&#24378;&#34892;&#21047;&#26032;&#20854;&#26597;&#35810;&#32531;&#23384;&#21306;&#22495;&#65292;&#37027;&#20040;&#20320;&#24212;&#35813;&#35843;&#29992;<TT 
class=literal>Query.setCacheMode(CacheMode.REFRESH)</TT>&#26041;&#27861;&#12290; 
&#36825;&#23545;&#22312;&#20854;&#20182;&#36827;&#31243;&#20013;&#20462;&#25913;&#24213;&#23618;&#25968;&#25454;&#65288;&#20363;&#22914;&#65292;&#19981;&#36890;&#36807;Hibernate&#20462;&#25913;&#25968;&#25454;&#65289;&#65292;&#25110;&#23545;&#37027;&#20123;&#38656;&#35201;&#36873;&#25321;&#24615;&#26356;&#26032;&#29305;&#23450;&#26597;&#35810;&#32467;&#26524;&#38598;&#30340;&#24773;&#20917;&#29305;&#21035;&#26377;&#29992;&#12290; &#36825;&#26159;&#23545;<TT 
class=literal>SessionFactory.evictQueries()</TT>&#30340;&#26356;&#20026;&#26377;&#25928;&#30340;&#26367;&#20195;&#26041;&#26696;&#65292;&#21516;&#26679;&#21487;&#20197;&#28165;&#38500;&#26597;&#35810;&#32531;&#23384;&#21306;&#22495;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=performance-collections></A>19.5.&nbsp; &#29702;&#35299;&#38598;&#21512;&#24615;&#33021;&#65288;Understanding Collection 
performance&#65289; </H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21069;&#38754;&#25105;&#20204;&#24050;&#32463;&#23545;&#38598;&#21512;&#36827;&#34892;&#20102;&#36275;&#22815;&#30340;&#35752;&#35770;&#12290;&#26412;&#27573;&#20013;&#65292;&#25105;&#20204;&#23558;&#30528;&#37325;&#35762;&#36848;&#38598;&#21512;&#22312;&#36816;&#34892;&#26102;&#30340;&#20107;&#23452;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-collections-taxonomy></A>19.5.1.&nbsp; 
&#20998;&#31867;&#65288;Taxonomy&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#23450;&#20041;&#20102;&#19977;&#31181;&#22522;&#26412;&#31867;&#22411;&#30340;&#38598;&#21512;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#20540;&#25968;&#25454;&#38598;&#21512; </P>
  <LI>
  <P>&#19968;&#23545;&#22810;&#20851;&#32852; </P>
  <LI>
  <P>&#22810;&#23545;&#22810;&#20851;&#32852; </P></LI></UL></DIV>
<P>&#36825;&#20010;&#20998;&#31867;&#26159;&#21306;&#20998;&#20102;&#19981;&#21516;&#30340;&#34920;&#21644;&#22806;&#38190;&#20851;&#31995;&#31867;&#22411;&#65292;&#20294;&#26159;&#23427;&#27809;&#26377;&#21578;&#35785;&#25105;&#20204;&#20851;&#31995;&#27169;&#22411;&#30340;&#25152;&#26377;&#20869;&#23481;&#12290; 
&#35201;&#23436;&#20840;&#29702;&#35299;&#20182;&#20204;&#30340;&#20851;&#31995;&#32467;&#26500;&#21644;&#24615;&#33021;&#29305;&#28857;&#65292;&#25105;&#20204;&#24517;&#39035;&#21516;&#26102;&#32771;&#34385;“&#29992;&#20110;Hibernate&#26356;&#26032;&#25110;&#21024;&#38500;&#38598;&#21512;&#34892;&#25968;&#25454;&#30340;&#20027;&#38190;&#30340;&#32467;&#26500;”&#12290; &#22240;&#27492;&#24471;&#21040;&#20102;&#22914;&#19979;&#30340;&#20998;&#31867;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#26377;&#24207;&#38598;&#21512;&#31867; </P>
  <LI>
  <P>&#38598;&#21512;&#65288;sets&#65289; </P>
  <LI>
  <P>&#21253;&#65288;bags) </P></LI></UL></DIV>
<P>&#25152;&#26377;&#30340;&#26377;&#24207;&#38598;&#21512;&#31867;&#65288;maps, lists, arrays)&#37117;&#25317;&#26377;&#19968;&#20010;&#30001;<TT class=literal>&lt;key&gt;</TT>&#21644; <TT 
class=literal>&lt;index&gt;</TT>&#32452;&#25104;&#30340;&#20027;&#38190;&#12290; 
&#36825;&#31181;&#24773;&#20917;&#19979;&#38598;&#21512;&#31867;&#30340;&#26356;&#26032;&#26159;&#38750;&#24120;&#39640;&#25928;&#30340;——&#20027;&#38190;&#24050;&#32463;&#34987;&#26377;&#25928;&#30340;&#32034;&#24341;&#65292;&#22240;&#27492;&#24403;Hibernate&#35797;&#22270;&#26356;&#26032;&#25110;&#21024;&#38500;&#19968;&#34892;&#26102;&#65292;&#21487;&#20197;&#36805;&#36895;&#25214;&#21040;&#35813;&#34892;&#25968;&#25454;&#12290; </P>
<P>&#38598;&#21512;(sets)&#30340;&#20027;&#38190;&#30001;<TT class=literal>&lt;key&gt;</TT>&#21644;&#20854;&#20182;&#20803;&#32032;&#23383;&#27573;&#26500;&#25104;&#12290; 
&#23545;&#20110;&#26377;&#20123;&#20803;&#32032;&#31867;&#22411;&#26469;&#35828;&#65292;&#36825;&#24456;&#20302;&#25928;&#65292;&#29305;&#21035;&#26159;&#32452;&#21512;&#20803;&#32032;&#25110;&#32773;&#22823;&#25991;&#26412;&#12289;&#22823;&#20108;&#36827;&#21046;&#23383;&#27573;&#65307; &#25968;&#25454;&#24211;&#21487;&#33021;&#26080;&#27861;&#26377;&#25928;&#30340;&#23545;&#22797;&#26434;&#30340;&#20027;&#38190;&#36827;&#34892;&#32034;&#24341;&#12290; 
&#21478;&#19968;&#26041;&#38754;&#65292;&#23545;&#20110;&#19968;&#23545;&#22810;&#12289;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#29305;&#21035;&#26159;&#21512;&#25104;&#30340;&#26631;&#35782;&#31526;&#26469;&#35828;&#65292;&#38598;&#21512;&#20063;&#21487;&#20197;&#36798;&#21040;&#21516;&#26679;&#30340;&#39640;&#25928;&#24615;&#33021;&#12290;&#65288; &#38468;&#27880;&#65306;&#22914;&#26524;&#20320;&#24076;&#26395;<TT 
class=literal>SchemaExport</TT>&#20026;&#20320;&#30340;<TT class=literal>&lt;set&gt;</TT>&#21019;&#24314;&#20027;&#38190;&#65292; 
&#20320;&#24517;&#39035;&#25226;&#25152;&#26377;&#30340;&#23383;&#27573;&#37117;&#22768;&#26126;&#20026;<TT class=literal>not-null="true"</TT>&#12290;&#65289; </P>
<P><TT class=literal>&lt;idbag&gt;</TT>&#26144;&#23556;&#23450;&#20041;&#20102;&#20195;&#29702;&#38190;&#65292;&#22240;&#27492;&#23427;&#24635;&#26159;&#21487;&#20197;&#24456;&#39640;&#25928;&#30340;&#34987;&#26356;&#26032;&#12290;&#20107;&#23454;&#19978;&#65292; <TT 
class=literal>&lt;idbag&gt;</TT>&#25317;&#26377;&#30528;&#26368;&#22909;&#30340;&#24615;&#33021;&#34920;&#29616;&#12290; </P>
<P>Bag&#26159;&#26368;&#24046;&#30340;&#12290;&#22240;&#20026;bag&#20801;&#35768;&#37325;&#22797;&#30340;&#20803;&#32032;&#20540;&#65292;&#20063;&#27809;&#26377;&#32034;&#24341;&#23383;&#27573;&#65292;&#22240;&#27492;&#19981;&#21487;&#33021;&#23450;&#20041;&#20027;&#38190;&#12290; 
Hibernate&#26080;&#27861;&#21028;&#26029;&#20986;&#37325;&#22797;&#30340;&#34892;&#12290;&#24403;&#36825;&#31181;&#38598;&#21512;&#34987;&#26356;&#25913;&#26102;&#65292;Hibernate&#23558;&#20250;&#20808;&#23436;&#25972;&#22320;&#31227;&#38500; &#65288;&#36890;&#36807;&#19968;&#20010;(in a single <TT 
class=literal>DELETE</TT>)&#65289;&#25972;&#20010;&#38598;&#21512;&#65292;&#28982;&#21518;&#20877;&#37325;&#26032;&#21019;&#24314;&#25972;&#20010;&#38598;&#21512;&#12290; &#22240;&#27492;Bag&#26159;&#38750;&#24120;&#20302;&#25928;&#30340;&#12290; </P>
<P>&#35831;&#27880;&#24847;&#65306;&#23545;&#20110;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;“&#20027;&#38190;”&#24456;&#21487;&#33021;&#24182;&#19981;&#26159;&#25968;&#25454;&#24211;&#34920;&#30340;&#29289;&#29702;&#20027;&#38190;&#12290; 
&#20294;&#23601;&#31639;&#22312;&#27492;&#24773;&#20917;&#19979;&#65292;&#19978;&#38754;&#30340;&#20998;&#31867;&#20173;&#28982;&#26159;&#26377;&#29992;&#30340;&#12290;&#65288;&#23427;&#20173;&#28982;&#21453;&#26144;&#20102;Hibernate&#22312;&#38598;&#21512;&#30340;&#21508;&#25968;&#25454;&#34892;&#20013;&#26159;&#22914;&#20309;&#36827;&#34892;“&#23450;&#20301;”&#30340;&#12290;&#65289; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-collections-mostefficientupdate></A>19.5.2.&nbsp; Lists, maps 
&#21644;sets&#29992;&#20110;&#26356;&#26032;&#25928;&#29575;&#26368;&#39640; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26681;&#25454;&#25105;&#20204;&#19978;&#38754;&#30340;&#35752;&#35770;&#65292;&#26174;&#28982;&#26377;&#24207;&#38598;&#21512;&#31867;&#22411;&#21644;&#22823;&#22810;&#25968;set&#37117;&#21487;&#20197;&#22312;&#22686;&#21152;&#12289;&#21024;&#38500;&#12289;&#20462;&#25913;&#20803;&#32032;&#20013;&#25317;&#26377;&#26368;&#22909;&#30340;&#24615;&#33021;&#12290; </P>
<P>&#21487;&#35770;&#35777;&#30340;&#26159;&#23545;&#20110;&#22810;&#23545;&#22810;&#20851;&#32852;&#12289;&#20540;&#25968;&#25454;&#38598;&#21512;&#32780;&#35328;&#65292;&#26377;&#24207;&#38598;&#21512;&#31867;&#27604;&#38598;&#21512;(set)&#26377;&#19968;&#20010;&#22909;&#22788;&#12290;&#22240;&#20026;<TT class=literal>Set</TT>&#30340;&#20869;&#22312;&#32467;&#26500;&#65292; 
&#22914;&#26524;“&#25913;&#21464;”&#20102;&#19968;&#20010;&#20803;&#32032;&#65292;Hibernate&#24182;&#19981;&#20250;<TT class=literal>&#26356;&#26032;&#65288;UPDATE&#65289;</TT>&#36825;&#19968;&#34892;&#12290; &#23545;&#20110;<TT 
class=literal>Set</TT>&#26469;&#35828;&#65292;&#21482;&#26377;&#22312;<TT class=literal>&#25554;&#20837;&#65288;INSERT&#65289;</TT>&#21644;<TT 
class=literal>&#21024;&#38500;&#65288;DELETE&#65289;</TT> &#25805;&#20316;&#26102;“&#25913;&#21464;”&#25165;&#26377;&#25928;&#12290;&#20877;&#27425;&#24378;&#35843;&#65306;&#36825;&#27573;&#35752;&#35770;&#23545;“&#19968;&#23545;&#22810;&#20851;&#32852;”&#24182;&#19981;&#36866;&#29992;&#12290; </P>
<P>&#27880;&#24847;&#21040;&#25968;&#32452;&#26080;&#27861;&#24310;&#36831;&#36733;&#20837;&#65292;&#25105;&#20204;&#21487;&#20197;&#24471;&#20986;&#32467;&#35770;&#65292;list, map&#21644;idbags&#26159;&#26368;&#39640;&#25928;&#30340;&#65288;&#38750;&#21453;&#21521;&#65289;&#38598;&#21512;&#31867;&#22411;&#65292;set&#21017;&#32039;&#38543;&#20854;&#21518;&#12290; 
&#22312;Hibernate&#20013;&#65292;set&#24212;&#35813;&#26102;&#26368;&#36890;&#29992;&#30340;&#38598;&#21512;&#31867;&#22411;&#65292;&#36825;&#26102;&#22240;&#20026;“set”&#30340;&#35821;&#20041;&#22312;&#20851;&#31995;&#27169;&#22411;&#20013;&#26159;&#26368;&#33258;&#28982;&#30340;&#12290; </P>
<P>&#20294;&#26159;&#65292;&#22312;&#35774;&#35745;&#33391;&#22909;&#30340;Hibernate&#39046;&#22495;&#27169;&#22411;&#20013;&#65292;&#25105;&#20204;&#36890;&#24120;&#21487;&#20197;&#30475;&#21040;&#26356;&#22810;&#30340;&#38598;&#21512;&#20107;&#23454;&#19978;&#26159;&#24102;&#26377;<TT 
class=literal>inverse="true"</TT> 
&#30340;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#12290;&#23545;&#20110;&#36825;&#20123;&#20851;&#32852;&#65292;&#26356;&#26032;&#25805;&#20316;&#23558;&#20250;&#22312;&#22810;&#23545;&#19968;&#30340;&#36825;&#19968;&#31471;&#36827;&#34892;&#22788;&#29702;&#12290;&#22240;&#27492;&#23545;&#20110;&#27492;&#31867;&#24773;&#20917;&#65292;&#26080;&#38656;&#32771;&#34385;&#20854;&#38598;&#21512;&#30340;&#26356;&#26032;&#24615;&#33021;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=performance-collections-mostefficentinverse></A>19.5.3.&nbsp; 
Bag&#21644;list&#26159;&#21453;&#21521;&#38598;&#21512;&#31867;&#20013;&#25928;&#29575;&#26368;&#39640;&#30340; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#25226;bag&#25172;&#36827;&#27700;&#27807;&#20043;&#21069;&#65292;&#20320;&#24517;&#39035;&#20102;&#35299;&#65292;&#22312;&#19968;&#31181;&#24773;&#20917;&#19979;&#65292;bag&#30340;&#24615;&#33021;(&#21253;&#25324;list)&#35201;&#27604;set&#39640;&#24471;&#22810;&#65306; &#23545;&#20110;&#25351;&#26126;&#20102;<TT 
class=literal>inverse="true"</TT>&#30340;&#38598;&#21512;&#31867;&#65288;&#27604;&#22914;&#35828;&#65292;&#26631;&#20934;&#30340;&#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;&#65289;&#65292; 
&#25105;&#20204;&#21487;&#20197;&#22312;&#26410;&#21021;&#22987;&#21270;(fetch)&#21253;&#20803;&#32032;&#30340;&#24773;&#20917;&#19979;&#30452;&#25509;&#21521;bag&#25110;list&#28155;&#21152;&#26032;&#20803;&#32032;&#65281; &#36825;&#26159;&#22240;&#20026;<TT 
class=literal>Collection.add()</TT>)&#25110;&#32773;<TT class=literal>Collection.addAll()</TT> 
&#26041;&#27861; &#23545;bag&#25110;&#32773;List&#24635;&#26159;&#36820;&#22238;true&#65288;&#36825;&#28857;&#19982;&#19982;Set&#19981;&#21516;&#65289;&#12290;&#22240;&#27492;&#23545;&#20110;&#19979;&#38754;&#30340;&#30456;&#21516;&#20195;&#30721;&#26469;&#35828;&#65292;&#36895;&#24230;&#20250;&#24555;&#24471;&#22810;&#12290; </P><PRE class=programlisting>Parent p = (Parent) sess.load(Parent.class, id);
    Child c = new Child();
    c.setParent(p);
    p.getChildren().add(c);  //no need to fetch the collection!
    sess.flush();</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-collections-oneshotdelete></A>19.5.4.&nbsp; 
&#19968;&#27425;&#24615;&#21024;&#38500;&#65288;One shot delete&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20598;&#23572;&#30340;&#65292;&#36880;&#20010;&#21024;&#38500;&#38598;&#21512;&#31867;&#20013;&#30340;&#20803;&#32032;&#26159;&#30456;&#24403;&#20302;&#25928;&#30340;&#12290;Hibernate&#24182;&#27809;&#37027;&#20040;&#31528;&#65292; 
&#22914;&#26524;&#20320;&#24819;&#35201;&#25226;&#25972;&#20010;&#38598;&#21512;&#37117;&#21024;&#38500;&#65288;&#27604;&#22914;&#35828;&#35843;&#29992;list.clear()&#65289;&#65292;Hibernate&#21482;&#38656;&#35201;&#19968;&#20010;DELETE&#23601;&#25630;&#23450;&#20102;&#12290; </P>
<P>&#20551;&#35774;&#25105;&#20204;&#22312;&#19968;&#20010;&#38271;&#24230;&#20026;20&#30340;&#38598;&#21512;&#31867;&#20013;&#26032;&#22686;&#21152;&#20102;&#19968;&#20010;&#20803;&#32032;&#65292;&#28982;&#21518;&#20877;&#21024;&#38500;&#20004;&#20010;&#12290; Hibernate&#20250;&#23433;&#25490;&#19968;&#26465;<TT 
class=literal>INSERT</TT>&#35821;&#21477;&#21644;&#20004;&#26465;<TT class=literal>DELETE</TT>&#35821;&#21477;&#65288;&#38500;&#38750;&#38598;&#21512;&#31867;&#26159;&#19968;&#20010;bag)&#12290; 
&#36825;&#24403;&#28982;&#26159;&#26174;&#32780;&#26131;&#35265;&#30340;&#12290; </P>
<P>&#20294;&#26159;&#65292;&#20551;&#35774;&#25105;&#20204;&#21024;&#38500;&#20102;18&#20010;&#25968;&#25454;&#65292;&#21482;&#21097;&#19979;2&#20010;&#65292;&#28982;&#21518;&#26032;&#22686;3&#20010;&#12290;&#21017;&#26377;&#20004;&#31181;&#22788;&#29702;&#26041;&#24335;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#36880;&#19968;&#30340;&#21024;&#38500;&#36825;18&#20010;&#25968;&#25454;&#65292;&#20877;&#26032;&#22686;&#19977;&#20010;&#65307; </P>
  <LI>
  <P>&#21024;&#38500;&#25972;&#20010;&#38598;&#21512;&#31867;&#65288;&#21482;&#29992;&#19968;&#21477;DELETE&#35821;&#21477;&#65289;&#65292;&#28982;&#21518;&#22686;&#21152;5&#20010;&#25968;&#25454;&#12290; </P></LI></UL></DIV>
<P>Hibernate&#36824;&#27809;&#37027;&#20040;&#32874;&#26126;&#65292;&#30693;&#36947;&#31532;&#20108;&#31181;&#36873;&#25321;&#21487;&#33021;&#20250;&#27604;&#36739;&#24555;&#12290; 
&#65288;&#20063;&#35768;&#35753;Hibernate&#19981;&#36825;&#20040;&#32874;&#26126;&#20063;&#26159;&#22909;&#20107;&#65292;&#21542;&#21017;&#21487;&#33021;&#20250;&#24341;&#21457;&#24847;&#22806;&#30340;“&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;”&#20043;&#31867;&#30340;&#38382;&#39064;&#12290;&#65289; </P>
<P>&#24184;&#36816;&#30340;&#26159;&#65292;&#20320;&#21487;&#20197;&#24378;&#21046;&#20351;&#29992;&#31532;&#20108;&#31181;&#31574;&#30053;&#12290;&#20320;&#38656;&#35201;&#21462;&#28040;&#21407;&#26469;&#30340;&#25972;&#20010;&#38598;&#21512;&#31867;&#65288;&#35299;&#38500;&#20854;&#24341;&#29992;&#65289;&#65292; 
&#28982;&#21518;&#20877;&#36820;&#22238;&#19968;&#20010;&#26032;&#30340;&#23454;&#20363;&#21270;&#30340;&#38598;&#21512;&#31867;&#65292;&#21482;&#21253;&#21547;&#38656;&#35201;&#30340;&#20803;&#32032;&#12290;&#26377;&#20123;&#26102;&#20505;&#36825;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290; </P>
<P>&#26174;&#28982;&#65292;&#19968;&#27425;&#24615;&#21024;&#38500;&#24182;&#19981;&#36866;&#29992;&#20110;&#34987;&#26144;&#23556;&#20026;<TT class=literal>inverse="true"</TT>&#30340;&#38598;&#21512;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=performance-monitoring></A>19.6.&nbsp; &#30417;&#27979;&#24615;&#33021;&#65288;Monitoring performance&#65289; 
</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#27809;&#26377;&#30417;&#27979;&#21644;&#24615;&#33021;&#21442;&#25968;&#32780;&#36827;&#34892;&#20248;&#21270;&#26159;&#27627;&#26080;&#24847;&#20041;&#30340;&#12290;Hibernate&#20026;&#20854;&#20869;&#37096;&#25805;&#20316;&#25552;&#20379;&#20102;&#19968;&#31995;&#21015;&#30340;&#31034;&#24847;&#22270;&#65292;&#22240;&#27492;&#21487;&#20197;&#20174; &#27599;&#20010;<TT 
class=literal>SessionFactory</TT>&#25235;&#21462;&#20854;&#32479;&#35745;&#25968;&#25454;&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-monitoring-sf></A>19.6.1.&nbsp; 
&#30417;&#27979;SessionFactory </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#26377;&#20004;&#31181;&#26041;&#24335;&#35775;&#38382;<TT class=literal>SessionFactory</TT>&#30340;&#25968;&#25454;&#35760;&#24405;&#65292;&#31532;&#19968;&#31181;&#23601;&#26159;&#33258;&#24049;&#30452;&#25509;&#35843;&#29992; <TT 
class=literal>sessionFactory.getStatistics()</TT>&#26041;&#27861;&#35835;&#21462;&#12289;&#26174;&#31034;<TT 
class=literal>&#32479;&#35745;</TT>&#25968;&#25454;&#12290; </P>
<P>&#27492;&#22806;&#65292;&#22914;&#26524;&#20320;&#25171;&#24320;<TT class=literal>StatisticsService</TT> 
MBean&#36873;&#39033;&#65292;&#37027;&#20040;Hibernate&#21017;&#21487;&#20197;&#20351;&#29992;JMX&#25216;&#26415; &#21457;&#24067;&#20854;&#25968;&#25454;&#35760;&#24405;&#12290;&#20320;&#21487;&#20197;&#35753;&#24212;&#29992;&#20013;&#25152;&#26377;&#30340;<TT 
class=literal>SessionFactory</TT>&#21516;&#26102;&#20849;&#20139;&#19968;&#20010;MBean&#65292;&#20063;&#21487;&#20197;&#27599;&#20010; 
SessionFactory&#20998;&#37197;&#19968;&#20010;MBean&#12290;&#19979;&#38754;&#30340;&#20195;&#30721;&#21363;&#26159;&#20854;&#28436;&#31034;&#20195;&#30721;&#65306; </P><PRE class=programlisting>// MBean service registration for a specific SessionFactory
Hashtable tb = new Hashtable();
tb.put("type", "statistics");
tb.put("sessionFactory", "myFinancialApp");
ObjectName on = new ObjectName("hibernate", tb); // MBean object name

StatisticsService stats = new StatisticsService(); // MBean implementation
stats.setSessionFactory(sessionFactory); // Bind the stats to a SessionFactory
server.registerMBean(stats, on); // Register the Mbean on the server</PRE><PRE class=programlisting>// MBean service registration for all SessionFactory's
Hashtable tb = new Hashtable();
tb.put("type", "statistics");
tb.put("sessionFactory", "all");
ObjectName on = new ObjectName("hibernate", tb); // MBean object name

StatisticsService stats = new StatisticsService(); // MBean implementation
server.registerMBean(stats, on); // Register the MBean on the server</PRE>
<P>TODO&#65306;&#20173;&#38656;&#35201;&#35828;&#26126;&#30340;&#26159;&#65306;&#22312;&#31532;&#19968;&#20010;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#30452;&#25509;&#24471;&#21040;&#21644;&#20351;&#29992;MBean&#65307;&#32780;&#22312;&#31532;&#20108;&#20010;&#20363;&#23376;&#20013;&#65292;&#22312;&#20351;&#29992;MBean&#20043;&#21069; 
&#25105;&#20204;&#21017;&#38656;&#35201;&#32473;&#20986;SessionFactory&#30340;JNDI&#21517;&#65292;&#20351;&#29992;<TT 
class=literal>hibernateStatsBean.setSessionFactoryJNDIName("my/JNDI/Name")</TT> 
&#24471;&#21040;SessionFactory&#65292;&#28982;&#21518;&#23558;MBean&#20445;&#23384;&#20110;&#20854;&#20013;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#36890;&#36807;&#20197;&#19979;&#26041;&#27861;&#25171;&#24320;&#25110;&#20851;&#38381;<TT class=literal>SessionFactory</TT>&#30340;&#30417;&#27979;&#21151;&#33021;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#22312;&#37197;&#32622;&#26399;&#38388;&#65292;&#23558;<TT class=literal>hibernate.generate_statistics</TT>&#35774;&#32622;&#20026;<TT 
  class=literal>true</TT>&#25110;<TT class=literal>false</TT>&#65307; </P></LI></UL></DIV>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#22312;&#36816;&#34892;&#26399;&#38388;&#65292;&#21017;&#21487;&#20197;&#21487;&#20197;&#36890;&#36807;<TT 
  class=literal>sf.getStatistics().setStatisticsEnabled(true)</TT> &#25110;<TT 
  class=literal>hibernateStatsBean.setStatisticsEnabled(true)</TT> 
</P></LI></UL></DIV>
<P>&#20320;&#20063;&#21487;&#20197;&#22312;&#31243;&#24207;&#20013;&#35843;&#29992;<TT class=literal>clear()</TT>&#26041;&#27861;&#37325;&#32622;&#32479;&#35745;&#25968;&#25454;&#65292;&#35843;&#29992;<TT 
class=literal>logSummary()</TT> &#22312;&#26085;&#24535;&#20013;&#35760;&#24405;&#65288;info&#32423;&#21035;&#65289;&#20854;&#24635;&#32467;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=performance-monitoring-metrics></A>19.6.2.&nbsp; 
&#25968;&#25454;&#35760;&#24405;&#65288;Metrics&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate&#25552;&#20379;&#20102;&#19968;&#31995;&#21015;&#25968;&#25454;&#35760;&#24405;&#65292;&#20854;&#35760;&#24405;&#30340;&#20869;&#23481;&#21253;&#25324;&#20174;&#26368;&#22522;&#26412;&#30340;&#20449;&#24687;&#21040;&#19982;&#20855;&#20307;&#22330;&#26223;&#30340;&#29305;&#27530;&#20449;&#24687;&#12290;&#25152;&#26377;&#30340;&#27979;&#37327;&#20540;&#37117;&#21487;&#20197;&#30001; <TT 
class=literal>Statistics</TT>&#25509;&#21475;&#36827;&#34892;&#35775;&#38382;&#65292;&#20027;&#35201;&#20998;&#20026;&#19977;&#31867;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#20351;&#29992;<TT class=literal>Session</TT>&#30340;&#26222;&#36890;&#25968;&#25454;&#35760;&#24405;&#65292;&#20363;&#22914;&#25171;&#24320;&#30340;Session&#30340;&#20010;&#25968;&#12289;&#21462;&#24471;&#30340;JDBC&#30340;&#36830;&#25509;&#25968;&#31561;&#65307; </P>
  <LI>
  <P>&#23454;&#20307;&#12289;&#38598;&#21512;&#12289;&#26597;&#35810;&#12289;&#32531;&#23384;&#31561;&#20869;&#23481;&#30340;&#32479;&#19968;&#25968;&#25454;&#35760;&#24405; </P>
  <LI>
  <P>&#21644;&#20855;&#20307;&#23454;&#20307;&#12289;&#38598;&#21512;&#12289;&#26597;&#35810;&#12289;&#32531;&#23384;&#30456;&#20851;&#30340;&#35814;&#32454;&#25968;&#25454;&#35760;&#24405; </P></LI></UL></DIV>
<P>&#20363;&#22914;&#65306;&#20320;&#21487;&#20197;&#26816;&#26597;&#32531;&#23384;&#30340;&#21629;&#20013;&#25104;&#21151;&#27425;&#25968;&#65292;&#32531;&#23384;&#30340;&#21629;&#20013;&#22833;&#36133;&#27425;&#25968;&#65292;&#23454;&#20307;&#12289;&#38598;&#21512;&#21644;&#26597;&#35810;&#30340;&#20351;&#29992;&#27010;&#29575;&#65292;&#26597;&#35810;&#30340;&#24179;&#22343;&#26102;&#38388;&#31561;&#12290;&#35831;&#27880;&#24847; 
Java&#20013;&#26102;&#38388;&#30340;&#36817;&#20284;&#31934;&#24230;&#26159;&#27627;&#31186;&#12290;Hibernate&#30340;&#25968;&#25454;&#31934;&#24230;&#21644;&#20855;&#20307;&#30340;JVM&#26377;&#20851;&#65292;&#22312;&#26377;&#20123;&#24179;&#21488;&#19978;&#20854;&#31934;&#24230;&#29978;&#33267;&#21482;&#33021;&#31934;&#30830;&#21040;10&#31186;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;getter&#26041;&#27861;&#24471;&#21040;&#20840;&#23616;&#25968;&#25454;&#35760;&#24405;&#65288;&#20363;&#22914;&#65292;&#21644;&#20855;&#20307;&#30340;&#23454;&#20307;&#12289;&#38598;&#21512;&#12289;&#32531;&#23384;&#21306;&#26080;&#20851;&#30340;&#25968;&#25454;&#65289;&#65292;&#20320;&#20063;&#21487;&#20197;&#22312;&#20855;&#20307;&#26597;&#35810;&#20013;&#36890;&#36807;&#26631;&#35760;&#23454;&#20307;&#21517;&#12289; 
&#25110;HQL&#12289;SQL&#35821;&#21477;&#24471;&#21040;&#26576;&#23454;&#20307;&#30340;&#25968;&#25454;&#35760;&#24405;&#12290;&#35831;&#21442;&#32771;<TT class=literal>Statistics</TT>&#12289;<TT 
class=literal>EntityStatistics</TT>&#12289; <TT 
class=literal>CollectionStatistics</TT>&#12289;<TT 
class=literal>SecondLevelCacheStatistics</TT>&#12289; &#21644;<TT 
class=literal>QueryStatistics</TT>&#30340;API&#25991;&#26723;&#20197;&#25235;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290;&#19979;&#38754;&#30340;&#20195;&#30721;&#21017;&#26159;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#65306; </P><PRE class=programlisting>Statistics stats = HibernateUtil.sessionFactory.getStatistics();

double queryCacheHitCount  = stats.getQueryCacheHitCount();
double queryCacheMissCount = stats.getQueryCacheMissCount();
double queryCacheHitRatio =
  queryCacheHitCount / (queryCacheHitCount + queryCacheMissCount);

log.info("Query Hit ratio:" + queryCacheHitRatio);

EntityStatistics entityStats =
  stats.getEntityStatistics( Cat.class.getName() );
long changes =
        entityStats.getInsertCount()
        + entityStats.getUpdateCount()
        + entityStats.getDeleteCount();
log.info(Cat.class.getName() + " changed " + changes + "times"  );</PRE>
<P>&#22914;&#26524;&#20320;&#24819;&#24471;&#21040;&#25152;&#26377;&#23454;&#20307;&#12289;&#38598;&#21512;&#12289;&#26597;&#35810;&#21644;&#32531;&#23384;&#21306;&#30340;&#25968;&#25454;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#20197;&#19979;&#26041;&#27861;&#33719;&#24471;&#23454;&#20307;&#12289;&#38598;&#21512;&#12289;&#26597;&#35810;&#21644;&#32531;&#23384;&#21306;&#21015;&#34920;&#65306; <TT 
class=literal>getQueries()</TT>&#12289;<TT class=literal>getEntityNames()</TT>&#12289; <TT 
class=literal>getCollectionRoleNames()</TT>&#21644; <TT 
class=literal>getSecondLevelCacheRegionNames()</TT>&#12290; </P></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=toolsetguide></A>&#31532;&nbsp;20&nbsp;&#31456;&nbsp;&#24037;&#20855;&#31665;&#25351;&#21335;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#20197;&#36890;&#36807;&#19968;&#31995;&#21015;Eclipse&#25554;&#20214;&#12289;&#21629;&#20196;&#34892;&#24037;&#20855;&#21644;Ant&#20219;&#21153;&#26469;&#36827;&#34892;&#19982;Hibernate&#20851;&#32852;&#30340;&#36716;&#25442;&#12290; </P>
<P>&#38500;&#20102;Ant&#20219;&#21153;&#22806;&#65292;&#24403;&#21069;&#30340;<SPAN class=emphasis><EM>Hibernate Tools</EM></SPAN>&#20063;&#21253;&#21547;&#20102;Eclipse 
IDE&#30340;&#25554;&#20214;&#65292;&#29992;&#20110;&#19982;&#29616;&#23384;&#25968;&#25454;&#24211;&#30340;&#36870;&#21521;&#24037;&#31243;&#12290; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P><SPAN class=emphasis><EM>Mapping Editor:</EM></SPAN> Hibernate 
  XML&#26144;&#23556;&#25991;&#20214;&#30340;&#32534;&#36753;&#22120;&#65292;&#25903;&#25345;&#33258;&#21160;&#23436;&#25104;&#21644;&#35821;&#27861;&#39640;&#20142;&#12290;&#23427;&#20063;&#25903;&#25345;&#23545;&#31867;&#21517;&#21644;&#23646;&#24615;/&#23383;&#27573;&#21517;&#30340;&#35821;&#20041;&#33258;&#21160;&#23436;&#25104;&#65292;&#27604;&#36890;&#24120;&#30340;XML&#32534;&#36753;&#22120;&#26041;&#20415;&#24471;&#22810;&#12290; </P>
  <LI>
  <P><SPAN class=emphasis><EM>Console:</EM></SPAN> 
  Console&#26159;Eclipse&#30340;&#19968;&#20010;&#26032;&#35270;&#22270;&#12290;&#38500;&#20102;&#23545;&#20320;&#30340;console&#37197;&#32622;&#30340;&#26641;&#29366;&#27010;&#35272;&#65292;&#20320;&#36824;&#21487;&#20197;&#33719;&#24471;&#23545;&#20320;&#25345;&#20037;&#21270;&#31867;&#21450;&#20854;&#20851;&#32852;&#30340;&#20132;&#20114;&#24335;&#35270;&#22270;&#12290;Console&#20801;&#35768;&#20320;&#23545;&#25968;&#25454;&#24211;&#25191;&#34892;HQL&#26597;&#35810;&#65292;&#24182;&#30452;&#25509;&#22312;Eclipse&#20013;&#27983;&#35272;&#32467;&#26524;&#12290; 
  </P>
  <LI>
  <P><SPAN class=emphasis><EM>Development Wizards:</EM></SPAN> &#22312;Hibernate 
  Eclipse tools&#20013;&#36824;&#25552;&#20379;&#20102;&#20960;&#20010;&#21521;&#23548;&#65307;&#20320;&#21487;&#20197;&#29992;&#21521;&#23548;&#24555;&#36895;&#29983;&#25104;Hibernate 
  &#37197;&#32622;&#25991;&#20214;&#65288;cfg.xml&#65289;&#65292;&#20320;&#29978;&#33267;&#36824;&#21487;&#20197;&#21516;&#29616;&#23384;&#30340;&#25968;&#25454;&#24211;schema&#20013;&#21453;&#21521;&#24037;&#31243;&#20986;POJO&#28304;&#20195;&#30721;&#19982;Hibernate &#26144;&#23556;&#25991;&#20214;&#12290;&#21453;&#21521;&#24037;&#31243;&#25903;&#25345;&#21487;&#23450;&#21046;&#30340;&#27169;&#29256;&#12290; 
  </P>
  <LI>
  <P><SPAN class=emphasis><EM>Ant Tasks:</EM></SPAN> </P></LI></UL></DIV>
<P>&#35201;&#24471;&#21040;&#26356;&#22810;&#20449;&#24687;&#65292;&#35831;&#26597;&#38405; <SPAN class=emphasis><EM>Hibernate Tools</EM></SPAN> &#21253;&#21450;&#20854;&#25991;&#26723;&#12290; </P>
<P>&#21516;&#26102;&#65292;Hibernate&#20027;&#21457;&#34892;&#21253;&#36824;&#38468;&#24102;&#20102;&#19968;&#20010;&#38598;&#25104;&#30340;&#24037;&#20855;&#65288;&#23427;&#29978;&#33267;&#21487;&#20197;&#22312;Hibernate“&#20869;&#37096;”&#24555;&#36895;&#36816;&#34892;&#65289;<SPAN 
class=emphasis><EM>SchemaExport</EM></SPAN> &#65292;&#20063;&#23601;&#26159; <TT class=literal>hbm2ddl</TT>&#12290; 
</P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=toolsetguide-s1></A>20.1.&nbsp;Schema&#33258;&#21160;&#29983;&#25104;&#65288;Automatic schema 
generation&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#20197;&#20174;&#20320;&#30340;&#26144;&#23556;&#25991;&#20214;&#20351;&#29992;&#19968;&#20010;Hibernate&#24037;&#20855;&#29983;&#25104;DDL&#12290; 
&#29983;&#25104;&#30340;schema&#21253;&#21547;&#26377;&#23545;&#23454;&#20307;&#21644;&#38598;&#21512;&#31867;&#34920;&#30340;&#23436;&#25972;&#24615;&#24341;&#29992;&#32422;&#26463;&#65288;&#20027;&#38190;&#21644;&#22806;&#38190;&#65289;&#12290;&#28041;&#21450;&#21040;&#30340;&#26631;&#31034;&#31526;&#29983;&#25104;&#22120;&#25152;&#38656;&#30340;&#34920;&#21644;sequence&#20063;&#20250;&#21516;&#26102;&#29983;&#25104;&#12290; </P>
<P>&#22312;&#20351;&#29992;&#36825;&#20010;&#24037;&#20855;&#30340;&#26102;&#20505;&#65292;&#20320;<SPAN class=emphasis><EM>&#24517;&#39035;</EM></SPAN> &#36890;&#36807;<TT 
class=literal>hibernate.dialet</TT>&#23646;&#24615;&#25351;&#23450;&#19968;&#20010;SQL<TT 
class=literal>&#26041;&#35328;(Dialet)</TT>&#65292;&#22240;&#20026;DDL&#26159;&#19982;&#20379;&#24212;&#21830;&#39640;&#24230;&#30456;&#20851;&#30340;&#12290; </P>
<P>&#39318;&#20808;&#65292;&#35201;&#23450;&#21046;&#20320;&#30340;&#26144;&#23556;&#25991;&#20214;&#65292;&#26469;&#25913;&#21892;&#29983;&#25104;&#30340;schema&#12290; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=toolsetguide-s1-2></A>20.1.1.&nbsp;&#23545;schema&#23450;&#21046;&#21270;(Customizing the 
schema)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#24456;&#22810;Hibernate&#26144;&#23556;&#20803;&#32032;&#23450;&#20041;&#20102;&#21487;&#36873;&#30340;<TT class=literal>length</TT>&#12289;<TT 
class=literal>precision</TT> &#25110;&#32773; <TT 
class=literal>scale</TT>&#23646;&#24615;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#36825;&#20010;&#23646;&#24615;&#35774;&#32622;&#23383;&#27573;&#30340;&#38271;&#24230;&#12289;&#31934;&#24230;&#12289;&#23567;&#25968;&#28857;&#20301;&#25968;&#12290; </P><PRE class=programlisting>&lt;property name="zip" length="5"/&gt;</PRE><PRE class=programlisting>&lt;property name="balance" precision="12" scale="2"/&gt;</PRE>
<P>&#26377;&#20123;tag&#36824;&#25509;&#21463;<TT class=literal>not-null</TT>&#23646;&#24615;&#65288;&#29992;&#26469;&#22312;&#34920;&#23383;&#27573;&#19978;&#29983;&#25104;<TT class=literal>NOT 
NULL</TT>&#32422;&#26463;&#65289;&#21644;<TT class=literal>unique</TT>&#23646;&#24615;&#65288;&#29992;&#26469;&#22312;&#34920;&#23383;&#27573;&#19978;&#29983;&#25104;<TT 
class=literal>UNIQUE</TT>&#32422;&#26463;&#65289;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="bar" column="barId" not-null="true"/&gt;</PRE><PRE class=programlisting>&lt;element column="serialNumber" type="long" not-null="true" unique="true"/&gt;</PRE>
<P><TT class=literal>unique-key</TT>&#23646;&#24615;&#21487;&#20197;&#23545;&#25104;&#32452;&#30340;&#23383;&#27573;&#25351;&#23450;&#19968;&#20010;&#21807;&#19968;&#38190;&#32422;&#26463;(unique key 
constraint)&#12290;&#30446;&#21069;&#65292;<TT class=literal>unique-key</TT>&#23646;&#24615;&#25351;&#23450;&#30340;&#20540;&#22312;&#29983;&#25104;DDL&#26102;<SPAN 
class=emphasis><EM>&#24182;&#19981;&#20250;</EM></SPAN>&#34987;&#24403;&#20316;&#36825;&#20010;&#32422;&#26463;&#30340;&#21517;&#23383;&#65292;&#23427;&#20204;&#21482;&#26159;&#22312;&#29992;&#26469;&#22312;&#26144;&#23556;&#25991;&#20214;&#20869;&#37096;&#29992;&#20316;&#21306;&#20998;&#30340;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="org" column="orgId" unique-key="OrgEmployeeId"/&gt;
&lt;property name="employeeId" unique-key="OrgEmployee"/&gt;</PRE>
<P><TT 
class=literal>index</TT>&#23646;&#24615;&#20250;&#29992;&#23545;&#24212;&#30340;&#23383;&#27573;&#65288;&#19968;&#20010;&#25110;&#22810;&#20010;&#65289;&#29983;&#25104;&#19968;&#20010;index,&#23427;&#25351;&#20986;&#20102;&#36825;&#20010;index&#30340;&#21517;&#23383;&#12290;&#22914;&#26524;&#22810;&#20010;&#23383;&#27573;&#23545;&#24212;&#30340;index&#21517;&#23383;&#30456;&#21516;&#65292;&#23601;&#20250;&#29983;&#25104;&#21253;&#21547;&#36825;&#20123;&#23383;&#27573;&#30340;index&#12290; 
</P><PRE class=programlisting>&lt;property name="lastName" index="CustName"/&gt;
&lt;property name="firstName" index="CustName"/&gt;</PRE>
<P><TT class=literal>foreign-key</TT>&#23646;&#24615;&#21487;&#20197;&#29992;&#26469;&#35206;&#30422;&#20219;&#20309;&#29983;&#25104;&#30340;&#22806;&#38190;&#32422;&#26463;&#30340;&#21517;&#23383;&#12290; </P><PRE class=programlisting>&lt;many-to-one name="bar" column="barId" foreign-key="FKFooBar"/&gt;</PRE>
<P>&#24456;&#22810;&#26144;&#23556;&#20803;&#32032;&#36824;&#25509;&#21463;<TT class=literal>&lt;column&gt;</TT>&#23376;&#20803;&#32032;&#12290;&#36825;&#22312;&#23450;&#20041;&#36328;&#36234;&#22810;&#23383;&#27573;&#30340;&#31867;&#22411;&#26102;&#29305;&#21035;&#26377;&#29992;&#12290; </P><PRE class=programlisting>&lt;property name="name" type="my.customtypes.Name"/&gt;
    &lt;column name="last" not-null="true" index="bar_idx" length="30"/&gt;
    &lt;column name="first" not-null="true" index="bar_idx" length="20"/&gt;
    &lt;column name="initial"/&gt;
&lt;/property&gt;</PRE>
<P><TT class=literal>default</TT>&#23646;&#24615;&#20026;&#23383;&#27573;&#25351;&#23450;&#19968;&#20010;&#40664;&#35748;&#20540; (&#22312;&#20445;&#23384;&#34987;&#26144;&#23556;&#30340;&#31867;&#30340;&#26032;&#23454;&#20363;&#20043;&#21069;&#65292;&#20320;&#24212;&#35813;&#23558;&#21516;&#26679;&#30340;&#20540;&#36171;&#20110;&#23545;&#24212;&#30340;&#23646;&#24615;)&#12290; 
</P><PRE class=programlisting>&lt;property name="credits" type="integer" insert="false"&gt;
    &lt;column name="credits" default="10"/&gt;
&lt;/property&gt;</PRE><PRE class=programlisting>&lt;version name="version" type="integer" insert="false"&gt;
    &lt;column name="version" default="0"/&gt;
&lt;/property&gt;</PRE>
<P><TT class=literal>sql-type</TT>&#23646;&#24615;&#20801;&#35768;&#29992;&#25143;&#35206;&#30422;&#40664;&#35748;&#30340;Hibernate&#31867;&#22411;&#21040;SQL&#25968;&#25454;&#31867;&#22411;&#30340;&#26144;&#23556;&#12290; </P><PRE class=programlisting>&lt;property name="balance" type="float"&gt;
    &lt;column name="balance" sql-type="decimal(13,3)"/&gt;
&lt;/property&gt;</PRE>
<P><TT class=literal>check</TT>&#23646;&#24615;&#20801;&#35768;&#29992;&#25143;&#25351;&#23450;&#19968;&#20010;&#32422;&#26463;&#26816;&#26597;&#12290; </P><PRE class=programlisting>&lt;property name="foo" type="integer"&gt;
    &lt;column name="foo" check="foo &gt; 10"/&gt;
&lt;/property&gt;</PRE><PRE class=programlisting>&lt;class name="Foo" table="foos" check="bar &lt; 100.0"&gt;
    ...
    &lt;property name="bar" type="float"/&gt;
&lt;/class&gt;</PRE>
<DIV class=table><A name=schemattributes-summary></A>
<P class=title><B>&#34920;&nbsp;20.1.&nbsp;Summary</B></P>
<TABLE summary=Summary border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;(Attribute)</TH>
    <TH>&#20540;&#65288;Values&#65289;</TH>
    <TH>&#35299;&#37322;&#65288;Interpretation&#65289;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>length</TT></TD>
    <TD>&#25968;&#23383;</TD>
    <TD>&#23383;&#27573;&#38271;&#24230;</TD></TR>
  <TR>
    <TD><TT class=literal>precision</TT></TD>
    <TD>&#25968;&#23383;</TD>
    <TD>&#31934;&#24230;(decimal precision)</TD></TR>
  <TR>
    <TD><TT class=literal>scale</TT></TD>
    <TD>&#25968;&#23383;</TD>
    <TD>&#23567;&#25968;&#28857;&#20301;&#25968;(decimal scale)</TD></TR>
  <TR>
    <TD><TT class=literal>not-null</TT></TD>
    <TD><TT class=literal>true|false</TT></TD>
    <TD>&#25351;&#26126;&#23383;&#27573;&#26159;&#21542;&#24212;&#35813;&#26159;&#38750;&#31354;&#30340;</TD></TR>
  <TR>
    <TD><TT class=literal>unique</TT></TD>
    <TD><TT class=literal>true|false</TT></TD>
    <TD>&#25351;&#26126;&#26159;&#21542;&#35813;&#23383;&#27573;&#20855;&#26377;&#24799;&#19968;&#32422;&#26463;</TD></TR>
  <TR>
    <TD><TT class=literal>index</TT></TD>
    <TD><TT class=literal>index_name</TT></TD>
    <TD>&#25351;&#26126;&#19968;&#20010;&#65288;&#22810;&#23383;&#27573;&#65289;&#30340;&#32034;&#24341;(index)&#30340;&#21517;&#23383;</TD></TR>
  <TR>
    <TD><TT class=literal>unique-key</TT></TD>
    <TD><TT class=literal>unique_key_name</TT></TD>
    <TD>&#25351;&#26126;&#22810;&#23383;&#27573;&#24799;&#19968;&#32422;&#26463;&#30340;&#21517;&#23383;&#65288;&#21442;&#35265;&#19978;&#38754;&#30340;&#35828;&#26126;&#65289;</TD></TR>
  <TR>
    <TD><TT class=literal>foreign-key</TT></TD>
    <TD><TT class=literal>foreign_key_name</TT></TD>
    <TD>specifies the name of the foreign key constraint generated for an 
      association, for a <TT class=literal>&lt;one-to-one&gt;</TT>, <TT 
      class=literal>&lt;many-to-one&gt;</TT>, <TT 
      class=literal>&lt;key&gt;</TT>, or <TT 
      class=literal>&lt;many-to-many&gt;</TT> mapping element. Note that <TT 
      class=literal>inverse="true"</TT> sides will not be considered by <TT 
      class=literal>SchemaExport</TT>. &#25351;&#26126;&#19968;&#20010;&#22806;&#38190;&#30340;&#21517;&#23383;&#65292;&#23427;&#26159;&#20026;&#20851;&#32852;&#29983;&#25104;&#30340;&#65292;&#25110;&#32773;<TT 
      class=literal>&lt;one-to-one&gt;</TT>&#65292;<TT 
      class=literal>&lt;many-to-one&gt;</TT>, <TT 
      class=literal>&lt;key&gt;</TT>, &#25110;&#32773;<TT 
      class=literal>&lt;many-to-many&gt;</TT>&#26144;&#23556;&#20803;&#32032;&#12290;&#27880;&#24847;<TT 
      class=literal>inverse="true"</TT>&#22312;<TT 
      class=literal>SchemaExport</TT>&#26102;&#20250;&#34987;&#24573;&#30053;&#12290; </TD></TR>
  <TR>
    <TD><TT class=literal>sql-type</TT></TD>
    <TD><TT class=literal>SQL &#23383;&#27573;&#31867;&#22411;</TT></TD>
    <TD>&#35206;&#30422;&#40664;&#35748;&#30340;&#23383;&#27573;&#31867;&#22411;(&#21482;&#33021;&#29992;&#20110;<TT class=literal>&lt;column&gt;</TT>&#23646;&#24615;&#65289; </TD></TR>
  <TR>
    <TD><TT class=literal>default</TT></TD>
    <TD>SQL&#34920;&#36798;&#24335;</TD>
    <TD>&#20026;&#23383;&#27573;&#25351;&#23450;&#40664;&#35748;&#20540; </TD></TR>
  <TR>
    <TD><TT class=literal>check</TT></TD>
    <TD>SQL &#34920;&#36798;&#24335;</TD>
    <TD>&#23545;&#23383;&#27573;&#25110;&#34920;&#21152;&#20837;SQL&#32422;&#26463;&#26816;&#26597; </TD></TR></TBODY></TABLE></DIV>
<P><TT class=literal>&lt;comment&gt;</TT>&#20803;&#32032;&#21487;&#20197;&#35753;&#20320;&#22312;&#29983;&#25104;&#30340;schema&#20013;&#21152;&#20837;&#27880;&#37322;&#12290; </P><PRE class=programlisting>&lt;class name="Customer" table="CurCust"&gt;
    &lt;comment&gt;Current customers only&lt;/comment&gt;
    ...
&lt;/class&gt;</PRE><PRE class=programlisting>&lt;property name="balance"&gt;
    &lt;column name="bal"&gt;
        &lt;comment&gt;Balance in USD&lt;/comment&gt;
    &lt;/column&gt;
&lt;/property&gt;</PRE>
<P>&#32467;&#26524;&#26159;&#22312;&#29983;&#25104;&#30340;DDL&#20013;&#21253;&#21547;<TT class=literal>comment on table</TT> &#25110;&#32773; <TT 
class=literal>comment on column</TT>&#35821;&#21477;(&#20551;&#33509;&#25903;&#25345;&#30340;&#35805;)&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=toolsetguide-s1-3></A>20.1.2.&nbsp;&#36816;&#34892;&#35813;&#24037;&#20855;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>SchemaExport</TT>&#24037;&#20855;&#25226;DDL&#33050;&#26412;&#20889;&#21040;&#26631;&#20934;&#36755;&#20986;&#65292;&#21516;&#26102;/&#25110;&#32773;&#25191;&#34892;DDL&#35821;&#21477;&#12290; </P>
<P><TT class=literal>java -cp </TT><SPAN 
class=emphasis><EM>hibernate_classpaths</EM></SPAN> <TT 
class=literal>org.hibernate.tool.hbm2ddl.SchemaExport</TT> <SPAN 
class=emphasis><EM>options mapping_files</EM></SPAN> </P>
<DIV class=table><A name=d0e15398></A>
<P class=title><B>&#34920;&nbsp;20.2.&nbsp;<TT 
class=literal>SchemaExport</TT>&#21629;&#20196;&#34892;&#36873;&#39033;</B></P>
<TABLE summary=SchemaExport&#21629;&#20196;&#34892;&#36873;&#39033; border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#36873;&#39033;</TH>
    <TH>&#35828;&#26126;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>--quiet</TT></TD>
    <TD>&#19981;&#35201;&#25226;&#33050;&#26412;&#36755;&#20986;&#21040;stdout</TD></TR>
  <TR>
    <TD><TT class=literal>--drop</TT></TD>
    <TD>&#21482;&#36827;&#34892;drop tables&#30340;&#27493;&#39588;</TD></TR>
  <TR>
    <TD><TT class=literal>--create</TT></TD>
    <TD>&#21482;&#21019;&#24314;&#34920;</TD></TR>
  <TR>
    <TD><TT class=literal>--text</TT></TD>
    <TD>&#19981;&#25191;&#34892;&#22312;&#25968;&#25454;&#24211;&#20013;&#36816;&#34892;&#30340;&#27493;&#39588;</TD></TR>
  <TR>
    <TD><TT class=literal>--output=my_schema.ddl</TT></TD>
    <TD>&#25226;&#36755;&#20986;&#30340;ddl&#33050;&#26412;&#36755;&#20986;&#21040;&#19968;&#20010;&#25991;&#20214;</TD></TR>
  <TR>
    <TD><TT class=literal>--naming=eg.MyNamingStrategy</TT></TD>
    <TD>&#36873;&#25321;&#19968;&#20010;&#21629;&#21517;&#31574;&#30053;(<TT class=literal>NamingStrategy</TT>)</TD></TR>
  <TR>
    <TD><TT class=literal>--config=hibernate.cfg.xml</TT></TD>
    <TD>&#20174;XML&#25991;&#20214;&#35835;&#20837;Hibernate&#37197;&#32622;</TD></TR>
  <TR>
    <TD><TT class=literal>--properties=hibernate.properties</TT></TD>
    <TD>&#20174;&#25991;&#20214;&#35835;&#20837;&#25968;&#25454;&#24211;&#23646;&#24615;</TD></TR>
  <TR>
    <TD><TT class=literal>--format</TT></TD>
    <TD>&#25226;&#33050;&#26412;&#20013;&#30340;SQL&#35821;&#21477;&#23545;&#40784;&#21644;&#32654;&#21270;</TD></TR>
  <TR>
    <TD><TT class=literal>--delimiter=;</TT></TD>
    <TD>&#20026;&#33050;&#26412;&#35774;&#32622;&#34892;&#32467;&#26463;&#31526;</TD></TR></TBODY></TABLE></DIV>
<P>&#20320;&#29978;&#33267;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#23884;&#20837;<TT class=literal>SchemaExport</TT>&#24037;&#20855;: </P><PRE class=programlisting>Configuration cfg = ....;
new SchemaExport(cfg).create(false, true);</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=toolsetguide-s1-4></A>20.1.3.&nbsp;&#23646;&#24615;(Properties)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#26041;&#24335;&#25351;&#23450;&#25968;&#25454;&#24211;&#23646;&#24615;: </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#36890;&#36807;<TT class=literal>-D</TT><SPAN 
  class=emphasis><EM>&lt;property&gt;</EM></SPAN>&#31995;&#32479;&#21442;&#25968;</P>
  <LI>
  <P>&#22312;<TT class=literal>hibernate.properties</TT>&#25991;&#20214;&#20013;</P>
  <LI>
  <P>&#20301;&#20110;&#19968;&#20010;&#20854;&#23427;&#21517;&#23383;&#30340;properties&#25991;&#20214;&#20013;,&#28982;&#21518;&#29992; <TT 
class=literal>--properties</TT>&#21442;&#25968;&#25351;&#23450;</P></LI></UL></DIV>
<P>&#25152;&#38656;&#30340;&#21442;&#25968;&#21253;&#25324;: </P>
<DIV class=table><A name=d0e15511></A>
<P class=title><B>&#34920;&nbsp;20.3.&nbsp;SchemaExport &#36830;&#25509;&#23646;&#24615;</B></P>
<TABLE summary="SchemaExport &#36830;&#25509;&#23646;&#24615;" border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#23646;&#24615;&#21517;</TH>
    <TH>&#35828;&#26126;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>hibernate.connection.driver_class</TT></TD>
    <TD>jdbc driver class</TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.url</TT></TD>
    <TD>jdbc url</TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.username</TT></TD>
    <TD>database user</TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.connection.password</TT></TD>
    <TD>user password</TD></TR>
  <TR>
    <TD><TT class=literal>hibernate.dialect</TT></TD>
    <TD>&#26041;&#35328;(dialect)</TD></TR></TBODY></TABLE></DIV></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=toolsetguide-s1-5></A>20.1.4.&nbsp;&#20351;&#29992;Ant(Using 
Ant)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#22312;&#20320;&#30340;Ant build&#33050;&#26412;&#20013;&#35843;&#29992;<TT class=literal>SchemaExport</TT>: </P><PRE class=programlisting>&lt;target name="schemaexport"&gt;
    &lt;taskdef name="schemaexport"
        classname="org.hibernate.tool.hbm2ddl.SchemaExportTask"
        classpathref="class.path"/&gt;
    
    &lt;schemaexport
        properties="hibernate.properties"
        quiet="no"
        text="no"
        drop="no"
        delimiter=";"
        output="schema-export.sql"&gt;
        &lt;fileset dir="src"&gt;
            &lt;include name="**/*.hbm.xml"/&gt;
        &lt;/fileset&gt;
    &lt;/schemaexport&gt;
&lt;/target&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=toolsetguide-s1-6></A>20.1.5.&nbsp;&#23545;schema&#30340;&#22686;&#37327;&#26356;&#26032;(Incremental schema 
updates)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>SchemaUpdate</TT>&#24037;&#20855;&#23545;&#24050;&#23384;&#22312;&#30340;schema&#37319;&#29992;"&#22686;&#37327;"&#26041;&#24335;&#36827;&#34892;&#26356;&#26032;&#12290;&#27880;&#24847;<TT 
class=literal>SchemaUpdate</TT>&#20005;&#37325;&#20381;&#36182;&#20110;JDBC metadata API,&#25152;&#20197;&#23427;&#24182;&#38750;&#23545;&#25152;&#26377;JDBC&#39537;&#21160;&#37117;&#26377;&#25928;&#12290; </P>
<P><TT class=literal>java -cp </TT><SPAN 
class=emphasis><EM>hibernate_classpaths</EM></SPAN> <TT 
class=literal>org.hibernate.tool.hbm2ddl.SchemaUpdate</TT> <SPAN 
class=emphasis><EM>options mapping_files</EM></SPAN> </P>
<DIV class=table><A name=d0e15588></A>
<P class=title><B>&#34920;&nbsp;20.4.&nbsp;<TT 
class=literal>SchemaUpdate</TT>&#21629;&#20196;&#34892;&#36873;&#39033;</B></P>
<TABLE summary=SchemaUpdate&#21629;&#20196;&#34892;&#36873;&#39033; border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#36873;&#39033;</TH>
    <TH>&#35828;&#26126;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>--quiet</TT></TD>
    <TD>&#19981;&#35201;&#25226;&#33050;&#26412;&#36755;&#20986;&#21040;stdout</TD></TR>
  <TR>
    <TD><TT class=literal>--text</TT></TD>
    <TD>&#19981;&#25226;&#33050;&#26412;&#36755;&#20986;&#21040;&#25968;&#25454;&#24211;</TD></TR>
  <TR>
    <TD><TT class=literal>--naming=eg.MyNamingStrategy</TT></TD>
    <TD>&#36873;&#25321;&#19968;&#20010;&#21629;&#21517;&#31574;&#30053; (<TT class=literal>NamingStrategy</TT>)</TD></TR>
  <TR>
    <TD><TT class=literal>--properties=hibernate.properties</TT></TD>
    <TD>&#20174;&#25351;&#23450;&#25991;&#20214;&#35835;&#20837;&#25968;&#25454;&#24211;&#23646;&#24615;</TD></TR>
  <TR>
    <TD><TT class=literal>--config=hibernate.cfg.xml</TT></TD>
    <TD>&#25351;&#23450;&#19968;&#20010; <TT class=literal>.cfg.xml</TT>&#25991;&#20214;</TD></TR></TBODY></TABLE></DIV>
<P>&#20320;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#23884;&#20837;<TT class=literal>SchemaUpdate</TT>&#24037;&#20855;: </P><PRE class=programlisting>Configuration cfg = ....;
new SchemaUpdate(cfg).execute(false);</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=toolsetguide-s1-7></A>20.1.6.&nbsp;&#29992;Ant&#26469;&#22686;&#37327;&#26356;&#26032;schema(Using 
Ant for incremental schema updates)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#22312;Ant&#33050;&#26412;&#20013;&#35843;&#29992;<TT class=literal>SchemaUpdate</TT>&#65306; </P><PRE class=programlisting>&lt;target name="schemaupdate"&gt;
    &lt;taskdef name="schemaupdate"
        classname="org.hibernate.tool.hbm2ddl.SchemaUpdateTask"
        classpathref="class.path"/&gt;
    
    &lt;schemaupdate
        properties="hibernate.properties"
        quiet="no"&gt;
        &lt;fileset dir="src"&gt;
            &lt;include name="**/*.hbm.xml"/&gt;
        &lt;/fileset&gt;
    &lt;/schemaupdate&gt;
&lt;/target&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=toolsetguide-s1-8></A>20.1.7.&nbsp;Schema 
&#26657;&#39564;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>SchemaValidator</TT>&#24037;&#20855;&#20250;&#27604;&#36739;&#25968;&#25454;&#24211;&#29616;&#29366;&#26159;&#21542;&#19982;&#26144;&#23556;&#25991;&#26723;“&#21305;&#37197;”&#12290;&#27880;&#24847;&#65292;<TT 
class=literal>SchemaValidator</TT> &#20005;&#37325;&#20381;&#36182;&#20110;JDBC&#30340;metadata 
API&#65292;&#22240;&#27492;&#19981;&#26159;&#23545;&#25152;&#26377;&#30340;JDBC&#39537;&#21160;&#37117;&#36866;&#29992;&#12290;&#36825;&#19968;&#24037;&#20855;&#22312;&#27979;&#35797;&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#12290; </P>
<P><TT class=literal>java -cp </TT><SPAN 
class=emphasis><EM>hibernate_classpaths</EM></SPAN> <TT 
class=literal>org.hibernate.tool.hbm2ddl.SchemaValidator</TT> <SPAN 
class=emphasis><EM>options mapping_files</EM></SPAN> </P>
<DIV class=table><A name=d0e15680></A>
<P class=title><B>&#34920;&nbsp;20.5.&nbsp;<TT 
class=literal>SchemaValidator</TT>&#21629;&#20196;&#34892;&#21442;&#25968;</B></P>
<TABLE summary=SchemaValidator&#21629;&#20196;&#34892;&#21442;&#25968; border=1>
  <COLGROUP>
  <COL>
  <COL></COLGROUP>
  <THEAD>
  <TR>
    <TH>&#36873;&#39033;</TH>
    <TH>&#25551;&#36848;</TH></TR></THEAD>
  <TBODY>
  <TR>
    <TD><TT class=literal>--naming=eg.MyNamingStrategy</TT></TD>
    <TD>&#36873;&#25321;&#19968;&#20010;&#21629;&#21517;&#31574;&#30053; (<TT class=literal>NamingStrategy</TT>)</TD></TR>
  <TR>
    <TD><TT class=literal>--properties=hibernate.properties</TT></TD>
    <TD>&#20174;&#25991;&#20214;&#20013;&#35835;&#21462;&#25968;&#25454;&#24211;&#23646;&#24615;</TD></TR>
  <TR>
    <TD><TT class=literal>--config=hibernate.cfg.xml</TT></TD>
    <TD>&#25351;&#23450;&#19968;&#20010;<TT class=literal>.cfg.xml</TT>&#25991;&#20214;</TD></TR></TBODY></TABLE></DIV>
<P>&#20320;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#23884;&#20837;<TT class=literal>SchemaValidator</TT>&#65306; </P><PRE class=programlisting>Configuration cfg = ....;
new SchemaValidator(cfg).validate();</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=toolsetguide-s1-9></A>20.1.8.&nbsp;&#20351;&#29992;Ant&#36827;&#34892;schema&#26657;&#39564;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20320;&#21487;&#20197;&#22312;Ant&#33050;&#26412;&#20013;&#35843;&#29992;<TT class=literal>SchemaValidator</TT>: </P><PRE class=programlisting>&lt;target name="schemavalidate"&gt;
    &lt;taskdef name="schemavalidator"
        classname="org.hibernate.tool.hbm2ddl.SchemaValidatorTask"
        classpathref="class.path"/&gt;
    
    &lt;schemavalidator
        properties="hibernate.properties"&gt;
        &lt;fileset dir="src"&gt;
            &lt;include name="**/*.hbm.xml"/&gt;
        &lt;/fileset&gt;
    &lt;/schemaupdate&gt;
&lt;/target&gt;</PRE></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=example-parentchild></A>&#31532;&nbsp;21&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child 
Relationships)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#21018;&#21018;&#25509;&#35302;Hibernate&#30340;&#20154;&#22823;&#22810;&#26159;&#20174;&#29238;&#23376;&#20851;&#31995;&#65288;parent / child type 
relationship&#65289;&#30340;&#24314;&#27169;&#20837;&#25163;&#30340;&#12290;&#29238;&#23376;&#20851;&#31995;&#30340;&#24314;&#27169;&#26377;&#20004;&#31181;&#26041;&#27861;&#12290;&#30001;&#20110;&#31181;&#31181;&#21407;&#22240;&#65292;&#26368;&#26041;&#20415;&#30340;&#26041;&#27861;&#26159;&#25226;<TT 
class=literal>Parent</TT>&#21644;<TT class=literal>Child</TT>&#37117;&#24314;&#27169;&#25104;&#23454;&#20307;&#31867;&#65292;&#24182;&#21019;&#24314;&#19968;&#20010;&#20174;<TT 
class=literal>Parent</TT>&#25351;&#21521;<TT 
class=literal>Child</TT>&#30340;&lt;one-to-many&gt;&#20851;&#32852;&#65292;&#23545;&#26032;&#25163;&#26469;&#35828;&#23588;&#20854;&#22914;&#27492;&#12290;&#36824;&#26377;&#19968;&#31181;&#26041;&#27861;&#65292;&#23601;&#26159;&#23558;<TT 
class=literal>Child</TT>&#22768;&#26126;&#20026;&#19968;&#20010;<TT 
class=literal>&lt;composite-element&gt;</TT>&#65288;&#32452;&#21512;&#20803;&#32032;&#65289;&#12290; &#20107;&#23454;&#19978;&#22312;Hibernate&#20013;one to 
many&#20851;&#32852;&#30340;&#40664;&#35748;&#35821;&#20041;&#36828;&#27809;&#26377;composite element&#36148;&#36817;parent / child&#20851;&#31995;&#30340;&#36890;&#24120;&#35821;&#20041;&#12290;&#19979;&#38754;&#25105;&#20204;&#20250;&#38416;&#36848;&#22914;&#20309;&#20351;&#29992;<SPAN 
class=emphasis><EM>&#24102;&#26377;&#32423;&#32852;&#30340;&#21452;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;(bidirectional one to many association with 
cascades)</EM></SPAN>&#21435;&#24314;&#31435;&#26377;&#25928;&#12289;&#20248;&#32654;&#30340;parent / child&#20851;&#31995;&#12290;&#36825;&#19968;&#28857;&#20063;&#19981;&#38590;&#65281; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-parentchild-collections></A>21.1.&nbsp;&#20851;&#20110;collections&#38656;&#35201;&#27880;&#24847;&#30340;&#19968;&#28857;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>Hibernate collections&#34987;&#24403;&#20316;&#20854;&#25152;&#23646;&#23454;&#20307;&#32780;&#19981;&#26159;&#20854;&#21253;&#21547;&#23454;&#20307;&#30340;&#19968;&#20010;&#36923;&#36753;&#37096;&#20998;&#12290;&#36825;&#38750;&#24120;&#37325;&#35201;&#65281;&#23427;&#20027;&#35201;&#20307;&#29616;&#20026;&#20197;&#19979;&#20960;&#28857;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#24403;&#21024;&#38500;&#25110;&#22686;&#21152;collection&#20013;&#23545;&#35937;&#30340;&#26102;&#20505;&#65292;collection&#25152;&#23646;&#32773;&#30340;&#29256;&#26412;&#20540;&#20250;&#36882;&#22686;&#12290; </P>
  <LI>
  <P>&#22914;&#26524;&#19968;&#20010;&#20174;collection&#20013;&#31227;&#38500;&#30340;&#23545;&#35937;&#26159;&#19968;&#20010;&#20540;&#31867;&#22411;(value type)&#30340;&#23454;&#20363;&#65292;&#27604;&#22914;composite 
  element&#65292;&#37027;&#20040;&#36825;&#20010;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#29366;&#24577;&#23558;&#20250;&#32456;&#27490;&#65292;&#20854;&#22312;&#25968;&#25454;&#24211;&#20013;&#23545;&#24212;&#30340;&#35760;&#24405;&#20250;&#34987;&#21024;&#38500;&#12290;&#21516;&#26679;&#30340;&#65292;&#21521;collection&#22686;&#21152;&#19968;&#20010;value 
  type&#30340;&#23454;&#20363;&#23558;&#20250;&#20351;&#20043;&#31435;&#21363;&#34987;&#25345;&#20037;&#21270;&#12290; </P>
  <LI>
  <P>&#21478;&#19968;&#26041;&#38754;&#65292;&#22914;&#26524;&#20174;&#19968;&#23545;&#22810;&#25110;&#22810;&#23545;&#22810;&#20851;&#32852;&#30340;collection&#20013;&#31227;&#38500;&#19968;&#20010;&#23454;&#20307;&#65292;&#22312;&#32570;&#30465;&#24773;&#20917;&#19979;&#36825;&#20010;&#23545;&#35937;&#24182;&#19981;&#20250;&#34987;&#21024;&#38500;&#12290;&#36825;&#20010;&#34892;&#20026;&#26159;&#23436;&#20840;&#21512;&#20046;&#36923;&#36753;&#30340;&#65293;&#65293;&#25913;&#21464;&#19968;&#20010;&#23454;&#20307;&#30340;&#20869;&#37096;&#29366;&#24577;&#19981;&#24212;&#35813;&#20351;&#19982;&#23427;&#20851;&#32852;&#30340;&#23454;&#20307;&#28040;&#22833;&#25481;&#65281;&#21516;&#26679;&#30340;&#65292;&#21521;collection&#22686;&#21152;&#19968;&#20010;&#23454;&#20307;&#19981;&#20250;&#20351;&#20043;&#34987;&#25345;&#20037;&#21270;&#12290; 
  </P></LI></UL></DIV>
<P>&#23454;&#38469;&#19978;&#65292;&#21521;Collection&#22686;&#21152;&#19968;&#20010;&#23454;&#20307;&#30340;&#32570;&#30465;&#21160;&#20316;&#21482;&#26159;&#22312;&#20004;&#20010;&#23454;&#20307;&#20043;&#38388;&#21019;&#24314;&#19968;&#20010;&#36830;&#25509;&#32780;&#24050;&#65292;&#21516;&#26679;&#31227;&#38500;&#30340;&#26102;&#20505;&#20063;&#21482;&#26159;&#21024;&#38500;&#36830;&#25509;&#12290;&#36825;&#31181;&#22788;&#29702;&#23545;&#20110;&#25152;&#26377;&#30340;&#24773;&#20917;&#37117;&#26159;&#21512;&#36866;&#30340;&#12290;&#23545;&#20110;&#29238;&#23376;&#20851;&#31995;&#21017;&#26159;&#23436;&#20840;&#19981;&#36866;&#21512;&#30340;&#65292;&#22312;&#36825;&#31181;&#20851;&#31995;&#19979;&#65292;&#23376;&#23545;&#35937;&#30340;&#29983;&#23384;&#32465;&#23450;&#20110;&#29238;&#23545;&#35937;&#30340;&#29983;&#23384;&#21608;&#26399;&#12290; 
</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-parentchild-bidir></A>21.2.&nbsp;&#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#31995;(Bidirectional 
one-to-many)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20551;&#35774;&#25105;&#20204;&#35201;&#23454;&#29616;&#19968;&#20010;&#31616;&#21333;&#30340;&#20174;Parent&#21040;Child&#30340;&lt;one-to-many&gt;&#20851;&#32852;&#12290; </P><PRE class=programlisting>&lt;set name="children"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</PRE>
<P>&#22914;&#26524;&#25105;&#20204;&#36816;&#34892;&#19979;&#38754;&#30340;&#20195;&#30721; </P><PRE class=programlisting>Parent p = .....;
Child c = new Child();
p.getChildren().add(c);
session.save(c);
session.flush();</PRE>
<P>Hibernate&#20250;&#20135;&#29983;&#20004;&#26465;SQL&#35821;&#21477;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc>
  <LI>
  <P>&#19968;&#26465;<TT class=literal>INSERT</TT>&#35821;&#21477;&#65292;&#20026;<TT class=literal>c</TT>&#21019;&#24314;&#19968;&#26465;&#35760;&#24405;</P>
  <LI>
  <P>&#19968;&#26465;<TT class=literal>UPDATE</TT>&#35821;&#21477;&#65292;&#21019;&#24314;&#20174;<TT class=literal>p</TT>&#21040;<TT 
  class=literal>c</TT>&#30340;&#36830;&#25509; </P></LI></UL></DIV>
<P>&#36825;&#26679;&#20570;&#19981;&#20165;&#25928;&#29575;&#20302;&#65292;&#32780;&#19988;&#36829;&#21453;&#20102;&#21015;<TT class=literal>parent_id</TT>&#38750;&#31354;&#30340;&#38480;&#21046;&#12290;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#22312;&#38598;&#21512;&#31867;&#26144;&#23556;&#19978;&#25351;&#23450;<TT 
class=literal>not-null="true"</TT>&#26469;&#35299;&#20915;&#36829;&#21453;&#38750;&#31354;&#32422;&#26463;&#30340;&#38382;&#39064;&#65306; </P><PRE class=programlisting>&lt;set name="children"&gt;
    &lt;key column="parent_id" not-null="true"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</PRE>
<P>&#28982;&#32780;&#65292;&#36825;&#24182;&#38750;&#26159;&#25512;&#33616;&#30340;&#35299;&#20915;&#26041;&#27861;&#12290; </P>
<P>&#36825;&#31181;&#29616;&#35937;&#30340;&#26681;&#26412;&#21407;&#22240;&#26159;&#20174;<TT class=literal>p</TT>&#21040;<TT 
class=literal>c</TT>&#30340;&#36830;&#25509;&#65288;&#22806;&#38190;parent_id&#65289;&#27809;&#26377;&#34987;&#24403;&#20316;<TT 
class=literal>Child</TT>&#23545;&#35937;&#29366;&#24577;&#30340;&#19968;&#37096;&#20998;&#65292;&#22240;&#32780;&#27809;&#26377;&#22312;INSERT&#35821;&#21477;&#20013;&#34987;&#21019;&#24314;&#12290;&#22240;&#27492;&#35299;&#20915;&#30340;&#21150;&#27861;&#23601;&#26159;&#25226;&#36825;&#20010;&#36830;&#25509;&#28155;&#21152;&#21040;Child&#30340;&#26144;&#23556;&#20013;&#12290; 
</P><PRE class=programlisting>&lt;many-to-one name="parent" column="parent_id" not-null="true"/&gt;</PRE>
<P>&#65288;&#25105;&#20204;&#36824;&#38656;&#35201;&#20026;&#31867;<TT class=literal>Child</TT>&#28155;&#21152;<TT class=literal>parent</TT>&#23646;&#24615;&#65289; </P>
<P>&#29616;&#22312;&#23454;&#20307;<TT class=literal>Child</TT>&#22312;&#31649;&#29702;&#36830;&#25509;&#30340;&#29366;&#24577;&#65292;&#20026;&#20102;&#20351;collection&#19981;&#26356;&#26032;&#36830;&#25509;&#65292;&#25105;&#20204;&#20351;&#29992;<TT 
class=literal>inverse</TT>&#23646;&#24615;&#12290; </P><PRE class=programlisting>&lt;set name="children" inverse="true"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</PRE>
<P>&#19979;&#38754;&#30340;&#20195;&#30721;&#26159;&#29992;&#26469;&#28155;&#21152;&#19968;&#20010;&#26032;&#30340;<TT class=literal>Child</TT> </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
c.setParent(p);
p.getChildren().add(c);
session.save(c);
session.flush();</PRE>
<P>&#29616;&#22312;&#65292;&#21482;&#20250;&#26377;&#19968;&#26465;<TT class=literal>INSERT</TT>&#35821;&#21477;&#34987;&#25191;&#34892;&#65281; </P>
<P>&#20026;&#20102;&#35753;&#20107;&#24773;&#21464;&#24471;&#20117;&#20117;&#26377;&#26465;&#65292;&#21487;&#20197;&#20026;<TT class=literal>Parent</TT>&#21152;&#19968;&#20010;<TT 
class=literal>addChild()</TT>&#26041;&#27861;&#12290; </P><PRE class=programlisting>public void addChild(Child c) {
    c.setParent(this);
    children.add(c);
}</PRE>
<P>&#29616;&#22312;&#65292;&#28155;&#21152;<TT class=literal>Child</TT>&#30340;&#20195;&#30721;&#23601;&#26159;&#36825;&#26679; </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
p.addChild(c);
session.save(c);
session.flush();</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-parentchild-cascades></A>21.3.&nbsp;&#32423;&#32852;&#29983;&#21629;&#21608;&#26399;&#65288;Cascading 
lifecycle&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#38656;&#35201;&#26174;&#24335;&#35843;&#29992;<TT class=literal>save()</TT>&#20173;&#28982;&#24456;&#40635;&#28902;&#65292;&#25105;&#20204;&#21487;&#20197;&#29992;&#32423;&#32852;&#26469;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#12290; </P><PRE class=programlisting>&lt;set name="children" inverse="true" cascade="all"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</PRE>
<P>&#36825;&#26679;&#19978;&#38754;&#30340;&#20195;&#30721;&#21487;&#20197;&#31616;&#21270;&#20026;&#65306; </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
p.addChild(c);
session.flush();</PRE>
<P>&#21516;&#26679;&#30340;&#65292;&#20445;&#23384;&#25110;&#21024;&#38500;<TT class=literal>Parent</TT>&#23545;&#35937;&#30340;&#26102;&#20505;&#24182;&#19981;&#38656;&#35201;&#36941;&#21382;&#20854;&#23376;&#23545;&#35937;&#12290; &#19979;&#38754;&#30340;&#20195;&#30721;&#20250;&#21024;&#38500;&#23545;&#35937;<TT 
class=literal>p</TT>&#21450;&#20854;&#25152;&#26377;&#23376;&#23545;&#35937;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;&#12290; </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
session.delete(p);
session.flush();</PRE>
<P>&#28982;&#32780;&#65292;&#36825;&#27573;&#20195;&#30721; </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
Child c = (Child) p.getChildren().iterator().next();
p.getChildren().remove(c);
c.setParent(null);
session.flush();</PRE>
<P>&#19981;&#20250;&#20174;&#25968;&#25454;&#24211;&#21024;&#38500;<TT class=literal>c</TT>&#65307;&#23427;&#21482;&#20250;&#21024;&#38500;&#19982;<TT 
class=literal>p</TT>&#20043;&#38388;&#30340;&#36830;&#25509;&#65288;&#24182;&#19988;&#20250;&#23548;&#33268;&#36829;&#21453;<TT class=literal>NOT 
NULL</TT>&#32422;&#26463;&#65292;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65289;&#12290;&#20320;&#38656;&#35201;&#26174;&#24335;&#35843;&#29992;<TT class=literal>delete()</TT>&#26469;&#21024;&#38500;<TT 
class=literal>Child</TT>&#12290; </P><PRE class=programlisting>Parent p = (Parent) session.load(Parent.class, pid);
Child c = (Child) p.getChildren().iterator().next();
p.getChildren().remove(c);
session.delete(c);
session.flush();</PRE>
<P>&#22312;&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#65292;&#22914;&#26524;&#27809;&#26377;&#29238;&#23545;&#35937;&#65292;&#23376;&#23545;&#35937;&#23601;&#19981;&#24212;&#35813;&#23384;&#22312;&#65292;&#22914;&#26524;&#23558;&#23376;&#23545;&#35937;&#20174;collection&#20013;&#31227;&#38500;&#65292;&#23454;&#38469;&#19978;&#25105;&#20204;&#26159;&#24819;&#21024;&#38500;&#23427;&#12290;&#35201;&#23454;&#29616;&#36825;&#31181;&#35201;&#27714;&#65292;&#23601;&#24517;&#39035;&#20351;&#29992;<TT 
class=literal>cascade="all-delete-orphan"</TT>&#12290; </P><PRE class=programlisting>&lt;set name="children" inverse="true" cascade="all-delete-orphan"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</PRE>
<P>&#27880;&#24847;&#65306;&#21363;&#20351;&#22312;collection&#19968;&#26041;&#30340;&#26144;&#23556;&#20013;&#25351;&#23450;<TT 
class=literal>inverse="true"</TT>&#65292;&#32423;&#32852;&#20173;&#28982;&#26159;&#36890;&#36807;&#36941;&#21382;collection&#20013;&#30340;&#20803;&#32032;&#26469;&#22788;&#29702;&#30340;&#12290;&#22914;&#26524;&#20320;&#24819;&#35201;&#36890;&#36807;&#32423;&#32852;&#36827;&#34892;&#23376;&#23545;&#35937;&#30340;&#25554;&#20837;&#12289;&#21024;&#38500;&#12289;&#26356;&#26032;&#25805;&#20316;&#65292;&#23601;&#24517;&#39035;&#25226;&#23427;&#21152;&#21040;collection&#20013;&#65292;&#21482;&#35843;&#29992;<TT 
class=literal>setParent()</TT>&#26159;&#19981;&#22815;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-parentchild-update></A>21.4.&nbsp;&#32423;&#32852;&#19982;<TT 
class=literal>&#26410;&#20445;&#23384;&#20540;</TT>&#65288;Cascades and <TT 
class=literal>unsaved-value</TT>&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#20551;&#35774;&#25105;&#20204;&#20174;<TT class=literal>Session</TT>&#20013;&#35013;&#20837;&#20102;&#19968;&#20010;<TT 
class=literal>Parent</TT>&#23545;&#35937;&#65292;&#29992;&#25143;&#30028;&#38754;&#23545;&#20854;&#36827;&#34892;&#20102;&#20462;&#25913;&#65292;&#28982;&#21518;&#24076;&#26395;&#22312;&#19968;&#20010;&#26032;&#30340;Session&#37324;&#38754;&#35843;&#29992;<TT 
class=literal>update()</TT>&#26469;&#20445;&#23384;&#36825;&#20123;&#20462;&#25913;&#12290;&#23545;&#35937;<TT 
class=literal>Parent</TT>&#21253;&#21547;&#20102;&#23376;&#23545;&#35937;&#30340;&#38598;&#21512;&#65292;&#30001;&#20110;&#25171;&#24320;&#20102;&#32423;&#32852;&#26356;&#26032;&#65292;Hibernate&#38656;&#35201;&#30693;&#36947;&#21738;&#20123;Child&#23545;&#35937;&#26159;&#26032;&#23454;&#20363;&#21270;&#30340;&#65292;&#21738;&#20123;&#20195;&#34920;&#25968;&#25454;&#24211;&#20013;&#24050;&#32463;&#23384;&#22312;&#30340;&#35760;&#24405;&#12290;&#25105;&#20204;&#20551;&#35774;<TT 
class=literal>Parent</TT>&#21644;<TT class=literal>Child</TT>&#23545;&#35937;&#30340;&#26631;&#35782;&#23646;&#24615;&#37117;&#26159;&#33258;&#21160;&#29983;&#25104;&#30340;&#65292;&#31867;&#22411;&#20026;<TT 
class=literal>java.lang.Long</TT>&#12290;Hibernate&#20250;&#20351;&#29992;&#26631;&#35782;&#23646;&#24615;&#30340;&#20540;&#65292;&#21644;version &#25110; timestamp 
&#23646;&#24615;&#65292;&#26469;&#21028;&#26029;&#21738;&#20123;&#23376;&#23545;&#35937;&#26159;&#26032;&#30340;&#12290;(&#21442;&#35265;<A title=10.7.&nbsp;&#33258;&#21160;&#29366;&#24577;&#26816;&#27979; 
href="#objectstate-saveorupdate">&#31532;&nbsp;10.7&nbsp;&#33410; “&#33258;&#21160;&#29366;&#24577;&#26816;&#27979;”</A>.) <SPAN 
class=emphasis><EM>&#22312; Hibernate3 &#20013;,&#26174;&#24335;&#25351;&#23450;<TT 
class=literal>unsaved-value</TT>&#19981;&#20877;&#26159;&#24517;&#39035;&#30340;&#20102;&#12290;</EM></SPAN> </P>
<P>&#19979;&#38754;&#30340;&#20195;&#30721;&#20250;&#26356;&#26032;<TT class=literal>parent</TT>&#21644;<TT class=literal>child</TT>&#23545;&#35937;&#65292;&#24182;&#19988;&#25554;&#20837;<TT 
class=literal>newChild</TT>&#23545;&#35937;&#12290; </P><PRE class=programlisting>//parent and child were both loaded in a previous session
parent.addChild(child);
Child newChild = new Child();
parent.addChild(newChild);
session.update(parent);
session.flush();</PRE>
<P>Well, that's all very well for the case of a generated identifier, but what 
about assigned identifiers and composite identifiers? This is more difficult, 
since Hibernate can't use the identifier property to distinguish between a newly 
instantiated object (with an identifier assigned by the user) and an object 
loaded in a previous session. In this case, Hibernate will either use the 
timestamp or version property, or will actually query the second-level cache or, 
worst case, the database, to see if the row exists. </P>
<P>&#36825;&#23545;&#20110;&#33258;&#21160;&#29983;&#25104;&#26631;&#35782;&#30340;&#24773;&#20917;&#26159;&#38750;&#24120;&#22909;&#30340;&#65292;&#20294;&#26159;&#33258;&#20998;&#37197;&#30340;&#26631;&#35782;&#21644;&#22797;&#21512;&#26631;&#35782;&#24590;&#20040;&#21150;&#21602;&#65311;&#36825;&#26159;&#26377;&#28857;&#40635;&#28902;&#65292;&#22240;&#20026;Hibernate&#27809;&#26377;&#21150;&#27861;&#21306;&#20998;&#26032;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65288;&#26631;&#35782;&#34987;&#29992;&#25143;&#25351;&#23450;&#20102;&#65289;&#21644;&#21069;&#19968;&#20010;Session&#35013;&#20837;&#30340;&#23545;&#35937;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;Hibernate&#20250;&#20351;&#29992;timestamp&#25110;version&#23646;&#24615;&#65292;&#25110;&#32773;&#26597;&#35810;&#31532;&#20108;&#32423;&#32531;&#23384;&#65292;&#25110;&#32773;&#26368;&#22351;&#30340;&#24773;&#20917;&#65292;&#26597;&#35810;&#25968;&#25454;&#24211;&#65292;&#26469;&#30830;&#35748;&#26159;&#21542;&#27492;&#34892;&#23384;&#22312;&#12290;</P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-parentchild-conclusion></A>21.5.&nbsp;&#32467;&#35770;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#37324;&#26377;&#19981;&#23569;&#19996;&#35199;&#38656;&#35201;&#34701;&#20250;&#36143;&#36890;&#65292;&#21487;&#33021;&#20250;&#35753;&#26032;&#25163;&#24863;&#21040;&#36855;&#24785;&#12290;&#20294;&#26159;&#22312;&#23454;&#36341;&#20013;&#23427;&#20204;&#37117;&#24037;&#20316;&#22320;&#38750;&#24120;&#22909;&#12290;&#22823;&#37096;&#20998;Hibernate&#24212;&#29992;&#31243;&#24207;&#37117;&#20250;&#32463;&#24120;&#29992;&#21040;&#29238;&#23376;&#23545;&#35937;&#27169;&#24335;&#12290; </P>
<P>&#22312;&#31532;&#19968;&#27573;&#20013;&#25105;&#20204;&#26366;&#32463;&#25552;&#21040;&#21478;&#19968;&#20010;&#26041;&#26696;&#12290;&#19978;&#38754;&#30340;&#36825;&#20123;&#38382;&#39064;&#37117;&#19981;&#20250;&#20986;&#29616;&#22312;<TT 
class=literal>&lt;composite-element&gt;</TT>&#26144;&#23556;&#20013;&#65292;&#23427;&#20934;&#30830;&#22320;&#34920;&#36798;&#20102;&#29238;&#23376;&#20851;&#31995;&#30340;&#35821;&#20041;&#12290;&#24456;&#19981;&#24184;&#22797;&#21512;&#20803;&#32032;&#36824;&#26377;&#20004;&#20010;&#37325;&#22823;&#38480;&#21046;:&#22797;&#21512;&#20803;&#32032;&#19981;&#33021;&#25317;&#26377;collections&#65292;&#24182;&#19988;&#65292;&#38500;&#20102;&#29992;&#20110;&#24799;&#19968;&#30340;&#29238;&#23545;&#35937;&#22806;&#65292;&#23427;&#20204;&#19981;&#33021;&#20877;&#20316;&#20026;&#20854;&#23427;&#20219;&#20309;&#23454;&#20307;&#30340;&#23376;&#23545;&#35937;&#12290; 
</P></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=example-weblog></A>&#31532;&nbsp;22&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;Weblog 
&#24212;&#29992;&#31243;&#24207;</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-weblog-classes></A>22.1.&nbsp;&#25345;&#20037;&#21270;&#31867;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19979;&#38754;&#30340;&#25345;&#20037;&#21270;&#31867;&#34920;&#31034;&#19968;&#20010;weblog&#21644;&#22312;&#20854;&#20013;&#24352;&#36148;&#30340;&#19968;&#20010;&#36148;&#23376;&#12290;&#20182;&#20204;&#26159;&#26631;&#20934;&#30340;&#29238;/&#23376;&#20851;&#31995;&#27169;&#22411;&#65292;&#20294;&#26159;&#25105;&#20204;&#20250;&#29992;&#19968;&#20010;&#26377;&#24207;&#21253;&#65288;ordered bag)&#32780;&#38750;&#38598;&#21512;(set)&#12290; 
</P><PRE class=programlisting>package eg;

import java.util.List;

public class Blog {
    private Long _id;
    private String _name;
    private List _items;

    public Long getId() {
        return _id;
    }
    public List getItems() {
        return _items;
    }
    public String getName() {
        return _name;
    }
    public void setId(Long long1) {
        _id = long1;
    }
    public void setItems(List list) {
        _items = list;
    }
    public void setName(String string) {
        _name = string;
    }
}</PRE><PRE class=programlisting>package eg;

import java.text.DateFormat;
import java.util.Calendar;

public class BlogItem {
    private Long _id;
    private Calendar _datetime;
    private String _text;
    private String _title;
    private Blog _blog;

    public Blog getBlog() {
        return _blog;
    }
    public Calendar getDatetime() {
        return _datetime;
    }
    public Long getId() {
        return _id;
    }
    public String getText() {
        return _text;
    }
    public String getTitle() {
        return _title;
    }
    public void setBlog(Blog blog) {
        _blog = blog;
    }
    public void setDatetime(Calendar calendar) {
        _datetime = calendar;
    }
    public void setId(Long long1) {
        _id = long1;
    }
    public void setText(String string) {
        _text = string;
    }
    public void setTitle(String string) {
        _title = string;
    }
}</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-weblog-mappings></A>22.2.&nbsp;Hibernate &#26144;&#23556;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19979;&#21015;&#30340;XML&#26144;&#23556;&#24212;&#35813;&#26159;&#24456;&#30452;&#30333;&#30340;&#12290; </P><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC 
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;
    &lt;class 
        name="Blog" 
        table="BLOGS" &gt;
        
        &lt;id 
            name="id" 
            column="BLOG_ID"&gt;
            
            &lt;generator class="native"/&gt;
            
        &lt;/id&gt;
        
        &lt;property 
            name="name" 
            column="NAME" 
            not-null="true" 
            unique="true"/&gt;
            
        &lt;bag 
            name="items" 
            inverse="true" 
            order-by="DATE_TIME" 
            cascade="all"&gt;
            
            &lt;key column="BLOG_ID"/&gt;
            &lt;one-to-many class="BlogItem"/&gt;
            
        &lt;/bag&gt;
        
    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</PRE><PRE class=programlisting>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC 
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;
    
    &lt;class 
        name="BlogItem" 
        table="BLOG_ITEMS" 
        dynamic-update="true"&gt;
        
        &lt;id 
            name="id" 
            column="BLOG_ITEM_ID"&gt;
            
            &lt;generator class="native"/&gt;
            
        &lt;/id&gt;
        
        &lt;property 
            name="title" 
            column="TITLE" 
            not-null="true"/&gt;
            
        &lt;property 
            name="text" 
            column="TEXT" 
            not-null="true"/&gt;
            
        &lt;property 
            name="datetime" 
            column="DATE_TIME" 
            not-null="true"/&gt;
            
        &lt;many-to-one 
            name="blog" 
            column="BLOG_ID" 
            not-null="true"/&gt;
            
    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-weblog-code></A>22.3.&nbsp;Hibernate &#20195;&#30721;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19979;&#38754;&#30340;&#31867;&#28436;&#31034;&#20102;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;Hibernate&#23545;&#36825;&#20123;&#31867;&#36827;&#34892;&#30340;&#19968;&#20123;&#25805;&#20316;&#12290; </P><PRE class=programlisting>package eg;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.Iterator;
import java.util.List;

import org.hibernate.HibernateException;
import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.Configuration;
import org.hibernate.tool.hbm2ddl.SchemaExport;

public class BlogMain {
    
    private SessionFactory _sessions;
    
    public void configure() throws HibernateException {
        _sessions = new Configuration()
            .addClass(Blog.class)
            .addClass(BlogItem.class)
            .buildSessionFactory();
    }
    
    public void exportTables() throws HibernateException {
        Configuration cfg = new Configuration()
            .addClass(Blog.class)
            .addClass(BlogItem.class);
        new SchemaExport(cfg).create(true, true);
    }
    
    public Blog createBlog(String name) throws HibernateException {
        
        Blog blog = new Blog();
        blog.setName(name);
        blog.setItems( new ArrayList() );
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.persist(blog);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return blog;
    }
    
    public BlogItem createBlogItem(Blog blog, String title, String text)
                        throws HibernateException {
        
        BlogItem item = new BlogItem();
        item.setTitle(title);
        item.setText(text);
        item.setBlog(blog);
        item.setDatetime( Calendar.getInstance() );
        blog.getItems().add(item);
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.update(blog);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return item;
    }
    
    public BlogItem createBlogItem(Long blogid, String title, String text)
                        throws HibernateException {
        
        BlogItem item = new BlogItem();
        item.setTitle(title);
        item.setText(text);
        item.setDatetime( Calendar.getInstance() );
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            Blog blog = (Blog) session.load(Blog.class, blogid);
            item.setBlog(blog);
            blog.getItems().add(item);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return item;
    }
    
    public void updateBlogItem(BlogItem item, String text)
                    throws HibernateException {
        
        item.setText(text);
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.update(item);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
    }
    
    public void updateBlogItem(Long itemid, String text)
                    throws HibernateException {
    
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            BlogItem item = (BlogItem) session.load(BlogItem.class, itemid);
            item.setText(text);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
    }
    
    public List listAllBlogNamesAndItemCounts(int max)
                    throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        List result = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "select blog.id, blog.name, count(blogItem) " +
                "from Blog as blog " +
                "left outer join blog.items as blogItem " +
                "group by blog.name, blog.id " +
                "order by max(blogItem.datetime)"
            );
            q.setMaxResults(max);
            result = q.list();
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return result;
    }
    
    public Blog getBlogAndAllItems(Long blogid)
                    throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        Blog blog = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "from Blog as blog " +
                "left outer join fetch blog.items " +
                "where blog.id = :blogid"
            );
            q.setParameter("blogid", blogid);
            blog  = (Blog) q.uniqueResult();
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return blog;
    }
    
    public List listBlogsAndRecentItems() throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        List result = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "from Blog as blog " +
                "inner join blog.items as blogItem " +
                "where blogItem.datetime &gt; :minDate"
            );

            Calendar cal = Calendar.getInstance();
            cal.roll(Calendar.MONTH, false);
            q.setCalendar("minDate", cal);
            
            result = q.list();
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return result;
    }
}</PRE></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=example-mappings></A>&#31532;&nbsp;23&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#22797;&#26434;&#26144;&#23556;&#23454;&#20363;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#26412;&#31456;&#23637;&#31034;&#20102;&#19968;&#20123;&#36739;&#20026;&#22797;&#26434;&#30340;&#20851;&#31995;&#26144;&#23556;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-mappings-emp></A>23.1.&nbsp;Employer&#65288;&#38599;&#20027;)/Employee(&#38599;&#21592;)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#19979;&#38754;&#20851;&#20110;<TT class=literal>Employer</TT> &#21644; <TT 
class=literal>Employee</TT>&#30340;&#20851;&#31995;&#27169;&#22411;&#20351;&#29992;&#20102;&#19968;&#20010;&#30495;&#23454;&#30340;&#23454;&#20307;&#31867; (<TT 
class=literal>Employment</TT>)&#26469;&#34920;&#36848;&#65292;&#36825;&#26159;&#22240;&#20026;&#23545;&#20110;&#30456;&#21516;&#30340;&#38599;&#21592;&#21644;&#38599;&#20027;&#21487;&#33021;&#20250;&#26377;&#22810;&#20010;&#38599;&#20323;&#26102;&#38388;&#27573;&#12290; 
&#23545;&#20110;&#37329;&#39069;&#21644;&#38599;&#21592;&#22995;&#21517;&#65292;&#29992;Components&#24314;&#27169;&#12290; </P>
<DIV class=mediaobject align=center><IMG 
src="../shared/images/EmployerEmployee.gif" align=middle></DIV>
<P>&#26144;&#23556;&#25991;&#20214;&#21487;&#33021;&#26159;&#36825;&#26679;: </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
        
    &lt;class name="Employer" table="employers"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employer_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

    &lt;class name="Employment" table="employment_periods"&gt;

        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employment_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="startDate" column="start_date"/&gt;
        &lt;property name="endDate" column="end_date"/&gt;

        &lt;component name="hourlyRate" class="MonetaryAmount"&gt;
            &lt;property name="amount"&gt;
                &lt;column name="hourly_rate" sql-type="NUMERIC(12, 2)"/&gt;
            &lt;/property&gt;
            &lt;property name="currency" length="12"/&gt;
        &lt;/component&gt;

        &lt;many-to-one name="employer" column="employer_id" not-null="true"/&gt;
        &lt;many-to-one name="employee" column="employee_id" not-null="true"/&gt;

    &lt;/class&gt;

    &lt;class name="Employee" table="employees"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employee_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="taxfileNumber"/&gt;
        &lt;component name="name" class="Name"&gt;
            &lt;property name="firstName"/&gt;
            &lt;property name="initial"/&gt;
            &lt;property name="lastName"/&gt;
        &lt;/component&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#29992;<TT class=literal>SchemaExport</TT>&#29983;&#25104;&#34920;&#32467;&#26500;&#12290; </P><PRE class=programlisting>create table employers (
    id BIGINT not null, 
    name VARCHAR(255), 
    primary key (id)
)

create table employment_periods (
    id BIGINT not null,
    hourly_rate NUMERIC(12, 2),
    currency VARCHAR(12), 
    employee_id BIGINT not null, 
    employer_id BIGINT not null, 
    end_date TIMESTAMP, 
    start_date TIMESTAMP, 
    primary key (id)
)

create table employees (
    id BIGINT not null, 
    firstName VARCHAR(255), 
    initial CHAR(1), 
    lastName VARCHAR(255), 
    taxfileNumber VARCHAR(255), 
    primary key (id)
)

alter table employment_periods 
    add constraint employment_periodsFK0 foreign key (employer_id) references employers
alter table employment_periods 
    add constraint employment_periodsFK1 foreign key (employee_id) references employees
create sequence employee_id_seq
create sequence employment_id_seq
create sequence employer_id_seq</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-mappings-authorwork></A>23.2.&nbsp;Author(&#20316;&#23478;)/Work(&#20316;&#21697;)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#32771;&#34385;&#19979;&#38754;&#30340;<TT class=literal>Work</TT>,<TT class=literal>Author</TT> &#21644; <TT 
class=literal>Person</TT>&#27169;&#22411;&#30340;&#20851;&#31995;&#12290; &#25105;&#20204;&#29992;&#22810;&#23545;&#22810;&#20851;&#31995;&#26469;&#25551;&#36848;<TT class=literal>Work</TT> &#21644; <TT 
class=literal>Author</TT>&#65292; &#29992;&#19968;&#23545;&#19968;&#20851;&#31995;&#26469;&#25551;&#36848;<TT class=literal>Author</TT> &#21644; <TT 
class=literal>Person</TT>&#65292; &#21478;&#19968;&#31181;&#21487;&#33021;&#24615;&#26159;<TT class=literal>Author</TT>&#32487;&#25215;<TT 
class=literal>Person</TT>&#12290; </P>
<DIV class=mediaobject align=center><IMG src="../shared/images/AuthorWork.gif" 
align=middle></DIV>
<P>&#19979;&#38754;&#30340;&#26144;&#23556;&#25991;&#20214;&#27491;&#30830;&#30340;&#25551;&#36848;&#20102;&#36825;&#20123;&#20851;&#31995;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Work" table="works" discriminator-value="W"&gt;

        &lt;id name="id" column="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;discriminator column="type" type="character"/&gt;

        &lt;property name="title"/&gt;
        &lt;set name="authors" table="author_work"&gt;
            &lt;key column name="work_id"/&gt;
            &lt;many-to-many class="Author" column name="author_id"/&gt;
        &lt;/set&gt;

        &lt;subclass name="Book" discriminator-value="B"&gt;
            &lt;property name="text"/&gt;
        &lt;/subclass&gt;

        &lt;subclass name="Song" discriminator-value="S"&gt;
            &lt;property name="tempo"/&gt;
            &lt;property name="genre"/&gt;
        &lt;/subclass&gt;

    &lt;/class&gt;

    &lt;class name="Author" table="authors"&gt;

        &lt;id name="id" column="id"&gt;
            &lt;!-- The Author must have the same identifier as the Person --&gt;
            &lt;generator class="assigned"/&gt; 
        &lt;/id&gt;

        &lt;property name="alias"/&gt;
        &lt;one-to-one name="person" constrained="true"/&gt;

        &lt;set name="works" table="author_work" inverse="true"&gt;
            &lt;key column="author_id"/&gt;
            &lt;many-to-many class="Work" column="work_id"/&gt;
        &lt;/set&gt;

    &lt;/class&gt;

    &lt;class name="Person" table="persons"&gt;
        &lt;id name="id" column="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P>&#26144;&#23556;&#20013;&#26377;4&#20010;&#34920;&#12290;<TT class=literal>works</TT>, <TT class=literal>authors</TT> &#21644; <TT 
class=literal>persons</TT> &#20998;&#21035;&#20445;&#23384;&#30528;work&#65292;author&#21644;person&#30340;&#25968;&#25454;&#12290;<TT 
class=literal>author_work</TT>&#26159;authors&#21644;works&#30340;&#20851;&#32852;&#34920;&#12290; &#34920;&#32467;&#26500;&#26159;&#30001;<TT 
class=literal>SchemaExport</TT>&#29983;&#25104;&#30340;&#12290; </P><PRE class=programlisting>create table works (
    id BIGINT not null generated by default as identity, 
    tempo FLOAT, 
    genre VARCHAR(255), 
    text INTEGER, 
    title VARCHAR(255), 
    type CHAR(1) not null, 
    primary key (id)
)

create table author_work (
    author_id BIGINT not null, 
    work_id BIGINT not null, 
    primary key (work_id, author_id)
)

create table authors (
    id BIGINT not null generated by default as identity, 
    alias VARCHAR(255), 
    primary key (id)
)

create table persons (
    id BIGINT not null generated by default as identity, 
    name VARCHAR(255), 
    primary key (id)
)

alter table authors 
    add constraint authorsFK0 foreign key (id) references persons
alter table author_work 
    add constraint author_workFK0 foreign key (author_id) references authors
alter table author_work
    add constraint author_workFK1 foreign key (work_id) references works</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=example-mappings-customerorderproduct></A>23.3.&nbsp;Customer(&#23458;&#25143;)/Order(&#35746;&#21333;)/Product(&#20135;&#21697;)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#29616;&#22312;&#26469;&#32771;&#34385;<TT class=literal>Customer</TT>,<TT class=literal>Order</TT> &#65292; <TT 
class=literal>LineItem</TT> &#21644; <TT class=literal>Product</TT>&#20851;&#31995;&#30340;&#27169;&#22411;&#12290;<TT 
class=literal>Customer</TT> &#21644; <TT class=literal>Order</TT>&#20043;&#38388; 
&#26159;&#19968;&#23545;&#22810;&#30340;&#20851;&#31995;&#65292;&#20294;&#26159;&#25105;&#20204;&#24590;&#20040;&#26469;&#25551;&#36848;<TT class=literal>Order</TT> / <TT class=literal>LineItem</TT> 
/ <TT class=literal>Product</TT>&#21602;&#65311; &#25105;&#21487;&#20197;&#25226;<TT class=literal>LineItem</TT>&#20316;&#20026;&#25551;&#36848;<TT 
class=literal>Order</TT> &#21644; <TT class=literal>Product</TT> 
&#22810;&#23545;&#22810;&#20851;&#31995;&#30340;&#20851;&#32852;&#31867;&#65292;&#22312;Hibernate&#65292;&#36825;&#21483;&#20570;&#32452;&#21512;&#20803;&#32032;&#12290; </P>
<DIV class=mediaobject align=center><IMG 
src="../shared/images/CustomerOrderProduct.gif" align=middle></DIV>
<P>&#26144;&#23556;&#25991;&#20214;&#22914;&#19979;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class name="Customer" table="customers"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
        &lt;set name="orders" inverse="true"&gt;
            &lt;key column="customer_id"/&gt;
            &lt;one-to-many class="Order"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Order" table="orders"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="date"/&gt;
        &lt;many-to-one name="customer" column="customer_id"/&gt;
        &lt;list name="lineItems" table="line_items"&gt;
            &lt;key column="order_id"/&gt;
            &lt;list-index column="line_number"/&gt;
            &lt;composite-element class="LineItem"&gt;
                &lt;property name="quantity"/&gt;
                &lt;many-to-one name="product" column="product_id"/&gt;
            &lt;/composite-element&gt;
        &lt;/list&gt;
    &lt;/class&gt;

    &lt;class name="Product" table="products"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="serialNumber"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</PRE>
<P><TT class=literal>customers</TT>, <TT class=literal>orders</TT>, <TT 
class=literal>line_items</TT> &#21644; <TT class=literal>products</TT> &#20998;&#21035;&#20445;&#23384;&#30528;customer, 
order, order line item &#21644; product&#30340;&#25968;&#25454;&#12290; <TT 
class=literal>line_items</TT>&#20063;&#20316;&#20026;&#36830;&#25509;orders &#21644; products&#30340;&#20851;&#32852;&#34920;&#12290; </P><PRE class=programlisting>create table customers (
    id BIGINT not null generated by default as identity, 
    name VARCHAR(255), 
    primary key (id)
)

create table orders (
    id BIGINT not null generated by default as identity, 
    customer_id BIGINT, 
    date TIMESTAMP, 
    primary key (id)
)

create table line_items (
    line_number INTEGER not null, 
    order_id BIGINT not null, 
    product_id BIGINT, 
    quantity INTEGER, 
    primary key (order_id, line_number)
)

create table products (
    id BIGINT not null generated by default as identity, 
    serialNumber VARCHAR(255), 
    primary key (id)
)

alter table orders 
    add constraint ordersFK0 foreign key (customer_id) references customers
alter table line_items
    add constraint line_itemsFK0 foreign key (product_id) references products
alter table line_items
    add constraint line_itemsFK1 foreign key (order_id) references orders</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=misc></A>23.4.&nbsp;&#26434;&#20363;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#36825;&#20123;&#20363;&#23376;&#20840;&#37096;&#26469;&#33258;&#20110;Hibernate&#30340;test suite&#65292;&#21516;&#26102;&#20320;&#20063;&#21487;&#20197;&#25214;&#21040;&#20854;&#20182;&#26377;&#29992;&#30340;&#20363;&#23376;&#12290; &#21487;&#20197;&#21442;&#32771;Hibernate&#30340;<TT 
class=literal>test</TT>&#30446;&#24405;&#12290; </P>
<P>TODO: put words around this stuff</P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=example-mappings-typed-onetone></A>23.4.1.&nbsp;"Typed" 
one-to-one association</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;class name="Person"&gt;
    &lt;id name="name"/&gt;
    &lt;one-to-one name="address" 
            cascade="all"&gt;
        &lt;formula&gt;name&lt;/formula&gt;
        &lt;formula&gt;'HOME'&lt;/formula&gt;
    &lt;/one-to-one&gt;
    &lt;one-to-one name="mailingAddress" 
            cascade="all"&gt;
        &lt;formula&gt;name&lt;/formula&gt;
        &lt;formula&gt;'MAILING'&lt;/formula&gt;
    &lt;/one-to-one&gt;
&lt;/class&gt;

&lt;class name="Address" batch-size="2" 
        check="addressType in ('MAILING', 'HOME', 'BUSINESS')"&gt;
    &lt;composite-id&gt;
        &lt;key-many-to-one name="person" 
                column="personName"/&gt;
        &lt;key-property name="type" 
                column="addressType"/&gt;
    &lt;/composite-id&gt;
    &lt;property name="street" type="text"/&gt;
    &lt;property name="state"/&gt;
    &lt;property name="zip"/&gt;
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=example-mappings-composite-key></A>23.4.2.&nbsp;Composite key 
example</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;class name="Customer"&gt;

    &lt;id name="customerId"
        length="10"&gt;
        &lt;generator class="assigned"/&gt;
    &lt;/id&gt;

    &lt;property name="name" not-null="true" length="100"/&gt;
    &lt;property name="address" not-null="true" length="200"/&gt;

    &lt;list name="orders"
            inverse="true"
            cascade="save-update"&gt;
        &lt;key column="customerId"/&gt;
        &lt;index column="orderNumber"/&gt;
        &lt;one-to-many class="Order"/&gt;
    &lt;/list&gt;

&lt;/class&gt;

&lt;class name="Order" table="CustomerOrder" lazy="true"&gt;
    &lt;synchronize table="LineItem"/&gt;
    &lt;synchronize table="Product"/&gt;
    
    &lt;composite-id name="id" 
            class="Order$Id"&gt;
        &lt;key-property name="customerId" length="10"/&gt;
        &lt;key-property name="orderNumber"/&gt;
    &lt;/composite-id&gt;
    
    &lt;property name="orderDate" 
            type="calendar_date"
            not-null="true"/&gt;
    
    &lt;property name="total"&gt;
        &lt;formula&gt;
            ( select sum(li.quantity*p.price) 
            from LineItem li, Product p 
            where li.productId = p.productId 
                and li.customerId = customerId 
                and li.orderNumber = orderNumber )
        &lt;/formula&gt;
    &lt;/property&gt;
    
    &lt;many-to-one name="customer"
            column="customerId"
            insert="false"
            update="false" 
            not-null="true"/&gt;
        
    &lt;bag name="lineItems"
            fetch="join" 
            inverse="true"
            cascade="save-update"&gt;
        &lt;key&gt;
            &lt;column name="customerId"/&gt;
            &lt;column name="orderNumber"/&gt;
        &lt;/key&gt;
        &lt;one-to-many class="LineItem"/&gt;
    &lt;/bag&gt;
    
&lt;/class&gt;
    
&lt;class name="LineItem"&gt;
    
    &lt;composite-id name="id" 
            class="LineItem$Id"&gt;
        &lt;key-property name="customerId" length="10"/&gt;
        &lt;key-property name="orderNumber"/&gt;
        &lt;key-property name="productId" length="10"/&gt;
    &lt;/composite-id&gt;
    
    &lt;property name="quantity"/&gt;
    
    &lt;many-to-one name="order"
            insert="false"
            update="false" 
            not-null="true"&gt;
        &lt;column name="customerId"/&gt;
        &lt;column name="orderNumber"/&gt;
    &lt;/many-to-one&gt;
    
    &lt;many-to-one name="product"
            insert="false"
            update="false" 
            not-null="true"
            column="productId"/&gt;
        
&lt;/class&gt;

&lt;class name="Product"&gt;
    &lt;synchronize table="LineItem"/&gt;

    &lt;id name="productId"
        length="10"&gt;
        &lt;generator class="assigned"/&gt;
    &lt;/id&gt;
    
    &lt;property name="description" 
        not-null="true" 
        length="200"/&gt;
    &lt;property name="price" length="3"/&gt;
    &lt;property name="numberAvailable"/&gt;
    
    &lt;property name="numberOrdered"&gt;
        &lt;formula&gt;
            ( select sum(li.quantity) 
            from LineItem li 
            where li.productId = productId )
        &lt;/formula&gt;
    &lt;/property&gt;
    
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=example-mappings-composite-key-manytomany></A>23.4.3.&nbsp;&#20849;&#26377;&#32452;&#21512;&#38190;&#23646;&#24615;&#30340;&#22810;&#23545;&#22810;(Many-to-many 
with shared composite key attribute)</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;class name="User" table="`User`"&gt;
    &lt;composite-id&gt;
        &lt;key-property name="name"/&gt;
        &lt;key-property name="org"/&gt;
    &lt;/composite-id&gt;
    &lt;set name="groups" table="UserGroup"&gt;
        &lt;key&gt;
            &lt;column name="userName"/&gt;
            &lt;column name="org"/&gt;
        &lt;/key&gt;
        &lt;many-to-many class="Group"&gt;
            &lt;column name="groupName"/&gt;
            &lt;formula&gt;org&lt;/formula&gt;
        &lt;/many-to-many&gt;
    &lt;/set&gt;
&lt;/class&gt;
    
&lt;class name="Group" table="`Group`"&gt;
    &lt;composite-id&gt;
        &lt;key-property name="name"/&gt;
        &lt;key-property name="org"/&gt;
    &lt;/composite-id&gt;
    &lt;property name="description"/&gt;
    &lt;set name="users" table="UserGroup" inverse="true"&gt;
        &lt;key&gt;
            &lt;column name="groupName"/&gt;
            &lt;column name="org"/&gt;
        &lt;/key&gt;
        &lt;many-to-many class="User"&gt;
            &lt;column name="userName"/&gt;
            &lt;formula&gt;org&lt;/formula&gt;
        &lt;/many-to-many&gt;
    &lt;/set&gt;
&lt;/class&gt;
</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=example-mappings-content-discrimination></A>23.4.4.&nbsp;Content based 
discrimination</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;class name="Person"
    discriminator-value="P"&gt;
    
    &lt;id name="id" 
        column="person_id" 
        unsaved-value="0"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    
            
    &lt;discriminator 
        type="character"&gt;
        &lt;formula&gt;
            case 
                when title is not null then 'E' 
                when salesperson is not null then 'C' 
                else 'P' 
            end
        &lt;/formula&gt;
    &lt;/discriminator&gt;

    &lt;property name="name" 
        not-null="true"
        length="80"/&gt;
        
    &lt;property name="sex" 
        not-null="true"
        update="false"/&gt;
    
    &lt;component name="address"&gt;
        &lt;property name="address"/&gt;
        &lt;property name="zip"/&gt;
        &lt;property name="country"/&gt;
    &lt;/component&gt;
    
    &lt;subclass name="Employee" 
        discriminator-value="E"&gt;
            &lt;property name="title"
                length="20"/&gt;
            &lt;property name="salary"/&gt;
            &lt;many-to-one name="manager"/&gt;
    &lt;/subclass&gt;
    
    &lt;subclass name="Customer" 
        discriminator-value="C"&gt;
            &lt;property name="comments"/&gt;
            &lt;many-to-one name="salesperson"/&gt;
    &lt;/subclass&gt;
    
&lt;/class&gt;</PRE></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=example-mappings-association-alternatekeys></A>23.4.5.&nbsp;Associations on 
alternate keys</H3></DIV></DIV>
<DIV></DIV></DIV><PRE class=programlisting>&lt;class name="Person"&gt;
    
    &lt;id name="id"&gt;
        &lt;generator class="hilo"/&gt;
    &lt;/id&gt;
    
    &lt;property name="name" length="100"/&gt;
    
    &lt;one-to-one name="address" 
        property-ref="person"
        cascade="all"
        fetch="join"/&gt;
    
    &lt;set name="accounts" 
        inverse="true"&gt;
        &lt;key column="userId"
            property-ref="userId"/&gt;
        &lt;one-to-many class="Account"/&gt;
    &lt;/set&gt;
    
    &lt;property name="userId" length="8"/&gt;

&lt;/class&gt;

&lt;class name="Address"&gt;

    &lt;id name="id"&gt;
        &lt;generator class="hilo"/&gt;
    &lt;/id&gt;

    &lt;property name="address" length="300"/&gt;
    &lt;property name="zip" length="5"/&gt;
    &lt;property name="country" length="25"/&gt;
    &lt;many-to-one name="person" unique="true" not-null="true"/&gt;

&lt;/class&gt;

&lt;class name="Account"&gt;
    &lt;id name="accountId" length="32"&gt;
        &lt;generator class="uuid"/&gt;
    &lt;/id&gt;
    
    &lt;many-to-one name="user"
        column="userId"
        property-ref="userId"/&gt;
    
    &lt;property name="type" not-null="true"/&gt;
    
&lt;/class&gt;</PRE></DIV></DIV></DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A name=best-practices></A>&#31532;&nbsp;24&nbsp;&#31456;&nbsp;&#26368;&#20339;&#23454;&#36341;(Best 
Practices)</H2></DIV></DIV>
<DIV></DIV></DIV>
<DIV class=variablelist>
<DL>
  <DT><SPAN class=term>&#35774;&#35745;&#32454;&#39063;&#31890;&#24230;&#30340;&#25345;&#20037;&#31867;&#24182;&#19988;&#20351;&#29992;<TT 
  class=literal>&lt;component&gt;</TT>&#26469;&#23454;&#29616;&#26144;&#23556;&#12290;</SPAN>
  <DD>
  <P>&#20351;&#29992;&#19968;&#20010;<TT class=literal>Address</TT>&#25345;&#20037;&#31867;&#26469;&#23553;&#35013; <TT class=literal>street</TT>, <TT 
  class=literal>suburb</TT>, <TT class=literal>state</TT>, <TT 
  class=literal>postcode</TT>. &#36825;&#23558;&#26377;&#21033;&#20110;&#20195;&#30721;&#37325;&#29992;&#21644;&#31616;&#21270;&#20195;&#30721;&#37325;&#26500;(refactoring)&#30340;&#24037;&#20316;&#12290; </P>
  <DT><SPAN class=term>&#23545;&#25345;&#20037;&#31867;&#22768;&#26126;&#26631;&#35782;&#31526;&#23646;&#24615;( identifier properties)&#12290;</SPAN>
  <DD>
  <P>Hibernate&#20013;&#26631;&#35782;&#31526;&#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#65292;&#19981;&#36807;&#26377;&#24456;&#22810;&#21407;&#22240;&#26469;&#35828;&#26126;&#20320;&#24212;&#35813;&#20351;&#29992;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290;&#25105;&#20204;&#24314;&#35758;&#26631;&#35782;&#31526;&#24212;&#35813;&#26159;“&#20154;&#36896;”&#30340;(&#33258;&#21160;&#29983;&#25104;&#65292;&#19981;&#28041;&#21450;&#19994;&#21153;&#21547;&#20041;)&#12290; 
</P>
  <DT><SPAN class=term>&#20351;&#29992;&#33258;&#28982;&#38190;(natural keys)&#26631;&#35782;</SPAN>
  <DD>
  <P>&#23545;&#25152;&#26377;&#30340;&#23454;&#20307;&#37117;&#26631;&#35782;&#20986;&#33258;&#28982;&#38190;&#65292;&#29992;<TT class=literal>&lt;natural-id&gt;</TT>&#36827;&#34892;&#26144;&#23556;&#12290;&#23454;&#29616;<TT 
  class=literal>equals()</TT>&#21644;<TT 
  class=literal>hashCode()</TT>&#65292;&#22312;&#20854;&#20013;&#29992;&#32452;&#25104;&#33258;&#28982;&#38190;&#30340;&#23646;&#24615;&#36827;&#34892;&#27604;&#36739;&#12290; </P>
  <DT><SPAN class=term>&#20026;&#27599;&#20010;&#25345;&#20037;&#31867;&#20889;&#19968;&#20010;&#26144;&#23556;&#25991;&#20214;</SPAN>
  <DD>
  <P>&#19981;&#35201;&#25226;&#25152;&#26377;&#30340;&#25345;&#20037;&#31867;&#26144;&#23556;&#37117;&#20889;&#21040;&#19968;&#20010;&#22823;&#25991;&#20214;&#20013;&#12290;&#25226; <TT class=literal>com.eg.Foo</TT> &#26144;&#23556;&#21040;<TT 
  class=literal>com/eg/Foo.hbm.xml</TT>&#20013;&#65292; &#22312;&#22242;&#38431;&#24320;&#21457;&#29615;&#22659;&#20013;&#65292;&#36825;&#19968;&#28857;&#26174;&#24471;&#29305;&#21035;&#26377;&#24847;&#20041;&#12290; </P>
  <DT><SPAN class=term>&#25226;&#26144;&#23556;&#25991;&#20214;&#20316;&#20026;&#36164;&#28304;&#21152;&#36733;</SPAN>
  <DD>
  <P>&#25226;&#26144;&#23556;&#25991;&#20214;&#21644;&#20182;&#20204;&#30340;&#26144;&#23556;&#31867;&#25918;&#22312;&#19968;&#36215;&#36827;&#34892;&#37096;&#32626;&#12290; </P>
  <DT><SPAN class=term>&#32771;&#34385;&#25226;&#26597;&#35810;&#23383;&#31526;&#20018;&#25918;&#22312;&#31243;&#24207;&#22806;&#38754;</SPAN>
  <DD>
  <P>&#22914;&#26524;&#20320;&#30340;&#26597;&#35810;&#20013;&#35843;&#29992;&#20102;&#38750;ANSI&#26631;&#20934;&#30340;SQL&#20989;&#25968;&#65292;&#37027;&#20040;&#36825;&#26465;&#23454;&#36341;&#32463;&#39564;&#23545;&#20320;&#36866;&#29992;&#12290;&#25226;&#26597;&#35810;&#23383;&#31526;&#20018;&#25918;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#21487;&#20197;&#35753;&#31243;&#24207;&#20855;&#26377;&#26356;&#22909;&#30340;&#21487;&#31227;&#26893;&#24615;&#12290; </P>
  <DT><SPAN class=term>&#20351;&#29992;&#32465;&#23450;&#21464;&#37327;</SPAN>
  <DD>
  <P>&#23601;&#20687;&#22312;JDBC&#32534;&#31243;&#20013;&#19968;&#26679;&#65292;&#24212;&#35813;&#24635;&#26159;&#29992;&#21344;&#20301;&#31526;"?"&#26469;&#26367;&#25442;&#38750;&#24120;&#37327;&#20540;&#65292;&#19981;&#35201;&#22312;&#26597;&#35810;&#20013;&#29992;&#23383;&#31526;&#20018;&#20540;&#26469;&#26500;&#36896;&#38750;&#24120;&#37327;&#20540;&#65281;&#26356;&#22909;&#30340;&#21150;&#27861;&#26159;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#12290; </P>
  <DT><SPAN class=term>&#19981;&#35201;&#33258;&#24049;&#26469;&#31649;&#29702;JDBC connections</SPAN>
  <DD>
  <P>Hibernate&#20801;&#35768;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#26469;&#31649;&#29702;JDBC 
  connections&#65292;&#20294;&#26159;&#24212;&#35813;&#20316;&#20026;&#26368;&#21518;&#27809;&#26377;&#21150;&#27861;&#30340;&#21150;&#27861;&#12290;&#22914;&#26524;&#20320;&#19981;&#33021;&#20351;&#29992;Hibernate&#20869;&#24314;&#30340;connections 
  providers&#65292;&#37027;&#20040;&#32771;&#34385;&#23454;&#29616;&#33258;&#24049;&#26469;&#23454;&#29616;<TT 
  class=literal>org.hibernate.connection.ConnectionProvider</TT> </P>
  <DT><SPAN class=term>&#32771;&#34385;&#20351;&#29992;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;(custom type)</SPAN>
  <DD>
  <P>&#20551;&#35774;&#20320;&#26377;&#19968;&#20010;Java&#31867;&#22411;&#65292;&#26469;&#33258;&#26576;&#20123;&#31867;&#24211;&#65292;&#38656;&#35201;&#34987;&#25345;&#20037;&#21270;&#65292;&#20294;&#26159;&#35813;&#31867;&#27809;&#26377;&#25552;&#20379;&#26144;&#23556;&#25805;&#20316;&#38656;&#35201;&#30340;&#23384;&#21462;&#26041;&#27861;&#12290;&#37027;&#20040;&#20320;&#24212;&#35813;&#32771;&#34385;&#23454;&#29616;<TT 
  class=literal>org.hibernate.UserType</TT>&#25509;&#21475;&#12290;&#36825;&#31181;&#21150;&#27861;&#20351;&#31243;&#24207;&#20195;&#30721;&#20889;&#36215;&#26469;&#26356;&#21152;&#33258;&#22914;&#65292;&#19981;&#20877;&#38656;&#35201;&#32771;&#34385;&#31867;&#19982;Hibernate 
  type&#20043;&#38388;&#30340;&#30456;&#20114;&#36716;&#25442;&#12290; </P>
  <DT><SPAN class=term>&#22312;&#24615;&#33021;&#29942;&#39048;&#30340;&#22320;&#26041;&#20351;&#29992;&#30828;&#32534;&#30721;&#30340;JDBC</SPAN>
  <DD>
  <P>In performance-critical areas of the system, some kinds of operations might 
  benefit from direct JDBC. But please, wait until you <SPAN 
  class=emphasis><EM>know</EM></SPAN> something is a bottleneck. And don't 
  assume that direct JDBC is necessarily faster. If you need to use direct JDBC, 
  it might be worth opening a Hibernate <TT class=literal>Session</TT> and using 
  that JDBC connection. That way you can still use the same transaction strategy 
  and underlying connection provider. 
  &#22312;&#31995;&#32479;&#20013;&#23545;&#24615;&#33021;&#35201;&#27714;&#24456;&#20005;&#26684;&#30340;&#19968;&#20123;&#37096;&#20998;&#65292;&#26576;&#20123;&#25805;&#20316;&#20063;&#35768;&#30452;&#25509;&#20351;&#29992;JDBC&#20250;&#26356;&#22909;&#12290;&#20294;&#26159;&#35831;&#20808;<SPAN 
  class=emphasis><EM>&#30830;&#35748;</EM></SPAN>&#36825;&#30340;&#30830;&#26159;&#19968;&#20010;&#29942;&#39048;&#65292;&#24182;&#19988;&#19981;&#35201;&#24819;&#24403;&#28982;&#35748;&#20026;JDBC&#19968;&#23450;&#20250;&#26356;&#24555;&#12290;&#22914;&#26524;&#30830;&#23454;&#38656;&#35201;&#30452;&#25509;&#20351;&#29992;JDBC&#65292;&#37027;&#20040;&#26368;&#22909;&#25171;&#24320;&#19968;&#20010; 
  Hibernate <TT class=literal>Session</TT> &#28982;&#21518;&#20174; <TT 
  class=literal>Session</TT>&#33719;&#24471;connection&#65292;&#25353;&#29031;&#36825;&#31181;&#21150;&#27861;&#20320;&#20173;&#28982;&#21487;&#20197;&#20351;&#29992;&#21516;&#26679;&#30340;transaction&#31574;&#30053;&#21644;&#24213;&#23618;&#30340;connection 
  provider&#12290; </P>
  <DT><SPAN class=term>&#29702;&#35299;<TT class=literal>Session</TT>&#28165;&#27927;&#65288; flushing&#65289;</SPAN>
  <DD>
  <P>Session&#20250;&#19981;&#26102;&#30340;&#21521;&#25968;&#25454;&#24211;&#21516;&#27493;&#25345;&#20037;&#21270;&#29366;&#24577;&#65292;&#22914;&#26524;&#36825;&#31181;&#25805;&#20316;&#36827;&#34892;&#30340;&#36807;&#20110;&#39057;&#32321;&#65292;&#24615;&#33021;&#20250;&#21463;&#21040;&#19968;&#23450;&#30340;&#24433;&#21709;&#12290;&#26377;&#26102;&#20505;&#20320;&#21487;&#20197;&#36890;&#36807;&#31105;&#27490;&#33258;&#21160;flushing&#65292;&#23613;&#37327;&#26368;&#23567;&#21270;&#38750;&#24517;&#35201;&#30340;flushing&#25805;&#20316;&#65292;&#25110;&#32773;&#26356;&#36827;&#19968;&#27493;&#65292;&#22312;&#19968;&#20010;&#29305;&#23450;&#30340;transaction&#20013;&#25913;&#21464;&#26597;&#35810;&#21644;&#20854;&#23427;&#25805;&#20316;&#30340;&#39034;&#24207;&#12290; 
  </P>
  <DT><SPAN class=term>&#22312;&#19977;&#23618;&#32467;&#26500;&#20013;&#65292;&#32771;&#34385;&#20351;&#29992;&#25176;&#31649;&#23545;&#35937;&#65288;detached object&#65289;</SPAN>
  <DD>
  <P>&#24403;&#20351;&#29992;&#19968;&#20010;servlet / session bean &#31867;&#22411;&#30340;&#26550;&#26500;&#30340;&#26102;&#20505;, &#20320;&#21487;&#20197;&#25226;&#24050;&#21152;&#36733;&#30340;&#25345;&#20037;&#23545;&#35937;&#22312;session bean&#23618;&#21644;servlet / 
  JSP &#23618;&#20043;&#38388;&#26469;&#22238;&#20256;&#36882;&#12290;&#20351;&#29992;&#26032;&#30340;session&#26469;&#20026;&#27599;&#20010;&#35831;&#27714;&#26381;&#21153;&#65292;&#20351;&#29992; <TT class=literal>Session.merge()</TT> 
  &#25110;&#32773;<TT class=literal>Session.saveOrUpdate()</TT>&#26469;&#19982;&#25968;&#25454;&#24211;&#21516;&#27493;&#12290; </P>
  <DT><SPAN class=term>&#22312;&#20004;&#23618;&#32467;&#26500;&#20013;&#65292;&#32771;&#34385;&#20351;&#29992;&#38271;&#25345;&#20037;&#19978;&#19979;&#25991;(long persistence contexts).</SPAN>
  <DD>
  <P>&#20026;&#20102;&#24471;&#21040;&#26368;&#20339;&#30340;&#21487;&#20280;&#32553;&#24615;&#65292;&#25968;&#25454;&#24211;&#20107;&#21153;(Database Transaction)&#24212;&#35813;&#23613;&#21487;&#33021;&#30340;&#30701;&#12290;&#20294;&#26159;&#65292;&#31243;&#24207;&#24120;&#24120;&#38656;&#35201;&#23454;&#29616;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;<SPAN 
  class=emphasis><EM>“&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;(Application 
  Transaction)”</EM></SPAN>&#65292;&#21253;&#21547;&#19968;&#20010;&#20174;&#29992;&#25143;&#30340;&#35266;&#28857;&#26469;&#30475;&#30340;&#21407;&#23376;&#25805;&#20316;&#12290;&#36825;&#20010;&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;&#21487;&#33021;&#36328;&#36234;&#22810;&#27425;&#20174;&#29992;&#25143;&#35831;&#27714;&#21040;&#24471;&#21040;&#21453;&#39304;&#30340;&#24490;&#29615;&#12290;&#29992;&#33073;&#31649;&#23545;&#35937;(&#19982;session&#33073;&#31163;&#30340;&#23545;&#35937;)&#26469;&#23454;&#29616;&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;&#26159;&#24120;&#35265;&#30340;&#12290;&#25110;&#32773;&#65292;&#23588;&#20854;&#22312;&#20004;&#23618;&#32467;&#26500;&#20013;&#65292;&#25226;Hibernate 
  Session&#20174;JDBC&#36830;&#25509;&#20013;&#33073;&#31163;&#24320;&#65292;&#19979;&#27425;&#38656;&#35201;&#29992;&#30340;&#26102;&#20505;&#20877;&#36830;&#25509;&#19978;&#12290;&#32477;&#19981;&#35201;&#25226;&#19968;&#20010;Session&#29992;&#22312;&#22810;&#20010;&#24212;&#29992;&#31243;&#24207;&#20107;&#21153;(Application 
  Transaction)&#20013;&#65292;&#21542;&#21017;&#20320;&#30340;&#25968;&#25454;&#21487;&#33021;&#20250;&#36807;&#26399;&#22833;&#25928;&#12290; </P>
  <DT><SPAN class=term>&#19981;&#35201;&#25226;&#24322;&#24120;&#30475;&#25104;&#21487;&#24674;&#22797;&#30340;</SPAN>
  <DD>
  <P>&#36825;&#19968;&#28857;&#29978;&#33267;&#27604;“&#26368;&#20339;&#23454;&#36341;”&#36824;&#35201;&#37325;&#35201;&#65292;&#36825;&#26159;“&#24517;&#22791;&#24120;&#35782;”&#12290;&#24403;&#24322;&#24120;&#21457;&#29983;&#30340;&#26102;&#20505;&#65292;&#24517;&#39035;&#35201;&#22238;&#28378; <TT class=literal>Transaction</TT> 
  &#65292;&#20851;&#38381;<TT 
  class=literal>Session</TT>&#12290;&#22914;&#26524;&#20320;&#19981;&#36825;&#26679;&#20570;&#30340;&#35805;&#65292;Hibernate&#26080;&#27861;&#20445;&#35777;&#20869;&#23384;&#29366;&#24577;&#31934;&#30830;&#30340;&#21453;&#24212;&#25345;&#20037;&#29366;&#24577;&#12290;&#23588;&#20854;&#19981;&#35201;&#20351;&#29992;<TT 
  class=literal>Session.load()</TT>&#26469;&#21028;&#26029;&#19968;&#20010;&#32473;&#23450;&#26631;&#35782;&#31526;&#30340;&#23545;&#35937;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#26159;&#21542;&#23384;&#22312;&#65292;&#24212;&#35813;&#20351;&#29992;<TT 
  class=literal>Session.get()</TT>&#25110;&#32773;&#36827;&#34892;&#19968;&#27425;&#26597;&#35810;. </P>
  <DT><SPAN class=term>&#23545;&#20110;&#20851;&#32852;&#20248;&#20808;&#32771;&#34385;lazy fetching </SPAN>
  <DD>
  <P>&#35880;&#24910;&#30340;&#20351;&#29992;&#20027;&#21160;&#25235;&#21462;(eager 
  fetching)&#12290;&#23545;&#20110;&#20851;&#32852;&#26469;&#35828;&#65292;&#33509;&#20854;&#30446;&#26631;&#26159;&#26080;&#27861;&#22312;&#31532;&#20108;&#32423;&#32531;&#23384;&#20013;&#23436;&#20840;&#32531;&#23384;&#25152;&#26377;&#23454;&#20363;&#30340;&#31867;&#65292;&#24212;&#35813;&#20351;&#29992;&#20195;&#29702;(proxies)&#19982;/&#25110;&#20855;&#26377;&#24310;&#36831;&#21152;&#36733;&#23646;&#24615;&#30340;&#38598;&#21512;(lazy 
  collections)&#12290;&#33509;&#30446;&#26631;&#26159;&#21487;&#20197;&#34987;&#32531;&#23384;&#30340;&#65292;&#23588;&#20854;&#26159;&#32531;&#23384;&#30340;&#21629;&#20013;&#29575;&#38750;&#24120;&#39640;&#30340;&#24773;&#20917;&#19979;&#65292;&#24212;&#35813;&#20351;&#29992;<TT 
  class=literal>lazy="false"</TT>&#65292;&#26126;&#30830;&#30340;&#31105;&#27490;&#25481;eager fetching&#12290;&#22914;&#26524;&#37027;&#20123;&#29305;&#27530;&#30340;&#30830;&#23454;&#36866;&#21512;&#20351;&#29992;join fetch 
  &#30340;&#22330;&#21512;&#65292;&#35831;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;<TT class=literal>left join fetch</TT>&#12290; </P>
  <DT><SPAN class=term>&#20351;&#29992;<SPAN class=emphasis><EM>open session in 
  view</EM></SPAN>&#27169;&#24335;&#65292;&#25110;&#32773;&#25191;&#34892;&#20005;&#26684;&#30340;<SPAN class=emphasis><EM>&#35013;&#37197;&#26399;(assembly 
  phase)</EM></SPAN>&#31574;&#30053;&#26469;&#36991;&#20813;&#20877;&#27425;&#25235;&#21462;&#25968;&#25454;&#24102;&#26469;&#30340;&#38382;&#39064; </SPAN>
  <DD>
  <P>Hibernate&#35753;&#24320;&#21457;&#32773;&#20204;&#25670;&#33073;&#20102;&#32321;&#29712;&#30340;<SPAN class=emphasis><EM>Data Transfer 
  Objects</EM></SPAN> (DTO)&#12290;&#22312;&#20256;&#32479;&#30340;EJB&#32467;&#26500;&#20013;&#65292;DTO&#26377;&#21452;&#37325;&#20316;&#29992;&#65306;&#39318;&#20808;&#65292;&#20182;&#20204;&#35299;&#20915;&#20102;entity 
  bean&#26080;&#27861;&#24207;&#21015;&#21270;&#30340;&#38382;&#39064;&#65307;&#20854;&#27425;&#65292;&#20182;&#20204;&#38544;&#21547;&#22320;&#23450;&#20041;&#20102;&#19968;&#20010;&#35013;&#37197;&#26399;&#65292;&#22312;&#27492;&#26399;&#38388;&#65292;&#25152;&#26377;&#22312;view&#23618;&#38656;&#35201;&#29992;&#21040;&#30340;&#25968;&#25454;&#65292;&#37117;&#34987;&#25235;&#21462;&#12289;&#38598;&#20013;&#21040;&#20102;DTO&#20013;&#65292;&#28982;&#21518;&#25511;&#21046;&#25165;&#34987;&#35013;&#21040;&#34920;&#31034;&#23618;&#12290;Hibernate&#32456;&#32467;&#20102;&#31532;&#19968;&#20010;&#20316;&#29992;&#12290;&#28982;&#32780;&#65292;&#38500;&#38750;&#20320;&#20570;&#22909;&#20102;&#22312;&#25972;&#20010;&#28210;&#26579;&#36807;&#31243;&#20013;&#37117;&#32500;&#25252;&#19968;&#20010;&#25171;&#24320;&#30340;&#25345;&#20037;&#21270;&#19978;&#19979;&#25991;(session)&#30340;&#20934;&#22791;&#65292;&#20320;&#20173;&#28982;&#38656;&#35201;&#19968;&#20010;&#35013;&#37197;&#26399;&#65288;&#24819;&#35937;&#19968;&#19979;&#65292;&#20320;&#30340;&#19994;&#21153;&#26041;&#27861;&#19982;&#20320;&#30340;&#34920;&#31034;&#23618;&#26377;&#20005;&#26684;&#30340;&#22865;&#32422;&#65292;&#25968;&#25454;&#24635;&#26159;&#34987;&#25918;&#32622;&#21040;&#25176;&#31649;&#23545;&#35937;&#20013;&#65289;&#12290;&#36825;&#24182;&#38750;&#26159;Hibernate&#30340;&#38480;&#21046;&#65281;&#36825;&#26159;&#23454;&#29616;&#23433;&#20840;&#30340;&#20107;&#21153;&#21270;&#25968;&#25454;&#35775;&#38382;&#30340;&#22522;&#26412;&#38656;&#27714;&#12290; 
  </P>
  <DT><SPAN class=term>&#32771;&#34385;&#25226;Hibernate&#20195;&#30721;&#20174;&#19994;&#21153;&#36923;&#36753;&#20195;&#30721;&#20013;&#25277;&#35937;&#20986;&#26469;</SPAN>
  <DD>
  <P>&#25226;Hibernate&#30340;&#25968;&#25454;&#23384;&#21462;&#20195;&#30721;&#38544;&#34255;&#21040;&#25509;&#21475;(interface)&#30340;&#21518;&#38754;&#65292;&#32452;&#21512;&#20351;&#29992;<SPAN 
  class=emphasis><EM>DAO</EM></SPAN>&#21644;<SPAN class=emphasis><EM>Thread Local 
  Session</EM></SPAN>&#27169;&#24335;&#12290;&#36890;&#36807;Hibernate&#30340;<TT 
  class=literal>UserType</TT>&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#30828;&#32534;&#30721;&#30340;JDBC&#26469;&#25345;&#20037;&#21270;&#37027;&#20123;&#26412;&#35813;&#34987;Hibernate&#25345;&#20037;&#21270;&#30340;&#31867;&#12290; 
  (&#35813;&#24314;&#35758;&#26356;&#36866;&#29992;&#20110;&#35268;&#27169;&#36275;&#22815;&#22823;&#24212;&#29992;&#36719;&#20214;&#20013;&#65292;&#23545;&#20110;&#37027;&#20123;&#21482;&#26377;5&#24352;&#34920;&#30340;&#24212;&#29992;&#31243;&#24207;&#24182;&#19981;&#36866;&#21512;&#12290;) </P>
  <DT><SPAN class=term>&#19981;&#35201;&#29992;&#24618;&#24322;&#30340;&#36830;&#25509;&#26144;&#23556;</SPAN>
  <DD>
  <P>&#22810;&#23545;&#22810;&#36830;&#25509;&#29992;&#24471;&#22909;&#30340;&#20363;&#23376;&#23454;&#38469;&#19978;&#30456;&#24403;&#23569;&#35265;&#12290;&#22823;&#22810;&#25968;&#26102;&#20505;&#20320;&#22312;“&#36830;&#25509;&#34920;”&#20013;&#38656;&#35201;&#20445;&#23384;&#39069;&#22806;&#30340;&#20449;&#24687;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#29992;&#20004;&#20010;&#25351;&#21521;&#20013;&#20171;&#31867;&#30340;&#19968;&#23545;&#22810;&#30340;&#36830;&#25509;&#27604;&#36739;&#22909;&#12290;&#23454;&#38469;&#19978;&#65292;&#25105;&#20204;&#35748;&#20026;&#32477;&#22823;&#22810;&#25968;&#30340;&#36830;&#25509;&#26159;&#19968;&#23545;&#22810;&#21644;&#22810;&#23545;&#19968;&#30340;&#65292;&#20320;&#24212;&#35813;&#35880;&#24910;&#20351;&#29992;&#20854;&#23427;&#36830;&#25509;&#39118;&#26684;&#65292;&#29992;&#20043;&#21069;&#38382;&#33258;&#24049;&#19968;&#21477;&#65292;&#26159;&#21542;&#30495;&#30340;&#24517;&#39035;&#36825;&#20040;&#20570;&#12290; 
  </P>
  <DT><SPAN class=term>&#20559;&#29233;&#21452;&#21521;&#20851;&#32852;</SPAN>
  <DD>
  <P>&#21333;&#21521;&#20851;&#32852;&#26356;&#21152;&#38590;&#20110;&#26597;&#35810;&#12290;&#22312;&#22823;&#22411;&#24212;&#29992;&#20013;&#65292;&#20960;&#20046;&#25152;&#26377;&#30340;&#20851;&#32852;&#24517;&#39035;&#22312;&#26597;&#35810;&#20013;&#21487;&#20197;&#21452;&#21521;&#23548;&#33322;&#12290; 
</P></DD></DL></DIV></DIV></DIV></BODY></HTML>
