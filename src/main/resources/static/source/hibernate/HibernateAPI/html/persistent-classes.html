<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>&#31532; 4 &#31456; &#25345;&#20037;&#21270;&#31867;(Persistent Classes)</TITLE>
<META content="text/html; charset=ISO-8859-1" http-equiv=Content-Type><LINK 
rel=stylesheet type=text/css href="../shared/css/html.css">
<META name=GENERATOR content="MSHTML 11.00.9431.193"><LINK 
title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;" rel=home href="index.html"><LINK 
title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;" rel=up href="index.html"><LINK 
title="&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#10;        &#37197;&#32622;&#10;    " rel=previous 
href="session-configuration.html"><LINK 
title="&#31532;&nbsp;5&nbsp;&#31456;&nbsp;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R Mapping)" rel=next 
href="mapping.html"></HEAD>
<BODY aLink=#0000ff link=#0000ff bgColor=white text=black vLink=#840084>
<DIV class=navheader>
<TABLE width="100%" summary="Navigation header">
  <TBODY>
  <TR>
    <TH colSpan=3 align=center>&#31532;&nbsp;4&nbsp;&#31456;&nbsp;&#25345;&#20037;&#21270;&#31867;(Persistent 
  Classes)</TH></TR>
  <TR>
    <TD width="20%" align=left><A accessKey=p 
      href="session-configuration.html">&#19978;&#19968;&#39029;</A>&nbsp;</TD>
    <TH width="60%" align=center>&nbsp;</TH>
    <TD width="20%" align=right>&nbsp;<A accessKey=n 
      href="mapping.html">&#19979;&#19968;&#39029;</A></TD></TR></TBODY></TABLE>
<HR>
</DIV>
<DIV lang=zh-cn class=chapter>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title><A 
name=persistent-classes></A>&#31532;&nbsp;4&nbsp;&#31456;&nbsp;&#25345;&#20037;&#21270;&#31867;(Persistent Classes)</H2>
<P class=title>&#23398;&#20064;<FONT color=#ff0000>QQ&#32676;&#65306;</FONT><FONT color=#ff0000 
size=5>476133513&nbsp;&nbsp; &#21487;&#20197;&#21152;&#32676;&#19968;&#36215;&#35752;&#35770;&#23398;&#20064;</FONT></P></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22312;&#24212;&#29992;&#31243;&#24207;&#20013;&#65292;&#29992;&#26469;&#23454;&#29616;&#19994;&#21153;&#38382;&#39064;&#23454;&#20307;&#30340;&#65288;&#22914;&#65292;&#22312;&#30005;&#23376;&#21830;&#21153;&#24212;&#29992;&#31243;&#24207;&#20013;&#30340;Customer&#21644;Order&#65289; 
&#31867;&#23601;&#26159;&#25345;&#20037;&#21270;&#31867;&#12290;&#19981;&#33021;&#35748;&#20026;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#37117;&#26159;&#25345;&#20037;&#30340;&#29366;&#24577;——&#19968;&#20010;&#23454;&#20363;&#30340;&#29366;&#24577;&#20063;&#21487;&#33021; &#26159;&#30636;&#26102;&#30340;&#25110;&#33073;&#31649;&#30340;&#12290; </P>
<P>&#22914;&#26524;&#36825;&#20123;&#25345;&#20037;&#21270;&#31867;&#36981;&#24490;&#19968;&#20123;&#31616;&#21333;&#30340;&#35268;&#21017;&#65292;Hibernate&#33021;&#22815;&#24037;&#20316;&#24471;&#26356;&#22909;&#65292;&#36825;&#20123;&#35268;&#21017;&#20063;&#34987;&#31216;&#20316; &#31616;&#21333;&#20256;&#32479;Java&#23545;&#35937;(POJO:Plain Old Java 
Object)&#32534;&#31243;&#27169;&#22411;&#12290;&#20294;&#26159;&#36825;&#20123;&#35268;&#21017;&#24182;&#19981;&#26159;&#24517;&#38656;&#30340;&#12290; &#23454;&#38469;&#19978;&#65292;Hibernate3&#23545;&#20110;&#20320;&#30340;&#25345;&#20037;&#21270;&#31867;&#20960;&#20046;&#19981;&#20570;&#20219;&#20309;&#35774;&#24819;&#12290;&#20320;&#21487;&#20197;&#29992;&#20854;&#20182;&#30340;&#26041;&#27861;&#26469;&#34920;&#36798;&#39046;&#22495;&#27169;&#22411;&#65306; 
&#27604;&#22914;&#65292;&#20351;&#29992;<TT class=literal>Map</TT>&#23454;&#20363;&#30340;&#26641;&#22411;&#32467;&#26500;&#12290; </P>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-pojo></A>4.1.&nbsp;&#19968;&#20010;&#31616;&#21333;&#30340;POJO&#20363;&#23376;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22823;&#22810;&#25968;Java&#31243;&#24207;&#38656;&#35201;&#29992;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#26469;&#34920;&#31034;&#29483;&#31185;&#21160;&#29289;&#12290; </P><PRE class=programlisting>package eg;
import java.util.Set;
import java.util.Date;

public class Cat {
    private Long id; // identifier

    private Date birthdate;
    private Color color;
    private char sex;
    private float weight;
    private int litterId;

    private Cat mother;
    private Set kittens = new HashSet();

    private void setId(Long id) {
        this.id=id;
    }
    public Long getId() {
        return id;
    }

    void setBirthdate(Date date) {
        birthdate = date;
    }
    public Date getBirthdate() {
        return birthdate;
    }

    void setWeight(float weight) {
        this.weight = weight;
    }
    public float getWeight() {
        return weight;
    }

    public Color getColor() {
        return color;
    }
    void setColor(Color color) {
        this.color = color;
    }

    void setSex(char sex) {
        this.sex=sex;
    }
    public char getSex() {
        return sex;
    }

    void setLitterId(int id) {
        this.litterId = id;
    }
    public int getLitterId() {
        return litterId;
    }

    void setMother(Cat mother) {
        this.mother = mother;
    }
    public Cat getMother() {
        return mother;
    }
    void setKittens(Set kittens) {
        this.kittens = kittens;
    }
    public Set getKittens() {
        return kittens;
    }
    
    // addKitten not needed by Hibernate
    public void addKitten(Cat kitten) {
    	kitten.setMother(this);
	kitten.setLitterId( kittens.size() ); 
        kittens.add(kitten);
    }
}</PRE>
<P>&#36825;&#37324;&#35201;&#36981;&#24490;&#22235;&#26465;&#20027;&#35201;&#30340;&#35268;&#21017;&#65306; </P>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-constructor></A>4.1.1.&nbsp;&#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#65288;&#21363;&#26080;&#21442;&#25968;&#30340;&#65289;&#26500;&#36896;&#26041;&#27861;&#65288;constructor&#65289;</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#26377;&#19968;&#20010;&#26080;&#21442;&#25968;&#30340;&#26500;&#36896;&#26041;&#27861;&#12290;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#37117;&#24517;&#39035;&#26377;&#19968;&#20010; 
&#40664;&#35748;&#30340;&#26500;&#36896;&#26041;&#27861;&#65288;&#21487;&#20197;&#19981;&#26159;public&#30340;&#65289;&#65292;&#36825;&#26679;&#30340;&#35805;Hibernate&#23601;&#21487;&#20197;&#20351;&#29992; <TT 
class=literal>Constructor.newInstance()</TT>&#26469;&#23454;&#20363;&#21270;&#23427;&#20204;&#12290; 
&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#65292;&#22312;Hibernate&#20013;&#65292;&#20026;&#20102;&#36816;&#34892;&#26399;&#20195;&#29702;&#30340;&#29983;&#25104;&#65292;&#26500;&#36896;&#26041;&#27861;&#33267;&#23569;&#26159; <SPAN 
class=emphasis><EM>&#21253;(package)</EM></SPAN>&#20869;&#21487;&#35265;&#30340;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-identifier></A>4.1.2.&nbsp;&#25552;&#20379;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;identifier 
property&#65289;&#65288;&#21487;&#36873;&#65289; </H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#26377;&#19968;&#20010;&#23646;&#24615;&#21483;&#20570;<TT class=literal>id</TT>&#12290;&#36825;&#20010;&#23646;&#24615;&#26144;&#23556;&#25968;&#25454;&#24211;&#34920;&#30340;&#20027; 
&#38190;&#23383;&#27573;&#12290;&#36825;&#20010;&#23646;&#24615;&#21487;&#20197;&#21483;&#20219;&#20309;&#21517;&#23383;&#65292;&#20854;&#31867;&#22411;&#21487;&#20197;&#26159;&#20219;&#20309;&#30340;&#21407;&#22987;&#31867;&#22411;&#12289;&#21407;&#22987;&#31867;&#22411;&#30340;&#21253;&#35013;&#31867;&#22411;&#12289; <TT class=literal>java.lang.String</TT> 
&#25110;&#32773;&#26159; <TT class=literal>java.util.Date</TT>&#12290; 
&#65288;&#22914;&#26524;&#20320;&#30340;&#36951;&#30041;&#25968;&#25454;&#24211;&#34920;&#26377;&#32852;&#21512;&#20027;&#38190;&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#19968;&#20010;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#31867;&#65292;&#35813;&#31867;&#25317;&#26377;&#36825;&#20123;&#31867;&#22411; &#30340;&#23646;&#24615;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;&#20851;&#20110;&#32852;&#21512;&#26631;&#35782;&#31526;&#30340;&#31456;&#33410;&#12290;&#65289; </P>
<P>&#26631;&#35782;&#31526;&#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#12290;&#21487;&#20197;&#19981;&#29992;&#31649;&#23427;&#65292;&#35753;Hibernate&#20869;&#37096;&#26469;&#36861;&#36394;&#23545;&#35937;&#30340;&#35782;&#21035;&#12290; &#20294;&#26159;&#25105;&#20204;&#24182;&#19981;&#25512;&#33616;&#36825;&#26679;&#20570;&#12290; </P>
<P>&#23454;&#38469;&#19978;&#65292;&#19968;&#20123;&#21151;&#33021;&#21482;&#23545;&#37027;&#20123;&#22768;&#26126;&#20102;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#31867;&#36215;&#20316;&#29992;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#25176;&#31649;&#23545;&#35937;&#30340;&#20256;&#25773;&#24615;&#20877;&#36830;&#25509;&#65288;&#32423;&#32852;&#26356;&#26032;&#25110;&#32423;&#32852;&#21512;&#24182;&#65289; ——&#21442;&#38405; <A 
  title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)" 
  href="objectstate.html#objectstate-transitive">&#31532;&nbsp;10.11&nbsp;&#33410; 
  “&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)”</A> </P>
  <LI>
  <P><TT class=literal>Session.saveOrUpdate()</TT> </P>
  <LI>
  <P><TT class=literal>Session.merge()</TT> </P></LI></UL></DIV>
<P>&#25105;&#20204;&#24314;&#35758;&#20320;&#23545;&#25345;&#20037;&#21270;&#31867;&#22768;&#26126;&#21629;&#21517;&#19968;&#33268;&#30340;&#26631;&#35782;&#23646;&#24615;&#12290;&#25105;&#20204;&#36824;&#24314;&#35758;&#20320;&#20351;&#29992;&#19968; &#20010;&#21487;&#20197;&#20026;&#31354;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#19981;&#26159;&#21407;&#22987;&#31867;&#22411;&#65289;&#30340;&#31867;&#22411;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A name=persistent-classes-pojo-final></A>4.1.3.&nbsp;&#20351;&#29992;&#38750;final&#30340;&#31867; 
(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#20195;&#29702;&#65288;proxies&#65289;</EM></SPAN>&#26159;Hibernate&#30340;&#19968;&#20010;&#37325;&#35201;&#30340;&#21151;&#33021;&#65292;&#23427;&#20381;&#36182;&#30340;&#26465;&#20214;&#26159;&#65292;&#25345;&#20037; 
&#21270;&#31867;&#25110;&#32773;&#26159;&#38750;final&#30340;&#65292;&#25110;&#32773;&#26159;&#23454;&#29616;&#20102;&#19968;&#20010;&#25152;&#26377;&#26041;&#27861;&#37117;&#22768;&#26126;&#20026;public&#30340;&#25509;&#21475;&#12290; </P>
<P>&#20320;&#21487;&#20197;&#29992;Hibernate&#25345;&#20037;&#21270;&#19968;&#20010;&#27809;&#26377;&#23454;&#29616;&#20219;&#20309;&#25509;&#21475;&#30340;<TT class=literal>final</TT>&#31867;&#65292;&#20294;&#26159;&#20320; 
&#19981;&#33021;&#20351;&#29992;&#20195;&#29702;&#26469;&#24310;&#36831;&#20851;&#32852;&#21152;&#36733;&#65292;&#36825;&#20250;&#38480;&#21046;&#20320;&#36827;&#34892;&#24615;&#33021;&#20248;&#21270;&#30340;&#36873;&#25321;&#12290; </P>
<P>&#20320;&#20063;&#24212;&#35813;&#36991;&#20813;&#22312;&#38750;final&#31867;&#20013;&#22768;&#26126; <TT class=literal>public final</TT>&#30340;&#26041;&#27861;&#12290;&#22914;&#26524;&#20320;&#24819;&#20351;&#29992;&#19968; &#20010;&#26377;<TT 
class=literal>public final</TT>&#26041;&#27861;&#30340;&#31867;&#65292;&#20320;&#24517;&#39035;&#36890;&#36807;&#35774;&#32622;<TT class=literal>lazy="false"</TT> 
&#26469;&#26126;&#30830;&#22320;&#31105;&#29992;&#20195;&#29702;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect2>
<DIV class=titlepage>
<DIV>
<DIV>
<H3 class=title><A 
name=persistent-classes-pojo-accessors></A>4.1.4.&nbsp;&#20026;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#35775;&#38382;&#22120;(accessors)&#21644;&#26159;&#21542;&#21487;&#21464;&#30340;&#26631;&#24535;(mutators)(&#21487;&#36873;)</H3></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>Cat</TT>&#20026;&#23427;&#30340;&#25152;&#26377;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#20102;&#35775;&#38382;&#26041;&#27861;&#12290;&#24456;&#22810;&#20854;&#20182;ORM&#24037;&#20855;&#30452;&#25509;&#23545; 
&#23454;&#20363;&#21464;&#37327;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290;&#25105;&#20204;&#30456;&#20449;&#65292;&#22312;&#20851;&#31995;&#25968;&#25454;&#24211;schema&#21644;&#31867;&#30340;&#20869;&#37096;&#25968;&#25454;&#32467;&#26500;&#20043;&#38388;&#24341;&#20837;&#38388;&#25509;&#23618;(&#21407;&#25991;&#20026;"&#38750;&#30452;&#25509;"&#65292;indirection)&#20250;&#22909;&#19968;&#20123;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;Hibernate&#25345;&#20037;&#21270;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#65292;&#35748;&#21487; 
<TT class=literal>getFoo</TT>&#65292;<TT class=literal>isFoo</TT> &#21644; <TT 
class=literal>setFoo</TT>&#36825;&#31181;&#24418;&#24335;&#30340;&#26041;&#27861;&#21517;&#12290; &#22914;&#26524;&#38656;&#35201;&#65292;&#20320;&#21487;&#20197;&#23545;&#26576;&#20123;&#29305;&#23450;&#23646;&#24615;&#23454;&#34892;&#30452;&#25509;&#23383;&#27573;&#35775;&#38382;&#12290; </P>
<P>&#23646;&#24615;<SPAN class=emphasis><EM>&#19981;&#38656;&#35201;</EM></SPAN>&#35201;&#22768;&#26126;&#20026;public&#30340;&#12290;Hibernate&#21487;&#20197;&#25345;&#20037;&#21270;&#19968;&#20010;&#26377; <TT 
class=literal>default</TT>&#12289;<TT class=literal>protected</TT>&#25110;<TT 
class=literal>private</TT>&#30340;get/set&#26041;&#27861;&#23545; &#30340;&#23646;&#24615;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290; </P></DIV></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-inheritance></A>4.2.&nbsp;&#23454;&#29616;&#32487;&#25215;&#65288;Inheritance&#65289;</H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#23376;&#31867;&#20063;&#24517;&#39035;&#36981;&#23432;&#31532;&#19968;&#26465;&#21644;&#31532;&#20108;&#26465;&#35268;&#21017;&#12290;&#23427;&#20174;&#36229;&#31867;<TT class=literal>Cat</TT>&#32487;&#25215;&#20102;&#26631;&#35782;&#23646;&#24615;&#12290; </P><PRE class=programlisting>package eg;

public class DomesticCat extends Cat {
        private String name;

        public String getName() {
                return name;
        }
        protected void setName(String name) {
                this.name=name;
        }
}</PRE></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-equalshashcode></A>4.3.&nbsp;&#23454;&#29616;<TT 
class=literal>equals()</TT>&#21644;<TT class=literal>hashCode()</TT></H2></DIV></DIV>
<DIV></DIV></DIV>
<P>&#22914;&#26524;&#20320;&#26377;&#22914;&#19979;&#38656;&#27714;&#65292;&#20320;&#24517;&#39035;&#37325;&#36733; <TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#26041;&#27861;&#65306; </P>
<DIV class=itemizedlist>
<UL type=disc compact>
  <LI>
  <P>&#24819;&#25226;&#25345;&#20037;&#31867;&#30340;&#23454;&#20363;&#25918;&#20837;<TT class=literal>Set</TT>&#20013;&#65288;&#24403;&#34920;&#31034;&#22810;&#20540;&#20851;&#32852;&#26102;&#65292;&#25512;&#33616;&#36825;&#20040;&#20570;&#65289; </P>
  <LI>
  <P>&#24819;&#37325;&#29992;&#33073;&#31649;&#23454;&#20363; </P></LI></UL></DIV>
<P>Hibernate&#20445;&#35777;&#65292;&#20165;&#22312;&#29305;&#23450;&#20250;&#35805;&#33539;&#22260;&#20869;&#65292;&#25345;&#20037;&#21270;&#26631;&#35782;&#65288;&#25968;&#25454;&#24211;&#30340;&#34892;&#65289;&#21644;Java&#26631;&#35782;&#26159;&#31561;&#20215;&#30340;&#12290;&#22240;&#27492;&#65292;&#19968;&#26086; &#25105;&#20204;&#28151;&#21512;&#20102;&#20174;&#19981;&#21516;&#20250;&#35805;&#20013;&#33719;&#21462;&#30340;&#23454;&#20363;&#65292;&#22914;&#26524;&#24076;&#26395;<TT 
class=literal>Set</TT>&#26377;&#26126;&#30830;&#30340;&#35821;&#20041;&#65292;&#23601;&#24517; &#39035;&#23454;&#29616;<TT class=literal>equals()</TT> &#21644;<TT 
class=literal>hashCode()</TT>&#12290; </P>
<P>&#23454;&#29616;<TT class=literal>equals()</TT>/<TT 
class=literal>hashCode()</TT>&#26368;&#26174;&#32780;&#26131;&#35265;&#30340;&#26041;&#27861;&#26159;&#27604;&#36739;&#20004;&#20010;&#23545;&#35937; 
&#26631;&#35782;&#31526;&#30340;&#20540;&#12290;&#22914;&#26524;&#20540;&#30456;&#21516;&#65292;&#21017;&#20004;&#20010;&#23545;&#35937;&#23545;&#24212;&#20110;&#25968;&#25454;&#24211;&#30340;&#21516;&#19968;&#34892;&#65292;&#22240;&#27492;&#23427;&#20204;&#26159;&#30456;&#31561;&#30340;&#65288;&#22914;&#26524;&#37117;&#34987;&#28155;&#21152;&#21040; <TT class=literal>Set</TT>&#65292;&#21017;&#22312;<TT 
class=literal>Set</TT>&#20013;&#21482;&#26377;&#19968;&#20010;&#20803;&#32032;&#65289;&#12290;&#19981;&#24184;&#30340;&#26159;&#65292;&#23545;&#29983;&#25104;&#30340;&#26631;&#35782;&#19981;&#33021; 
&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#12290;Hibernate&#20165;&#23545;&#37027;&#20123;&#25345;&#20037;&#21270;&#23545;&#35937;&#36171;&#26631;&#35782;&#20540;&#65292;&#19968;&#20010;&#26032;&#21019;&#24314;&#30340;&#23454;&#20363;&#23558;&#19981;&#20250;&#26377;&#20219;&#20309;&#26631;&#35782;&#20540;&#12290;&#27492;&#22806;&#65292; 
&#22914;&#26524;&#19968;&#20010;&#23454;&#20363;&#27809;&#26377;&#34987;&#20445;&#23384;(unsaved)&#65292;&#24182;&#19988;&#23427;&#24403;&#21069;&#27491;&#22312;&#19968;&#20010;<TT class=literal>Set</TT>&#20013;&#65292;&#20445;&#23384;&#23427;&#23558;&#20250;&#32473;&#36825;&#20010;&#23545;&#35937; 
&#36171;&#19968;&#20010;&#26631;&#35782;&#20540;&#12290;&#22914;&#26524;<TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#26159;&#22522;&#20110;&#26631;&#35782;&#20540; &#23454;&#29616;&#30340;&#65292;&#21017;&#20854;&#21704;&#24076;&#30721;&#23558;&#20250;&#25913;&#21464;&#65292;&#36825;&#36829;&#21453;&#20102;<TT 
class=literal>Set</TT>&#30340;&#22865;&#32422;&#12290;&#24314;&#35758;&#21435;Hibernate&#30340;&#31449;&#28857;&#38405;&#35835;&#20851;&#20110;&#36825;&#20010; 
&#38382;&#39064;&#30340;&#20840;&#37096;&#35752;&#35770;&#12290;&#27880;&#24847;&#65292;&#36825;&#19981;&#26159;Hibernate&#30340;&#38382;&#39064;&#65292;&#32780;&#26159;&#19968;&#33324;&#30340;Java&#23545;&#35937;&#26631;&#35782;&#21644;Java&#23545;&#35937;&#31561;&#20215;&#30340;&#35821;&#20041;&#38382;&#39064;&#12290; </P>
<P>&#25105;&#20204;&#24314;&#35758;&#20351;&#29992;<SPAN class=emphasis><EM>&#19994;&#21153;&#38190;&#20540;&#30456;&#31561;(Business key 
equality)</EM></SPAN>&#26469;&#23454;&#29616;<TT class=literal>equals()</TT> &#21644; <TT 
class=literal>hashCode()</TT>&#12290;&#19994;&#21153;&#38190;&#20540;&#30456;&#31561;&#30340;&#24847;&#24605;&#26159;&#65292;<TT class=literal>equals()</TT>&#26041;&#27861; 
&#20165;&#20165;&#27604;&#36739;&#24418;&#25104;&#19994;&#21153;&#38190;&#30340;&#23646;&#24615;&#65292;&#23427;&#33021;&#22312;&#29616;&#23454;&#19990;&#30028;&#37324;&#26631;&#35782;&#25105;&#20204;&#30340;&#23454;&#20363;&#65288;&#26159;&#19968;&#20010;<SPAN class=emphasis><EM>&#33258;&#28982;&#30340;</EM></SPAN>&#20505;&#36873;&#30721;&#65289;&#12290; 
</P><PRE class=programlisting>public class Cat {

    ...
    public boolean equals(Object other) {
        if (this == other) return true;
        if ( !(other instanceof Cat) ) return false;

        final Cat cat = (Cat) other;

        if ( !cat.getLitterId().equals( getLitterId() ) ) return false;
        if ( !cat.getMother().equals( getMother() ) ) return false;

        return true;
    }

    public int hashCode() {
        int result;
        result = getMother().hashCode();
        result = 29 * result + getLitterId();
        return result;
    }

}</PRE>
<P>&#27880;&#24847;&#65292;&#19994;&#21153;&#38190;&#19981;&#24517;&#20687;&#25968;&#25454;&#24211;&#30340;&#20027;&#38190;&#37027;&#26679;&#22266;&#23450;&#19981;&#21464;&#65288;&#21442;&#35265;<A 
title="11.1.3.&nbsp;&#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering object identity)" 
href="transactions.html#transactions-basics-identity">&#31532;&nbsp;11.1.3&nbsp;&#33410; 
“&#20851;&#27880;&#23545;&#35937;&#26631;&#35782;(Considering object identity)”</A>&#65289;&#12290; &#23545;&#19994;&#21153;&#38190;&#32780;&#35328;&#65292;&#19981;&#21487;&#21464;&#25110;&#21807;&#19968;&#30340;&#23646;&#24615;&#26159;&#19981;&#38169;&#30340;&#36873;&#25321;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-dynamicmodels></A>4.4.&nbsp;&#21160;&#24577;&#27169;&#22411;(Dynamic 
models)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><SPAN class=emphasis><EM>&#27880;&#24847;&#65292;&#20197;&#19979;&#29305;&#24615;&#22312;&#24403;&#21069;&#22788;&#20110;&#35797;&#39564;&#38454;&#27573;&#65292;&#23558;&#26469;&#21487;&#33021;&#20250;&#26377;&#21464;&#21270;&#12290;</EM></SPAN> </P>
<P>&#36816;&#34892;&#26399;&#30340;&#25345;&#20037;&#21270;&#23454;&#20307;&#27809;&#26377;&#24517;&#35201;&#19968;&#23450;&#34920;&#31034;&#20026;&#20687;POJO&#31867;&#25110;JavaBean&#23545;&#35937;&#37027;&#26679;&#30340;&#24418;&#24335;&#12290;Hibernate&#20063;&#25903;&#25345;&#21160;&#24577;&#27169;&#22411; &#65288;&#22312;&#36816;&#34892;&#26399;&#20351;&#29992;<TT 
class=literal>Map</TT>&#30340;<TT class=literal>Map</TT>&#65289;&#21644;&#35937;DOM4J&#30340;&#26641;&#27169;&#22411;&#37027; 
&#26679;&#30340;&#23454;&#20307;&#34920;&#31034;&#12290;&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#65292;&#20320;&#19981;&#29992;&#20889;&#25345;&#20037;&#21270;&#31867;&#65292;&#21482;&#20889;&#26144;&#23556;&#25991;&#20214;&#23601;&#34892;&#20102;&#12290; </P>
<P>Hibernate&#40664;&#35748;&#24037;&#20316;&#22312;&#26222;&#36890;POJO&#27169;&#24335;&#12290;&#20320;&#21487;&#20197;&#20351;&#29992;&#37197;&#32622;&#36873;&#39033;<TT class=literal>default_entity_mode</TT>&#65292; 
&#23545;&#29305;&#23450;&#30340;<TT class=literal>SessionFactory</TT>&#65292;&#35774;&#32622;&#19968;&#20010;&#40664;&#35748;&#30340;&#23454;&#20307;&#34920;&#31034;&#27169;&#24335;&#12290; &#65288;&#21442;&#35265;<A 
title="&#34920;&nbsp;3.3.&nbsp;&#10;                Hibernate&#37197;&#32622;&#23646;&#24615;&#10;            " 
href="session-configuration.html#configuration-optional-properties">&#34920;&nbsp;3.3 “ 
Hibernate&#37197;&#32622;&#23646;&#24615; ”</A>&#12290;&#65289; </P>
<P>&#19979;&#38754;&#26159;&#29992;<TT class=literal>Map</TT>&#26469;&#34920;&#31034;&#30340;&#20363;&#23376;&#12290;&#39318;&#20808;&#65292;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#65292;&#35201;&#22768;&#26126; <TT 
class=literal>entity-name</TT>&#26469;&#20195;&#26367;&#19968;&#20010;&#31867;&#21517;&#65288;&#25110;&#20316;&#20026;&#19968;&#31181;&#38468;&#23646;&#65289;&#12290; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;

    &lt;class entity-name="Customer"&gt;

        &lt;id name="id"
            type="long"
            column="ID"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;

        &lt;property name="name"
            column="NAME"
            type="string"/&gt;

        &lt;property name="address"
            column="ADDRESS"
            type="string"/&gt;

        &lt;many-to-one name="organization"
            column="ORGANIZATION_ID"
            class="Organization"/&gt;

        &lt;bag name="orders"
            inverse="true"
            lazy="false"
            cascade="all"&gt;
            &lt;key column="CUSTOMER_ID"/&gt;
            &lt;one-to-many class="Order"/&gt;
        &lt;/bag&gt;

    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</PRE>
<P>&#27880;&#24847;&#65292;&#34429;&#28982;&#26159;&#29992;&#30446;&#26631;&#31867;&#21517;&#26469;&#22768;&#26126;&#20851;&#32852;&#30340;&#65292;&#20294;&#26159;&#20851;&#32852;&#30340;&#30446;&#26631;&#31867;&#22411;&#38500;&#20102;&#26159;POJO&#20043;&#22806;&#65292;&#20063;&#21487;&#20197; &#26159;&#19968;&#20010;&#21160;&#24577;&#30340;&#23454;&#20307;&#12290; </P>
<P>&#22312;&#20351;&#29992;<TT class=literal>dynamic-map</TT>&#20026;<TT class=literal>SessionFactory</TT> 
&#35774;&#32622;&#20102;&#40664;&#35748;&#30340;&#23454;&#20307;&#27169;&#24335;&#20043;&#21518;&#65292;&#21487;&#20197;&#22312;&#36816;&#34892;&#26399;&#20351;&#29992;<TT class=literal>Map</TT>&#30340; <TT class=literal>Map</TT>&#12290; 
</P><PRE class=programlisting>Session s = openSession();
Transaction tx = s.beginTransaction();
Session s = openSession();

// Create a customer
Map david = new HashMap();
david.put("name", "David");

// Create an organization
Map foobar = new HashMap();
foobar.put("name", "Foobar Inc.");

// Link both
david.put("organization", foobar);

// Save both
s.save("Customer", david);
s.save("Organization", foobar);

tx.commit();
s.close();</PRE>
<P>&#21160;&#24577;&#26144;&#23556;&#30340;&#22909;&#22788;&#26159;&#65292;&#21464;&#21270;&#25152;&#38656;&#35201;&#30340;&#26102;&#38388;&#23569;&#20102;&#65292;&#22240;&#20026;&#21407;&#22411;&#19981;&#38656;&#35201;&#23454;&#29616;&#23454;&#20307;&#31867;&#12290;&#28982;&#32780;&#65292;&#20320;&#26080;&#27861;&#36827;&#34892; 
&#32534;&#35793;&#26399;&#30340;&#31867;&#22411;&#26816;&#26597;&#65292;&#24182;&#21487;&#33021;&#30001;&#27492;&#20250;&#22788;&#29702;&#24456;&#22810;&#30340;&#36816;&#34892;&#26399;&#24322;&#24120;&#12290;&#24184;&#20111;&#26377;&#20102;Hibernate&#26144;&#23556;&#65292;&#23427;&#20351;&#24471;&#25968; 
&#25454;&#24211;&#30340;schema&#33021;&#23481;&#26131;&#30340;&#35268;&#26684;&#21270;&#21644;&#21512;&#29702;&#21270;&#65292;&#24182;&#20801;&#35768;&#31245;&#21518;&#22312;&#27492;&#20043;&#19978;&#28155;&#21152;&#21512;&#36866;&#30340;&#39046;&#22495;&#27169;&#22411;&#23454;&#29616;&#12290; </P>
<P>&#23454;&#20307;&#34920;&#31034;&#27169;&#24335;&#20063;&#33021;&#22312;&#27599;&#20010;<TT class=literal>Session</TT>&#30340;&#22522;&#30784;&#19978;&#35774;&#32622;&#65306; </P><PRE class=programlisting>Session dynamicSession = pojoSession.getSession(EntityMode.MAP);

// Create a customer
Map david = new HashMap();
david.put("name", "David");
dynamicSession.save("Customer", david);
...
dynamicSession.flush();
dynamicSession.close()
...
// Continue on pojoSession
</PRE>
<P>&#35831;&#27880;&#24847;&#65292;&#29992;<TT class=literal>EntityMode</TT>&#35843;&#29992;<TT class=literal>getSession()</TT>&#26159;&#22312; 
<TT class=literal>Session</TT>&#30340;API&#20013;&#65292;&#32780;&#19981;&#26159;<TT class=literal>SessionFactory</TT>&#12290; 
&#36825;&#26679;&#65292;&#26032;&#30340;<TT class=literal>Session</TT>&#20849;&#20139;&#24213;&#23618;&#30340;JDBC&#36830;&#25509;&#65292;&#20107;&#21153;&#65292;&#21644;&#20854;&#20182;&#30340;&#19978;&#19979;&#25991;&#20449; &#24687;&#12290;&#36825;&#24847;&#21619;&#30528;&#65292;&#20320;&#19981;&#38656;&#35201;&#22312;&#31532;&#20108;&#20010;<TT 
class=literal>Session</TT>&#20013;&#35843;&#29992; <TT class=literal>flush()</TT>&#21644;<TT 
class=literal>close()</TT>&#65292;&#21516;&#26679;&#30340;&#65292;&#25226;&#20107;&#21153;&#21644;&#36830;&#25509;&#30340;&#22788;&#29702; &#20132;&#32473;&#21407;&#26469;&#30340;&#24037;&#20316;&#21333;&#20803;&#12290; </P>
<P>&#20851;&#20110;XML&#34920;&#31034;&#33021;&#21147;&#30340;&#26356;&#22810;&#20449;&#24687;&#21487;&#20197;&#22312;<A title=&#31532;&nbsp;18&nbsp;&#31456;&nbsp;XML&#26144;&#23556; 
href="xml.html">&#31532;&nbsp;18&nbsp;&#31456; <I>XML&#26144;&#23556;</I></A>&#20013;&#25214;&#21040;&#12290; </P></DIV>
<DIV lang=zh-cn class=sect1>
<DIV class=titlepage>
<DIV>
<DIV>
<H2 class=title style="CLEAR: both"><A 
name=persistent-classes-tuplizers></A>4.5.&nbsp;&#20803;&#32452;&#29255;&#26029;&#26144;&#23556;(Tuplizers)</H2></DIV></DIV>
<DIV></DIV></DIV>
<P><TT class=literal>org.hibernate.tuple.Tuplizer</TT>&#65292;&#20197;&#21450;&#20854;&#23376;&#25509;&#21475;&#65292;&#36127;&#36131;&#26681;&#25454;&#32473;&#23450;&#30340;<TT 
class=literal>org.hibernate.EntityMode</TT>&#65292;&#26469;&#22797;&#29616;&#29255;&#26029;&#25968;&#25454;&#12290;&#22914;&#26524;&#32473;&#23450;&#30340;&#29255;&#26029;&#25968;&#25454;&#34987;&#35748;&#20026;&#20854;&#26159;&#19968;&#31181;&#25968;&#25454;&#32467;&#26500;&#65292;"tuplizer"&#23601;&#26159;&#19968;&#20010;&#30693;&#36947;&#22914;&#20309;&#21019;&#24314;&#36825;&#26679;&#30340;&#25968;&#25454;&#32467;&#26500;&#65292;&#20197;&#21450;&#22914;&#20309;&#32473;&#36825;&#20010;&#25968;&#25454;&#32467;&#26500;&#36171;&#20540;&#30340;&#19996;&#35199;&#12290;&#27604;&#22914;&#35828;&#65292;&#23545;&#20110;POJO&#36825;&#31181;Entity 
Mode&#65292;&#23545;&#24212;&#30340;tuplizer&#30693;&#36947;&#36890;&#36807;&#20854;&#26500;&#36896;&#26041;&#27861;&#26469;&#21019;&#24314;&#19968;&#20010;POJO&#65292;&#20877;&#36890;&#36807;&#20854;&#23646;&#24615;&#35775;&#38382;&#22120;&#26469;&#35775;&#38382;POJO&#23646;&#24615;&#12290;&#26377;&#20004;&#22823;&#31867;&#39640;&#23618;Tuplizer&#65292;&#20998;&#21035;&#26159;<TT 
class=literal>org.hibernate.tuple.EntityTuplizer</TT> &#21644;<TT 
class=literal>org.hibernate.tuple.ComponentTuplizer</TT>&#25509;&#21475;&#12290;<TT 
class=literal>EntityTuplizer</TT>&#36127;&#36131;&#31649;&#29702;&#19978;&#38754;&#25552;&#21040;&#30340;&#23454;&#20307;&#30340;&#22865;&#32422;&#65292;&#32780;<TT 
class=literal>ComponentTuplizer</TT>&#21017;&#26159;&#38024;&#23545;&#32452;&#20214;&#30340;&#12290; </P>
<P>&#29992;&#25143;&#20063;&#21487;&#20197;&#25554;&#20837;&#20854;&#33258;&#23450;&#20041;&#30340;tuplizer&#12290;&#25110;&#35768;&#24744;&#38656;&#35201;&#19968;&#31181;&#19981;&#21516;&#20110;dynamic-map entity-mode&#20013;&#20351;&#29992;&#30340;<TT 
class=literal>java.util.HashMap</TT>&#30340;<TT 
class=literal>java.util.Map</TT>&#23454;&#29616;&#65307;&#25110;&#35768;&#24744;&#38656;&#35201;&#19982;&#40664;&#35748;&#31574;&#30053;&#19981;&#21516;&#30340;&#20195;&#29702;&#29983;&#25104;&#31574;&#30053;(proxy generation 
strategy)&#12290;&#36890;&#36807;&#33258;&#23450;&#20041;tuplizer&#23454;&#29616;&#65292;&#36825;&#20004;&#20010;&#30446;&#26631;&#24744;&#37117;&#21487;&#20197;&#36798;&#21040;&#12290;Tuplizer&#23450;&#20041;&#34987;&#38468;&#21152;&#21040;&#23427;&#20204;&#26399;&#26395;&#31649;&#29702;&#30340;entity&#25110;&#32773;component&#26144;&#23556;&#20013;&#12290;&#22238;&#21040;&#25105;&#20204;&#30340;customer 
entity&#20363;&#23376;&#65306; </P><PRE class=programlisting>&lt;hibernate-mapping&gt;
    &lt;class entity-name="Customer"&gt;
        &lt;!--
            Override the dynamic-map entity-mode
            tuplizer for the customer entity
        --&gt;
        &lt;tuplizer entity-mode="dynamic-map"
                class="CustomMapTuplizerImpl"/&gt;

        &lt;id name="id" type="long" column="ID"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;

        &lt;!-- other properties --&gt;
        ...
    &lt;/class&gt;
&lt;/hibernate-mapping&gt;


public class CustomMapTuplizerImpl
        extends org.hibernate.tuple.DynamicMapEntityTuplizer {
    // override the buildInstantiator() method to plug in our custom map...
    protected final Instantiator buildInstantiator(
            org.hibernate.mapping.PersistentClass mappingInfo) {
        return new CustomMapInstantiator( mappingInfo );
    }

    private static final class CustomMapInstantiator
            extends org.hibernate.tuple.DynamicMapInstantitor {
        // override the generateMap() method to return our custom map...
	    protected final Map generateMap() {
		    return new CustomMap();
	    }
    }
}</PRE></DIV>
<P>TODO&#65306;property&#21644;proxy&#21253;&#37324;&#30340;&#29992;&#25143;&#25193;&#23637;&#26694;&#26550;&#25991;&#26723;&#12290; </P></DIV>
<DIV class=navfooter>
<HR>

<TABLE width="100%" summary="Navigation footer">
  <TBODY>
  <TR>
    <TD width="40%" align=left><A accessKey=p 
      href="session-configuration.html">&#19978;&#19968;&#39029;</A>&nbsp;</TD>
    <TD width="20%" align=center><A accessKey=u href="index.html">&#19978;&#19968;&#32423;</A></TD>
    <TD width="40%" align=right>&nbsp;<A accessKey=n 
      href="mapping.html">&#19979;&#19968;&#39029;</A></TD></TR>
  <TR>
    <TD vAlign=top width="40%" align=left>&#31532;&nbsp;3&nbsp;&#31456;&nbsp; &#37197;&#32622; &nbsp;</TD>
    <TD width="20%" align=center><A accessKey=h href="index.html">&#36215;&#22987;&#39029;</A></TD>
    <TD vAlign=top width="40%" 
      align=right>&nbsp;&#31532;&nbsp;5&nbsp;&#31456;&nbsp;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#22522;&#30784;(Basic O/R 
  Mapping)</TD></TR></TBODY></TABLE></DIV></BODY></HTML>
