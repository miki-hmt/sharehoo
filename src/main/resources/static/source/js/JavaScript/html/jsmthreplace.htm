<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>replace 方法</TITLE>
<!--CSS_START-->
<style>@import url(../html-vss/msdnie4a.css);</style>
<link disabled rel="stylesheet" href="../html-vss/msdn_ie3.css">
<!--CSS_END-->
</HEAD>
<BODY>


<!--Start Head-->
<TABLE class="banner" width="100%" CELLSPACING=0>
<TR>
<TD class="bannerleft" nowrap>JScript&nbsp;</TD>
<TD class="bannerright" nowrap><a href="../html-vss/jsTOC.htm">语言参考</a></TD>
</TR>
</TABLE>
<HR>
<!--End Head-->

<H1><A NAME="jsmthreplace"></A>replace 方法</H1>

<P>返回根据正则表达式进行文字替换后的字符串的复制。</P>

<P><CODE>stringObj.<B>replace(</B>rgExp, replaceText<B>)</B></CODE></P>

<H4>参数</H4>

<P class=dt>stringObj </P>

<P class=indent>必选项。要执行该替换的 <B>String</B> 对象或字符串文字。该字符串不会被 <B>replace</B> 方法修改。 </P>

<P class=dt>rgExp </P>

<P class=indent>必选项。为包含正则表达式模式或可用标志的<B>正则表达式</B>对象。也可以是 <B>String</B> 对象或文字。如果 <I>rgExp </I>不是<B>正则表达式</B>对象，它将被转换为字符串，并进行精确的查找；不要尝试将字符串转化为正则表达式。</P>

<P class=dt>replaceText </P>

<P class=indent>必选项。是一个<B>String</B> 对象或字符串文字，对于<I>stringObj</I> 中每个匹配 <I>rgExp</I> 中的位置都用该对象所包含的文字加以替换。在 Jscript 5.5 或更新版本中，<I>replaceText</I> 参数也可以是返回替换文本的函数。</P>

<H4>说明</H4>

<P><B>replace</B> 方法的结果是一个完成了指定替换的 <I>stringObj</I> 对象的复制。 </P>

<P>下面任意的匹配变量都能用来识别最新的匹配以及找出匹配的字符串。在需要动态决定替换字符串的文本替换中可以使用匹配变量。</P>

<TABLE border=1 cellspacing=0 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TH width=20%>字符</TH>
<TH width=80%>含义</TH>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$$</B></TD>
<TD width=80%><B>$</B> （JScript 5.5 或更新版本）</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$&amp;</B></TD>
<TD width=80%>指定与整个模式匹配的 <I>stringObj</I> 的部分。 （JScript 5.5 或更新版本）</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$`</B></TD>
<TD width=80%>指定由 <B>$&amp;</B> 描述的匹配之前的 <I>stringObj</I> 部分。 （JScript 5.5 或更新版本）</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$'</B></TD>
<TD width=80%>指定由 <B>$&amp;</B> 描述的匹配之后的 <I>stringObj</I> 部分。 （JScript 5.5 或更新版本）</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$<I>n</I></B></TD>
<TD width=80%>捕获的第 <I>n</I> 个子匹配，此处 <I>n</I> 为从1到9的十进制一位数。 （JScript 5.5 或更新版本）</TD>
</TR>

<TR VALIGN="top">
<TD width=20%><B>$<I>nn</I></B></TD>
<TD width=80%>捕获的第 <I>nn</I> 个子匹配，此处 <I>nn</I> 为从01到99的十进制两位数。 （JScript 5.5 或更新版本）</TD>
</TR>
</TABLE><BR>

<P>如果 <I>replaceText</I> 为函数，对于每一个匹配的子字符串，调用该函数时带有下面的 m+3 个参数，此处 m 是在 <I>rgExp</I> 中捕获的左括弧的个数。第一个参数是匹配的子字符串。接下来的 <I>m</I> 个参数是查找中捕获的全部结果。第 <I>m</I>+2 个参数是在 <I>stringObj</I> 中匹配出现的偏移量，而第 <I>m</I>+3 个参数为 <I>stringObj</I>。结果为将每一匹配的子字符串替换为函数调用的相应返回值的字符串值。</P>

<P><B>Replace </B>方法更新全局 <B>RegExp</B> 对象的属性。</P>

<H4>示例</H4>

<P>下面的示例演示了 <B>replace</B> 方法将第一次出现的单词 "The" 替换为单词 "A" 的用法。</P>

<PRE><CODE>function ReplaceDemo(){
&nbsp;&nbsp;&nbsp;var r, re;                    // </CODE>声明变量。
<CODE>   var ss = "The man hit the ball with the bat.\n";</CODE>
<CODE>   ss += "while the fielder caught the ball with the glove.";</CODE>
<CODE>&nbsp;&nbsp;&nbsp;re = /The/g;             // </CODE>创建正则表达式模式。
&nbsp;&nbsp;&nbsp;<CODE>r = <span class=cfe><B>ss.replace(</B></span>re<span class=cfe><B>,</B></span> "A"<span class=cfe><B>)</B></span>;    // </CODE>用<CODE> "A" </CODE>替换<CODE> "The"</CODE>。
&nbsp;&nbsp;&nbsp;<CODE>return(r);                   // </CODE>返回替换后的字符串。
}</PRE>

<P>另外, <B>replace</B> 方法也可以替换模式中的子表达式。 下面的范例演示了交换字符串中的每一对单词： </P>

<PRE><CODE>function ReplaceDemo(){
&nbsp;&nbsp;&nbsp;var r, re;                      // </CODE>声明变量。
&nbsp;&nbsp;&nbsp;<CODE>var ss = "The rain in Spain falls mainly in the plain.";</CODE>
<CODE>&nbsp;&nbsp;&nbsp;re = /(\S+)(\s+)(\S+)/g;        // </CODE>创建正则表达式模式。
&nbsp;&nbsp;&nbsp;<CODE>r = <span class=cfe><B>ss.replace(</B></span>re<span class=cfe><B>,</B></span> "$3$2$1"<span class=cfe><B>)</B></span>;&nbsp;&nbsp;&nbsp;// </CODE>交换每一对单词。
&nbsp;&nbsp;&nbsp;<CODE>return(r);                      // </CODE>返回结果字符串。
}</PRE>

<P>下面的示例（在 JScript 5.5 及更新版本中执行）执行的是从华氏到摄氏的转换，它演示了使用函数作为 <I>replaceText</I>。要想知道该函数是如何工作的，传递一个包含数值的字符串，数值后要紧跟 "F" （例如 "Water boils at 212"）。</P>

<PRE><CODE>function f2c(s) {
  var test = /(\d+(\.\d*)?)F\b/g;    // </CODE>初始化模式。
<CODE>  return(<span class=cfe><B>s.replace</B></span></CODE>
<span class=cfe><B><CODE>    (test,</CODE></B></span>
<span class=cfe><B><CODE>      function($0,$1,$2) { </CODE></B></span>
<span class=cfe><B><CODE>        return((($1-32) * 5/9) + "C");</CODE></B></span>
<span class=cfe><B><CODE>      }</CODE></B></span>
<span class=cfe><B><CODE>    )</CODE></B></span>
<CODE>  );</CODE>
<CODE>}</CODE>
<CODE>document.write(f2c("Water freezes at 32F and boils at 212F."));</CODE></PRE>

<H4>要求</H4>

<P><A HREF="jsoriversioninformation.htm">版本 1</A> </P>

<H4>请参阅</H4>

<P><A HREF="jsmthexec.htm">exec 方法</A> | <A HREF="jsmthmatch.htm">match 方法</A> | <A HREF="jsobjregexp.htm">RegExp 对象</A> | <A HREF="jsmthsearch.htm">search 方法</A> | <A HREF="jsobjstring.htm#jsobjstringmeth">String 对象的方法</A> | <A HREF="jsmthtest.htm">test 方法</A></P>

<P>应用于： <A HREF="jsobjstring.htm">String 对象</A></P>
<!--Copyright_START-->
<DIV CLASS="footer">
<HR><a href="jscopy.htm">&copy; 2000 Microsoft Corporation 版权所有。保留所有权利。使用规定。</a><br>
</DIV> <!--Copyright_END-->

</BODY>
</HTML>
