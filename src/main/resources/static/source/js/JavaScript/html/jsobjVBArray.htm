<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=gb2312">
<TITLE>VBArray 对象</TITLE>
<!--CSS_START-->
<style>@import url(../html-vss/msdnie4a.css);</style>
<link disabled rel="stylesheet" href="../html-vss/msdn_ie3.css">
<!--CSS_END-->
</HEAD>
<BODY>


<!--Start Head-->
<TABLE class="banner" width="100%" CELLSPACING=0>
<TR>
<TD class="bannerleft" nowrap>JScript&nbsp;</TD>
<TD class="bannerright" nowrap><a href="../html-vss/jsTOC.htm">语言参考</a></TD>
</TR>
</TABLE>
<HR>
<!--End Head-->

<H1><A NAME="jsobjvbarray"></A>VBArray 对象</H1>

<P>提供对 Visual Basic 安全数组的访问。</P>

<P><CODE><I>varName</I> = <B>new VBArray(</B><I>safeArray</I><B>)</B> </CODE></P>

<H4>参数</H4>

<P class=dt><I>varName</I></P>

<P class=indent>必选项。要赋值为 VBArray 的变量名。</P>

<P class=dt><I>safeArray</I></P>

<P class=indent>必选项。<B>VBArray</B> 值。</P>

<H4>说明</H4>

<P><B>VBArrays</B> 是只读的，并且不能被直接创建。在传递给 <B>VBArray</B> 构造函数之前 <I>safeArray</I> 参数必须已获得 <B>VBArray </B>值。这只能通过从已有的 ActiveX 或其它对象获得值才能做到。</P>

<P><B>VBArrays</B> 可以有多维。每一维的下标可以不一样。<B>dimensions</B> 方法取得数组的维数；<B>lbound</B> 和 <B>ubound</B> 方法取得每个维的下标范围。</P>

<H4>示例</H4>

<P>下面的例子由三部分组成。第一部分是创建 Visual Basic 安全数组的 VBScript 代码。第二部分是将 VB 安全数组转换为 JScript 数组的 JScript 代码。这两部分都放到 HTML 页的 &lt;HEAD&gt; 节中。第三部分是放在 &lt;BODY&gt; 节中以运行其它两部分的 JScript 代码。 </P>

<PRE><CODE>&lt;HEAD&gt;
&lt;SCRIPT LANGUAGE="VBScript"&gt;
&lt;!--
Function CreateVBArray()
&nbsp;&nbsp;&nbsp;Dim i, j, k
&nbsp;&nbsp;&nbsp;Dim a(2, 2)
&nbsp;&nbsp;&nbsp;k = 1
&nbsp;&nbsp;&nbsp;For i = 0 To 2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For j = 0 To 2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a(j, i) = k
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.writeln(k)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k = k + 1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.writeln("vbCRLF")
&nbsp;&nbsp;&nbsp;Next
&nbsp;&nbsp;&nbsp;CreateVBArray = a
End Function
--&gt;
&lt;/SCRIPT&gt;

&lt;SCRIPT LANGUAGE="JScript"&gt;
&lt;!--
function VBArrayTest(vbarray){
&nbsp;&nbsp;&nbsp;var a = <span class=cfe><B>new VBArray(</B></span>vbarray<span class=cfe><B>)</B></span>;
&nbsp;&nbsp;&nbsp;var b = a.toArray();
&nbsp;&nbsp;&nbsp;var i;
&nbsp;&nbsp;&nbsp;for (i = 0; i &lt; 9; i++) 
&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.writeln(b[i]);
&nbsp;&nbsp;&nbsp;}
}
--&gt;
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
&lt;!--
&nbsp;&nbsp;&nbsp;VBArrayTest(CreateVBArray());
--&gt;
&lt;/SCRIPT&gt;
&lt;/BODY&gt;</CODE></PRE>

<H4>属性</H4>

<P><B>VBArray</B> 对象没有属性。</P>

<H4>方法</H4>

<P><A HREF="jsmthdimensions.htm">dimensions 方法</A> | <A HREF="jsmthgetitem.htm">getItem 方法</A> | <A HREF="jsmthlbound.htm">lbound 方法</A> | <A HREF="jsmthtoarray.htm">toArray 方法</A> | <A HREF="jsmthubound.htm">ubound 方法</A></P>

<H4>要求</H4>

<P><A HREF="jsoriversioninformation.htm">版本 3</A></P>

<H4>请参阅</H4>

<P><A HREF="jsobjarray.htm">Array 对象</A></P>
<!--Copyright_START-->
<DIV CLASS="footer">
<HR><a href="jscopy.htm">&copy; 2000 Microsoft Corporation 版权所有。保留所有权利。使用规定。</a><br>
</DIV> <!--Copyright_END-->

</BODY>
</HTML>
